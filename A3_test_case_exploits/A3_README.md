# A3: Test Cases and Proof-of-Concept Exploits

This directory contains the generated test cases and proof-of-concept
exploit payloads used to validate the vulnerability-triggering behavior
described in the paper. All A3 experiments are conducted **only in a
simulation environment** based on OAI and 5Ghoul.

‚ö†Ô∏è **Important:**  
All provided exploits are **simulation-only** and are **not usable
over-the-air (OTA)**.

---

## Prerequisites

- Docker is installed and running
- The A1 simulation environment is launched using the provided Docker image: kqing0515/oai_testing:v3
- Reviewers may either:
- Run everything locally using Docker, **or**
- Use the **pre-configured remote desktop environment** provided via HotCRP
  (recommended, as the container and payloads are already set up)

---

## Step 1: Copy Payloads into the Docker Container

After the Docker container is running, copy the prepared payloads into
the container.

On the host machine:

```
sudo docker ps
```
Identify the running container ID (CONTAINER_ID), then run:

```
sudo docker cp contest_AE_final/A3_test_case_exploits/payloads \
CONTAINER_ID:/home/5ghoul-5g-nr-attacks/modules/exploits/5gnr_gnb
```

## üìå Note:
If you are using the provided remote desktop environment, this step can
be skipped‚Äîthe payloads have already been placed in the correct location.

## Step 2: Enter the Docker Container

```
sudo docker exec -it CONTAINER_ID /bin/bash
```

Inside the container:

```
cd /home/5ghoul-5g-nr-attacks/modules/exploits/5gnr_gnb
cp ./payloads/* ./
cd /home/5ghoul-5g-nr-attacks
```

## Step 3: Recompile Exploits

Recompile all exploit payloads using:

```
sudo bin/5g_fuzzer --list-exploits
```

## ‚ö†Ô∏è Note:

Some compilation warnings or errors may appear during this step.
These can be safely ignored as long as the target exploit is successfully
registered.

## Step 4: Run a Specific Exploit Payload

The available exploit names can be found in:
```
contest_AE_final/A3_test_case_exploits/compiled_payloads/
```

To run a specific exploit:

```
sudo ./bin/5g_fuzzer \
  --exploit=PAYLOAD_NAME \
  --MCC=001 \
  --MNC=01 \
  --GlobalTimeout=false \
  --EnableMutation=false
```

### Example

If the exploit file is:

```
mac_sch_6e99a9e9.cpp
```
Run:
```
sudo ./bin/5g_fuzzer \
  --exploit=mac_sch_6e99a9e9 \
  --MCC=001 \
  --MNC=01 \
  --GlobalTimeout=false \
  --EnableMutation=false
```

## Expected Behavior (With Exploit)

When running a valid exploit payload, the simulator should frequently
report:

```
[!] UE process crashed
```

This indicates successful triggering of the vulnerability in the simulated UE.

## Baseline Behavior (Without Exploit)

As a control experiment, run the simulator **without loading any exploit**:
```
sudo bin/5g_fuzzer \
  --EnableSimulator=true \
  --EnableMutation=false \
  --GlobalTimeout=false
```

Expected output in this case is typically:

```
[!] UE process stopped
[!] UE process started
```

Crashes ([!] UE process crashed) should occur **rarely**, although some instability in the simulator is known and expected.

## Notes

- All crashes observed in A3 are **simulation-only** and occur in a
controlled laboratory environment.
- These experiments are intended to validate the **exploitability and
reproducibility** of the generated test cases, not to demonstrate real-world OTA attacks.