<!-- Page 1151 of ts_138331v170000p -->

3GPP TS 38.331 version 17.0.0 Release 17
1150
ETSI TS 138331 V17.0.0 (2022-05)

A nested two-level CHOICE structure is used, where the alternative PDU types are alternatives within the inner level \( c / \) CHOICE.
Spare alternatives (i.e., sparel in this case) may be included within the \( c l \) CHOICE to facilitate future extension. The number of such spare alternatives should not extend the total number of alternatives beyond an integer-power-of-two number of alternatives (i.e., eight in this case).

Further extension of the number of alternative PDU types is facilitated using the messageClass Extension alternative in the outer level CHOICE.
A.3.3 Message definition

Each PDU (message) type is specified in an ASN. 1 clause similar to the one shown in the example below.
```
-- /example/ ASN1START
RRCConnectionReconfiguration ::= SEQUENCE \
    rrc-TransactionIdentifier RRC-TransactionIdentifier,
    criticalExtensions CHOICE [
        cl CHOICEl
            rrcConnectionReconfiguration-r8 RRCConnectionReconfiguration-r8-IEs,
            spare3 NULL, spare2 NULL, sparel NULL
        },
        criticalExtensionsFuture SEQUENCE {}
    }
}
RRCConnectionReconfiguration-r8-IEs ::= SEQUENCE {
    -- Enter the IEs here.
    ...
}
-- ASNISTOP
```


Hooks for critical and non-critical extension should normally be included in the PDU type specification. How these hooks are used is further described in clause A.4.
Critical extensions are characterised by a redefinition of the PDU contents and need to be governed by a mechanism for protocol version agreement between the encoder and the decoder of the PDU, such that the encoder is prevented from sending a critically extended version of the PDU type, which is not comprehended by the decoder.

Critical extension of a PDU type is facilitated by a two-level CHOICE structure, where the alternative PDU contents are alternatives within the inner level \( c \) / CHOICE. Spare alternatives (i.e., spare 3 down to sparel in this case) may be included within the \( c l \) CHOICE. The number of spare alternatives to be included in the original PDU specification should be decided case by case, based on the expected rate of critical extension in the future releases of the protocol.

Further critical extension, when the spare alternatives from the original specifications are used up, is facilitated using the criticalExtensionsFuture in the outer level CHOICE.
In PDU types where critical extension is not expected in the future releases of the protocol, the inner level \( c l \) CHOICE and the spare alternatives may be excluded, as shown in the example below.
-- /example/ ASNISTART

ETSI