<!-- Page 67 of ts_138331v170000p -->

3GPP TS 38.331 version 17.0.0 Release 17
66
ETSI TS 138331 V17.0.0 (2022-05)

\( 2> \) if upper layers selected an SNPN or a PLMN and in case of PLMN UE is either allowed or instructed to access the PLMN via a cell for which at least one CAG ID is broadcast:
\( 3> \) set the selectedPLMN-Identity from the mpn-IdentityInfoList;
\( 2> \) else:
3> set the selectedPLMN-Identity to the PLMN selected by upper layers from the plmn-IdentityInfoList;
\( 2> \) if upper layers provide the 'Registered AMF':
3> include and set the registeredAMF as follows:
\( 4> \) if the PLMN identity of the 'Registered AMF' is different from the PLMN selected by the upper layers:

5> include the plmnldentity in the registeredAMF and set it to the value of the PLMN identity in the 'Registered AMF' received from upper layers;
\( 4> \) set the amf-Identifier to the value received from upper layers;
\( 3> \) include and set the guami-Type to the value provided by the upper layers;
\( 2> \) if upper layers provide one or more S-NSSAI (see TS 23.003 [21]):
\( 3> \) include the \( s \)-NSSAI-List and set the content to the values provided by the upper layers;
\( 2> \) if upper layers provide onboarding request indication:
\( 3> \) include the onboardingRequest;
\( 2> \) set the dedicatedNAS-Message to include the information received from upper layers;
\( 2> \) if connecting as an IAB-node:
\( 3> \) include the iab-Nodelndication;
\( 2> \) if the SIB1 contains idleModeMeasurementsNR and the UE has NR idle/inactive measurement information concerning cells other than the PCell available in VarMeasIdleReport; or
\( 2> \) if the SIB1 contains idleModeMeasurementsEUTRA and the UE has E-UTRA idle/inactive measurement information available in VarMeasIdleReport:
\( 3> \) include the idleMeasAvailable;
\( 2> \) if the UE has logged measurements available for NR and if the RPLMN is included in plmn-IdentityList stored in VarLogMeasReport:

3> if the sigLoggedMeasType in VarLogMeasReport is included:
\( 4> \) include the sigLogMeasConfigAvailable in the RRCSetupComplete message and set it according to the following:

5> if T330 timer is running:
6> set sigLogMeasConfigAvailable to true in the RRCSetupComplete message;
\( 5> \) else:
6> set sigLogMeasConfigAvailable to false in the RRCSetupComplete message;
\( 3> \) include the logMeasAvailable in the RRCSetupComplete message;
3> if Bluetooth measurement results are included in the logged measurements the UE has available for NR:
4> include the \( \log \) MeasAvailableBT in the RRCSetupComplete message;
\( 3> \) if WLAN measurement results are included in the logged measurements the UE has available for NR:

ETSI