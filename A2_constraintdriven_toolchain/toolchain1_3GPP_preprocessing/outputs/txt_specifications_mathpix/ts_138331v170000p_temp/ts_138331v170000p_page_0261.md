<!-- Page 261 of ts_138331v170000p -->

3GPP TS 38.331 version 17.0.0 Release 17
260
ETSI TS 138331 V17.0.0 (2022-05)

3> set the msg/-SubcarrierSpacingCFRA associated to the 4 step random-access resources used in the random-access procedure;

2> else:
3> set the msg1-SCS-From-prach-ConfigurationIndex to the subcarrier spacing as derived from the prachConfigurationIndex used in the 4 step random-access procedure;
\( 2> \) set the msgA-RO-FrequencyStartCFRA and msgA-RO-FDMCFRA associated to the 2 step contention free randomaccess resources if used in the random-access procedure;
\( 2> \) set the msgA-MCS, the nrofPRBs-PerMsgA-PO, the msgA-PUSCH-TimeDomainAllocation, the frequencyStartMsgA-PUSCH, the nrofMsgA-PO-FDM associated to the 2 step random-access resources if used in the random-access procedure;
\( 2> \) if \( m s g A \)-SubcarrierSpacing associated to the 2 step random-access resources used in the random-access procedure is available:

3> set the msgA-SubcarrierSpacing associated to the 2 step random-access resources used in the randomaccess procedure;
\( 2> \) else:
3> set the msgA-SCS-From-prach-Configurationlndex to the subcarrier spacing as derived from the msgA-PRACH-ConfigurationIndex used in the 2-step random-access procedure;

1> if the random access procedure is initialized with RA_TYPE set to 2-stepRA as described in TS 38.321 [3]:
\( 2> \) set the dilPathlossRSRP to the measeured RSRP of the DL pathloss reference obtained at the time of RA_Type selection stage of the initialization of the RA procedure as captured in TS 38.321 [3];
\( 2> \) if the configuration for the random access msgA-TransMax was configured in RACH-ConfigDedicated for this random access procedure:

3> set msgA-TransMax to the value of msgA-TransMax in RACH-ConfigDedicated;
\( 2> \) else if msgA-TransMax was configured in RACH-ConfigCommonTwoStepRA:
3> set msgA-TransMax to the value of msgA-TransMax in RACH-ConfigCommonTwoStepRA;
2> set the msgA-PUSCH-PayloadSize to the size of the overall payload available in the UE buffer at the time of initiating the 2 step RA procedure;
\( 1> \) if the purpose of the random access procedure is to request on-demand system information (i.e., if the raPurpose is set to requestForOtherSI or msg3RequestForOtherS/):
\( 2> \) set the intendedSIBs to indicate the SIB(s) the UE wanted to receive as a result of the SI request;
\( 2> \) set the ssbsForSI-Acquisition to indicate the SSB(s) used to receive the SI message;
\( 2> \) if the on-demand system information acquisition was successful:
\( 3> \) set the onDemandSISuccess to true;
\( 2> \) else:
3> set the onDemandSISuccess to false;
1> set the parameters associated to individual random-access attempt in the chronological order of attempts in the perRAInfoList as follows:

2> if the random-access resource used is associated to a SS/PBCH block, set the associated random-access parameters for the successive random-access attempts associated to the same SS/PBCH block for one or more random-access attempts as follows:
\( 3> \) set the ssb-Index to include the SS/PBCH block index associated to the used random-access resource;

ETSI