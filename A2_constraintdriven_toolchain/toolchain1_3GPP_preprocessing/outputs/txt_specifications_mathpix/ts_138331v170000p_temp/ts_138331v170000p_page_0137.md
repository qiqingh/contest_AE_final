<!-- Page 137 of ts_138331v170000p -->

3GPP TS 38.331 version 17.0.0 Release 17
136
ETSI TS 138331 V17.0.0 (2022-05)

listed first, based on the available SS/PBCH block based measurements collected up to the moment the UE detected failure;
\( 4> \) for each neighbour cell included, include the optional fields that are available;
\( 2> \) if the CSI-RS based measurement quantities are available:
3> set the measResultListNR in measResultNeighCells to include all the available measurement quantities of the best measured cells, other than the source PCell (in case HO failure) or PCell (in case RLF), ordered such that the cell with highest CSI-RS RSRP is listed first if CSI-RS RSRP measurement results are available, otherwise the cell with highest CSI-RS RSRQ is listed first if CSI-RS RSRQ measurement results are available, otherwise the cell with highest CSI-RS SINR is listed first, based on the available CSI-RS based measurements collected up to the moment the UE detected radio link failure;

4> for each neighbour cell included, include the optional fields that are available;
\( 2> \) for each neighbour cell, if any, included in measResultListNR in measResultNeighCells:
3> if the neighbour cell is one of the candidate cells for which the reconfigurationWithSync is included in the masterCellGroup in VarConditionalReconfig at the moment of the detected failure:

4> set choConfig in MeasResult2NR to the execution condition for each measld within condTriggerConfig associated to the neighbour cell within VarConditionalReconfig;

4> if at least one execution condition included in choConfig in MeasResult2NR was fulfilled at the moment of conditional reconfiguration execution, or radio link failure:
\( 5> \) if the first entry of choConfig corresponds to a fullfilled execution condition at the moment of conditional reconfiguration execution, or radio link failure:
\( 6> \) set condFirstEventFullfilled to true;
\( 5> \) if the second entry of choConfig, if available, corresponds to a fullfilled execution condition at the moment of conditional reconfiguration execution, or radio link failure:

6> set condSecondEventFullfilled to true;
\( 5> \) if the first entry of choConfig corresponds to a fulfilled execution condition at the moment of conditional reconfiguration execution, or radio link failure; and
\( 5> \) if the second entry of choConfig, if available, corresponds to a fulfilled execution condition at the moment of conditional reconfiguration execution, or radio link failure:

6> set firstTriggeredEvent to the execution condition condFirstEvent corresponding to the first entry of choConfig or to the execution condition condSecondEvent corresponding to the second entry of choConfig, whichever execution condition was fulfilled first in time;
\( 6> \) set timeBetweenEvents to the elapsed time between the point in time of fullfilling the condition in choConfig that was fulfilled first in time, and the point in time of fullfilling the condition in choConfig that was fulfilled second in time;

1> for each of the configured EUTRA frequencies in which measurements are available;
\( 2> \) set the measResultListEUTRA in measResultNeighCells to include the best measured cells ordered such that the cell with highest RSRP is listed first if RSRP measurement results are available, otherwise the cell with highest RSRQ is listed first, and based on measurements collected up to the moment the UE detected failure;

3> for each neighbour cell included, include the optional fields that are available;
NOTE 1: The measured quantities are filtered by the L3 filter as configured in the mobility measurement configuration. The measurements are based on the time domain measurement resource restriction, if configured. Exclude-listed cells are not required to be reported.
\( 1> \) set the \( c-R N T I \) to the C-RNTI used in the source PCell(in case HO failure) or PCell (in case RLF);

ETSI