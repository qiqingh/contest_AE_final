<!-- Page 82 of ts_138213v170100p -->

3GPP TS 38.213 version 17.1.0 Release 17
81
ETSI TS 138213 V17.1.0 (2022-05)
- If enableTimeDomainHARQ-Bundling is provided for serving cell \( c \) and for a DCI format indicating a TDRA row that includes more than one SLIV entry on the serving cell \( c \), the UE considers as received only a PDSCH associated with the last SLIV.
- \( \quad N_{m, c}^{\text {received, CBG }} \) is the number of CBGs the UE receives in a PDSCH reception occasion \( m \) for serving cell \( c \) if PDSCH-CodeBlockGroupTransmission is provided and the PDSCH reception is scheduled by a DCI format that supports CBG-based PDSCH receptions and the UE reports corresponding HARQ-ACK information in the PUCCH.
9.1.2.2 Type-1 HARQ-ACK codebook in physical uplink shared channel

If a UE is not provided pdsch-HARQ-ACK-Codebook = 'semi-static' for unicast or multicast HARQ-ACK information, the UE does not multiplex the unicast or multicast HARQ-ACK information in the PUSCH transmission, respectively.

If a UE is provided pdsch-HARQ-ACK-Codebook = 'semi-static' for unicast and/or multicast HARQ-ACK information, and would multiplex HARQ-ACK information in a PUSCH transmission that is not scheduled by a DCI format or is scheduled by a DCI format that does not include a DAI field, then
- if the UE has not received any PDSCH or SPS PDSCH release or TCI state update that the UE multiplexes corresponding HARQ-ACK information in the PUSCH, based on a value of a respective PDSCH-toHARQ_feedback timing indicator field in a DCI format scheduling the PDSCH reception or the SPS PDSCH release or the TCI state update, or on the value of dl-DataToUL-ACK or dl-DataToUL-ACK-r16 if the PDSCH-to-HARQ_feedback timing indicator field is not present in DCI format \( 1 \_1 \) or on the value of dl-DataToUL-ACK-DCI-1-2 if the PDSCH-to-HARQ_feedback timing indicator field is not present in DCI format 1 _ 2 and the UE is provided pdsch-HARQ-ACK-Codebook = 'semi-static' for unicast HARQ-ACK information, or on the value of dl-DataToUL-ACK if the PDSCH-to-HARQ_feedback timing indicator field is not present in DCI format \( 4 \_2 \) and the UE is provided pdsch-HARQ-ACK-Codebook = 'semi-static' for multicast HARQ-ACK information, in any of the \( M_{c} \) occasions for candidate PDSCH receptions by a DCI format or SPS PDSCH on any serving cell \( c \), as described in clause 9.1.2.1, the UE does not multiplex HARQ-ACK information in the PUSCH transmission
- else the UE generates the HARQ-ACK codebook as described in clause 9.1.2.1, except that harq-ACKSpatialBundlingPUCCH is replaced by harq-ACK-SpatialBundlingPUSCH, unless the UE receives only a SPS PDSCH release, or only a SPS PDSCH reception, or only a TCI state update, or only a PDSCH that is scheduled by DCI format \( 1 \_0 \) with a counter DAI field value of 1 if the UE is provided pdsch-HARQ-ACK-Codebook \( = \) 'semi-static' for unicast HARQ-ACK information, or is scheduled by DCI format \( 4 \_1 \) with a counter DAI field value of 1 if the UE is provided pdsch-HARQ-ACK-Codebook = 'semi-static' for multicast HARQ-ACK information, on the PCell in the \( M_{c} \) occasions for candidate PDSCH receptions in which case the UE generates HARQ-ACK information only for the SPS PDSCH release or only for the PDSCH reception or only for the TCI state update as described in clause 9.1.2.

A UE sets to NACK value in the HARQ-ACK codebook any HARQ-ACK information corresponding to PDSCH reception or SPS PDSCH release or TCI state update that the UE detects in a PDCCH monitoring occasion that starts after a PDCCH monitoring occasion where the UE detects a DCI format scheduling the PUSCH transmission.

A UE does not expect to detect a DCI format switching a DL BWP within \( N_{2} \) symbols prior to a first symbol of a PUSCH transmission where the UE multiplexes HARQ-ACK information, where \( N_{2} \) is defined in [6, TS 38.214].

If a UE multiplexes HARQ-ACK information in a PUSCH transmission that is scheduled by DCI format that includes a DAI field, and
- is not provided famed-Reception-Multicast and is provided pdsch-HARQ-ACK-Codebook = 'semi-static' for both unicast and multicast HARQ-ACK information, or
- is provided pdsch-HARQ-ACK-Codebook = 'semi-static' only for one of unicast and multicast HARQ-ACK information
the UE generates the HARQ-ACK codebook as described in clause 9-1.2.1 when a value of the DAI field is \( V_{T-D A I}^{U L}=1 \) except that harq-ACK-SpatialBundlingPUCCH is replaced by harq-ACK-SpatialBundlingPUSCH. The UE does not generate a HARQ-ACK codebook for multiplexing in the PUSCH transmission when \( V_{\text {T-DAI }}^{\text {UL }}=0 \) unless the UE receives only a SPS PDSCH release, or only SPS PDSCH(s), or only a TCI state update, or only a PDSCH that is scheduled by a DCI format 1_0 if the UE is provided pdsch-HARQ-ACK-Codebook = 'semi-static' for unicast HARQ-ACK information, or scheduled by a DCI format \( 4 \_1 \) if the UE is provided pdsch-HARQ-ACK-Codebook \( = \) 'semi-static' for

ETSI