<!-- Page 114 of ts_138213v170100p -->

3GPP TS 38.213 version 17.1.0 Release 17
113
ETSI TS 138213 V17.1.0 (2022-05)

HARQ-ACK information, and/or SR, and/or CSI reports and determines corresponding PUCCH(s) for transmission in the slot according to the following pseudo-code. If the multiple PUCCHs do not include HARQ-ACK information and do not overlap with any PUSCH transmission by the UE in response to a DCI format detection by the UE, the timing conditions do not apply.

If
- a UE is not provided multi-CSI-PUCCH-ResourceList, and
- a resource for a PUCCH transmission with HARQ-ACK information in response to SPS PDSCH reception and/or a resource for a PUCCH associated with a SR occasion overlap in time with two resources for respective PUCCH transmissions with two CSI reports, and
- there is no resource for a PUCCH transmission with HARQ-ACK information in response to a DCI format detection that overlaps in time with any of the previous resources, and
- the following pseudo code results to the UE attempting to determine a single PUCCH resource from the HARQACK and/or the SR resource and the two PUCCH resources with CSI reports
the UE
- multiplexes the HARQ-ACK information and/or the SR in the resource for the PUCCH transmission with the CSI report having the higher priority, and
- does not transmit the PUCCH with the CSI report having the lower priority

Set \( Q \) to the set of resources for transmission of corresponding PUCCHs in a single slot without repetitions where
- a resource with earlier first symbol is placed before a resource with later first symbol
- for two resources with same first symbol, the resource with longer duration is placed before the resource with shorter duration
- for two resources with same first symbol and same duration, the placement is arbitrary
- the above three steps for the set \( Q \) are according to a subsequent pseudo-code for a function order \( (Q) \)
- a resource for negative SR transmission that does not overlap with a resource for HARQ-ACK or CSI transmission is excluded from set \( Q \)
- if the UE is not provided simultaneousHARQ-ACK-CSI and resources for transmission of HARQ-ACK information include PUCCH format 0 or PUCCH format 2, resources that include PUCCH format 2, or PUCCH format 3, or PUCCH format 4 for transmission of CSI reports are excluded from the set \( Q \) if they overlap with any resource from the resources for transmission of HARQ-ACK information
- if the UE is not provided simultaneousHARQ-ACK-CSI and at least one of the resources for transmission of HARQ-ACK information includes PUCCH format 1, PUCCH format 3, or PUCCH format 4
- resources that include PUCCH format 3 or PUCCH format 4 for transmission of CSI reports are excluded from the set \( Q \)
- resources that include PUCCH format 2 for transmission of CSI reports are excluded from the set \( Q \) if they overlap with any resource from the resources for transmission of HARQ-ACK information

Set \( C(Q) \) to the cardinality of \( Q \)
Set \( Q(j, 0) \) to be the first symbol of resource \( Q(j) \) in the slot
Set \( L(Q(j)) \) to be the number of symbols of resource \( Q(j) \) in the slot
Set \( j=0 \) - index of first resource in set \( Q \)
Set \( o=0 \) - counter of overlapped resources
while \( j \leq C(Q)-1 \)
if

ETSI