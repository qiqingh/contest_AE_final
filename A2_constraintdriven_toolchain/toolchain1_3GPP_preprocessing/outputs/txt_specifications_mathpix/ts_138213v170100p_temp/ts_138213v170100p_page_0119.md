<!-- Page 119 of ts_138213v170100p -->

3GPP TS 38.213 version 17.1.0 Release 17
118
ETSI TS 138213 V17.1.0 (2022-05)

4 provided by nrofSymbols in PUCCH-format3 or nrofSymbols in PUCCH-format4, respectively, after excluding a number of symbols used for DM-RS transmission for PUCCH format 3 or for PUCCH format 4, respectively [4, TS 38.211]
- \( Q_{m}=1 \) if pi/2-BPSK is the modulation scheme and \( Q_{m}=2 \) if QPSK is the modulation scheme as indicated by pi2BPSK for PUCCH format 3 or PUCCH format 4. For PUCCH format 2, \( Q_{m}=2 \)

If a UE has one or more CSI reports and zero or more HARQ-ACK/SR information bits to transmit in a PUCCH where the HARQ-ACK, if any, is in response to a PDSCH reception without a corresponding PDCCH
- if any of the CSI reports are overlapping and the UE is provided by multi-CSI-PUCCH-ResourceList with \( J \leq 2 \) PUCCH resources in a slot, for PUCCH format 2 and/or PUCCH format 3 and/or PUCCH format 4, as described in clause 9.2.1, where the resources are indexed according to an ascending order for the product of a number of corresponding REs, modulation order \( Q_{m} \), and configured code rate \( r \);
- if \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}}+O_{\mathrm{CRC}}\right) \leq\left(M_{\mathrm{RB}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{SC}, \mathrm{Ctrl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r\right)_{0} \), the UE uses PUCCH format 2 resource 0 , or the PUCCH format 3 resource 0 , or the PUCCH format 4 resource 0
- else if \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CS} 1}+O_{\mathrm{CRC}}\right)>\left(M_{\mathrm{RB}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sc}, \mathrm{ctr} \mid}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{uCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r\right)_{j} \) and \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CS} 1}+O_{\mathrm{CRC}}\right) \leq\left(M_{\mathrm{RB}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sc}, \mathrm{ctrl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r\right)_{j+1}, 0 \leq j<J-1 \), the UE transmits a
PUCCH conveying HARQ-ACK information, SR and CSI report(s) in a respective PUCCH where the UE uses the PUCCH format 2 resource \( j+1 \), or the PUCCH format 3 resource \( j+1 \), or the PUCCH format 4 resource \( j+1 \)
- else the UE uses the PUCCH format 2 resource \( J-1 \), or the PUCCH format 3 resource \( J-1 \), or the PUCCH format 4 resource \( J-1 \) and the UE selects \( N_{\mathrm{CS} 1}^{\text {rported }} \) CSI report(s) for transmission together with HARQACK information and SR, when any, in ascending priority value as described in [6, TS 38.214]
- else, the UE transmits the \( O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}}+O_{\mathrm{CRC}} \) bits in a PUCCH resource provided by pucch-CSIResourceList and determined as described in clause 9.2.5

If a UE has HARQ-ACK, SR and wideband or sub-band CSI reports to transmit and the UE determines a PUCCH resource with PUCCH format 2, or the UE has HARQ-ACK, SR and wideband CSI reports [6, TS 38.214] to transmit and the UE determines a PUCCH resource with PUCCH format 3 or PUCCH format 4, where
- the UE determines the PUCCH resource using the PUCCH resource indicator field [5, TS 38.212] in a last of a number of DCI formats with a value of a PDSCH-to-HARQ_feedback timing indicator field, if present, or a value of dl-DataToUL-ACK, or dl-DataToUL-ACK-r16, or dl-DataToUL-ACK-DCI-1-2, indicating a same slot for the PUCCH transmission, from a PUCCH resource set provided to the UE for HARQ-ACK transmission, and
- the UE determines the PUCCH resource set as described in clause 9.2.1 and clause 9.2.3 for \( Q_{\text {UCI }} \mathrm{UCI} \) bits
and
- if \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CST} \text {-part 1 }}+O_{\mathrm{CRC}, \mathrm{CST} \text {-part 1 }}\right) \leq M_{\mathrm{RB}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{SS}, \mathrm{crtl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCT}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \), the UE transmits the HARQ-ACK, SR , and CSI reports bits by selecting the minimum number \( M_{\mathrm{RB}, \mathrm{min}}^{\mathrm{PUCCH}} \) of the \( M_{\mathrm{RB}}^{\mathrm{PUCCH}} \) PRBs satisfying \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CST}-\text { part } 1}+O_{\mathrm{CRC}, \mathrm{CSI}-\text { part } 1}\right) \leq M_{\mathrm{RB}, \text { min }}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sC}, \mathrm{ctr} 1}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCT}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \) as described in clauses 9.2.3 and 9.2.5.1;
- else, the UE selects \( N_{\mathrm{CS} 1}^{\text {reported }} \mathrm{CSI} \) report(s), from the \( N_{\mathrm{CS} 1}^{\text {btal }} \mathrm{CSI} \) reports, for transmission together with HARQACK and SR in ascending priority value [6, TS 38.214], where the value of \( N_{\text {CS] }}^{\text {eported }} \) satisfies
\[
\left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+\sum_{n=1}^{N_{\mathrm{CSB}}^{\text {moded }}} O_{\mathrm{CSI}-\mathrm{partl}, n}+O_{\mathrm{CRC}, \mathrm{CSl}-\mathrm{partl}, N}\right) \leq M_{\mathrm{RB}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sC}, \mathrm{ctrl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \text { and }
\]

ETSI