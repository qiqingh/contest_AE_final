<!-- Page 69 of ts_138213v170100p -->

3GPP TS 38.213 version 17.1.0 Release 17
68
ETSI TS 138213 V17.1.0 (2022-05)

The HARQ-ACK codebook includes the \( N_{\text {HARQ-ACK }}^{\mathrm{CBGTB}, \text { max }} \) HARQ-ACK information bits and, if \( N_{\text {HARQ-ACK }}^{\mathrm{CBGTB}}<N_{\text {HARQ-ACK }}^{\mathrm{CBG} / \mathrm{TB}, \text { max }} \) for a transport block, the UE generates a NACK value for the last \( N_{\text {HARQ-ACK }}^{\mathrm{CBG} / \mathrm{TB}, \text { max }}-N_{\text {HARQ-ACK }}^{\mathrm{CBG} / \mathrm{TB}} \) HARQ-ACK information bits for the transport block in the HARQ-ACK codebook.

If the UE generates a HARQ-ACK codebook in response to a retransmission of a transport block, corresponding to a same HARQ process as a previous transmission of the transport block, the UE generates an ACK for each CBG that the UE correctly decoded in a previous transmission of the transport block.

If a UE correctly detects each of the \( N_{\text {HARQ-ACK }}^{\mathrm{CBGTB}} \) CBGs and does not correctly detect the transport block for the \( N_{\text {HARQ-ACK }}^{\mathrm{CBGTB}} \) CBGs, the UE generates a NACK value for each of the \( N_{\text {HARQ-ACK }}^{\mathrm{CBGTB}} \) CBGs.
9.1.2 Type-1 HARQ-ACK codebook determination

This clause applies if the UE is configured with pdsch-HARQ-ACK-Codebook \( = \) semi-static. In clauses 9.1.2, 9.1.2.1, and 9.1.2.2, if the UE is configured with pdsch-HARQ-ACK-Codebook = semi-static for only one of unicast or multicast HARQ-ACK codebook, the Type-1 HARQ-ACK codebook is generated considering only one of respective unicast or multicast configurations for PDSCH receptions or for PDCCH monitoring for detection of DCI formats.

If a UE is provided HARQ-feedbackEnabling-disablingperHARQprocess indicating disabled HARQ-ACK information for a HARQ process associated with a transport block in PDSCH reception occasion \( m \) on serving cell \( c \), the UE reports a NACK value for a HARQ-ACK information bit corresponding to the transport block in a Type-1 HARQ-ACK codebook and does not consider the transport block as received in the determination of \( N_{m, c}^{\text {received }} \) in clause 9.1.2.1. If the UE is also provided PDSCH-CodeBlockGroupTransmission, the UE reports NACK values for HARQ-ACK information bits corresponding to CBGs of the transport block in the Type-1 HARQ-ACK codebook and does not consider the CBGs as received in the determination of \( N_{m, c}^{\text {received, CBG }} \) in clause 9.1.2.1. If the UE is also provided HARQfeedbackEnablingforSPSactive, the UE considers a HARQ process associated with a transport block in a first SPS PDSCH reception, after an activation of SPS PDSCH receptions, to have enabled HARQ-ACK information and the UE provides a HARQ-ACK information bit according to a decoding outcome for the transport block in the first SPS PDSCH reception.

A UE reports HARQ-ACK information for a corresponding PDSCH reception or SPS PDSCH release or TCI state update only in a HARQ-ACK codebook that the UE transmits in a slot indicated by a value of a PDSCH-toHARQ_feedback timing indicator field in a corresponding DCI format or provided by dl-DataToUL-ACK or dl-DataToUL-ACK-r16 or dl-DataToUL-ACK-ForDCI-Formatl-2 if the PDSCH-to-HARQ_feedback timing indicator field is not present in the DCI format as described in clause 9.2.3. The UE reports NACK value(s) for HARQ-ACK information bit(s) in a HARQ-ACK codebook that the UE transmits in a slot not indicated by a value of a PDSCH-toHARQ_feedback timing indicator field in a corresponding DCI format.

If a UE is not provided pdsch-HARQ-ACK-OneShotFeedback, the UE does not expect to receive a PDSCH scheduled by a DCI format that the UE detects in any PDCCH monitoring occasion and includes a PDSCH-to-HARQ_feedback timing indicator field providing an inapplicable value from \( d l \)-DataToUL-ACK-r 16 .

If the UE is provided pdsch-AggregationFactor-r16 in SPS-Config or pdsch-AggregationFactor in PDSCH-Config and no entry in pdsch-TimeDomainAllocationList and pdsch-TimeDomainAllocationListDCI-1-2 includes repetitionNumber in PDSCH-TimeDomainResourceAllocation-r 16, \( N_{\text {PDSCH }}^{\text {repeat }}{ }^{\text {max }} \) is a maximum value of pdsch-AggregationFactor-r 16 in SPS-Config or pdsch-AggregationFactor in PDSCH-Config; otherwise \( N_{\text {PDSCH }}^{\text {repeat }} \) max \( =1 \). The UE reports HARQ-ACK information for a PDSCH reception
- from DL slot \( n_{D}-N_{\text {PDSCH }}^{\text {repeat }}+1 \) to DL slot \( n_{D} \), if \( N_{\text {PDSCH }}^{\text {repeat }} \) is provided by pdsch-AggregationFactor or pdsch-AggregationFactor-r16 [6, TS 38.214], or
- from DL slot \( n_{D} \)-repetitionNumber +1 to DL slot \( n_{D} \), if the time domain resource assignment field in the DCI format scheduling the PDSCH reception indicates an entry containing repetitionNumber, or
- in DL slot \( n_{D} \), otherwise
only in a HARQ-ACK codebook that the UE includes in a PUCCH or PUSCH transmission in slot \( n+k \), where \( n \) is
- an UL slot overlapping with the end of the PDSCH reception in DL slot \( n_{D} \) if the UE is provided subslotLengthForPUCCH for the HARQ-ACK codebook

ETSI