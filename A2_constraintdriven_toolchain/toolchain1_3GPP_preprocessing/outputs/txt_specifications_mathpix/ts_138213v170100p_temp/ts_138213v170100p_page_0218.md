<!-- Page 218 of ts_138213v170100p -->

3GPP TS 38.213 version 17.1.0 Release 17
217
ETSI TS 138213 V17.1.0 (2022-05)
16.3.0 UE procedure for transmitting PSFCH with control information

A UE can be indicated by an SCI format scheduling a PSSCH reception to transmit a PSFCH with HARQ-ACK information in response to the PSSCH reception. The UE provides HARQ-ACK information that includes ACK or NACK, or only NACK.

A UE can be provided, by \( s l-P S F C H-P e r i o d \), a number of slots in a resource pool for a period of PSFCH transmission occasion resources. If the number is zero, PSFCH transmissions from the UE in the resource pool are disabled.

A UE can be enabled, by inter-UECoordinationScheme2, to transmit a PSFCH with conflict information in a resource pool. The UE can determine, based on an indication by a SCI format 1-A, a set of resources that includes one or more slots and resource blocks that are reserved for PSSCH transmission. If the UE determines a conflict for a reserved resource for PSSCH transmission, the UE provides conflict information in a PSFCH.

A UE expects that a slot \( t^{\prime}{ }_{k}\left(0 \leq k<T^{\prime}{ }_{\max }\right) \) has a PSFCH transmission occasion resource if \( k \bmod N_{\mathrm{PSSCH}}^{\mathrm{PSFCH}}=0 \), where \( t^{\prime S L}{ }_{k} \) is defined in [6, TS 38.214], and \( T^{\prime}{ }_{\text {max }} \) is a number of slots that belong to the resource pool within 10240 msec according to [6, TS 38.214], and \( N_{\text {PSSCH }}^{\text {PSFC }} \) is provided by sl-PSFCH-Period.

A UE may be indicated by higher layers to not transmit a PSFCH that includes HARQ-ACK information in response to a PSSCH reception [11, TS 38.321].

If a UE receives a PSSCH in a resource pool and the HARQ feedback enabled/disabled indicator field in an associated SCI format 2-A/2-B/2-C has value 1 [5, TS 38.212], the UE provides the HARQ-ACK information in a PSFCH transmission in the resource pool. The UE transmits the PSFCH in a first slot that includes PSFCH resources and is at least a number of slots, provided by sl-MinTimeGapPSFCH, of the resource pool after a last slot of the PSSCH reception.

A UE is provided by \( s l-P S F C H-R B \)-Set a set of \( M_{\mathrm{PRB}}^{\mathrm{PSEC}} \) set PRBs in a resource pool for PSFCH transmission with HARQACK information in a PRB of the resource pool. A UE can be provided by sl-PSFCH-Conflict-RB-Set a set of \( M_{\mathrm{PRB}}^{\mathrm{PSFCH}} \) set PRBs in a resource pool for PSFCH transmission with conflict information in a PRB of the resource pool. A UE expects that different PRBs are (pre)configured for conflict information and HARQ-ACK information. For a number of \( N_{\text {subch }} \) sub-channels for the resource pool, provided by sl-NumSubchannel, and a number of PSSCH slots associated with a PSFCH slot that is less than or equal to \( N_{\mathrm{PSSCH}}^{\mathrm{PSFCH}} \), the UE allocates the \( \left[\left(i+j \cdot N_{\mathrm{PSSCH}}^{\mathrm{PSFCH}}\right) \cdot M_{\mathrm{subch}, \mathrm{slot}}^{\mathrm{PSFCH}},\left(i+1+j \cdot N_{\mathrm{PSSCH}}^{\mathrm{PSFCH}}\right)\right. \). \( \left.M_{\text {subch, slot }}^{\text {PSFC }}-1\right] \) PRBs from the \( M_{\text {PRB, set }}^{\text {PSECH }} \) PRBs to slot \( i \) among the PSSCH slots associated with the PSFCH slot and subchannel \( j \), where \( M_{\text {subch, slot }}^{\mathrm{PSFCH}}=M_{\mathrm{PRB}, \mathrm{set}}^{\mathrm{PSFCH}} /\left(N_{\text {subch }} \cdot N_{\mathrm{PSSCH}}^{\mathrm{PSFCH}}\right), 0 \leq i<N_{\mathrm{PSSCH}}^{\mathrm{PSFCH}}, 0 \leq j<N_{\text {subch }} \), and the allocation starts in an ascending order of \( i \) and continues in an ascending order of \( j \). The UE expects that \( M_{\text {PRB }}^{\text {PSEt }} \) is a multiple of \( N_{\text {subch }} \). \( N_{\text {PSSCH }}^{\text {PSFCH }} \).

The second OFDM symbol \( l^{\prime} \) of PSFCH transmission in a slot is defined as \( l^{\prime}=s l \)-StartSymbol + sl-LengthSymbols -2 .

A UE determines a number of PSFCH resources available for multiplexing HARQ-ACK or conflict information in a PSFCH transmission as \( R_{\text {PRB, CS }}^{\text {PSFCH }}=N_{\text {type }}^{\text {PSFCH }} \cdot M_{\text {subch, slot }}^{\text {PSFCH }} \cdot N_{\text {CS }}^{\text {PSFCH }} \) where \( N_{\text {CS }}^{\text {PSFCH }} \) is a number of cyclic shift pairs for the resource pool provided by sl-NumMuxCS-Pair and, based on an indication by sl-PSFCH-CandidateResourceType,
- if sl-PSFCH-CandidateResourceType is configured as startSubCH, \( N_{\mathrm{type}}^{\mathrm{PSFCH}}=1 \) and the \( M_{\mathrm{subch}, \mathrm{slot}}^{\mathrm{PSFCH}} \) PRBs are associated with the starting sub-channel of the corresponding PSSCH
- if sl-PSFCH-CandidateResourceType is configured as allocSubCH, \( N_{\text {type }}^{\text {PSFCH }}=N_{\text {subch }}^{\text {PSSCH }} \) and the \( N_{\text {subch }}^{\text {PSSCH }} \cdot M_{\text {subch }, \text { slot }}^{\text {PSFCH }} \) PRBs are associated with the \( N_{\text {subch }}^{\text {PSSCH }} \) sub-channels of the corresponding PSSCH
- for conflict information, the corresponding PSSCH is determined based on PSFCHOccasionScheme2

The PSFCH resources are first indexed according to an ascending order of the PRB index, from the \( N_{\text {type }}^{\text {PSFCH }} \cdot M_{\text {subch, slot }}^{\text {PSFCH }} \) PRBs, and then according to an ascending order of the cyclic shift pair index from the \( N_{\mathrm{CS}}^{\mathrm{PSFCH}} \) cyclic shift pairs.

A UE determines an index of a PSFCH resource for a PSFCH transmission with HARQ-ACK information in response to a PSSCH reception or with conflict information corresponding to a reserved resource as ( \( \left.P_{\mathrm{ID}}+M_{\mathrm{ID}}\right) \bmod R_{\mathrm{PRB}, \mathrm{CS}}^{\mathrm{PSFCH}} \) where \( P_{\mathrm{ID}} \) is a physical layer source ID provided by SCI format 2-A/2-B/2-C [5, TS 38.212] scheduling the PSSCH reception, or by SCI format \( 2-\mathrm{A} / 2-\mathrm{B} / 2-\mathrm{C} \) with corresponding SCI format \( 1-\mathrm{A} \) reserving the resource from another UE to be provided with the conflict information. For HARQ-ACK information, \( M_{\mathrm{ID}} \) is the identity of the UE receiving the

ETSI