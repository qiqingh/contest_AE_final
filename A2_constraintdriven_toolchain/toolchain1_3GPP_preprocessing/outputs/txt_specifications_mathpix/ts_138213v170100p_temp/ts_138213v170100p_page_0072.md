<!-- Page 72 of ts_138213v170100p -->

3GPP TS 38.213 version 17.1.0 Release 17
71
ETSI TS 138213 V17.1.0 (2022-05)
- the union of row indexes of time domain resource allocation tables for DCI formats the UE is configured to monitor PDCCH for serving cell \( c \) if the UE is not configured to monitor PDCCH for multicast DCI formats for serving cell \( c \), or is not provided typel-Codebook-Generation-Mode = 'model', or, if any, for the first \( K_{1, \mathrm{UM}} \) set
- the union of row indexes of time domain resource allocation tables for DCI format \( 1 \_0 \) and/or DCI format 1_1 and/or DCI format 1_2 for serving cell \( c \) for the second \( K_{1, U \backslash M} \) set, if any
- the union of row indexes of time domain resource allocation tables for multicast DCI formats the UE is configured to monitor PDCCH for serving cell \( c \) for the third \( K_{1, \mathrm{M} \backslash \mathrm{U}} \) set, if any
- if the UE is provided referenceOfSLIVDCI-1-2, for each row index with slot offset \( K_{0}=0 \) and PDSCH mapping Type B in a set of row indexes of a table for DCI format 1 _ 2 [6, TS 38.214], for any PDCCH monitoring occasion in any slot where the UE monitors PDCCH for DCI format \( 1 \_2 \) and with starting symbol \( S_{0}>0 \), if \( S+S_{0}+L \leq 14 \) for nomal cyclic prefix and \( S+S_{0}+L \leq 12 \) for extended cyclic prefix, add a new row index in the set of row indexes of the table by replacing the starting symbol \( S \) of the row index by \( S+S_{0} \)
c) on the ratio \( 2^{\mu_{\mathrm{DL}}-\mu_{\mathrm{UL}}} \) between the downlink SCS configuration \( \mu_{\mathrm{DL}} \) and the uplink SCS configuration \( \mu_{\mathrm{UL}} \) provided by subcarrierSpacing in BWP-Downlink and BWP-Uplink for the active DL BWP and the active UL BWP, respectively
d) if provided, on tdd-UL-DL-ConfigurationCommon and tdd-UL-DL-ConfigurationDedicated as described in clause 11.1
e) if ca-SlotOffset is provided, on \( N_{\text {slot, offset, } \mathrm{C}}^{\mathrm{DL}} \) and \( \mu_{\text {off set, } \mathrm{DL}, \mathrm{c}} \) provided by ca-SlotOffset for serving cell \( c \), or on \( N_{\text {slot, offset }}^{\text {UL }} \) and \( \mu_{\text {offset,UL }} \) provided by ca-SlotOffset for the primary cell, as described in [4, TS 38.211].

If a UE
- is not provided coresetPoollndex or is provided coresetPoollndex with a value of 0 for first CORESETs on active DL BWPs of serving cells, and
- is provided coresetPoollndex with a value of 1 for second CORESETs on active DL BWPs of the serving cells, and
- is provided ackNackFeedbackMode = joint
where
- a serving cell is placed in a first set \( S_{0} \) of \( N_{\text {cells }}^{\text {DL }, 0} \) serving cells if the serving cell includes a first CORESET, and
- a serving cell is placed in a second set \( S_{1} \) of \( N_{\text {cells }}^{\text {DL1 }} \) serving cells if the serving cell includes a second CORESET, and
- serving cells are placed in a set according to an ascending order of a serving cell index
the UE generates a Type-1 HARQ-ACK codebook for the set \( S_{0} \) and the set \( S_{1} \) of serving cells separately by setting \( N_{\text {cells }}^{\mathrm{DL}}=N_{\text {cells }}^{\mathrm{DL} 0} \) and \( N_{\text {cells }}^{\mathrm{DL}}=N_{\text {cells }}^{\mathrm{DL} 1} \) in the following pseudo-code. The UE concatenates the HARQ-ACK codebook generated for the set \( S_{0} \) followed by the HARQ-ACK codebook generated for the set \( S_{1} \) to obtain a total number of \( O_{\text {ACK }} \) HARQ-ACK information bits.

If a UE is provided fdmed-Reception-Multicast and the UE is configured to monitor PDCCH for detection of unicast DCI formats and to monitor PDCCH for detection of multicast DCI formats
- a serving cell is placed in a first set \( S_{\mathrm{U}} \) of \( N_{\text {cells }}^{\text {DLU }} \) serving cells if the UE is configured to monitor PDCCH for DCI formats \( 1 \_0 / 1 \_1 / 1 \_2 \) for scheduling on serving cell \( c \), and
- a serving cell is placed in a second set \( S_{\mathrm{M}} \) of \( N_{\text {cells }}^{\mathrm{DL} \mathrm{M}} \) serving cells if the UE is configured to monitor PDCCH for detection of DCI format 4_1/4_2 for scheduling on serving cell \( c \), and
- serving cells are placed in a set according to an ascending order of a serving cell index

ETSI