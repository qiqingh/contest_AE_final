<!-- Page 50 of ts_138321v180200p -->

3GPP TS 38.321 version 18.2.0 Release 18
49
ETSI TS 138321 V18.2.0 (2024-08)

4> stop ra-ContentionResolutionTimer;
\( 4> \) if the MAC PDU contains a UE Contention Resolution Identity MAC CE; and
4- if the UE Contention Resolution Identity in the MAC CE matches the CCCH SDU transmitted in Msg3:
\( 5> \) consider this Contention Resolution successful and finish the disassembly and demultiplexing of the MAC PDU;
\( 5> \) if this Random Access procedure was initiated for SI request:
\( 6> \) indicate the reception of an acknowledgement for SI request to upper layers.
\( 5> \) else:
6> set the C-RNTI to the value of the TEMPORARY_C-RNTI;
\( 5> \) discard the TEMPORARY_C-RNTI;
\( 5> \) consider this Random Access procedure successfully completed.
\( 4> \) else:
\( 5> \) discard the TEMPORARY_C-RNTF;
\( 5> \) consider this Contention Resolution not successful and discard the successfully decoded MAC PDU.
\( 3> \) else, for eRedCap UE, if lower layer detects that PDSCH transmission scheduled by PDCCH has a larger bandwidth than UE can receive or process per slot:

4> stop ra-ContentionResolutionTimer;
\( 4> \) discard the TEMPORARY_C-RNTI;
4> consider this Contention Resolution not successful.
1> if ra-ContentionResolutionTimer expires:
\( 2> \) if Msg3 transmission was transmitted on a non-terrestrial network:
3> if no PDCCH addressed to TC-RNTI indicating uplink grant for a Msg3 retransmission is received after the start of the ra-ContentionResolutionTimer:
\( 4> \) discard the TEMPORARY_C-RNTT;
4> consider the Contention Resolution not successful.
\( 2> \) else:
\( 3> \) discard the TEMPORARY_C-RNTI;
3> consider the Contention Resolution not successful.
1> if the Contention Resolution is considered not successful:
2 flush the HARQ buffer used for transmission of the MAC PDU in the Msg3 buffer;
\( 2> \) increment PREAMBLE_TRANSMISSION_COUNTER by 1 ;
2 if PREAMBLE_TRANSMISSION_COUNTER \( = \) preambleTransMax +1 :
3> indicate a Random Access problem to upper layers.
\( 3> \) if this Random Access procedure was triggered for SI request:
\( 4> \) consider the Random Access procedure unsuccessfully completed.

ETSI