<!-- Page 235 of ts_138321v180200p -->

3GPP TS 38.321 version 18.2.0 Release 18
234
ETSI TS 138321 V18.2.0 (2024-08)
6.1.3.23 BFR MAC CEs

The MAC CEs for BFR consists of either:
- BFR MAC CE; or
- Truncated BFR MAC CE.

The BFR MAC CE and Truncated BFR MAC CE are identified by a MAC subheader with LCID/eLCID as specified in Table 6.2.1-2 and Table 6.2.1-2b.

The BFR MAC CE and Truncated BFR MAC CE have a variable size. They include a bitmap and in ascending order based on the ServCellIndex, beam failure recovery information i.e. octets containing candidate beam availability indication (AC) for SCells indicated in the bitmap. For BFR MAC CE, a single octet bitmap is used when the highest ServCellIndex of this MAC entity's SCell for which beam failure is detected and the evaluation of the candidate beams according to the requirements as specified in TS 38.133 [11] has been completed is less than 8, otherwise four octets are used. A MAC PDU shall contain at most one BFR MAC CE.

For Truncated BFR MAC CE, a single octet bitmap is used for the following cases, otherwise four octets are used:
- the highest ServCellIndex of this MAC entity's SCell for which beam failure is detected and the evaluation of the candidate beams according to the requirements as specified in TS 38.133 [11] has been completed is less than 8; or
- beam failure is detected for SpCell (as specified in Clause 5.17) and the SpCell is to be indicated in a Truncated BFR MAC CE and the UL-SCH resources available for transmission cannot accommodate the Truncated BFR MAC CE with the four octets bitmap plus its subheader as a result of LCP.

The fields in the BFR MAC CEs are defined as follows:
- SP: This field indicates beam failure detection (as specified in clause 5.17) for the SpCell of this MAC entity. The SP field is set to 1 to indicate that beam failure is detected for SpCell only when BFR MAC CE or Truncated BFR MAC CE is to be included into a MAC PDU as part of Random Access Procedure (as specified in 5.1.3a and 5.1.4), otherwise, it is set to 0;
- \( \mathrm{C}_{1} \) (BFR MAC CE): This field indicates beam failure detection (as specified in clause 5.17) and the presence of an octet containing the AC field for the SCell with ServCellIndex 1 as specified in TS 38.331 [5]. The \( \mathrm{C}_{1} \) field set to 1 indicates that beam failure is detected, the evaluation of the candidate beams according to the requirements as specified in TS 38.133 [11] has been completed, and the octet containing the AC field is present for the SCell with ServCellIndex i. The \( \mathrm{C}_{1} \) field set to 0 indicates that the beam failure is either not detected or the beam failure is detected but the evaluation of the candidate beams according to the requirements as specified in TS 38.133 [11] has not been completed, and the octet containing the AC field is not present for the SCell with ServCellIndexi. The octets containing the AC field are present in ascending order based on the ServCellIndex;
- \( \mathrm{C}_{1} \) (Truncated BFR MAC CE): This field indicates beam failure detection (as specified in clause 5.17) for the SCell with ServCellIndex i as specified in TS 38.331 [5]. The \( \mathrm{C}_{1} \) field set to 1 indicates that beam failure is detected, the evaluation of the candidate beams according to the requirements as specified in TS 38.133 [11] has been completed, and the octet containing the AC field for the SCell with ServCellIndex i may be present. The \( \mathrm{C}_{1} \) field set to 0 indicates that the beam failure is either not detected or the beam failure is detected but the evaluation of the candidate beams according to the requirements as specified in TS 38.133 [11] has not been completed, and the octet containing the AC field is not present for the SCell with ServCellIndex i. The octets containing the AC field, if present, are included in ascending order based on the ServCellIndex. The number of octets containing the AC field included is maximised, while not exceeding the available grant size;

NOTE: The number of the octets containing the AC field in the Truncated BFR MAC CE can be zero.
- AC: This field indicates the presence of the Candidate RS ID field in this octet. If at least one of the SSBs with SS-RSRP above rsrp-ThresholdBFR amongst the SSBs in candidateBeamRSSCellList or the CSI-RSs with CSIRSRP above rsrp-ThresholdBFR amongst the CSI-RSs in candidateBeamRSSCellList is available, the AC field is set to 1 ; otherwise, it is set to 0 . If the AC field set to 1 , the Candidate RS ID field is present. If the AC field set to \( 0, \mathrm{R} \) bits are present instead;
- Candidate RS ID: This field is set to the index of an SSB with SS-RSRP above rsrp-ThresholdBFR amongst the SSBs in candidateBeamRSSCellList or to the index of a CSI-RS with CSI-RSRP above rsrp-ThresholdBFR amongst the CSI-RSs in candidateBeamRSSCellList. Index of an SSB or CSI-RS is the index of an entry in

ETSI