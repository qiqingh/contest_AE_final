<!-- Page 47 of ts_138321v180200p -->

3GPP TS 38.321 version 18.2.0 Release 18
46
ETSI TS 138321 V18.2.0 (2024-08)

\( 6> \) process the received Timing Advance Command (see clause 5.2);
\( 6> \) consider this Random Access Response reception successful;
6> stop the msgB-ResponseWindow;
6> consider this Random Access procedure successfully completed and finish the disassembly and demultiplexing of the MAC PDU.

2 if a valid (as specified in TS 38.213 [6]) downlink assignment has been received on the PDCCH for the MSGB-RNTI and the received TB is successfully decoded:

3> if the MSGB contains a MAC subPDU with Backoff Indicator:
4> set the PREAMBLE_BACKOFF to value of the BI field of the MAC subPDU using Table 7.2-1, multiplied with SCALING_FACTOR_BI.
\( 3> \) else:
4> set the PREAMBLE_BACKOFF to 0 ms .
\( 3> \) if the MSGB contains a fallbackRAR MAC subPDU; and
3> if the Random Access Preamble identifier in the MAC subPDU matches the transmitted PREAMBLE_INDEX (see clause 5.1_3a):

4> consider this Random Access Response reception successful;
4> apply the following actions for the SpCell:
\( 5> \) process the received Timing Advance Command (see clause 5.2);
\( 5> \) indicate the msgA-PreambleReceivedTargetPower and the amount of power ramping applied to the latest Random Access Preamble transmission to lower layers (i.e.
(PREAMBLE_POWER_RAMPING_COUNTER -1 ) Ã— PREAMBLE_POWER_RAMPING_STEP );
\( 5> \) if the Random Access Preamble was not selected by the MAC entity among the contention-based Random Access Preamble(s):
\( 6> \) consider the Random Access procedure successfully completed;
\( 6> \) process the received UL grant value and indicate it to the lower layers.
\( 5> \) else:
6> set the TEMPORARY_C-RNTI to the value received in the Random Access Response;
6> if the Msg3 buffer is empty:
7> obtain the MAC PDU to transmit from the MSGA buffer and store it in the Msg3 buffer;
6> process the received UL grant value and indicate it to the lower layers and proceed with Msg3 transmission.

NOTE: If within a 2 -step RA type procedure, an uplink grant provided in the fallback RAR has a different size than the MSGA payload, the UE behavior is not defined.
\( 3> \) else if the MSGB contains a successRAR MAC subPDU; and
3> if the CCCH SDU was included in the MSGA and the UE Contention Resolution Identity in the MAC subPDU matches the CCCH SDU:

4> stop msgB-ResponseWindow;
4> if this Random Access procedure was initiated for SI request:
\( 5> \) indicate the reception of an acknowledgement for SI request to upper layers.

ETSI