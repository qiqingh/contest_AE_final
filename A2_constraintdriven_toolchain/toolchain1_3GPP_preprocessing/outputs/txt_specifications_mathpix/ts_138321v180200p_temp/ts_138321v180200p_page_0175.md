<!-- Page 175 of ts_138321v180200p -->

3GPP TS 38.321 version 18.2.0 Release 18
174
ETSITS 138321 V18.2.0 (2024-08)

\( 2> \) if the length of the Source ID is configured to as 12 bit:
\( 3> \) set the Source ID to the 12 LSB of the Source layer-2 ID corresponding to the SL-PRS transmission;
\( 2> \) else if length of the Source ID is configured to as 24 bit:
\( 3> \) set the Source [D to the Source layer-2 [D corresponding to the SL-PRS transmission;
\( 2> \) set the cast type indicator to one of broadcast, groupcast and unicast as indiated by the upper layer;
\( 2> \) set the SL-PRS priority as the value indicated by upper layer;
\( 2> \) set the SL-PRS resource ID;
NOTE 1: The SL-PRS resource ID(s) for initial transmission and retransmission(s) are determined by the UE's own upper layers by implementation.
\( 2> \) if the upper layer triggers SL-PRS transmission of the peer UE identified by the Destination layer-2 ID:
\( 3> \) set the SL-PRS request to request;
\( 2> \) deliver the SL-PRS transmission information to the Sidelink process;
\( 2> \) instruct the associated Sidelink process to trigger a new transmission as defined in 5.22.1.3.5.
\( 1> \) else (i.e., retransmission):
\( 2> \) identify the Sidelink process associated with this grant;
\( 2> \) if sl-PRS-MaxNumTransmissions is configured and the number of transmissions of the SL-PRS has not reached sl-PRS-MaxNumTransmissions:
\( 3> \) set the SL-PRS resource ID;
\( 3> \) deliver the SL-PRS transmission information to the Sidelink process;
3> instruct the associated Sidelink process to trigger a retransmission as defined in 5.22.1.3.5.
NOTE 2: For configured sidelink grant, the Sidelink process for retransmission is identified by the SL-PRS Process ID as specified in clause 5.22.1.3.1.
5.22.1.3.5 Sidelink process associated with Dedicated SL-PRS resource pool

If the Sidelink process is configured to perform transmissions of multiple SL-PRS with Sidelink resource allocation scheme 2 , the process maintains a counter SL_RESOURCE_RESELECTION_COUNTER. For other configurations of the Sidelink process, this counter is not available. For each SL-PRS new transmission or retransmission, the MAC entity shall:
\( 1> \) if there is no uplink transmission; or
\( 1> \) if there is uplink transmission and the sidelink transmission is prioritized over uplink transmission:
\( 2> \) instruct the physical layer to transmit SCI of the SL grant with the associated SL-PRS transmission information on Dedicated SL-PRS resource pool;
\( 2> \) instruct the physical layer to generate the SL-PRS on Dedicated SL-PRS resource pool.
\( 1> \) if this transmission corresponds to the last transmission of the SL-PRS transmission:
\( 2> \) decrement \( S L \) _RESOURCE_RESELECTION_COUNTER by 1 , if available.
The transmission of the SL-PRS is prioritized over uplink transmission(s) of the MAC entity or the other MAC entity if the following conditions are met:

1> if the MAC entity is not able to perform this sidelink transmission simultaneously with all uplink transmission(s) at the time of the transmission, and

ETSI