<!-- Page 36 of ts_138321v180200p -->

3GPP TS 38.321 version 18.2.0 Release 18
35
ETSI TS 138321 V18.2.0 (2024-08)

1> else (i.e. for the contention-based Random Access preamble selection):
\( 2> \) if at least one of the SSBs with SS-RSRP above rsrp-ThresholdSSB is available:
\( 3> \) select an SSB with SS-RSRP above rsrp-ThresholdSSB.
\( 2> \) else:
\( 3> \) select any SSB.
\( 2> \) if the RA_TYPE is switched from 2-stepRA to 4-stepRA:
\( 3> \) if a Random Access Preambles group was selected during the current Random Access procedure:
\( 4> \) select the same group of Random Access Preambles as was selected for the 2 -step RA type.
\( 3> \) else:
4- if Random Access Preambles group B is configured; and
4 if the transport block size of the MSGA payload configured in the rach-ConfigDedicated corresponds to the transport block size of the MSGA payload associated with Random Access Preambles group B:
\( 5> \) select the Random Access Preambles group B.
\( 4> \) else:
\( 5> \) select the Random Access Preambles group A.
\( 2> \) else if Msg3 buffer is empty:
\( 3> \) if Random Access Preambles group \( B \) is configured:
4 if the potential Msg3 size (UL data available for transmission plus MAC subheader(s) and, where required, MAC CEs) is greater than ra-Msg3SizeGroupA and the pathloss is less than PCMAX (of the Serving Cell performing the Random Access Procedure) - preambleReceivedTargetPower - msg3DeltaPreamble - messagePowerOffsetGroupB; or
\( 4- \) if the Random Access procedure was initiated for the CCCH logical channel and the CCCH SDU size plus MAC subheader is greater than ra-Msg3SizeGroupA:
\( 5> \) select the Random Access Preambles group B.
\( 4> \) else:
\( 5> \) select the Random Access Preambles group A.
\( 3> \) else:
\( 4> \) select the Random Access Preambles group A.
\( 2> \) else (i.e. Msg3 is being retransmitted):
3> select the same group of Random Access Preambles as was used for the Random Access Preamble transmission attempt corresponding to the first transmission of Msg3.
\( 2> \) select a Random Access Preamble randomly with equal probability from the Random Access Preambles associated with the selected SSB and the selected Random Access Preambles group;
\( 2> \) set the PREAMBLE_INDEX to the selected Random Access Preamble.
\( 1> \) if the Random Access procedure was initiated for SI request (as specified in TS 38.331 [5]); and
\( 1> \) if ra-AssociationPeriodIndex and si-RequestPeriod are configured:
\( 2> \) determine the next available PRACH occasion from the PRACH occasions corresponding to the selected SSB in the association period given by ra-AssociationPeriodIndex in the si-RequestPeriod permitted by the restrictions given by the \( r a \)-ssb-OccasionMaskIndex if configured (the MAC entity shall select a PRACH

ETSI