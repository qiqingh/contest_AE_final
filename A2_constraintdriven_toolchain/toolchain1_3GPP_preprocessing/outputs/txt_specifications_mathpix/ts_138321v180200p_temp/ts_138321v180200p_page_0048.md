<!-- Page 48 of ts_138321v180200p -->

3GPP TS 38.321 version 18.2.0 Release 18
47
ETSI TS 138321 V18.2.0 (2024-08)

4> else:
\( 5> \) set the C-RNTI to the value received in the successRAR;
\( 5> \) apply the following actions for the SpCell:
\( 6> \) process the received Timing Advance Command (see clause 5.2);
6> indicate the msgA-PreambleReceivedTargetPower and the amount of power ramping applied to the latest Random Access Preamble transmission to lower layers (i.e.
(PREAMBLE_POWER_RAMPING_COUNTER -1 ) Ã— PREAMBLE_POWER_RAMPING_STEP).
\( 4> \) deliver the TPC, PUCCH resource Indicator, ChannelAccess-CPext (if indicated), and HARQ feedback Timing Indicator received in successRAR to lower layers.

4> consider this Random Access Response reception successful;
\( 4> \) consider this Random Access procedure successfully completed;
4> finish the disassembly and demultiplexing of the MAC PDU.
1> if msgB-ResponseWindow expires, and the Random Access Response Reception has not been considered as successful based on descriptions above:
\( 2> \) increment PREAMBLE_TRANSMISSION_COUNTER by 1 ;
\( 2> \) if PREAMBLE_TRANSMISSION_COUNTER \( = \) preambleTransMax +1 :
3> indicate a Random Access problem to upper layers;
3> if this Random Access procedure was triggered for SI request:
4> consider this Random Access procedure unsuccessfully completed.
\( 2> \) if the Random Access procedure is not completed:
3> if msgA-TransMax is applied (see clause 5.1.1a) and PREAMBLE_TRANSMISSION_COUNTER \( = \) msgATransMax + 1:

4> set the RA_TYPE to 4-stepRA;
\( 4> \) perform initialization of variables specific to Random Access type as specified in clause 5.1.1a;
4> if the Msg3 buffer is empty:
\( 5> \) obtain the MAC PDU to transmit from the MSGA buffer and store it in the Msg3 buffer;
4> flush HARQ buffer used for the transmission of MAC PDU in the MSGA buffer;
\( 4> \) discard explicitly signalled contention-free 2 -step RA type Random Access Resources, if any;
4> perform the Random Access Resource selection procedure as specified in clause 5.1.2.
\( 3> \) else:
4> select a random backoff time according to a uniform distribution between 0 and the PREAMBLE_BACKOFF;

4- if the criteria (as defined in clause 5.1.2a) to select contention-free Random Access Resources is met during the backoff time:
\( 5> \) perform the Random Access Resource selection procedure for 2-step RA type Random Access (see clause 5.1.2a).

4 else:

ETSI