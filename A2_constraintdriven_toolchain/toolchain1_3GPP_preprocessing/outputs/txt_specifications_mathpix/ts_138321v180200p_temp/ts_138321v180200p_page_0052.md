<!-- Page 52 of ts_138321v180200p -->

3GPP TS 38.321 version 18.2.0 Release 18
51
ETSI TS 138321 V18.2.0 (2024-08)
5.1.6 Completion of the Random Access procedure

Upon completion of the Random Access procedure, the MAC entity shall:
\( 1> \) discard any explicitly signalled contention-free Random Access Resources for 2 -step RA type and 4 -step RA type except the 4 -step RA type contention-free Random Access Resources for beam failure recovery request, if any;
\( 1> \) flush the HARQ buffer used for transmission of the MAC PDU in the Msg3 buffer and the MSGA buffer.
Upon successful completion of the Random Access procedure initiated for DAPS handover, the target MAC entity shall:
\( 1> \) indicate the successful completion of the Random Access procedure to the upper layers.
5.2 Maintenance of Uplink Time Alignment

RRC configures the following parameters for the maintenance of UL time alignment:
- timeAlignmentTimer (per TAG) which controls how long the MAC entity considers the Serving Cells to the associated TAG to be uplink time aligned for the TAG;
- inactivePosSRS-TimeAlignmentTimer which controls how long the MAC entity considers the Positioning SRS transmission in RRC_INACTIVE in clause 5.26 to be uplink time aligned;
- cg-SDT-TimeAlignmentTimer which controls how long the MAC entity considers the uplink transmission for CG-SDT to be uplink time aligned;
- inactivePosSRS-ValidityAreaTAT which controls how long the MAC entity considers Positioning SRS transmission in RRC_INACTIVE in clause 5.26 to be uplink time aligned when SRS positioning validity area is configured.

The MAC entity shall:
1> when a Timing Advance Command MAC CE is received, and if an \( \mathrm{N}_{\mathrm{TA}} \) (as defined in TS 38.211 [8]) has been maintained with the indicated TAG:
\( 2> \) apply the Timing Advance Command for the indicated TAG;
\( 2> \) if there is ongoing Positioning SRS Transmission in RRC_INACTIVE as in clause 5.26:
3> if SRS positioning validity area is configured:
4> start or restart the inactivePosSRS-ValidityAreaTAT associated with the indicated TAG.
\( 3> \) else:
4> start or restart the inactivePosSRS-TimeAlignmentTimer associated with the indicated TAG.
\( 2> \) if CG-SDT procedure triggered as in clause 5.27 is ongoing:
3> start or restart the cg-SDT-TimeAlignmentTimer associated with the indicated TAG.
\( 2> \) else:
3> start or restart the timeAlignmentTimer associated with the indicated TAG.
1> when a Timing Advance Command is received in a Random Access Response message for a Serving Cell configured with two TAGs or in a MSGB for an SpCell configured with two TAGs:
\( 2> \) if the Random Access Preamble was not selected by the MAC entity among the contention-based Random Access Preamble:
\( 3> \) apply the Timing Advance Command for the TAG indicated in the received Random Access Response message or MSGB;

ETSI