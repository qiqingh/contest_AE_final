<!-- Page 38 of ts_138321v180200p -->

3GPP TS 38.321 version 18.2.0 Release 18
37
ETSI TS 138321 V18.2.0 (2024-08)

NOTE 4: If an (e)RedCap UE in RRC_IDLE or RRC_INACTIVE mode is configured with a BWP indicated by initialDownlinkBWP-RedCap which is not associated with any SSB for RACH, it is up to the UE implementation to perform a new RSRP measurements before Msg1/MsgA retransmission.
5.1.2a Random Access Resource selection for 2-step RA type

If the selected \( R A \_ \)TYPE is set to 2 -stepRA, the MAC entity shall:
\( 1> \) if the contention-free 2 -step RA type Resources associated with SSBs have been explicitly provided in rachConfigDedicated and at least one SSB with SS-RSRP above msgA-RSRP-ThresholdSSB amongst the associated SSBs is available:
\( 2> \) select an SSB with SS-RSRP above \( m s g A-R S R P \)-ThresholdSSB amongst the associated SSBs;
\( 2> \) set the PREAMBLE_INDEX to a ra-PreambleIndex corresponding to the selected SSB.
\( 1> \) else (i.e. for the contention-based Random Access Preamble selection):
\( 2> \) if at least one of the SSBs with SS-RSRP above msgA-RSRP-ThresholdSSB is available:
\( 3> \) select an SSB with SS-RSRP above msgA-RSRP-ThresholdSSB.
\( 2> \) else:
\( 3> \) select any SSB.
\( 2> \) if contention-free Random Access Resources for 2 -step RA type have not been configured and if Random Access Preambles group has not yet been selected during the current Random Access procedure:
\( 3> \) if Random Access Preambles group B for 2-step RA type is configured:
4 - if the potential MSGA payload size (UL data available for transmission plus MAC subheader and, where required, MAC CEs) is greater than the ra-MsgA-SizeGroupA and the pathloss is less than PCMAX (of the Serving Cell performing the Random Access Procedure) - msgAPreambleReceivedTargetPower - msgA-DeltaPreamble - messagePowerOffsetGroupB; or

4> if the Random Access procedure was initiated for the CCCH logical channel and the CCCH SDU size plus MAC subheader is greater than ra-MsgA-SizeGroupA:
\( 5> \) select the Random Access Preambles group B.
\( 4> \) else:
\( 5> \) select the Random Access Preambles group A.
\( 3> \) else:
\( 4> \) select the Random Access Preambles group A.
\( 2> \) else if contention-free Random Access Resources for 2 -step RA type have been configured and if Random Access Preambles group has not yet been selected during the current Random Access procedure:
\( 3> \) if Random Access Preambles group B for 2-step RA type is configured; and
\( 3> \) if the transport block size of the MSGA payload configured in the rach-ConfigDedicated corresponds to the transport block size of the MSGA payload associated with Random Access Preambles group B:
\( 4> \) select the Random Access Preambles group B.
\( 3> \) else:
\( 4> \) select the Random Access Preambles group A.
\( 2> \) else (i.e. Random Access preambles group has been selected during the current Random Access procedure):
\( 3> \) select the same group of Random Access Preambles as was used for the Random Access Preamble transmission attempt corresponding to the earlier transmission of MSGA.

ETSI