# ts_138213v170100p

Processed with Mathpix OCR API + pdfplumber fallback
Total pages: 247
Generated: 2025-12-06T14:47:23.752049

================================================================================


--- Page 1  ---


ETSI TS 138213 v17.1.0 (2022-05)

TECHNICAL SPECIFICATION

\author{
5G; \\ NR; \\ Physical layer procedures for control \\ (3GPP TS 38.213 version 17.1.0 Release 17)
}


--- Page 2  ---


3GPP TS 38.213 version 17.1.0 Release 17
1
ETSI TS 138213 V17.1.0 (2022-05)

\begin{tabular}{|l|}
\hline Reference \\
\hline RTS/TSGR-0138213vh10 \\
\hline Keywords \\
\hline 5G \\
\hline ETSI 650 Route des Lucioles F-06921 Sophia Antipolis Cedex - FRANCE \\
\hline \\
\hline \\
\hline Tel.: +33492944200 Fax: +33493654716 \\
\hline Siret No 34862356200017 - APE 7112B Association à but non lucratif enregistree a la Sous-Préfecture de Grasse (06) No w061004871 \\
\hline Important notice \\
\hline The present document can be downloaded from: http://www.etsi.org/standards-search \\
\hline
\end{tabular}

The present document may be made available in electronic versions and/or in print. The content of any electronic and/or print versions of the present document shall not be modified without the prior written authorization of ETSI. In case of any existing or perceived difference in contents between such versions and/or in print, the prevailing version of an ETSI deliverable is the one made publicly available in PDF format at www.etsi.org/deliver.

Users of the present document should be aware that the document may be subject to revision or change of status. Information on the current status of this and other ETSI documents is available at https://portal.etsi.org/TB/ETSIDeliverableStatus.aspx

If you find errors in the present document, please send your comment to one of the following services: https://portal.etsi.org/People/CommiteeSupportStaff.aspx

If you find a security vulnerability in the present document, please report it through our
Coordinated Vulnerability Disclosure Program:
https://www.etsi.org/standards/coordinated-vulnerability-disclosure
Notice of disclaimer \& limitation of liability
The information provided in the present deliverable is directed solely to professionals who have the appropriate degree of experience to understand and interpret its content in accordance with generally accepted engineering or other professional standard and applicable regulations.
No recommendation as to products and services or vendors is made or should be implied.
No representation or warranty is made that this deliverable is technically accurate or sufficient or conforms to any law and/or governmental rule and/or regulation and further, no representation or warranty is made of merchantability or fitness for any particular purpose or against infringement of intellectual property rights.
In no event shall ETSI be held liable for loss of profits or any other incidental or consequential damages.
Any software contained in this deliverable is provided "AS IS" with no warranties, express or implied, including but not limited to, the warranties of merchantability, fitness for a particular purpose and non-infringement of intellectual property rights and ETSI shall not be held liable in any event for any damages whatsoever (including, without limitation, damages for loss of profits, business interruption, loss of information, or any other pecuniary loss) arising out of or related to the use of or inability to use the software.

Copyright Notification
No part may be reproduced or utilized in any form or by any means, electronic or mechanical, including photocopying and microfilm except as authorized by written permission of ETSI.
The content of the PDF version shall not be modified without the written authorization of ETSI.
The copyright and the foregoing restriction extend to reproduction in all media.
© ETSI 2022.
All rights reserved.

ETSI


--- Page 3  ---


3GPP TS 38.213 version 17.1.0 Release 17
2
ETSI TS 138213 V17.1.0 (2022-05)

Intellectual Property Rights

Essential patents
IPRs essential or potentially essential to normative deliverables may have been declared to ETSL. The declarations pertaining to these essential IPRs, if any, are publicly available for ETSI members and non-members, and can be found in ETSI SR 000 314: "Intellectual Property Rights (IPRs); Essential, or potentially Essential, IPRs notified to ETSI in respect of ETSI standards", which is available from the ETSI Secretariat. Latest updates are available on the ETSI Web server (https://ipr.etsi.org).

Pursuant to the ETSI Directives including the ETSI IPR Policy, no investigation regarding the essentiality of [PRs, including IPR searches, has been carried out by ETSI. No guarantee can be given as to the existence of other IPRs not referenced in ETSI SR 000314 (or the updates on the ETSI Web server) which are, or may be, or may become, essential to the present document.

Trademarks
The present document may include trademarks and/or tradenames which are asserted and/or registered by their owners. ETSI claims no ownership of these except for any which are indicated as being the property of ETSI, and conveys no right to use or reproduce any trademark and/or tradename. Mention of those trademarks in the present document does not constitute an endorsement by ETSI of products, services or organizations associated with those trademarks.

DECT \( { }^{\text {TM }} \), PLUGTESTS \( { }^{\text {TM }} \), UMTS \( { }^{\text {TM }} \) and the ETSI logo are trademarks of ETSI registered for the benefit of its Members. 3GPPTM and LTETM are trademarks of ETSI registered for the benefit of its Members and of the 3GPP Organizational Partners. oneM2M \( { }^{\text {TM }} \) logo is a trademark of ETSI registered for the benefit of its Members and of the oneM2M Partners. GSM \( { }^{\text {® }} \) and the GSM logo are trademarks registered and owned by the GSM Association.

Legal Notice
This Technical Specification (TS) has been produced by ETSI 3rd Generation Partnership Project (3GPP).
The present document may refer to technical specifications or reports using their 3GPP identities. These shall be interpreted as being references to the corresponding ETSI deliverables.

The cross reference between 3GPP and ETSI identities can be found under http//webapp.etsi.org/key/queryform.asp.
Modal verbs terminology
In the present document "shall", "shall not", "should", "should not", "may", "need not", "will", "will not", "can" and "cannot" are to be interpreted as described in clause 3.2 of the ETSI Drafting Rules (Verbal forms for the expression of provisions).
"must" and "must not" are NOT allowed in ETSI deliverables except when used in direct citation.

ETSI


--- Page 4  ---


3GPP TS 38.213 version 17.1.0 Release 17
3
ETSI TS 138213 V17.1.0 (2022-05)

Contents

\begin{tabular}{|l|l|l|}
\hline \multicolumn{2}{|l|}{Intellectual Property Rights} & 2 \\
\hline \multicolumn{2}{|l|}{Legal Notice} & 2 \\
\hline \multicolumn{2}{|l|}{Modal verbs terminology} & 2 \\
\hline \multicolumn{2}{|l|}{Foreword} & 6 \\
\hline \multicolumn{2}{|l|}{1 Scope} & 7 \\
\hline \multicolumn{2}{|l|}{2 References} & 7 \\
\hline 3 & Definitions, symbols and abbreviations & 8 \\
\hline 3.1 & Definitions & 8 \\
\hline 3.2 & Symbols & 8 \\
\hline 3.3 & Abbreviations & 8 \\
\hline 4 & Synchronization procedures & 10 \\
\hline 4.1 & Cell search & 10 \\
\hline 4.2 & Transmission timing adjustments & 13 \\
\hline 4.3 & Timing for secondary cell activation / deactivation. & 14 \\
\hline 5 & Radio link monitoring & 14 \\
\hline 6 & Link recovery procedures & 16 \\
\hline 7 & Uplink Power control & 19 \\
\hline 7.1 & Physical uplink shared channel & 20 \\
\hline 7.1.1 & UE behaviour & 21 \\
\hline 7.2 & Physical uplink control channel & 31 \\
\hline 7.2.1 & UE behaviour & 32 \\
\hline 7.3 & Sounding reference signals & 37 \\
\hline 7.3.1 & UE behaviour & 37 \\
\hline 7.4 & Physical random access channel & 40 \\
\hline 7.5 & Prioritizations for transmission power reductions & 40 \\
\hline 7.6 & Dual connectivity & 41 \\
\hline 7.6.1 & EN-DC & 41 \\
\hline 7.6.1A & NE-DC & 42 \\
\hline 7.6.2 & NR-DC & 43 \\
\hline 7.7 & Power headroom report & 44 \\
\hline 7.7.1 & Type 1 PH report & 45 \\
\hline 7.7 .2 & Type 2 PH report & 47 \\
\hline 7.7.3 & Type 3 PH report & 47 \\
\hline 8 & Random access procedure & 47 \\
\hline 8.1 & Random access preamble & 48 \\
\hline 8.1A & PUSCH for Type-2 random access procedure & 51 \\
\hline 8.2 & Random access response - Type-1 random access procedure & 53 \\
\hline 8.2A & Random access response - Type-2 random access procedure & 55 \\
\hline 8.3 & PUSCH scheduled by RAR UL grant & 56 \\
\hline 8.4 & PDSCH with UE contention resolution identity & 58 \\
\hline 9 & UE procedure for reporting control information & 58 \\
\hline 9.A & PUCCH cell switching & 66 \\
\hline 9.1 & HARQ-ACK codebook determination & 66 \\
\hline 9.1.1 & CBG-based HARQ-ACK codebook determination & 67 \\
\hline 9.1.2 & Type-1 HARQ-ACK codebook determination & 68 \\
\hline 9.1.2.1 & Type-1 HARQ-ACK codebook in physical uplink control channel & 70 \\
\hline 9.1.2.2 & Type-1 HARQ-ACK codebook in physical uplink shared channel & 81 \\
\hline 9.1.3 & Type-2 HARQ-ACK codebook determination & 82 \\
\hline 9.1.3.1 & Type-2 HARQ-ACK codebook in physical uplink control channel & 83 \\
\hline 9.1.3.2 & Type-2 HARQ-ACK codebook in physical uplink shared channel & 92 \\
\hline 9.1.3.3 & Type-2 HARQ-ACK codebook grouping and HARQ-ACK retransmission. & 93 \\
\hline
\end{tabular}

ETSI


--- Page 5  ---


3GPP TS 38.213 version 17.1.0 Release 17
4
ETSI TS 138213 V17.1.0 (2022-05)

\begin{tabular}{|l|l|}
\hline 9.14 & Type-3 HARQ-ACK codebook determination \\
\hline 9.1.5 & HARQ-ACK codebook retransmission \\
\hline 9.2 & UCI reporting in physical uplink control channel \\
\hline 9.2.1 & PUCCH Resource Sets. \\
\hline 9.2.2 & PUCCH Formats for UCI transmission \\
\hline 9.2.3 & UE procedure for reporting HARQ-ACK \\
\hline 9.2.4 & UE procedure for reporting SR \\
\hline 9.2.5 & UE procedure for reporting multiple UCI types \\
\hline 9.2.5.0 & UE procedure for prioritization between SL HARQ-ACK information in a PUCCH and DL \\
\hline 9.2.5.1 & UE procedure for multiplexing HARQ-ACK or CSI and SR in a PUCCH \\
\hline 9.2.5.2 & UE procedure for multiplexing HARQ-ACK/SR/CSI in a PUCCH \\
\hline 9.2.5.3 & UE procedure for reporting UCI of different priorities \\
\hline 9.2.5.4 & UE procedure for deferring HARQ-ACK for SPS PDSCH \\
\hline 9.2.6 & PUCCH repetition procedure \\
\hline 9.3 & UCI reporting in physical uplink shared channel \\
\hline & 10 UE procedure for receiving control information \\
\hline 10.1 & UE procedure for determining physical downlink control channel assignment \\
\hline 10.1.1 & Self-carrier and cross-carrier scheduling on the primary cell \\
\hline 10.2 & PDCCH validation for DL SPS and UL grant Type 2 \\
\hline 10.2A & PDCCH validation for SL configured grant Type 2 \\
\hline 10.3 & PDCCH monitoring indication and dormancy/non-dormancy behaviour for SCells \\
\hline 10.4 & Search space set group switching and skipping of PDCCH monitoring \\
\hline 10.4A & PDCCH monitoring for early indication of paging \\
\hline 10.4B & Indication of TRS resources \\
\hline 10.5 & HARQ-ACK information for PUSCH transmissions \\
\hline & 11 UE-group common signalling \\
\hline 11.1 & Slot configuration \\
\hline 11.1.1 & UE procedure for determining slot format \\
\hline 11.2 & Interrupted transmission indication \\
\hline 11.2A & Cancellation indication \\
\hline 11.3 & Group TPC commands for PUCCH/PUSCH \\
\hline 11.4 & SRS switching \\
\hline & 12 Bandwidth part operation \\
\hline & 13 UE procedure for monitoring Type0-PDCCH CSS sets \\
\hline & 14 Integrated access-backhaul operation \\
\hline & 15 Dual active protocol stack based handover \\
\hline & 16 UE procedures for sidelink \\
\hline 16.1 & Synchronization procedures \\
\hline 16.2 & Power control \\
\hline 16.2.0 & S-SS/PSBCH blocks \\
\hline 16.2.1 & PSSCH \\
\hline 16.2.2 & PSCCH \\
\hline 16.2.3 & PSFCH \\
\hline 16.2.4 & Prioritization of transmissions/receptions \\
\hline 16.2.4.1 & Simultaneous NR and E-UTRA transmission/reception \\
\hline 16.2.4.2 & Simultaneous PSFCH transmission/reception \\
\hline 16.2.4.3 & Simultaneous SL and UL transmissions/receptions \\
\hline 16.2.4.3.1 & Prioritizations for sidelink and uplink transmissions/receptions \\
\hline 16.3 & UE procedure for reporting and obtaining control information in PSFCH \\
\hline 16.3.0 & UE procedure for transmitting PSFCH with control information \\
\hline 16.3.1 & UE procedure for receiving PSFCH with control information \\
\hline 16.4 & UE procedure for transmitting PSCCH \\
\hline 16.5 & UE procedure for reporting HARQ-ACK on uplink \\
\hline 16.5.1 & Type-1 HARQ-ACK codebook determination \\
\hline 16.5.1.1 & Type-1 HARQ-ACK codebook in physical uplink control channel \\
\hline 16.5.1.2 & Type-1 HARQ-ACK codebook in physical uplink shared channel \\
\hline
\end{tabular}

ETSI


--- Page 6  ---


3GPP TS 38.213 version 17.1.0 Release 17
5
ETSI TS 138213 V17.1.0 (2022-05)
16.5.2 Type-2 HARQ-ACK codebook determination ..... 226
16.5.2.1 Type-2 HARQ-ACK codebook in physical uplink control channel ..... 226
16.5.2.2 Type-2 HARQ-ACK codebook in physical uplink shared channel. ..... 228
16.6 UE procedure for LTE sidelink transmission ..... 229
16.7 Operation for in-device coexistence ..... 229
17 UE with reduced capabilities. ..... 229
17.1 RedCap UE procedures ..... 230
17.2 Half-Duplex UE in paired spectrum ..... 230
18 Multicast Broadcast Services ..... 231
19 PUSCH transmission in RRC_INACTIVE state ..... 234
19.1 Configured-grant based PUSCH transmission ..... 234
19.2 Random-access based PUSCH transmission ..... 236
Annex A: Change history ..... 237
History ..... 246

ETSI


--- Page 7  ---


3GPP TS 38.213 version 17.1.0 Release 17
6
ETSI TS 138213 V17.1.0 (2022-05)

Foreword
This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:

Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e technical enhancements, corrections, updates, etc.
\( z \) the third digit is incremented when editorial only changes have been incorporated in the document.

ETSI


--- Page 8  ---


3GPP TS 38.213 version 17.1.0 Release 17
7
ETSI TS 138213 V17.1.0 (2022-05)

1 Scope
The present document specifies and establishes the characteristics of the physical layer procedures for control operations in 5G-NR.

2 References
The following documents contain provisions which, through reference in this text, constitute provisions of the present document.

[1]

3GPP TR 21.905: "Vocabulary for 3GPP Specifications"

[2]

3GPP TS 38.201: "NR; Physical Layer - General Description"

[3]

3GPP TS 38.202: "NR; Services provided by the physical layer"

[4]

3GPP TS 38.211: "NR; Physical channels and modulation"

[5]

3GPP TS 38.212: "NR; Multiplexing and channel coding"

[6]

3GPP TS 38.214: "NR; Physical layer procedures for data"

[7]

3GPP TS 38.215: "NR; Physical layer measurements"

[8-1]

3GPP TS 38.101-1: "NR; User Equipment (UE) radio transmission and reception; Part 1: Range 1 Standalone"

[8-2]

3GPP TS 38.101-2: "NR; User Equipment (UE) radio transmission and reception; Part 2: Range 2 Standalone"

[8-3]

3GPP TS 38.101-3: "NR; User Equipment (UE) radio transmission and reception; Part 3: Range 1 and Range 2 Interworking operation with other radios"

[8-4]

3GPP TS 38.101-4: "NR; User Equipment (UE) radio transmission and reception; Part 4: Performance requirements"

[9]

3GPP TS 38.104: "NR; Base Station (BS) radio transmission and reception"

[10]

3GPP TS 38.133: "NR; Requirements for support of radio resource management"

[11]

3GPP TS 38.321: "NR; Medium Access Control (MAC) protocol specification"

[12]

3GPP TS 38.331: "NR; Radio Resource Control (RRC); Protocol specification"

[13]

3GPP TS 36.213: "Evolved Universal Terrestrial Radio Access (E-UTRA); Physical layer procedures"

[14]

3GPP TS 36.321: "Evolved Universal Terrestrial Radio Access (E-UTRA); Medium Access Control (MAC) protocol specification"

[15]

3GPP TS 37.213: "Physical layer procedures for shared spectrum channel access"

[16]

3GPP TS 38.473: "F1 application protocol (F1AP)"

[17]

3GPP TS 38.304: "NR; User Equipment (UE) procedures in Idle mode and RRC Inactive state"

[18]

3GPP TS 38.306: "NR; User Equipment (UE) radio access capabilities"

ETSI


--- Page 9  ---


3GPP TS 38.213 version 17.1.0 Release 17
8
ETSI TS 138213 V17.1.0 (2022-05)

3 Definitions, symbols and abbreviations
3.1 Definitions

For the purposes of the present document, the terms and definitions given in [1, TR 21.905] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in [1, TR 21.905]. A parameter referenced in italics is provided by higher layers.
3.2 Symbols

For the purposes of the present document, the following symbols apply:
3.3 Abbreviations

For the purposes of the present document, the abbreviations given in TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in [1, TR 21.905].

\begin{tabular}{|l|l|}
\hline BPRE & Bits per resource element \\
\hline BWP & Bandwidth part \\
\hline CB & Code block \\
\hline CBG & Code block group \\
\hline CBR & Channel busy ratio \\
\hline CCE & Control channel element \\
\hline CORESET & Control resource set \\
\hline CP & Cyclic prefix \\
\hline CRC & Cyclic redundancy check \\
\hline C-RNTI & Cell RNTI \\
\hline CS-RNTI & Configured scheduling RNTI \\
\hline CSI & Channel state information \\
\hline CSS & Common search space \\
\hline DAI & Downlink assignment index \\
\hline DAPS & Dual active protocol stack \\
\hline DC & Dual connectivity \\
\hline DCI & Downlink control information \\
\hline DL & Downlink \\
\hline DL-SCH & Downlink shared channel \\
\hline EPRE & Energy per resource element \\
\hline EN-DC & E-UTRA NR dual connectivity with MCG using E-UTRA and SCG using NR \\
\hline FR1 & Frequency range 1 \\
\hline FR2 & Frequency range 2 \\
\hline G-CS-RNTI & Group configured scheduling RNTI \\
\hline G-RNTI & Group RNTI \\
\hline GSCN & Global synchronization channel number \\
\hline HARQ-ACK & Hybrid automatic repeat request acknowledgement \\
\hline MBS & Multicast broadcast services \\
\hline MCG & Master cell group \\
\hline MCS & Modulation and coding scheme \\
\hline NDI & New Data Indicator \\
\hline NE-DC & E-UTRA NR dual connectivity with MCG using NR and SCG using E-UTRA \\
\hline NR-DC & NR NR dual connectivity \\
\hline PBCH & Physical broadcast channel \\
\hline PCell & Primary cell \\
\hline PDCCH & Physical downlink control channel \\
\hline PDSCH & Physical downlink shared channel \\
\hline PO & Paging occasion \\
\hline PRACH & Physical random access channel \\
\hline PRB & Physical resource block \\
\hline
\end{tabular}

ETSI


--- Page 10  ---


3GPP TS 38.213 version 17.1.0 Release 17
9
ETSI TS 138213 V17.1.0 (2022-05)

\begin{tabular}{|l|l|}
\hline PRG & Physical resource block group \\
\hline PSCell & Primary secondary cell \\
\hline PSBCH & Physical sidelink broadcast channel \\
\hline PSCCH & Physical sidelink control channel \\
\hline PSFCH & Physical sidelink feedback channel \\
\hline PSS & Primary synchronization signal \\
\hline PSSCH & Physical sidelink shared channel \\
\hline PUCCH & Physical uplink control channel \\
\hline PUCCH-SCell & PUCCH SCell \\
\hline PUCCH-sSCell & PUCCH switching SCell \\
\hline PUSCH & Physical uplink shared channel \\
\hline QCL & Quasi co-location \\
\hline RB & Resource block \\
\hline RE & Resource element \\
\hline RLM & Radio link monitoring \\
\hline RRM & Radio resource management \\
\hline RS & Reference signal \\
\hline RSRP & Reference signal received power \\
\hline SCG & Secondary cell group \\
\hline SCI & Sidelink control information \\
\hline SCS & Subcarrier spacing \\
\hline SFCI & Sidelink feedback control information \\
\hline SFN & System frame number \\
\hline SL & Sidelink \\
\hline SLIV & Start and length indicator value \\
\hline SPS & Semi-persistent scheduling \\
\hline SR & Scheduling request \\
\hline SRI & SRS resource indicator \\
\hline SRS & Sounding reference signal \\
\hline SSS & Secondary synchronization signal \\
\hline SSSG & Search space set group \\
\hline TA & Timing advance \\
\hline TAG & Timing advance group \\
\hline TB & Transport block \\
\hline TBG & Transport block group \\
\hline TCI & Transmission Configuration Indicator \\
\hline UCI & Uplink control information \\
\hline UE & User equipment \\
\hline UL & Uplink \\
\hline UL-SCH & Uplink shared channel \\
\hline USS & UE-specific search space \\
\hline
\end{tabular}

ETSI


--- Page 11  ---


3GPP TS 38.213 version 17.1.0 Release 17
10
ETSI TS 138213 V17.1.0 (2022-05)

4 Synchronization procedures
4.1 Cell search

Cell search is the procedure for a UE to acquire time and frequency synchronization with a cell and to detect the physical layer Cell ID of the cell.

A UE receives the following synchronization signals (SS) in order to perform cell search: the primary synchronization signal (PSS) and secondary synchronization signal (SSS) as defined in [4, TS 38.211].

A UE assumes that reception occasions of a physical broadcast channel (PBCH), PSS, and SSS are in consecutive symbols, as defined in [4, TS 38.211], and form a SS/PBCH block. The UE assumes that SSS, PBCH DM-RS, and PBCH data have same EPRE. The UE may assume that the ratio of PSS EPRE to SSS EPRE in a SS/PBCH block is either 0 dB or 3 dB . If the UE has not been provided dedicated higher layer parameters, the UE may assume that the ratio of PDCCH DMRS EPRE to SSS EPRE is within -8 dB and 8 dB when the UE monitors PDCCHs for a DCI format \( 1 \_0 \) with CRC scrambled by SI-RNTI, P-RNTI, or RA-RNTI, or for a DCI format 2 -

For a half frame with SS/PBCH blocks, the first symbol indexes for candidate SS/PBCH blocks are determined according to the SCS of SS/PBCH blocks as follows, where index 0 corresponds to the first symbol of the first slot in a half-frame.
- Case A - 15 kHz SCS: the first symbols of the candidate SS/PBCH blocks have indexes of \( \{2,8\}+14 \cdot n \).
- For operation without shared spectrum channel access:
- For carrier frequencies smaller than or equal to \( 3 \mathrm{GHz}, n=0,1 \).
- For carrier frequencies within FR1 larger than \( 3 \mathrm{GHz}, n=0,1,2,3 \).
- For operation with shared spectrum channel access, as described in [15, TS 37.213], \( n=0,1,2,3,4 \).
- Case B - 30 kHz SCS : the first symbols of the candidate SS/PBCH blocks have indexes \( \{4,8,16,20\}+28 \cdot n \). For carrier frequencies smaller than or equal to \( 3 \mathrm{GHz}, n=0 \). For carrier frequencies within FR1 larger than 3 \( \mathrm{GHz}, n=0,1 \).
- Case C - 30 kHz SCS: the first symbols of the candidate SS/PBCH blocks have indexes \( \{2,8\}+14 \cdot n \).
- For operation without shared spectrum channel access
- For paired spectrum operation
- For carrier frequencies smaller than or equal to \( 3 \mathrm{GHz}, n=0,1 \). For carrier frequencies within FR1 larger than \( 3 \mathrm{GHz}, n=0,1,2,3 \).
- For unpaired spectrum operation
- For carrier frequencies smaller than \( 1.88 \mathrm{GHz}, n=0,1 \). For carrier frequencies within FR1 equal to or larger than \( 1.88 \mathrm{GHz}, n=0,1,2,3 \).
- For operation with shared spectrum channel access, \( n=0,1,2,3,4,5,6,7,8,9 \).
- Case D - 120 kHz SCS : the first symbols of the candidate SS/PBCH blocks have indexes \( \{4,8,16,20\}+28 \cdot n \). For carrier frequencies within \( \mathrm{FR} 2, n=0,1,2,3,5,6,7,8,10,11,12,13,15,16,17 \), 18 .
- Case E - 240 kHz SCS: the first symbols of the candidate SS/PBCH blocks have indexes \( \{8,12,16,20,32,36,40,44\}+56 \cdot n \). For carrier frequencies within \( \mathrm{FR} 2-1, n=0,1,2,3,5,6,7,8 \).
- Case F -480 kHz SCS : the first symbols of the candidate SS/PBCH blocks have indexes \( \{2,9\}+14 \cdot n \). For carrier frequencies within FR2-2, \( n= 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31 \).

ETSI


--- Page 12  ---


3GPP TS 38.213 version 17.1.0 Release 17
11
ETSI TS 138213 V17.1.0 (2022-05)
- Case G -960 kHz SCS: the first symbols of the candidate SS/PBCH blocks have indexes \( \{2,9\}+14 \cdot n \). For carrier frequencies within FR2-2, \( n= \)
\[
0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31 .
\]

From the above cases, if the SCS of SS/PBCH blocks is not provided by ssbSubcarrierSpacing, the applicable cases for a cell depend on a respective frequency band, as provided in [8-1, TS 38.101-1] and [8-2, TS 38.101-2]. A same case applies for all SS/PBCH blocks on the cell. If a 30 kHz SS/PBCH block SCS is indicated by ssbSubcarrierSpacing, Case B applies for frequency bands with only 15 kHz SS/PBCH block SCS as specified in [8-1, TS 38.101-1], and the case specified for 30 kHz SS/PBCH block SCS in [8-1, TS 38.101-1] applies for frequency bands with 30 kHz SS/PBCH block SCS or both 15 kHz and 30 kHz SS/PBCH block SCS as specified in [8-1, TS 38.101-1]. For a UE configured to operate with carrier aggregation over a set of cells in a frequency band of FR2 or with frequencycontiguous carrier aggregation over a set of cells in a frequency band of FR1, if the UE is provided SCS values by ssbSubcarrierSpacing for receptions of SS/PBCH blocks on any cells from the set of cells, the UE expects the SCS values to be same.

The candidate SS/PBCH blocks in a half frame are indexed in an ascending order in time from 0 to \( \bar{L}_{\text {max }}-1 \), where \( \bar{L}_{\text {max }} \) is determined according to SS/PBCH block patterns for Cases A through G. \( L_{\text {max }} \) is a maximum number of SS/PBCH block indexes in a cell, and the maximum number of transmitted SS/PBCH blocks within a half frame is \( L_{\text {max }} \) -
- For operation without shared spectrum channel access in FR1 and FR2, and for operation with shared spectrum channel access in FR2-2, \( L_{\text {max }}=\bar{L}_{\text {max }} \)
- For operation with shared spectrum channel access in FR1, \( L_{\text {max }}=8 \) for \( \bar{L}_{\text {max }}=10 \) and 15 kHz SCS of SS/PBCH blocks and for \( \bar{L}_{\text {max }}=20 \) and 30 kHz SCS of SS/PBCH blocks

For \( \bar{L}_{\text {max }}=4 \), a UE determines the 2 LSB bits of a candidate SS/PBCH block index per half frame from a one-to-one mapping with an index of the DM-RS sequence transmitted in the PBCH as described in [4, TS 38.211].

For \( \bar{L}_{\text {max }}>4 \), a UE determines the 3 LSB bits of a candidate SS/PBCH block index per half frame from a one-to-one mapping with an index of the DM-RS sequence transmitted in the PBCH as described in [4, TS 38.211]
- for \( \bar{L}_{\text {max }}=10 \), the UE determines the 1 MSB bit of the candidate SS/PBCH block index from PBCH payload bit \( \bar{a}_{\bar{A}+7} \) as described in [5, TS 38.212]
- for \( \bar{L}_{\text {max }}=20 \), the UE determines the 2 MSB bits of the candidate SS/PBCH block index from PBCH payload bits \( \bar{a}_{\bar{A}+6}, \bar{a}_{\bar{A}+7} \) as described in [5, TS 38.212]
- for \( \bar{L}_{\text {max }}=64 \), the UE determines the 3 MSB bits of the candidate SS/PBCH block index from PBCH payload bits \( \bar{a}_{\bar{A}+5}, \bar{a}_{\bar{A}+6}, \bar{a}_{\bar{A}+7} \) as described in [5, TS 38.212]

A UE can be provided per serving cell by ssb-periodicityServingCell a periodicity of the half frames for reception of the SS/PBCH blocks for the serving cell. If the UE is not configured a periodicity of the half frames for receptions of the SS/PBCH blocks, the UE assumes a periodicity of a half frame. A UE assumes that the periodicity is same for all SS/PBCH blocks in the serving cell.

For initial cell selection, a UE may assume that half frames with SS/PBCH blocks occur with a periodicity of 2 frames.
For operation without shared spectrum channel access, an SS/PBCH block index is same as a candidate SS/PBCH block index.

For operation with shared spectrum channel access, a UE assumes that transmission of SS/PBCH blocks in a half frame is within a discovery burst transmission window that starts from the first symbol of the first slot in a half-frame. The UE can be provided per serving cell by discoveryBurstWindowLength a duration of the discovery burst transmission window. If discoveryBurstWindowLength is not provided, the UE assumes that the duration of the discovery burst transmission window is a half frame. For a serving cell, the UE assumes that a periodicity of the discovery burst transmission window is same as a periodicity of half frames for receptions of SS/PBCH blocks in the serving cell. The UE assumes that one or more SS/PBCH blocks indicated by ssb-PositionsInBurst may be transmitted within the discovery burst transmission window and have candidate SS/PBCH blocks indexes corresponding to SS/PBCH block indexes provided by ssb-PositionsInBurst. If MSB \( k, k \geq 1 \), of ssb-PositionsInBurst is set to 1 , the UE assumes that SS/PBCH block(s) within the discovery burst transmission window with candidate SS/PBCH block index(es)

ETSI


--- Page 13  ---


3GPP TS 38.213 version 17.1.0 Release 17
12
ETSI TS 138213 V17.1.0 (2022-05)

corresponding to SS/PBCH block index equal to \( k-1 \) may be transmitted; if MSB \( k \) is set to 0 , the UE assumes that the SS/PBCH block(s) are not transmitted. If MSB \( k, k \geq 1 \), of inOneGroup is set to 1 , and MSB \( m, m \geq 1 \), of groupPresence is set to 1 , the UE assumes that SS/PBCH block(s) within the discovery burst transmission window with candidate SS/PBCH block index(es) corresponding to SS/PBCH block index determined by \( k \) and \( m \) may be transmitted; otherwise, the UE assumes that the SS/PBCH block(s) are not transmitted.

For operation with shared spectrum channel access in FR1, a UE assumes that SS/PBCH blocks in a serving cell that are within a same discovery burst transmission window or across discovery burst transmission windows are quasi colocated with respect to average gain, quasi co-location 'type A' and 'typeD' properties, when applicable [6, TS 38.214], if a value of \( \left(N_{D M-R S}^{P B C H} \bmod N_{S S B}^{Q C L}\right) \) is same among the SS/PBCH blocks. \( N_{D M-R S}^{P B C H} \) is an index of a DM-RS sequence transmitted in a PBCH of a corresponding SS/PBCH block, and \( N_{S S B}^{Q C L} \) is either provided by ssb-PositionQCL or, if ssbPositionQCL is not provided, obtained from a MIB provided by a SS/PBCH block according to Table 4.1-1 with \( k_{S S B}< \) 24 [4, TS 38.211]. The UE can determine an SS/PBCH block index according to \( \left(N_{D M-R S}^{P B C H} \bmod N_{S S B}^{Q C L}\right) \), or according to \( \left(\bar{l} \bmod N_{S S B}^{Q C L}\right) \) where \( \bar{l} \) is the candidate SS/PBCH block index. The UE assumes that within a discovery burst transmission window, a number of transmitted SS/PBCH blocks on a serving cell is not larger than \( N_{S S B}^{Q C L} \) and a number of transmitted SS/PBCH blocks with a same SS/PBCH block index is not larger than one.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 4.1-1: Mapping between the combination of subCarrierSpacingCommon and LSB of ssbSubcarrierOffset to \( N_{S S B}^{Q C L} \) for operation with shared spectrum channel access in FR1}
\begin{tabular}{|c|c|c|}
\hline subCarrierSpacingCommon & LSB of ssb-SubcarrierOffset & \( N_{\text {ssB }}^{\text {QCL }} \) \\
\hline scs15or60 & 0 & 1 \\
\hline scs15or60 & 1 & 2 \\
\hline scs30or120 & 0 & 4 \\
\hline scs30or120 & 1 & 8 \\
\hline
\end{tabular}
\end{table}

For operation with shared spectrum channel access in FR2-2, a UE assumes that SS/PBCH blocks in a serving cell that are within a same discovery burst transmission window or across discovery burst transmission windows are quasi colocated with respect to average gain, quasi co-location 'type A ' and 'typeD' properties, when applicable, if a value of \( \left(\bar{\imath} \bmod N_{S S B}^{Q C L}\right) \) is same among the SS/PBCH blocks, where \( \bar{\imath} \) is the candidate SS/PBCH block index. \( N_{S S B}^{Q C L} \) is either provided by ssb-PositionQCL or, if ssb-PositionQCL is not provided, obtained from a MIB provided by a SS/PBCH block according to Table 4.1-2. The UE can determine an SS/PBCH block index according to \( \left(\bar{l} \bmod N_{S S B}^{Q C L}\right) \). The UE assumes that within a discovery burst transmission window, a number of transmitted SS/PBCH blocks on a serving cell is not larger than \( N_{S S B}^{Q C L} \) and a number of transmitted SS/PBCH blocks with a same SS/PBCH block index is not larger than one.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 4.1-2: Mapping between subCarrierSpacingCommon to \( N_{S S B}^{Q C L} \) for operation with shared spectrum channel access in FR2-2}
\begin{tabular}{|c|c|}
\hline subCarrierSpacingCommon & \( N_{\text {SSR }}^{\text {QCL }} \) \\
\hline Scs15or60 & 32 \\
\hline scs30or120 & 64 \\
\hline
\end{tabular}
\end{table}

For operation without shared spectrum channel access in FR2-2, a UE expects a MIB in a SS/PBCH block to provide subCarrierSpacingCommon \( = \) 'scs30or120'.

Upon detection of a SS/PBCH block, the UE determines from MIB that a CORESET for Type0-PDCCH CSS set, as described in clause 13, is present if \( k_{S S B}<24 \) [4, TS 38.211] for FR1 or if \( k_{S S B}<12 \) for FR2. The UE determines from MIB that a CORESET for Type0-PDCCH CSS set is not present if \( k_{S S B}>23 \) for FR1 or if \( k_{S S B}>11 \) for FR2; the CORESET for Type0-PDCCH CSS set may be provided by PDCCH-ConfigCommon.

For a serving cell without transmission of SS/PBCH blocks, a UE acquires time and frequency synchronization with the serving cell based on receptions of SS/PBCH blocks on the PCell, or on the PSCell, or on an SCell if applicable as described in [10, TS 38.133], of the cell group for the serving cell.

ETSI


--- Page 14  ---


3GPP TS 38.213 version 17.1.0 Release 17
13
ETSI TS 138213 V17.1.0 (2022-05)
4.2 Transmission timing adjustments

A UE can be provided a value \( N_{\text {TA, offset }} \) of a timing advance offset for a serving cell by \( n \)-TimingAdvanceOffset for the serving cell. If the UE is not provided \( n \)-TimingAdvanceOffset for a serving cell, the UE determines a default value \( N_{\text {TA, offset }} \) of the timing advance offset for the serving cell as described in [10, TS 38.133].

If a UE is configured with two UL carriers for a serving cell, a same timing advance offset value \( N_{\mathrm{TA}} \) offset applies to both carriers.

Upon reception of a timing advance command for a TAG, the UE adjusts uplink timing for PUSCH/SRS/PUCCH transmission on all the serving cells in the TAG based on a value \( N_{\text {TA offset }} \) that the UE expects to be same for all the serving cells in the TAG and based on the received timing advance command where the uplink timing for PUSCH/SRS/PUCCH transmissions is the same for all the serving cells in the TAG.

For a band with synchronous contiguous intra-band EN-DC in a band combination with non-applicable maximum transmit timing difference requirements as described in Note 1 of Table 7.5.3-1 of [10, TS 38.133], if the UE indicates ul-TimingAlignmentEUTRA-NR as 'required' and uplink transmission timing based on timing adjustment indication for a TAG from MCG and a TAG from SCG are determined to be different by the UE, the UE adjusts the transmission timing for PUSCH/SRS/PUCCH transmission on all serving cells part of the band with the synchronous contiguous intra-band EN-DC based on timing adjustment indication for a TAG from a serving cell in MCG in the band. The UE is not expected to transmit a PUSCH/SRS/PUCCH in one CG when the PUSCH/SRS/PUCCH is overlapping in time, even partially, with random access preamble transmitted in another CG.

For a SCS of \( 2^{\mu}+15 \mathrm{kHz} \), the timing advance command for a TAG indicates the change of the uplink timing relative to the current uplink timing for the TAG in multiples of \( 16 \cdot 64 \cdot T_{c} / 2^{\mu} \). The start timing of the random access preamble is described in [4, TS 38.211].

A timing advance command [11, TS 38.321 ] in case of random access response or in an absolute timing advance command MAC CE, \( T_{\mathrm{A}} \), for a TAG indicates \( N_{\mathrm{TA}} \) values by index values of \( T_{\mathrm{A}}=0,1,2, \ldots, 3846 \), where an amount of the time alignment for the TAG with SCS of \( 2^{\mu} \cdot 15 \mathrm{kHz} \) is \( N_{\mathrm{TA}}=T_{\mathrm{A}} \cdot 16 \cdot 64 / 2^{\mu} \). \( N_{\mathrm{TA}} \) is defined in [4, TS 38.211] and is relative to the SCS of the first uplink transmission from the UE after the reception of the random access response or absolute timing advance command MAC CE.

In other cases, a timing advance command [11, TS 38.321], \( T_{\mathrm{A}} \), for a TAG indicates adjustment of a current \( N_{\mathrm{TA}} \) value, \( N_{\text {TA_old, to the new }} N_{\text {TA }} \) value, \( N_{\text {TA_new }} \), by index values of \( T_{\mathrm{A}}=0,1,2, \ldots, 63 \), where for a SCS of \( 2^{\mu} \cdot 15 \mathrm{kHz} \), \( N_{\text {TA_new }}=N_{\text {TA_old }}+\left(T_{\mathrm{A}}-31\right) \cdot 16 \cdot 64 / 2^{\mu} \).

If a UE has multiple active UL BWPs, as described in clause 12, in a same TAG, including UL BWPs in two UL carriers of a serving cell, the timing advance command value is relative to the largest SCS of the multiple active UL BWPs. The applicable \( N_{\text {TA_new }} \) value for an UL BWP with lower SCS may be rounded to align with the timing advance granularity for the UL BWP with the lower SCS while satisfying the timing advance accuracy requirements in [10, TS 38.133].

Adjustment of an \( N_{\text {TA }} \) value by a positive or a negative amount indicates advancing or delaying the uplink transmission timing for the TAG by a corresponding amount, respectively.

For a timing advance command received on uplink slot \( n \) and for a transmission other than a PUSCH scheduled by a RAR UL grant or a fallbackRAR UL grant as described in clause 8.2A or 8.3, or a PUCCH with HARQ-ACK information in response to a successRAR as described in clause 8.2 A , the corresponding adjustment of the uplink transmission timing applies from the beginning of uplink slot \( n+k+1+2^{\mu} \cdot K_{\text {offset }} \) where \( k=\left\lceil N_{\text {slot }}^{\text {sub frame, } \mu}\right. \). \( \left.\left(N_{\mathrm{T}, 1}+N_{\mathrm{T}, 2}+N_{\mathrm{TA}, \max }+0.5\right) / T_{\mathrm{sf}}\right], N_{\mathrm{T}, 1} \) is a time duration in msec of \( N_{1} \) symbols corresponding to a PDSCH processing time for UE processing capability 1 when additional PDSCH DM-RS is configured, \( N_{\mathrm{T}, 2} \) is a time duration in msec of \( \mathrm{N}_{2} \) symbols corresponding to a PUSCH preparation time for UE processing capability 1 [6, TS 38.214], \( N_{\text {TA, max }} \) is the maximum timing advance value in msec that can be provided by a TA command field of 12 bits, \( N_{\text {slot }}^{\text {subframe, } \mu} \) is the number of slots per subframe, \( T_{\text {sf }} \) is the subframe duration of 1 msec , and \( K_{\text {offset }}=K_{\text {cell, offset }} \) \( K_{\text {UE } \text {, offset }} \), where \( K_{\text {cell, offset }} \) is provided by CellSpecific_Koffset and \( K_{\text {UE, offset }} \) is provided by a MAC CE command; otherwise, if not respectively provided, \( K_{\text {cell, offset }}=0 \) or \( K_{\text {UE, offset }}=0 . N_{1} \) and \( N_{2} \) are determined with respect to the minimum SCS among the SCSs of all configured UL BWPs for all uplink carriers in the TAG and of all configured DL BWPs for the corresponding downlink carriers. For \( \mu=0 \), the UE assumes \( N_{1,0}=14 \) [6, TS 38.214]. Slot \( n \) and \( N_{\text {slot }}^{\text {subframe }, \mu} \) are determined with respect to the minimum SCS among the SCSs of all configured UL BWPs for all uplink

ETSI


--- Page 15  ---


3GPP TS 38.213 version 17.1.0 Release 17
14
ETSI TS 138213 V17.1.0 (2022-05)

carriers in the TAG. \( N_{\text {TA, max }} \) is determined with respect to the minimum SCS among the SCSs of all configured UL BWPs for all uplink carriers in the TAG and for all configured initial UL BWPs provided by initialUplinkBWP. The uplink slot \( n \) is the last slot among uplink slot(s) overlapping with the slot(s) of PDSCH reception assuming \( T_{T A}=0 \), where the PDSCH provides the timing advance command and \( T_{T A} \) is defined in [4, TS 38.211].

If a UE changes an active UL BWP between a time of a timing advance command reception and a time of applying a corresponding adjustment for the uplink transmission timing, the UE determines the timing advance command value based on the SCS of the new active UL BWP. If the UE changes an active UL BWP after applying an adjustment for the uplink transmission timing, the UE assumes a same absolute timing advance command value before and after the active UL BWP change.

If the received downlink timing changes and is not compensated or is only partly compensated by the uplink timing adjustment without timing advance command as described in [10, TS 38.133], the UE changes \( N_{\text {TA }} \) accordingly.

If two adjacent slots overlap due to a TA command, the latter slot is reduced in duration relative to the former slot. The UE does not change \( N_{T A} \) during an actual transmission time window for a PUSCH or a PUCCH transmission [6, TS 38.214].
4.3 Timing for secondary cell activation / deactivation

With reference to slots for PUCCH transmissions, when a UE receives in a PDSCH an activation command [11, TS 38.321] for a secondary cell ending in slot \( n \), the UE applies the corresponding actions in [11, TS 38.321] no later than the minimum requirement defined in [ 10 , TS 38.133] and no earlier than slot \( n+k \), except for the following:
- the actions related to CSI reporting on a serving cell that is active in slot \( n+k \)
- the actions related to the sCellDeactivationTimer associated with the secondary cell [11, TS 38.321] that the UE applies in slot \( n+k \)
- the actions related to CSI reporting on a serving cell which is not active in slot \( n+k \) that the UE applies in the earliest slot after \( n+k \) in which the serving cell is active.

The value of \( k \) is \( m+3 N_{\text {slot }}^{\text {subfram } \mathrm{e}, \mu}+1 \) where slot \( n+m \) is a slot indicated for PUCCH transmission with HARQ-ACK information for the PDSCH reception as described in clause 9.2 .3 and \( N_{\text {slot }}^{\text {sublame, } \mu} \) is a number of slots per subframe for the SCS configuration \( \mu \) of the PUCCH transmission as defined in [4, TS 38.211].

With reference to slots for PUCCH transmissions, if a UE receives a deactivation command [11, TS 38.321] for a secondary cell ending in slot \( n \), the UE applies the corresponding actions in [11, TS 38.321] no later than the minimum requirement defined in [10, TS 38.133], except for the actions related to CSI reporting on an activated serving cell which the UE applies in slot \( n+k \).

If the sCellDeactivationTimer associated with the secondary cell expires in slot \( n \), the UE applies the corresponding actions in [11, TS 38.321] no later than the minimum requirement defined in [10, TS 38.133], except for the actions related to CSI reporting on an activated serving cell which the UE applies in the first slot that is after slot \( n+3 \cdot N_{\text {slon }}^{\text {subrame, } \mu} \) where \( \mu \) is the SCS configuration for PDSCH reception on the secondary cell.

5 Radio link monitoring
The downlink radio link quality of the primary cell is monitored by a UE for the purpose of indicating out-of-sync/insync status to higher layers. The UE is not required to monitor the downlink radio link quality in DL BWPs other than the active DL BWP, as described in clause 12, on the primary cell. If the active DL BWP is the initial DL BWP and for SS/PBCH block and CORESET multiplexing pattern 2 or 3, as described in clause 13, the UE is expected to perform RLM using the associated SS/PBCH block when the associated SS/PBCH block index is provided by RadioLinkMonitoringRS

If the UE is configured with a SCG, as described in [12, TS 38.331], and the parameter rff-TimersAndConstants is provided by higher layers and is not set to release, the downlink radio link quality of the PSCell of the SCG is

ETSI


--- Page 16  ---


3GPP TS 38.213 version 17.1.0 Release 17
15
ETSI TS 138213 V17.1.0 (2022-05)

monitored by the UE for the purpose of indicating out-of-sync/in-sync status to higher layers. The UE is not required to monitor the downlink radio link quality in DL BWPs other than the active DL BWP on the PSCell.

A UE can be configured for each DL BWP of a SpCell [11, TS 38.321] with a set of resource indexes, through a corresponding set of RadioLinkMonitoringRS, for radio link monitoring by failureDetectionResources. The UE is provided either a CSI-RS resource configuration index, by csi-RS-Index, or a SS/PBCH block index, by ssb-Index. The UE can be configured with up to \( N_{\text {LR-RLM }} \) RadioLinkMonitoringRS for link recovery procedures, as described in clause 6, and for radio link monitoring. From the \( N_{\mathrm{LR}-\mathrm{RLM}} \) RadioLinkMonitoringRS, up to \( N_{\mathrm{RLM}} \) RadioLinkMonitoringRS can be used for radio link monitoring depending on \( L_{\text {max }} \) as described in Table 5-1, wherein \( L_{\text {max }} \) is as defined in clause 4.1, and up to two RadioLinkMonitoringRS can be used for link recovery procedures.

For operation with shared spectrum channel access, when a UE is provided a SS/PBCH block index by ssb-Index, the UE is expected to perform radio link monitoring using SS/PBCH block(s) in the discovery burst transmission window as described in clause 4.1, where the SS/PBCH block(s) have candidate SS/PBCH block index(es) corresponding to SS/PBCH block index provided by ssb-Index.

If the UE is not provided RadioLinkMonitoringRS and the UE is provided for PDCCH receptions TCI states that include one or more of a CSI-RS
- the UE uses for radio link monitoring the RS provided for the active TCI state for PDCCH reception if the active TCI state for PDCCH reception includes only one RS
- if the active TCI state for PDCCH reception includes two RS, the UE expects that one RS is configured with qclType set to 'typeD' [6, TS 38.214] and the UE uses the RS configured with qcl-Type set to 'typeD' for radio link monitoring; the UE does not expect both RS to be configured with qcl-Type set to 'typeD'
- the UE is not required to use for radio link monitoring an aperiodic or semi-persistent RS
- For \( L_{\text {max }}=4 \), the UE selects the \( N_{\text {RLM }} \) RS provided for active TCI states for PDCCH receptions in CORESETs associated with the search space sets in an order from the shortest monitoring periodicity. If more than one CORESETs are associated with search space sets having same monitoring periodicity, the UE determines the order of the CORESET from the highest CORESET index as described in clause 10.1.

A UE does not expect to use more than \( N_{\text {RLM }} \) RadioLinkMonitoringRS for radio link monitoring when the UE is not provided RadioLinkMonitoringRS.

Values of \( N_{\text {LR-RLM }} \) and \( N_{\text {RLM }} \) for different values of \( L_{\text {max }} \) are given in Table 5-1.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 5-1: \( N_{\mathrm{LR}-\mathrm{RLM}} \) and \( N_{\mathrm{RLM}} \) as a function of maximum number \( L_{\max } \) of SS/PBCH blocks per half frame}
\begin{tabular}{|c|c|c|}
\hline\( L_{\text {max }} \) & \( N_{\text {LR-RLM }} \) & \( N_{\text {RLM }} \) \\
\hline 4 & 2 & 2 \\
\hline 8 & 6 & 4 \\
\hline 64 & 8 & 8 \\
\hline
\end{tabular}
\end{table}

For a CSI-RS resource configuration, powerControlOffsetSS is not applicable and a UE expects to be provided only 'noCDM' from cdm-Type, only 'one' and 'three' from density, and only '1 port' from nrofPorts [6, TS 38.214].

If a UE is configured with multiple DL BWPs for a serving cell, the UE performs RLM using the RS(s) corresponding to resource indexes provided by RadioLinkMonitoringRS for the active DL BWP or, if RadioLinkMonitoringRS is not provided for the active DL BWP, using the RS(s) provided for the active TCI state for PDCCH receptions in CORESETS on the active DL BWP.

In non-DRX mode operation, the physical layer in the UE assesses once per indication period the radio link quality, evaluated over the previous time period defined in [10, TS 38.133] against thresholds ( \( \mathrm{Q}_{\text {out }} \) and \( \mathrm{Q}_{1 n} \) ) configured by rimInSyncOutOfSyncThreshold. The UE determines the indication period as the maximum between the shortest periodicity for radio link monitoring resources and 10 msec .

In DRX mode operation, the physical layer in the UE assesses once per indication period the radio link quality, evaluated over the previous time period defined in [10, TS 38.133], against thresholds ( \( \mathrm{Q}_{\text {out }} \) and \( \mathrm{Q}_{\mathbf{m}} \) ) provided by

ETSI


--- Page 17  ---


3GPP TS 38.213 version 17.1.0 Release 17
16
ETSI TS 138213 V17.1.0 (2022-05)

rimInSyncOutOfSyncThreshold. The UE determines the indication period as the maximum between the shortest periodicity for radio link monitoring resources and the DRX period.

The physical layer in the UE indicates, in frames where the radio link quality is assessed, out-of-sync to higher layers when the radio link quality is worse than the threshold \( Q_{\text {out }} \) for all resources in the set of resources for radio link monitoring. When the radio link quality is better than the threshold \( Q_{m} \) for any resource in the set of resources for radio link monitoring, the physical layer in the UE indicates, in frames where the radio link quality is assessed, in-sync to higher layers.

6 Link recovery procedures
A UE can be provided, for each BWP of a serving cell, a set \( \bar{q}_{0} \) of periodic CSI-RS resource configuration indexes by failureDetectionResourcesToAddModList and a set \( \bar{q}_{1} \) of periodic CSI-RS resource configuration indexes and/or SS/PBCH block indexes by candidateBeamRSList or candidateBeamRSListExt or candidateBeamRSSCellList for radio link quality measurements on the BWP of the serving cell. Instead of the sets \( \bar{q}_{0} \) and \( \bar{q}_{1} \), for each BWP of a serving cell, the UE can be provided respective two sets \( \bar{q}_{0,0} \) and \( \bar{q}_{0,1} \) of periodic CSI-RS resource configuration indexes that can be activated by a MAC CE [11 TS 38.321] and corresponding two sets \( \bar{q}_{1,0} \) and \( \bar{q}_{1,1} \) of periodic CSI-RS resource configuration indexes and/or SS/PBCH block indexes by candidateBeamRSList l and candidateBeamRSList2, respectively, for radio link quality measurements on the BWP of the serving cell. The set \( \bar{q}_{0,0} \) is associated with the set \( \bar{q}_{1,0} \) and the set \( \bar{q}_{0,1} \) is associated with the set \( \bar{q}_{1,1} \).

If the UE is not provided \( \bar{q}_{0} \) by failureDetectionResourcesToAddModList for a BWP of the serving cell, the UE determines the set \( \bar{q}_{0} \) to include periodic CSI-RS resource configuration indexes with same values as the RS indexes in the RS sets indicated by TCI-State for respective CORESETs that the UE uses for monitoring PDCCH. If the UE is not provided \( \bar{q}_{0,0} \) or \( \bar{q}_{0,1} \) for a BWP of the serving cell, the UE determines the set \( \bar{q}_{0,0} \) or \( \bar{q}_{0,1} \) to include periodic CSI-RS resource configuration indexes with same values as the RS indexes in the RS sets indicated by TCI-State for first and second CORESETs that the UE uses for monitoring PDCCH, where the UE is provided two coresetPoollndex values 0 and 1 for the first and second CORESETs, or is not provided coresetPoollndex value for the first CORESETs and is provided coresetPoollndex value of 1 for the second CORESETs, respectively. If there are two RS indexes in a TCI state, the set \( \bar{q}_{0} \) or \( \bar{q}_{0,0} \), or \( \bar{q}_{0,1} \) includes RS indexes configured with qcl-Type set to 'typeD' for the corresponding TCI states. If a CORESET that the UE uses for monitoring PDCCH includes two TCI states and the UE is provided sfnSchemePdcch set to 'sfnSchemeA' or 'sfnSchemeB', the set \( \bar{q}_{0} \) includes RS indexes in the RS sets associated with the two TCI states. The UE expects the set \( \bar{q}_{0} \) to include up to two RS indexes. If the UE is provided \( \bar{q}_{0,0} \) or \( \bar{q}_{0,1} \), the UE expects the set \( \bar{q}_{0,0} \) or the set \( \bar{q}_{0,1} \) to include up to a number of \( N_{\mathrm{BFD}} \) RS indexes indicated by capabilityparametername. If the UE is not provided \( \bar{q}_{0,0} \) or \( \bar{q}_{0,1} \), and if a number of active TCI states for PDCCH receptions in the first or second CORESETs is larger than \( N_{\mathrm{BFD}} \), the UE determines the set \( \bar{q}_{0,0} \) or \( \bar{q}_{0,1} \) to include periodic CSI-RS resource configuration indexes with same values as the RS indexes in the RS sets associated with the active TCI states for PDCCH receptions in the first or second CORESETs corresponding to search space sets according to an ascending order for monitoring periodicity. If more than one first or second CORESETs correspond to search space sets with same monitoring periodicity, the UE determines the order of the first or second CORESETs according to a descending order of a CORESET index.

If a UE
- is not provided coresetPoollndex or is provided coresetPoollndex with a value of 0 for first CORESETs on an active DL BWP of a serving cell,
- is provided coresetPoollndex with a value of 1 for second CORESETs on the active DL BWP of the serving cells, and
- is provided SSB-MTCAdditionalPCI

SS/PBCH block indexes associated with a physical cell identity other than the one provided by physCellld in ServingCellConfigCommon can be provided in either \( \bar{q}_{1,0} \) or \( \bar{q}_{1,1} \) set and the corresponding \( \bar{q}_{0,0} \) or \( \bar{q}_{0,1} \) set is associated with the physical cell identity.

The UE expects single port RS in the set \( \bar{q}_{0} \), or \( \bar{q}_{0,0} \), or \( \bar{q}_{0,1} \). The UE expects single-port or two-port CSI-RS with frequency density equal to 1 or 3 REs per RB in the set \( \bar{q}_{1} \), or \( \bar{q}_{1,0} \), or \( \bar{q}_{1,1} \). The thresholds \( \mathrm{Q}_{\text {out }, \mathrm{LR}} \) and \( \mathrm{Q}_{\mathrm{m}, \mathrm{LR}} \) correspond to the default value of rimInSyncOutOfSyncThreshold, as described in [10, TS 38.133] for \( \mathrm{Q}_{\text {out }} \), and to the value provided by rsrp-ThresholdSSB or rsrp-ThresholdBFR, respectively.

ETSI


--- Page 18  ---


3GPP TS 38.213 version 17.1.0 Release 17
17
ETSI TS 138213 V17.1.0 (2022-05)

The physical layer in the UE assesses the radio link quality according to the set \( \bar{q}_{0}, \bar{q}_{0,0} \), or \( \bar{q}_{0,1} \), of resource configurations against the threshold \( \mathrm{Q}_{\text {out }, \mathrm{LR} \text {. }} \) For the set \( \bar{q}_{0} \), the UE assesses the radio link quality only according to SS/PBCH blocks on the PCell or the PSCell or periodic CSI-RS resource configurations that are quasi co-located, as described in [6, TS 38.214], with the DM-RS of PDCCH receptions monitored by the UE. The UE applies the \( \mathrm{Q}_{\mathrm{m}, \mathrm{LR}} \) threshold to the L1-RSRP measurement obtained from a SS/PBCH block. The UE applies the \( \mathrm{Q}_{\mathrm{m}, \mathrm{LR}} \) threshold to the L1RSRP measurement obtained for a CSI-RS resource after scaling a respective CSI-RS reception power with a value provided by powerControlOffsetSS.

In non-DRX mode operation, the physical layer in the UE provides an indication to higher layers when the radio link quality for all corresponding resource configurations in the set \( \bar{q}_{0} \), or in the set \( \bar{q}_{0,0} \) or \( \bar{q}_{0,1} \) that the UE uses to assess the radio link quality is worse than the threshold \( Q_{\text {out }, \text { LR }} \). The physical layer informs the higher layers when the radio link quality is worse than the threshold \( Q_{\text {out, } L R} \) with a periodicity determined by the maximum between the shortest periodicity among the SS/PBCH blocks on the PCell or the PSCell and/or the periodic CSI-RS configurations in the set \( \bar{q}_{0}, \bar{q}_{0,0} \), or \( \bar{q}_{0,1} \) that the UE uses to assess the radio link quality and 2 msec . In DRX mode operation, the physical layer provides an indication to higher layers when the radio link quality is worse than the threshold \( Q_{\text {out }, L R} \) with a periodicity determined as described in [10, TS 38.133].

For the PCell or the PSCell, upon request from higher layers, the UE provides to higher layers the periodic CSI-RS configuration indexes and/or SS/PBCH block indexes from the set \( \bar{q}_{1} \), or \( \bar{q}_{1,0} \), or \( \bar{q}_{1,1} \) and the corresponding L1-RSRP measurements that are larger than or equal to the \( \mathrm{Q}_{\mathrm{m}, \mathrm{LR}} \) threshold.

For the SCell, upon request from higher layers, the UE indicates to higher layers whether there is at least one periodic CSI-RS configuration index or SS/PBCH block index from the set \( \bar{q}_{1} \), or \( \bar{q}_{1,0} \), or \( \bar{q}_{1,1} \) with corresponding L1-RSRP measurements that is larger than or equal to the \( \mathrm{Q}_{\mathrm{m}, \mathrm{LR}} \) threshold, and provides the periodic CSI-RS configuration indexes and/or SS/PBCH block indexes from the set \( \bar{q}_{1} \), or \( \bar{q}_{1,0} \), or \( \bar{q}_{1,1} \) and the corresponding L1-RSRP measurements that are larger than or equal to the \( \mathrm{Q}_{\mathrm{m}, L \mathrm{R}} \) threshold, if any.

For the PCell or the PSCell, a UE can be provided a CORESET through a link to a search space set provided by recoverySearchSpaceld, as described in clause 10.1, for monitoring PDCCH in the CORESET. If the UE is provided recoverySearchSpaceld, the UE does not expect to be provided another search space set for monitoring PDCCH in the CORESET associated with the search space set provided by recoverySearchSpaceld.

For the PCell or the PSCell, the UE can be provided, by PRACH-ResourceDedicatedBFR, a configuration for PRACH transmission as described in clause 8.1. For PRACH transmission in slot \( n \) and according to antenna port quasi colocation parameters associated with periodic CSI-RS resource configuration or with SS/PBCH block associated with index \( q_{\text {new }} \) provided by higher layers [11, TS 38.321], the UE monitors PDCCH in a search space set provided by recoverySearchSpaceld for detection of a DCI format with CRC scrambled by C-RNTI or MCS-C-RNTI starting from slot \( n+4+2^{\mu} \cdot k_{\text {mac }} \), where \( \mu \) is the SCS configuration for the PRACH transmission and \( k_{\text {mac }} \) is a number of slots provided by \( K-M a c[12, T S 38.331] \) or \( k_{\mathrm{mac}}=0 \) if \( K-M a c \) is not provided, within a window configured by BeamFailureRecoveryConfig. For PDCCH monitoring in a search space set provided by recoverySearchSpaceld and for corresponding PDSCH reception, the UE assumes the same antenna port quasi-collocation parameters as the ones associated with index \( q_{\text {new }} \) until the UE receives by higher layers an activation for a TCI state or any of the parameters tci-StatesPDCCH-ToAddList and/or tci-StatesPDCCH-ToReleaseList. After the UE detects a DCI format with CRC scrambled by C-RNTI or MCS-C-RNTI in the search space set provided by recoverySearchSpaceld, the UE continues to monitor PDCCH candidates in the search space set provided by recoverySearchSpaceld until the UE receives a MAC CE activation command for a TCI state or tci-StatesPDCCH-ToAddList and/or tci-StatesPDCCH-ToReleaseList.

For the PCell or the PSCell, after 28 symbols from a last symbol of a first PDCCH reception in a search space set provided by recoverySearchSpaceld for which the UE detects a DCI format with CRC scrambled by C-RNTI or MCS-C-RNTI and until the UE receives an activation command for PUCCH-SpatialRelationInfo [11, TS 38.321] or is provided PUCCH-SpatialRelationInfo for PUCCH resource(s), the UE transmits a PUCCH on a same cell as the PRACH transmission using
- a same spatial filter as for the last PRACH transmission
- a power determined as described in clause 7.2.1 with \( q_{u}=0, q_{d}=q_{\text {new }} \), and \( l=0 \)

For the PCell or the PSCell and for sets \( \bar{q}_{0} \) and \( \bar{q}_{1} \), after 28 symbols from a last symbol of a first PDCCH reception in a search space set provided by recoverySearchSpaceld where a UE detects a DCI format with CRC scrambled by CRNTI or MCS-C-RNTI, the UE assumes same antenna port quasi-collocation parameters as the ones associated with index \( q_{\text {new }} \) for PDCCH monitoring in a CORESET with index 0 .

ETSI


--- Page 19  ---


3GPP TS 38.213 version 17.1.0 Release 17
18
ETSI TS 138213 V17.1.0 (2022-05)

If a UE is provided TCI-State_r17 indicating a unified TCI state for the PCell or the PSCell [6, TS 38.214], after X symbols from a last symbol of a first PDCCH reception in a search space set provided by recoverySearchSpaceld where the UE detects a DCI format with CRC scrambled by C-RNTI or MCS-C-RNTI, the UE
- if AdditionalPCIInfo is not provided, monitors PDCCH in all CORESETs, and receives PDSCH and aperiodic CSI-RS in a resource from a CSI-RS resource set with same indicated TCI state as for the PDCCH and PDSCH, using the same antenna port quasi co-location parameters as the ones associated with the corresponding index \( q_{\text {new }} \), if any
- transmits PUCCH, PUSCH and SRS that uses a same spatial domain filter with same indicated TCI state as for the PUCCH and the PUSCH, using a same spatial domain filter as for the last PRACH transmission

For the remaining of this clause, if a PDCCH reception includes two PDCCH candidates from two linked search space sets based on searchSpaceLinking, as described in clause 10.1, the last symbol of the PDCCH reception is the last symbol of the PDCCH candidate that ends later. The PDCCH reception includes the two PDCCH candidates also when the UE is not required to monitor one of the two PDCCH candidates as described in clauses 10, 11.1, and 11.1.1.

For the PCell or the PSCell, if BFR MAC CE [11, TS 38.321] is provided in Msg3 or MsgA of contention based random access procedure, and if a PUCCH resource is provided with PUCCH-SpatialRelationInfo, after 28 symbols from the last symbol of the PDCCH reception that determines the completion of the contention based random access procedure as described in clause 5.1.4a or in clause 5.1.5 of [11, TS38.321], the UE transmits the PUCCH on a same cell as the PRACH transmission using
- a same spatial filter as for the last PRACH transmission
- a power determined as described in clause 7.2.1 with \( q_{u}=0, q_{d}=q_{\text {new }} \), and \( l=0 \), where \( q_{\text {new }} \) is the SS/PBCH block index selected for the last PRACH transmission.

If a UE is provided TCI-State_r17 indicating a unified TCI state for the PCell or the PSCell and the UE provides BFR MAC CE in Msg3 or MsgA of contention based random access procedure, after X symbols from the last symbol of the PDCCH reception that determines the completion of the contention based random access procedure as described in [11, TS 38.321], the UE
- if AdditionalPCIInfo is not provided, monitors PDCCH in all CORESETs, and receives PDSCH and aperiodic CSI-RS resource in a CSI-RS resource set with same indicated TCI state as for the PDCCH and PDSCH using the same antenna port quasi co-location parameters as the ones associated with the corresponding index \( q_{\text {new }} \), if any
- transmits PUCCH, PUSCH and SRS that uses a same spatial domain filter with same indicated TCI state as for the PUCCH and PUSCH, using a same spatial domain filter as for the last PRACH transmission

A UE can be provided, by schedulingRequestID-BFR-SCell, a configuration for PUCCH transmission with a link recovery request (LRR) as described in clause 9.24 for the UE to transmit PUCCH [11, TS 38.321]. If the PCell or the PSCell is associated with sets \( \bar{q}_{0,0} \) and \( \bar{q}_{1,0} \), and with sets \( \bar{q}_{0,1} \) and \( \bar{q}_{1,1} \), the UE can be provided by schedulingRequestIDForMTRPBFR a first configuration for PUCCH transmission with a LRR and, if the UE provides twoLRRcapability, a second configuration for PUCCH transmission with a LRR. If the UE is provided only the first configuration, the UE transmits a PUCCH with LRR for either set \( \bar{q}_{0,0} \) or \( \bar{q}_{0,1} \). If the UE is provided both the first and second configurations, the UE uses the first configuration to transmt a PUCCH with LRR associated with set \( \bar{q}_{0,0} \) and the second configuration to transmit a PUCCH with LRR associated with set \( \bar{q}_{0,1}[11 \), TS 38.321].

The UE can provide in a first PUSCH MAC CE index(es) for at least corresponding SCell(s) with radio link quality worse than \( \mathrm{Q}_{\text {out }, \mathrm{LR}} \), indication(s) of presence of \( q_{\text {new }} \) for corresponding SCell(s), and index(es) \( q_{\text {new }} \) for a periodic CSIRS configuration or for a SS/PBCH block provided by higher layers, as described in [11, TS 38.321], if any, for corresponding SCell(s). After 28 symbols from a last symbol of a PDCCH reception with a DCI format scheduling a PUSCH transmission with a same HARQ process number as for the transmission of the first PUSCH and having a toggled NDI field value, the UE
- monitors PDCCH in all CORESETs on the SCell(s) indicated by the MAC CE using the same antenna port quasi co-location parameters as the ones associated with the corresponding index(es) \( q_{\text {new }} \), if any
- transmits PUCCH on a PUCCH-SCell using a same spatial domain filter as the one corresponding to \( q_{\text {new }} \), if any, for periodic CSI-RS or SS/PBCH block reception, as described in clause 9.2.2, and using a power determined as described in clause 7.2.1 with \( q_{\mathrm{u}}=0, q_{\mathrm{d}}=q_{\text {new }} \), and \( l=0 \), if

ETSI


--- Page 20  ---


3GPP TS 38.213 version 17.1.0 Release 17
19
ETSI TS 138213 V17.1.0 (2022-05)
- the UE is provided PUCCH-SpatialRelationInfo for the PUCCH,
- a PUCCH with the LRR was either not transmitted or was transmitted on the PCell or the PSCell, and
- the PUCCH-SCell is included in the SCell(s) indicated by the MAC-CE
where the SCS configuration for the 28 symbols is the smallest of the SCS configurations of the active DL BWP for the PDCCH reception and of the active DL BWP(s) of the at least one SCell.

If a UE is provided TCI-State_r 17 indicating a unified TCI state, after X symbols from a last symbol of a PDCCH reception with a DCI format scheduling a PUSCH transmission with a same HARQ process number as for the transmission of the first PUSCH and having a toggled NDI field value, the UE
- monitors PDCCH in all CORESETs, and receives PDSCH and aperiodic CSI-RS in a resource from a CSI-RS resource set using the same antenna port quasi co-location parameters as the ones associated with the corresponding index \( q_{\text {new }} \), if any
- transmits PUCCH, PUSCH and SRS that uses a same spatial domain filter with same indicated TCI state as for the PUCCH and PUSCH, using a same spatial domain filter as the one corresponding to \( q_{\text {new }} \), if any

For serving cells associated with sets \( \bar{q}_{0,0} \) and \( \bar{q}_{1,0} \), and with sets \( \bar{q}_{0,1} \) and \( \bar{q}_{1,1} \), the UE can provide in a second PUSCH MAC CE index(es) for cell(s) with \( \bar{q}_{0,0} \) and/or \( \bar{q}_{0,1} \) having radio link quality worse than \( \mathrm{Q}_{\text {out }, \mathrm{LR}} \), the index(es) of those \( \bar{q}_{0,0} \) and/or \( \bar{q}_{0,1} \), and indication(s) of presence of \( q_{\text {new }} \) and of index(es) \( q_{\text {new }} \), if any, from corresponding sets \( \bar{q}_{1,0} \) and/or \( \bar{q}_{1,1} \) for the serving cells.

For serving cells associated with sets \( \bar{q}_{0,0} \) and \( \bar{q}_{1,0} \), and with sets \( \bar{q}_{0,1} \) and \( \bar{q}_{1,1} \), and having radio link quality worse than Qout,LR, after 28 symbols from a last symbol of a first PDCCH reception with a DCI format scheduling a PUSCH transmission with a same HARQ process number as for transmission of the second PUSCH and having a toggled NDI field value, the UE assumes antenna port quasi-collocation parameters
- corresponding to \( q_{\text {new }} \) from \( \bar{q}_{1,0} \), if any, for the first CORESETs,
- corresponding to \( q_{\text {new }} \) from \( \bar{q}_{1,1} \), if any, for the second CORESETs
where the SCS configuration for the 28 symbols is the smallest of the SCS configurations of the active DL BWP for the PDCCH reception and of the active \( \mathrm{DL} \mathrm{BWP}(\mathrm{s}) \) of the serving cells.

7 Uplink Power control
Uplink power control determines a power for PUSCH, PUCCH, SRS, and PRACH transmissions.
A UE does not expect to simultaneously maintain more than four pathloss estimates per serving cell for all PUSCH/PUCCH/SRS transmissions as described in clauses 7.1.1, 7.2.1, and 7.3.1, except for SRS transmissions configured by SRS-PosResourceSet as described in clause 7.3.1. If the UE is provided a number of RS resources for pathloss estimation for PUSCH/PUCCH/SRS transmissions that is larger than 4, the UE maintains for pathloss estimation RS resources corresponding to RS resource indexes \( q_{d} \) as described in clauses 7.1.1, 7.2.1, and 7.3.1. If an RS resource updated by MAC CE, as described in clauses 7.1.1, 7.2.1 and 7.3.1, is one from the RS resources the UE maintains for pathloss estimation for PUSCH/PUCCH/SRS transmissions, the UE applies the pathloss estimation based on the RS resources starting from the first slot that is after slot \( k+3 \cdot N_{\text {slot }}^{\text {subframe }, \mu}+2^{\mu} \cdot k_{\text {mac }} \) where \( k \) is the slot where the UE would transmit a PUCCH or PUSCH with HARQ-ACK information for the PDSCH providing the MAC CE, \( \mu \) is the SCS configuration for the PUCCH or PUSCH, respectively, that is determined in the slot when the MAC CE command is applied and \( k_{\text {mac }} \) is a number of slots for SCS configuration \( \mu=0 \) provided by \( K \)-Mac or \( k_{\text {mac }}=0 \) if \( K \) Mac is not provided.

A PUSCH/PUCCH/SRS/PRACH transmission occasion \( i \) is defined by a slot index \( n_{s, f}^{\mu} \) within a frame with system frame number \( S F N \), a first symbol \( S \) within the slot, and a number of consecutive symbols \( L \). For a PUSCH transmission with repetition Type B, a PUSCH transmission occasion is a nominal repetition [6, TS 38.214].

In the remaining of this clause, if a UE is provided DLorJoint-TCIState or UL-TCIstate and for an indicated DLorJointTCIState or UL-TCIstate as described in [6, TS 38.214]

ETSI


--- Page 21  ---


3GPP TS 38.213 version 17.1.0 Release 17
20
ETSI TS 138213 V17.1.0 (2022-05)
- in clauses 7.1.1,7.2.1, and 7.3.1, the RS index \( q_{d} \) for obtaining the downlink pathloss estimate for PUSCH, PUCCH, and SRS transmission is provided by PL-RS associated with or included in the indicated DLorJointTCIState or UL-TCIstate except for SRS transmission that is not provided uselndicatedTCIState
- in clause 7.1.1, if \( p 0 \)-Alpha-CLID-PUSCH-Set is provided, the values of \( P_{0 \_ \text {UE PUSCH, } b, f, c}(j), \alpha_{b, f, c}(j) \), and the PUSCH power control adjustment state \( l \) are provided by \( p 0 \)-Alpha-CLID-PUSCH-Set associated with the indicated DLorJoint-TCIState or UL-TCIstate
- in clause 7.2.1, if \( p 0 \)-Alpha-CLID-PUCCHSet is provided, the values of \( P_{0 \_ \text {PUCCH }, b, f, c}\left(q_{u}\right) \) and the PUCCH power control adjustment state \( l \) are provided by p0-Alpha-CLID-PUCCH-Set associated with the indicated DLorJoint-TCIState or UL-TCIstate
- in clause 7.3.1, if p0-Alpha-CLID-SRS-Set is provided,
- if useIndicatedTCIState is provided for a SRS resource set, the values of \( P_{0 \_ \text {SRS }, b, f, c}\left(q_{s}\right), \alpha_{\text {SRS }, b, f, c}\left(q_{s}\right) \), and SRS power control adjustment state \( l \) are provided by p0-Alpha-CLID-SRS-Set associated with the indicated DLorJoint-TCIState or UL-TCIState
- else, if uselndicatedTCIState is not provided for a SRS resource set and for a first SRS resource from the SRS resource set, the values of \( P_{0 \_ \text {SRS }, b, f, c}\left(q_{s}\right), \alpha_{\text {SRS }, b, f, c}\left(q_{s}\right) \), and SRS power control adjustment state \( l \) are provided by p0-Alpha-CLID-SRS-Set associated with DLorJoint-TCIState or UL-TCIState of an SRS resource with lowest SRS-Resourceld in the SRS resource set and a RS index \( q_{d} \) for obtaining a pathloss estimate for the SRS transmission is provided by PL-RS associated with or included in the indicated DLorJoint-TCIState or UL-TCIState of an SRS resource with lowest SRS-Resourceld in the SRS resource set

In the remaining of this clause, if a PDCCH reception by a UE includes two PDCCH candidates from corresponding search space sets, as described in clause 10.1
- a PDCCH monitoring occasion is the union of the PDCCH monitoring occasions for the two PDCCH candidates
- the end of the PDCCH reception is the end of the PDCCH candidate that ends later

The PDCCH reception includes the two PDCCH candidates also when the UE is not required to monitor one of the two PDCCH candidates as described in clauses 10,11.1, and 11.1.1.
7.1 Physical uplink shared channel

For a PUSCH transmission on active UL BWP \( b \), as described in clause 12 , of carrier \( f \) of serving cell \( c \), a UE first calculates a linear value \( \hat{P}_{\text {PUSCH }, b, f, c}\left(i, j, q_{d}, l\right) \) of the transmit power \( P_{\text {PUSCH }, b, f, c}\left(i, j, q_{d}, l\right) \), with parameters as defined in clause 7.1.1. For a PUSCH transmission scheduled by a DCI format other than DCI format \( 0 \_0 \), or configured by ConfiguredGrantConfig or semiPersistentOnPUSCH, if txConfig in PUSCH-Config is set to 'codebook',
- if ul-FullPowerTransmission in PUSCH-Config is provided, the UE scales \( \hat{P}_{\mathrm{PUSCH}, b, f, c}\left(i, j, q_{d}, l\right) \) by \( s \) where:
- if ul-FullPowerTransmission in PUSCH-Config is set to fullpowerModel, and each SRS resource in the SRSResourceSet with usage set to 'codebook' has more than one SRS port, \( s \) is the ratio of a number of antenna ports with non-zero PUSCH transmission power over the maximum number of SRS ports supported by the UE in one SRS resource
- if ul-FullPowerTransmission in PUSCH-Config is set to fullpowerMode2,
- \( s=1 \) for full power TPMIs reported by the UE [16, TS 38.306], and \( s \) is the ratio of a number of antenna ports with non-zero PUSCH transmission power over a number of SRS ports for remaining TPMIs, where the number of SRS ports is associated with an SRS resource indicated by an SRI field in a DCI format scheduling the PUSCH transmission if more than one SRS resource is configured in the SRS-ResourceSet with usage set to 'codebook', or indicated by Type 1 configured grant, or the number of SRS ports is associated with the SRS resource if only one SRS resource is configured in the SRS-ResourceSet with usage set to 'codebook',
- \( s=1 \), if an SRS resource with a single port is indicated by an SRI field in a DCI format scheduling the PUSCH transmission when more than one SRS resource is provided in the SRS-ResourceSet with usage set to 'codebook', or indicated by Type 1 configured grant, or if only one SRS resource with a single port is provided in the SRS-ResourceSet with usage set to 'codebook', and

ETSI


--- Page 22  ---


3GPP TS 38.213 version 17.1.0 Release 17
21
ETSI TS 138213 V17.1.0 (2022-05)
- if ul-FullPowerTransmission in PUSCH-Config is set to fullpower, \( s=1 \)
- else, if each SRS resource in the SRS-ResourceSet with usage set to 'codebook' has more than one SRS port, the UE scales the linear value by the ratio of the number of antenna ports with a non-zero PUSCH transmission power to the maximum number of SRS ports supported by the UE in one SRS resource.

The UE splits the power equally across the antenna ports on which the UE transmits the PUSCH with non-zero power.
7.1.1 UE behaviour

If a UE transmits a PUSCH on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) using parameter set configuration with index \( j \) and PUSCH power control adjustment state with index \( l \), the UE determines the PUSCH transmission power \( P_{\text {PUSCH }, b, f, c}\left(i, j, q_{d}, l\right) \) in PUSCH transmission occasion \( i \) as
\[
\begin{array}{c}
P_{\mathrm{PUSCH}, b, f, c}\left(i, j, q_{d}, l\right)=\min \left\{\begin{array}{l}
P_{\mathrm{CMAX}_{1}, f, c}(i), \\
P_{\mathrm{O}_{-} \mathrm{PUSCH}_{1}, f, c}(j)+10 \log _{10}\left(2^{\mu} \cdot M_{\mathrm{RE}, b, f, c}^{\mathrm{PuSCH}}(i)\right)+\alpha_{b, f, c}(j) \cdot P L_{b_{1}, f, c}\left(q_{d}\right)+\Delta_{\mathrm{TF}, b, f, c}(i)+f_{b, f, c}(i, l)
\end{array}\right\} \\
\quad[\mathrm{dBm}]
\end{array}
\]
where,
- \( P_{\text {CMAX }} f_{, c}(i) \) is the UE configured maximum output power defined in [8-1, TS 38.101-1], [8-2, TS38.101-2] and [8-3, TS38.101-3] for carrier \( f \) of serving cell \( c \) in PUSCH transmission occasion \( i \).
- \( \quad P_{0 \_ \text {PUSCH }, b, f, c}(j) \) is a parameter composed of the sum of a component \( P_{0 \_ \text {NOMINAL }, \mathrm{PUSCH}, f, c}(j) \) and a component \( P_{0 \_ \text {UE_PUSCH }, b, f, c}(j) \) where \( j \in\{0,1, \ldots, J-1\} \).
- If a UE established dedicated RRC connection using a Type-1 random access procedure, as described in clause 8, and is not provided P0-PUSCH-AlphaSet or for a PUSCH (re)transmission corresponding to a RAR UL grant as described in clause 8.3,
\[
j=0, P_{0 \_ \text {UE_PUSCH }, b, f, c}(0)=0, \text { and } P_{0 \_ \text {NOMINAL,PUSCH }, f, c}(0)=P_{0 \_ \text {PRE }}+\Delta_{\text {PREAMBLE, Msg3 }},
\]
where \( P_{0 \_ \text {PRE }} \) is provided by preambleReceivedTargetPower [11, TS 38.321] and \( \triangle_{\text {PREAMBLE_Msg }} \) is provided by \( m s g 3 \)-DeltaPreamble, or \( \Delta_{\text {PREAMBLE,Msg3 }}=0 \mathrm{~dB} \) if \( m s g 3 \)-DeltaPreamble is not provided, for carrier \( f \) of serving cell \( c \)
- If a UE established dedicated RRC connection using a Type-2 random access procedure, as described in clause 8, and is not provided P0-PUSCH-AlphaSet, or for a PUSCH transmission for Type-2 random access procedure as described in clause 8.1A,
\[
j=0, P_{\mathrm{O}_{-} \mathrm{UE} \_\mathrm{PUSCH}, b, f_{1}, c}(0)=0, \text { and } P_{\mathrm{O}_{-} \mathrm{NOMINAL} \mathrm{PUSCH}, f_{1} c}(0)=P_{\mathrm{O}_{-} \mathrm{PRE}}+\Delta_{\mathrm{MsgA}_{-} P U S C H},
\]
where \( P_{0 \_ \text {PRE }} \) is provided by msgA-preambleReceivedTargetPower, or by preambleReceivedTargetPower if msgA-preambleReceivedTargetPower is not provided and \( \Delta_{\text {Msga_PUSCH }} \) is provided by msgA-DeltaPreamble, or \( \Delta_{\text {Msga_PUSCH }}=\Delta_{\text {PREAMBLE_Msg3 }} \mathrm{dB} \) if msgA-DeltaPreamble is not provided, for carrier \( f \) of serving cell \( c \)
- For a PUSCH (re)transmission configured by ConfiguredGrantConfig, \( j=1, P_{0 \_ \text {NOMINAL,PUSCH, } f, c}(1) \) is provided by \( p 0 \)-NominalWithoutGrant, or \( P_{0 \_ \text {NOMINAL }} \) PUSCH \( _{1} f_{1} c ~(1)=P_{0 \_ \text {NOMINAL PUSCH } f_{1} c}(0) \) if \( p 0 \) NominalWithoutGrant is not provided.
- If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' or 'nonCodebook', and is provided p0-PUSCH-Alpha2, for a retransmission of a configured grant Type 1 PUSCH, or for activation or retransmission of a configured grant Type 2 PUSCH, scheduled by a DCI format that includes a SRS resource set indicator field, and for active UL BWP \( b \) of carrier \( f \) of serving cell
- If the SRS resource set indicator value is 00 , first \( P_{0 \_ \text {UE } \_ \text {PUSCH }, b_{1}, c, c}(1) \) value is provided by the value of p0-PUSCH-Alpha in ConfiguredGrantConfig.
- If the SRS resource set indicator value is 01 , second \( P_{0 \_ \text {UE PUSCH }, b, f, c}(1) \) value is provided by the value of p0-PUSCH-Alpha 2 in ConfiguredGrantConfig.

ETSI


--- Page 23  ---


3GPP TS 38.213 version 17.1.0 Release 17
22
ETSI TS 138213 V17.1.0 (2022-05)
- If the SRS resource set indicator value is 10 or 11 , first and second \( P_{0 \_ \text {UE PUSCH }, b, f, c}(1) \) values are respectively provided by the values of p0-PUSCH-Alpha and by p0-PUSCH-Alpha 2 in ConfiguredGrantConfig.
- else, \( P_{\text {O_NOMINAL,PUSCH }} f_{, c}(1) \) is provided by \( p 0 \) obtained from \( p 0 \)-PUSCH-Alpha in ConfiguredGrantConfig that provides an index P0-PUSCH-AlphaSetld to a set of P0-PUSCH-AlphaSet, or by \( p 0- \) PUSCH for a PUSCH (re)transmission as described in clause 19.1, for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \)
- For \( j \in\{2, \ldots, J-1\}=S_{J} \), a \( P_{0 \_ \text {NOMINAL }, \text { PUSCH }, f_{, c}}(j) \) value, applicable for all \( j \in S_{J} \), is provided by \( p 0 \) provided, for each carrier \( f \) of serving cell \( c \) and a set of \( P_{0 \_ \text {UE } \_ \text {PUSCH }, b, f, c}(j) \) values are provided by a set of \( p 0 \) in P0-PUSCH-AlphaSet indicated by a respective set of p0-PUSCH-AlphaSetld for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \)
- If the UE is provided by SRI-PUSCH-PowerControl more than one values of p0-PUSCH-AlphaSetld and if a DCI format scheduling the PUSCH transmission includes an SRI field, the UE obtains a mapping from sri-PUSCH-PowerControlld in SRI-PUSCH-PowerControl between a set of values for the SRI field in the DCI format [5, TS 38.212] and a set of indexes provided by \( p 0 \)-PUSCH-AlphaSetld that map to a set of P0-PUSCH-AlphaSet values and determines the value of \( P_{0} \) ue_pusch, \( b, f, c \) ( \( j \) ) from the \( p 0-P U S C H \) AlphaSetld value that is mapped to the SRI field value. If the UE is provided by SRI-PUSCHPowerControl more than one values of p0-PUSCH-AlphaSetld
- if the DCI format scheduling the PUSCH transmission includes two SRI fields and the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' and if, the UE obtains a mapping from sri-PUSCH-PowerControlld in SRI-PUSCH-PowerControl between a set of values for the two SRI fields and a set of indexes provided by \( p 0 \)-PUSCH-AlphaSetId that map to a set of P0-PUSCH-AlphaSet values, and determines first and second values of \( P_{0 \_ \text {ue_pusch }, b, f, c}(j) \) from the \( p 0 \)-PUSCH-AlphaSetld values that are mapped to the values of the first and second SRI fields, respectively.
- if the DCI format scheduling the PUSCH transmission includes two SRI fields and the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'nonCodebook', the UE obtains a mapping from sri-PUSCH-PowerControlld in SRI-PUSCH-PowerControl between
- a set of values for the first SRI field value and a set of indexes provided by p0-PUSCH-AlphaSetld that map to a set of P0-PUSCH-AlphaSet values, and determines the first value of \( P_{0 \_ \text {UE_PUSCH }, b, f, c}(j) \) from the p0-PUSCH-AlphaSetld value that is mapped to the first SRI field value, and
- a set of values associated with the second SRI field value for a same number of layers as indicated by the first SRI field [5, TS 38.212], and a set of indexes provided by p0-PUSCH-AlphaSetld that map to a set of P0-PUSCH-AlphaSet values, and determines the second value of \( P_{0 \_ \text {ue_pusch } b, f, c}(j) \) from the p0-PUSCH-AlphaSetld value that is mapped to the second SRI field value corresponding to Tables 7.3.1.1.2-28/29/30/31 of [5, TS 38.212].
- If the DCI format also includes an open-loop power control parameter set indication field and a value of the open-loop power control parameter set indication field is ' 1 ' and if the DCI format scheduling the PUSCH transmission includes an SRI field, the UE determines a value of \( P_{0 \_ \text {UE PUSCH }, b, f, c}(j) \) from a first value in P0-PUSCH-Set with a p0-PUSCH-Setld value mapped to the SRI field value.
- If the UE is provided by SRI-PUSCH-PowerControl more than one values of p0-PUSCH-AlphaSetld
- if a DCI format scheduling the PUSCH transmission includes two SRI fields and an open-loop power control parameter set indication field and the UE is provided two SRS resource sets in srsResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook'
- if a value of the open-loop power control parameter set indication field is ' 0 ', the UE determines two values of \( P_{0_{-} \text {ue_pusch }, b, f, c}(j) \) from the p0-PUSCH-AlphaSetld values in SRI-PUSCHPowerControl that are mapped to the two SRI values corresponding to each SRS resource set with usage set to 'codebook'.

ETSI


--- Page 24  ---


3GPP TS 38.213 version 17.1.0 Release 17
23
ETSI TS 138213 V17.1.0 (2022-05)
- if a value of the open-loop power control parameter set indication field is ' 1 ', the UE determines two values of \( P_{0 \_ \text {UE pusch }, b, f, c}(j) \) from first values in P0-PUSCH-Set in P0-PUSCH-SetList and P0-PUSCH-Set in P0-PUSCH-SetList2 with p0-PUSCH-Setld values mapped to the two SRI values corresponding to each SRS resource set with usage set to 'codebook', respectively.
- if a DCI format scheduling the PUSCH transmission includes two SRI fields and an open-loop power control parameter set indication field and the UE is provided two SRS resource sets in srsResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'nonCodebook',
- if a value of the open-loop power control parameter set indication field is ' 0 ', the UE determines two values of \( P_{0_{-} u e \text { pusch }, b_{1}, f, c}(j) \) from the p0-PUSCH-AlphaSetld values in SRI-PUSCHPowerControl that are mapped to the first SRI field value corresponding to the first SRS resource set with usage set to 'nonCodebook' and to a second value, that is associated with the second SRI field value corresponding to Tables 7.3.1.1.2-28/29/30/31 of [5, TS 38.212] for a same number of layers as indicated by the first SRI field value, corresponding to the second SRS resource set with usage set to 'nonCodebook'.
- if a value of the open-loop power control parameter set indication field is ' 1 ', the UE determines two values of \( P_{0} \) ue pusch \( , b, f, c \) j from first values in P0-PUSCH-Set in P0-PUSCH-SetList and P0-PUSCH-Set in P0-PUSCH-SetList2 with p0-PUSCH-Setld values mapped to the first SRI field value corresponding to the first SRS resource set with usage set to 'nonCodebook, and a second value, that is associated with the second SRS field value corresponding to Tables 7.3.1.1.228/29/30/31 of [5, TS 38.212] for a same number of layers as indicated by the first SRI field value, corresponding to the second SRS resource set with usage set to 'nonCodebook', respectively.
- If the UE is not provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' or 'nonCodebook' and if the PUSCH transmission, except for the PUSCH retransmission corresponding to a RAR UL grant, is scheduled by a DCI format that does not include an SRI field, or if SRI-PUSCH-PowerControl is not provided to the UE, \( j=2 \),
- If P0-PUSCH-Set is provided to the UE and the DCI format includes an open-loop power control parameter set indication field, the UE determines a value of \( P_{0 \_ \text {UE PUSCH }, b, f, c}(j) \) from
- a first P0-PUSCH-AlphaSet in p0-AlphaSets if a value of the open-loop power control parameter set indication field is ' 0 ' or ' 00 '
- a first value in P0-PUSCH-Set with the lowest \( p 0-P U S C H-S e t I D \) value if a value of the open-loop power control parameter set indication field is ' 1 ' or ' 01 '
- a second value in P0-PUSCH-Set with the lowest \( p 0-P U S C H-S e t I D \) value if a value of the openloop power control parameter set indication field is ' 10 '
- else, the UE determines \( P_{0 \_ \text {UE_PusCH, } b+} f_{c}(j) \) from the value of the first P0-PUSCH-AlphaSet in \( p 0 \) AlphaSets
- If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' or 'nonCodebook' and the PUSCH transmission is scheduled by a DCI format that does not include an SRI field and includes an SRS resource set indicator field with value 10 or 11
- If P0-PUSCH-Set is provided to the UE and the DCI format includes an open-loop power control parameter set indication field, the UE determines first and second values of \( P_{0 \_ \text {UE_PUSCH, } b, f, c}(j) \) as
- first and second P0-PUSCH-AlphaSet in p0-AlphaSets if the open-loop power control parameter set indication value is ' 0 ' or ' 00 '
- first value in P0-PUSCH-Set with the lowest p0-PUSCH-SetID value in p0-PUSCH-SetList and first value in P0-PUSCH-Set with the lowest p0-PUSCH-SetID value in p0-PUSCH-SetList2, respectively, if the open-loop power control parameter set indication value is ' 1 ' or ' 01 '

ETSI


--- Page 25  ---


3GPP TS 38.213 version 17.1.0 Release 17
24
ETSI TS 138213 V17.1.0 (2022-05)
- second value in P0-PUSCH-Set with the lowest p0-PUSCH-SetID value in p0-PUSCH-SetList and second value in P0-PUSCH-Set with the lowest p0-PUSCH-SetID in p0-PUSCH-SetList2, respectively, if the open-loop power control parameter set indication value is ' 10 ' or ' 11 '
- else, the UE determines first and second values \( P_{0 \_ \text {UE } \_ \text {PUSCH }, b, f, c}(j) \) from the value of the first and second P0-PUSCH-AlphaSet in p0-AlphaSets, respectively
- For \( \alpha_{b, f, c}(j) \)
- For \( j=0 \),
- if \( P_{O_{-} N O M N A L \text { PUSCH, } f_{, c}}(0)=P_{O_{-} \text {PRE }}+\Delta_{\text {MsgA_PUSCH }} \) and msgA-Alpha is provided, \( \alpha_{b_{,} f_{, c}}(0) \) is the value of msgA-Alpha
- elseif \( P_{\text {O_NOMINAL_PUSCH, } f, c}(0)=P_{\text {O_PRE }}+\Delta_{\text {PREAMBLE_Msg } 3} \) or msgA-Alpha is not provided, and msg3Alpha is provided, \( \alpha_{b, f, c}(0) \) is the value of msg3-Alpha
- else, \( \alpha_{b, f, c}(0)=1 \)
- For \( j=1 \),
- If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' or 'nonCodebook', and is provided p0-PUSCH-Alpha2, for a retransmission of a configured grant Type 1 PUSCH, or for activation or retransmission of a configured grant Type 2 PUSCH, scheduled by a DCI format that includes an SRS resource set indicator field, and for active UL BWP \( b \) of carrier \( f \) of serving cell
- If the SRS resource set indicator value is 00 , first \( \alpha_{b, f, c}(1) \) value is provided by \( p 0-P U S C H- \) Alpha in ConfiguredGrantConfig.
- If the SRS resource set indicator value is 01 , first \( \alpha_{b, f, c}(1) \) value is provided by p0-PUSCH-Alpha 2 in ConfiguredGrantConfig.
- If the SRS resource set indicator value is 10 or 11 , first and second \( \alpha_{b, f, c}(1) \) values are respectively provided by p0-PUSCH-Alpha and p0-PUSCH-Alpha 2 in ConfiguredGrantConfig-
- else \( \alpha_{b, f, c}(1) \) is provided by alpha obtained from p0-PUSCH-Alpha in ConfiguredGrantConfig providing an index P0-PUSCH-AlphaSetld to a set of P0-PUSCH-AlphaSet, or by alpha for a PUSCH (re)transmission as described in clause 19.1, for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \)
- For \( j \in S_{J} \), a set of \( \alpha_{b_{, f, c}}(j) \) values are provided by a set of alpha in P0-PUSCH-AlphaSet indicated by a respective set of p0-PUSCH-AlphaSetld for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \)
- If the UE is provided SRI-PUSCH-PowerControl and more than one values of p0-PUSCH-AlphaSetld in p0-AlphaSets,
- if a DCI format scheduling the PUSCH transmission includes two SRI fields and the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook', the UE obtains a mapping from sri-PUSCH-PowerControlld in SRI-PUSCH-PowerControl between a set of values for
- the two SRI fields and a set of indexes provided by P0-PUSCH-AlphaSetld that map to P0-PUSCH-AlphaSet values, and determines first and second values of \( \alpha_{b, f, c}(j) \) from the P0-PUSCHAlphaSetID values that are mapped to the values of the first and second SRI field values, respectively.
- if a DCI format scheduling the PUSCH transmission includes two SRI fields and the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'nonCodebook', the UE obtains a mapping from sri-PUSCH-PowerControlld in SRI-PUSCH-PowerControl between a set of values for
- the first SRI field and a set of indexes provided by P0-PUSCH-AlphaSetld that map to P0-PUSCH-AlphaSet values, and determines first value of \( \alpha_{b_{1}, c}(j) \) from the P0-PUSCH-AlphaSetID value that is mapped to the first SRI field value, and

ETSI


--- Page 26  ---


3GPP TS 38.213 version 17.1.0 Release 17
25
ETSI TS 138213 V17.1.0 (2022-05)
- the second value, associated with the second SRI field value corresponding to Tables 7.3.1.1.228/29/30/31 of [5, TS 38.212] for a same number of layers as indicated by the first SRI field value, and a set of indexes provided by p0-PUSCH-AlphaSetld that map to set of P0-PUSCH-AlphaSet values, and determines the second value of \( \alpha_{b_{1}, c}(j) \) from the \( p 0 \)-PUSCH-AlphaSetld value that is mapped to the second SRI field value
- if a DCI format scheduling the PUSCH transmission includes one SRI field, the UE obtains a mapping from sri-PUSCH-PowerControlld in SRI-PUSCH-PowerControl between a set of values for the SRI field in the DCI format [5, TS 38.212] and a set of indexes provided by p0-PUSCH-AlphaSetld that map to a set of P0-PUSCH-AlphaSet values and determines the values of \( \alpha_{b, f, c}(j) \) from the \( p 0 \) -PUSCH-AlphaSetld value that is mapped to the SRI field value
- If the UE is not provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' or 'nonCodebook' and if the PUSCH transmission except for the PUSCH retransmission corresponding to a RAR UL grant is scheduled by a DCI format that does not include an SRI field, or if SRI-PUSCH-PowerControl is not provided to the UE, \( j=2 \), and the UE determines \( \alpha_{b_{1}, c}(j) \) from the value of the first P0-PUSCH-AlphaSet in p0-AlphaSets
- If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' or 'nonCodebook' and the PUSCH transmission is scheduled by a DCI format that does not include an SRI field and includes an SRS resource set indicator field with value 10 or 11 , the UE determines \( \alpha_{b, f, c}(j) \) from first and second \( P 0 \) -PUSCH-AlphaSet in p0-AlphaSets
- \( M_{\mathrm{RB}, b_{1}, c_{c}}^{\mathrm{PUSC}}(i) \) is the bandwidth of the PUSCH resource assignment expressed in number of resource blocks for PUSCH transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) and \( \mu \) is a SCS configuration defined in [4, TS 38.211]
- \( P L_{b, f, c}\left(q_{d}\right) \) is a downlink pathloss estimate in dB calculated by the UE using reference signal (RS) index \( q_{d} \) for the active DL BWP, as described in clause 12 , of carrier \( f \) of serving cell \( c \)
- If the UE is not provided PUSCH-PathlossReferenceRS and enableDefaultBeamPL-ForSRS, or before the UE is provided dedicated higher layer parameters, the UE calculates \( P L_{b, f, c}\left(q_{d}\right) \) using a RS resource from an SS/PBCH block with same SS/PBCH block index as the one the UE uses to obtain MIB
- If the UE is configured with a number of RS resource indexes, up to the value of maxNrofPUSCHPathlossReferenceRSs, and a respective set of RS configurations for the number of RS resource indexes by PUSCH-PathlossReferenceRS, the set of RS resource indexes can include one or both of a set of SS/PBCH block indexes, each provided by ssb-Index when a value of a corresponding pusch-PathlossReferenceRS-Id maps to a SS/PBCH block index, and a set of CSI-RS resource indexes, each provided by csi-RS-Index when a value of a corresponding pusch-PathlossReferenceRS-Id maps to a CSI-RS resource index. The UE identifies a RS resource index \( q_{d} \) in the set of RS resource indexes to correspond either to a SS/PBCH block index or to a CSI-RS resource index as provided by pusch-PathlossReferenceRS-Id in PUSCHPathlossReferenceRS
- If the PUSCH transmission is scheduled by a RAR UL grant as described in clause 8.3, or for a PUSCH transmission for Type-2 random access procedure as described in clause 8.1A, the UE uses the same RS resource index \( q_{d} \) as for a corresponding PRACH transmission
- If the UE is provided SRI-PUSCH-PowerControl and more than one values of PUSCH-PathlossReferenceRS-Id, the UE obtains a mapping from sri-PUSCH-PowerControlld in SRI-PUSCHPowerControl between a set of values for the SRI field, or for first and second SRI fields if the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook', or values for a first SRI field and values associated with a second SRI field value corresponding to Tables 7.3.1.1.2-28/29/30/31 of [5, TS 38.212] for a same number of layers as indicated by the first SRI field value if the UE is provided two SRS resource sets in srsResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'nonCodebook', in a DCI format scheduling the PUSCH transmission and a set of PUSCH-PathlossReferenceRS-Id values and determines the RS resource index \( q_{d} \), or respective first and second RS resource indexes \( q_{d} \), from the value of PUSCH-PathlossReferenceRS-Id that is mapped to the SRI field value, or from the values of PUSCH-PathlossReferenceRS-Id that are mapped to respective first and second SRI field values if the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook', or from the values of PUSCH-PathlossReferenceRS-Id that are mapped to respective

ETSI


--- Page 27  ---


3GPP TS 38.213 version 17.1.0 Release 17
26
ETSI TS 138213 V17.1.0 (2022-05)

first SRI field value and a value associated with the second SRI field value corresponding to Tables 7.3.1.1.228/29/30/31 of [5, TS 38.212] for a same number of layers as indicated by the first SRI field value if the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'nonCodebook',
where the RS resource is either on serving cell \( c \) or, if provided, on a serving cell indicated by a value of pathlossReferenceLinking
- If the PUSCH transmission is scheduled by DCI format \( 0 \_0 \), and
- if two spatial settings from PUCCH-SpatialRelationInfo are activated for a PUCCH resource with a lowest index, the UE uses the same RS resource index \( q_{d} \) as for a PUCCH transmission with a spatial setting from the two spatial settings with lowest index in the PUCCH resource with the lowest index
- else, if the UE is provided a spatial setting by PUCCH-SpatialRelationInfo for a PUCCH resource with a lowest index for active UL BWP \( b \) of each carrier \( f \) and serving cell \( c \), as described in clause 9.2.2, the UE uses the same RS resource index \( q_{d} \) as for a PUCCH transmission in the PUCCH resource with the lowest index
- If the PUSCH transmission is not scheduled by DCI format \( 0 \_0 \), and if the UE is provided enableDefaultBeamPL-ForSRS and is not provided PUSCH-PathlossReferenceRS and PUSCH-PathlossReferenceRS-r16, the UE uses the same RS resource index \( q_{d} \) as for an SRS resource set with an SRS resource associated with the PUSCH transmission
- If
- the PUSCH transmission is scheduled by DCI format \( 0 \_0 \) and the UE is not provided a spatial setting for a PUCCH transmission, or
- the PUSCH transmission is scheduled by DCI format \( 0 \_1 \) or DCI format \( 0 \_2 \) that does not include an SRI field, or
- SRI-PUSCH-PowerControl is not provided to the UE,
the UE determines a RS resource index \( q_{d} \) with a respective PUSCH-PathlossReferenceRS-Id value being equal to zero where the RS resource is either on serving cell \( c \) or, if provided, on a serving cell indicated by a value of pathlossReferenceLinking
- If
- the PUSCH transmission is scheduled by DCI format \( 0 \_0 \) on serving cell \( c \),
- the UE is not provided PUCCH resources for the active UL BWP of serving cell \( c \), and
- the UE is provided enableDefaultBeamPL-ForPUSCH0-0
the UE determines a RS resource index \( q_{d} \) providing a periodic RS resource configured with qcl-Type set to 'typeD' in the TCI state or the QCL assumption of a CORESET with the lowest index in the active DL BWP of the serving cell \( c \). If the CORESET has two activated TCI states, as described in clause 10.1, the UE determines the RS resource index \( q_{d} \) based on the first TCI state.
- If
- the PUSCH transmission is scheduled by DCI format \( 0 \_0 \) on serving cell \( c \),
- the UE is not provided a spatial setting for PUCCH resources on the active UL BWP of the primary cell [11, TS 38.321], and
- the UE is provided enableDefaultBeamPL-ForPUSCH0-0
the UE determines a RS resource index \( q_{d} \) providing a periodic RS resource configured with qcl-Type set to 'typeD' in the TCI state or the QCL assumption of a CORESET with the lowest index in the active DL BWP of the serving cell \( c \). If the CORESET has two activated TCI states, as described in clause 10.1, the UE determines the RS resource index \( q_{d} \) based on the first TCI state.

ETSI


--- Page 28  ---


3GPP TS 38.213 version 17.1.0 Release 17
27
ETSI TS 138213 V17.1.0 (2022-05)
- For a PUSCH transmission configured by ConfiguredGrantConfig, if rrc-ConfiguredUplinkGrant is included in ConfiguredGrantConfig, a RS resource index \( q_{d} \) is provided by a value of pathlossReferenceIndex included in rrc-ConfiguredUplinkGrant where the RS resource is either on serving cell \( c \) or, if provided, on a serving cell indicated by a value of pathlossReferenceLinking. If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' or 'nonCodebook' and for configured grant Type 1 PUSCH, first and second RS resource indexes \( q_{d} \) are provided by respective values of pathlossReferenceIndex and pathlossReferenceIndex 2 in rrcConfiguredUplinkGrant.
- For a PUSCH transmission configured by ConfiguredGrantConfig that does not include rrcConfiguredUplinkGrant, the UE determines a RS resource index \( q_{d} \) from a value of PUSCH-PathlossReferenceRS-Id that is mapped to a SRI field value in a DCI format activating the PUSCH transmission.
- If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' and the DCI format activating the PUSCH transmission includes two SRI fields, the UE determines first and second RS resource indexes \( q_{d} \) from respective first and second values of PUSCH-PathlossReferenceRS-Id that are mapped to the first and second SRI values corresponding to each SRS resource set with usage set to 'codebook', respectively.
- If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'nonCodebook' and the DCI format activating the PUSCH transmission includes two SRI fields, the UE determines first and second RS resource indexes \( q_{d} \) from respective first and second values of PUSCH-PathlossReferenceRS-Id that are mapped to the first SRI value corresponding to the first SRS resource set with usage set to 'nonCodebook', and the value, associated with the second SRI field value corresponding to Tables 7.3.1.1.2-28/29/30/31 of [5, TS 38.212] for a same number of layers as indicated by the first SRI field value, corresponding to the second SRS resource set with usage set to 'nonCodebook'.
- If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' or 'nonCodebook' and the DCI format activating the PUSCH transmission does not include an SRI field, the UE determines first and second RS resource indexes \( q_{d} \) with respective first and second PUSCH-PathlossReferenceRS-Id value being equal to zero and one.
- If the DCI format activating the PUSCH transmission does not include an SRI field, the UE determines a RS resource index \( q_{d} \) with a respective \( P U S C H \) - \( P \) athloss ReferenceRS-Id value being equal to zero
where the RS resource is either on serving cell \( c \) or, if provided, on a serving cell indicated by a value of pathlossReferenceLinking
- If the UE is provided enablePL-RS-UpdateForPUSCH-SRS, a mapping between sri-PUSCH-PowerControlld and PUSCH-PathlossReferenceRS-Id values can be updated by a MAC CE as described in [11, TS 38.321]
- For a PUSCH transmission scheduled by a DCI format that does not include an SRI field, or for a PUSCH transmission configured by ConfiguredGrantConfig and activated, as described in clause 10.2, by a DCI format that does not include an SRI field, the UE determines a RS resource index \( q_{d} \) from the PUSCH-PathlossReferenceRS-Id mapped to sri-PUSCH-PowerControlld \( =0 \). If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' or 'nonCodebook', the UE determines first and second RS resource indexes \( q_{d} \) from respective PUSCH-PathlossReferenceRS-Id mapped to sri-PUSCH-PowerControlld \( =0 \) of sri-PUSCHMappingToAddModList and sri-PUSCH-PowerControlld \( =0 \) of sri-PUSCH-MappingToAddModList2, respectively.
- If the UE is not provided enablePL-RS-UpdateForPUSCH-SRS
- For a PUSCH transmission scheduled by a DCI format that does not include an SRI field, if the UE is provided two SRS resources in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' or 'nonCodebook', the UE determines first and second RS resource indexes \( q_{d} \) with respective first and second PUSCH-PathlossReferenceRS-Id values being equal to 0 and 1 .
\( P L_{b, f, c}\left(q_{d}\right)= \) referenceSignalPower - higher layer filtered RSRP, where referenceSignalPower is provided by higher layers and RSRP is defined in [7, TS 38.215] for the reference serving cell and the higher layer filter configuration provided by QuantityConfig is defined in [12, TS 38.331] for the reference serving cell

ETSI


--- Page 29  ---


3GPP TS 38.213 version 17.1.0 Release 17
28
ETSI TS 138213 V17.1.0 (2022-05)

If the UE is not configured periodic CSI-RS reception, referenceSignalPower is provided by \( s s-P B C H \) BlockPower. If the UE is configured periodic CSI-RS reception, referenceSignalPower is provided either by ss-PBCH-BlockPower or by powerControlOffsetSS providing an offset of the CSI-RS transmission power relative to the SS/PBCH block transmission power [6, TS 38.214]. [f powerControlOffsetSS is not provided to the UE, the UE assumes an offset of 0 dB .
- \( \Delta_{\mathrm{TF}, b, f, c}(i)=10 \log _{10}\left(\left(2^{\mathrm{BPRE} \cdot K_{S}}-1\right) \cdot \beta_{\text {offset }}^{\mathrm{PUSCH}}\right) \) for \( K_{s}=1.25 \) and \( \Delta_{\mathrm{TF}, b, f, c}(i)=0 \) for \( K_{s}=0 \) where \( K_{s} \) is provided by deltaMCS for each UL BWP \( b \) of each carrier \( f \) and serving cell \( c \). If the PUSCH transmission is over more than one layer \( [6, \mathrm{TS} 38.214], \Delta_{\mathrm{TF}, b, f, c}(i)=0 \). BPRE and \( \beta_{\mathrm{offset}}^{\mathrm{PUSCH}} \), for active UL BWP \( b \) of each carrier \( f \) and each serving cell \( c \), are computed as below
- BPRE \( =\sum_{r=0}^{C-1} K_{r} / N_{R E} \) for PUSCH with UL-SCH data and BPRE \( =Q_{m} \cdot R / \beta_{\text {offset }}^{\text {PUSCH }} \) for CSI transmission in a PUSCH without UL-SCH data, where
- \( C \) is a number of transmitted code blocks, \( K_{r} \) is a size for code block \( r \), and \( N_{\mathrm{RE}} \) is a number of resource elements determined as \( N_{\mathrm{RE}}=N \cdot M_{\mathrm{RB}, b, f, c}^{\mathrm{PUSCH}}(i) \cdot \sum_{j=0}^{N_{\mathrm{Symb}, b, f, c}^{\mathrm{PUSCH}}(i)-1} N_{\mathrm{Sc}, \text { data }}^{\mathrm{RB}}(i, j) \), where \( N \geq 1 \) is provided by numberOfSlotsTBoMS as described in [6, TS 38.214] and \( N=1 \) if numberOfSlotsTBoMS is not provided, \( N_{\text {symb, } b, f, c}^{\text {PUSCH }}(i) \) is a number of symbols for PUSCH transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of serving cell \( c, N_{\mathrm{sc}, \text { data }}^{\mathrm{RB}}(i, j) \) is a number of subcarriers excluding DM-RS subcarriers and phasetracking RS samples [4, TS 38.211] in PUSCH symbol \( j \) and assuming no segmentation for a nominal repetition in case the PUSCH transmission is with repetition Type \( \mathrm{B}, 0 \leq j<N_{\mathrm{symb}, b, f, c}^{\mathrm{PUSCH}}(i) \), and \( c, K_{r} \) are defined in [5, TS 38.212]
- \( \quad \beta_{\mathrm{offset}}^{\mathrm{PUSCH}}=1 \) when the PUSCH includes UL-SCH data and \( \beta_{\mathrm{offset}}^{\mathrm{PUSCH}}=\beta_{\mathrm{offset}}^{\mathrm{CSI}_{1}} \), as described in clause 9.3, when the PUSCH includes CSI and does not include UL-SCH data
- \( Q_{m} \) is the modulation order and \( R \) is the target code rate, as described in [6, TS 38.214], provided by the DCI format scheduling the PUSCH transmission that includes CSI and does not include UL-SCH data
- For the PUSCH power control adjustment state \( f_{b, f, c}(i, l) \) for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) in PUSCH transmission occasion \( i \)
- \( \quad \delta_{\mathrm{PUSCH}, b_{1} f_{1} c}(i, l) \) is a TPC command value included in a DCI format that schedules the PUSCH transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) or jointly coded with other TPC commands in a DCI format 2_2 with CRC scrambled by TPC-PUSCH-RNTI, as described in clause 11.3
- \( l \in\{0,1\} \) if the UE is configured with twoPUSCH-PC-AdjustmentStates and \( l=0 \) if the UE is not configured with twoPUSCH-PC-AdjustmentStates or if the PUSCH transmission is scheduled by a RAR UL grant as described in clause 8.3
- If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' or 'nonCodebook', and is provided p0-PUSCH-Alpha2, for a retransmission of a configured grant Type 1 PUSCH, or for activation or retransmission of a configured grant Type 2 PUSCH, scheduled by a DCI format that includes a SRS resource set indicator field, and for active UL BWP \( b \) of carrier \( f \) of serving cell
- If the SRS resource set indicator value is \( 00, l \) is equal to the value of power ControlloopTo Use in ConfiguredGrantConfig.
- If the SRS resource set indicator value is \( 01, l \) is equal to the value of power ControlloopTo Use 2 in ConfiguredGrantConfig-
- If the SRS resource set indicator value is 10 or 11 , a first \( l \) and a second \( l \) are respectively equal to powerControlloopTo Use and powerControlLoopTo Use 2 in ConfiguredGrantConfig-
- else, for a PUSCH (re)transmission configured by ConfiguredGrantConfig, the value of \( l \in\{0,1\} \) is provided to the UE by powerControlLoopTo Use in ConfiguredGrantConfig.
- If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook', is provided SRI-PUSCHPowerControl, and a DCI format scheduling the PUSCH transmission includes two SRI fields, the UE obtains a mapping from sri-PUSCH-PowerControlld in SRI-PUSCH-PowerControl between a set of

ETSI


--- Page 30  ---


3GPP TS 38.213 version 17.1.0 Release 17
29
ETSI TS 138213 V17.1.0 (2022-05)

values for the first and second SRI fields and the \( l \) values provided by sri-PUSCH-ClosedLoopIndex, and determines the \( l \) values mapped to the values of the first and second SRI fields corresponding to each SRS resource set with usage set to 'codebook', respectively
- If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'nonCodebook', is provided SRI-PUSCHPowerControl, and a DCI format scheduling the PUSCH transmission includes two SRI fields, the UE obtains a mapping from sri-PUSCH-PowerControlld in SRI-PUSCH-PowerControl between a set of values for
- the first SRI field value and the \( l \) values provided by sri-PUSCH-ClosedLoopIndex, and determines the \( l \) value that is mapped to the first SRI field value corresponding to the first SRS resource set with usage set to 'nonCodebook', and
- the value, associated with the second SRI field value corresponding to Tables 7.3_1.1_2-28/29/30/31 of [5, TS 38.212] for a same number of layers as indicated by the first SRI field value, and the \( l \) value(s) provided by sri-PUSCH-ClosedLoopIndex, and determines the \( l \) value that is mapped to the value corresponding to the second SRS resource set with usage set to 'nonCodebook'- If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' or 'nonCodebook', is provided SRI-PUSCH-PowerControl, and a DCI format scheduling the PUSCH transmission does not include an SRI field
- If the UE is provided twoPUSCH-PC-AdjustmentStates
- the UE determines \( l=0 \) for the PUSCH transmission corresponding to the first SRS resource set with usage set to 'codebook' or 'nonCodebook', and \( l=1 \) for the PUSCH transmission corresponding to the second SRS resource set with usage set to 'codebook' or 'nonCodebook'
- else
- the UE determines \( l=0 \) for the PUSCH transmission
- If the UE is provided two SRS resource sets in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with usage set to 'codebook' or 'nonCodebook', and is provided twoPUSCH-PC-AdjustmentStates
- If the DCI format includes two TPC command values and the PUSCH transmissions are associated with \( l=0 \) and \( l=1 \), the UE applies the first TPC command value for \( l=0 \) and applies the second TPC command value for \( l=1 \)
- If the DCI format includes two TPC command values and the PUSCH transmissions are associated with \( l=0 \), the UE applies the first TPC command value for \( l=0 \) and ignores the second TPC command value
- If the DCI format includes two TPC command values and the PUSCH transmissions are associated with \( l=1 \), the UE applies the second TPC command value for \( l=1 \) and ignores the first TPC command value
- If the DCI format includes one TPC command value, the UE applies the TPC command value for all \( l \) associated with the PUSCH transmission
- If the UE is provided SRI-PUSCH-PowerControl, the UE obtains a mapping between a set of values for the SRI field in a DCI format scheduling the PUSCH transmission and the \( l \) value(s) provided by sri-PUSCH-ClosedLoopIndex and determines the \( l \) value that is mapped to the SRI field value
- If the PUSCH transmission is scheduled by a DCI format that does not include an SRI field, or if an SRI-PUSCH-PowerControl is not provided to the UE, \( l=0 \)
- If the UE obtains one TPC command from a DCI format 2 _ 2 with CRC scrambled by a TPC-PUSCHRNTI, the \( l \) value is provided by the closed loop indicator field in DCI format 2 _2

ETSI


--- Page 31  ---


3GPP TS 38.213 version 17.1.0 Release 17
30
ETSI TS 138213 V17.1.0 (2022-05)
- \( f_{b, f, c}(i, l)=f_{b, f, c}\left(i-i_{0}, l\right)+\sum_{m=0}^{C\left(D_{i}\right)-1} \delta_{\text {PUSCH }, b, f, c}(m, l) \) is the PUSCH power control adjustment state \( l \) for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) and PUSCH transmission occasion \( i \) if the UE is not provided tpc-Accumulation, where
- The \( \delta_{\text {PUSCH }, b, f, c} \) values are given in Table 7.1.1-1
- \( \sum_{m=0}^{\ell\left(D_{i}\right)-1} \delta_{\text {PUSCH, } b_{1}, f_{1} c}(m, l) \) is a sum of TPC command values in a set \( D_{i} \) of TPC command values with cardinality \( C\left(D_{i}\right) \) that the UE receives between \( K_{\text {PUSCH }}\left(i-i_{0}\right)-1 \) symbols before PUSCH transmission occasion \( i-i_{0} \) and \( K_{\text {PUSCH }}(i) \) symbols before PUSCH transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) for PUSCH power control adjustment state \( l \), where \( i_{0}>0 \) is the smallest integer for which \( K_{\text {PUSCH }}\left(i-i_{0}\right) \) symbols before PUSCH transmission occasion \( i-i_{0} \) is earlier than \( K_{\text {PUSCH }}(i) \) symbols before PUSCH transmission occasion \( i \)
- If a PUSCH transmission is scheduled by a DCI format, \( K_{\text {PUSCH }}(i) \) is a number of symbols for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) after a last symbol of a corresponding PDCCH reception and before a first symbol of the PUSCH transmission
- If a PUSCH transmission is configured by ConfiguredGrantConfig, \( K_{\mathrm{PUSCH}}(i) \) is a number of \( K_{\mathrm{PUSCH}, \mathrm{min}} \) symbols equal to the product of a number of symbols per slot, \( N_{\text {symb }}^{\text {slot }} \), and the minimum of the values provided by \( k 2 \) in PUSCH-ConfigCommon for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \)
- If the UE has reached maximum power for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) at PUSCH transmission occasion \( i-i_{0} \) and \( \sum_{m=0}^{\ell\left(D_{i}\right)-1} \delta_{\text {PUSCH }, b_{1}, f, c}(m, l) \geq 0 \), then \( f_{b_{1}, f, c}(i, l)=f_{b_{1}, f, c}\left(i-i_{0}, l\right) \)
- If UE has reached minimum power for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) at PUSCH transmission occasion \( i-i_{0} \) and \( \sum_{m=0}^{C\left(D_{i}\right)-1} \delta_{\text {PUSCH }, b_{1}, f_{1} c}(m, l) \leq 0 \), then \( f_{b_{1}, f_{1} c}(i, l)=f_{b_{1}, c, c}\left(i-i_{0}, l\right) \)
- A UE resets accumulation of a PUSCH power control adjustment state \( l \) for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) to \( f_{b_{1} f_{1} c}(k, l)=0, k=0,1, \ldots, i \)
- If a configuration for a corresponding \( P_{0_{-} \text {UE_PusCH, } b, f_{1} c}(j) \) value is provided by higher layers
- If a configuration for a corresponding \( \alpha_{b_{1}, c}(j) \) value is provided by higher layers where \( l \) is determined from the value of \( j \) as
- If \( j>1 \) and the UE is provided higher SRI-PUSCH-PowerControl, \( l \) is the sri-PUSCHClosedLoopIndex value(s) configured in any SRI-PUSCH-PowerControl with the sri-P0-PUSCHAlphaSetld value corresponding to \( j \)
- If \( j>1 \) and the UE is not provided SRI-PUSCH-PowerControl or \( j=0, l=1 \) if \( P_{0 \_ \text {UE_PusCH }, b, f, c}(j) \) and \( \alpha_{b, f, c}(j) \) are provided by the second \( P 0-P U S C H- \) AlphaSet in \( p 0- \) AlphaSets ; otherwise, \( l=0 \)
- \( \quad \) If \( j=1 \),
- \( l \) is provided by the value of powerControlLoopTo Use if \( P_{0_{-} \cup E_{-} \mathrm{PuSCH}, b, f, c}(1) \) and \( \alpha_{b_{1}, f, c}(1) \) are provided by p0-PUSCH-Alpha in ConfiguredGrantConfig
- \( l \) is provided by the value of powerControlLoopToUse 2 if \( P_{\mathrm{O}_{-} \mathrm{UE} \_ \text {PusCH }, b, f, c}(1) \) and \( \alpha_{b_{1}, f, c}(1) \) are provided by p0-PUSCH-Alpha 2 in ConfiguredGrantConfig
- \( f_{b, f, c}(i, l)=\delta_{\text {PUSCH }, b, f, c}(i, l) \) is the PUSCH power control adjustment state for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) and PUSCH transmission occasion \( i \) if the UE is provided tpc-Accumulation, where
- \( \delta_{\text {PUSCH }, b, f, c} \) absolute values are given in Table 7.1.1-1

If the UE transmits a PUSCH associated with the first RS resource index \( q_{d} \), the UE applies the first \( P_{0 \_ \text {UE_PUSCH }, b, f, c}(j) \) value, the first \( \alpha_{b, f, c}(j) \) value, and \( f_{b, f, c}(i, l) \) for determining \( P_{\mathrm{PUSCH}, b, f, c}\left(i, j, q_{d}, l\right) \). If the UE transmits a PUSCH associated with the second RS resource index \( q_{d} \), the UE applies the second \( P_{0 \_ \text {UE } \_ \text {PUSCH }, b, f, c}(j) \) value, the second \( \alpha_{b, f, c}(j) \) value, and \( f_{b, f, c}(i, l) \) or \( f_{b, f, c}(i, 0) \) if twoPUSCH-PC-AdjustmentStates is provided or not provided, respectively, for determining \( P_{\text {PUSCH }, b, f, c}\left(i, j, q_{d}, l\right) \).

ETSI


--- Page 32  ---


3GPP TS 38.213 version 17.1.0 Release 17
31
ETSI TS 138213 V17.1.0 (2022-05)
- If the UE receives a random access response message in response to a PRACH transmission or a MsgA transmission on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) as described in clause 8
- \( f_{b_{1}, f_{1} c}(0, l)=\Delta P_{\text {rampup }, b, f, c}+\delta_{\text {msg } 2, b, f, c} \), where \( l=0 \) and
- \( \delta_{\text {msg2, } b_{1}, c} \) is a TPC command value indicated in a random access response grant of the random access response message corresponding to a PRACH transmission according to Type-1 random access procedure, or in a random access response grant of the random access response message corresponding to a MsgA transmission according to Type-2 random access procedure with RAR message(s) for fallbackRAR, on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \), and
\[
-\Delta P_{\text {rampup, } b, f, c}=\min \left[\left\{\max \left(0, P_{\text {CMAX, }, c}-\left(\begin{array}{c}
10 \log _{10}\left(2^{\mu} \cdot M_{\text {RB }, f, f, c}^{\text {PUSCH }}(0)\right) \\
+P_{\mathrm{O}_{-} \text {PUSCH, }, b, c}(0)+\alpha_{b, f, c}(0) \cdot P L_{c} \\
+\Delta_{\text {TF, } b, f, c}(0)+\delta_{\text {msg } 2, b, f, c}
\end{array}\right)\right)\right\}, \quad \Delta P_{\text {rampupreguessed }, b, f, c}\right]
\]
and \( \Delta P_{\text {rampup_requested }, b_{1}, c, c} \) is provided by higher layers and corresponds to the total power ramp-up requested by higher layers from the first to the last random access preamble for carrier \( f \) in the serving cell \( c, M_{\mathrm{RB}, b_{1}, f_{1} c}^{\mathrm{PUSCH}}(0) \) is the bandwidth of the PUSCH resource assignment expressed in number of resource blocks for the first PUSCH transmission on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \), and \( \Delta_{\mathrm{TF}, b, f_{1} c}(0) \) is the power adjustment of first PUSCH transmission on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \).
- If the UE transmits the PUSCH in PUSCH transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) as described in clause 8.1A, \( f_{b, f, c}(0, l)=\Delta P_{\text {rampup }, b, f, c} \), where
- \( l=0 \), and
and \( \Delta P_{\text {rampup_requested, } b_{1}, c} \) is provided by higher layers and corresponds to the total power ramp-up requested by higher layers, \( M_{\mathrm{RB}, b, f, c}^{\mathrm{PUSCH}}(i) \) is the band width of the PUSCH resource assignment expressed in number of resource blocks, and \( \Delta_{\mathrm{TF}, b, f, c}(i) \) is the power adjustment of the PUSCH transmission in PUSCH transmission occasion \( i \).

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 7.1.1-1: Mapping of TPC Command Field in a DCI format scheduling a PUSCH transmission, or in DCI format 2_2 with CRC scrambled by TPC-PUSCH-RNTI, or in DCI format 2_3, to absolute and accumulated \( \delta_{\text {PUSCH }, b_{1}, c} \) values or \( \delta_{\text {SRS }, b, f, c} \) values}
\begin{tabular}{|c|c|c|}
\hline TPC Command Field & Accumulated \( \delta_{\text {PUSCH }, b, f, c} \) or \( \delta_{\text {SRS }, b, f, c} \) [dB] & Absolute \( \delta_{\text {PUSCH, } b, f, c} \) or \( \delta_{\text {SRS }, b, f, c} \) [dB] \\
\hline 0 & -1 & -4 \\
\hline 1 & 0 & -1 \\
\hline 2 & 1 & 1 \\
\hline 3 & 3 & 4 \\
\hline
\end{tabular}
\end{table}
7.2 Physical uplink control channel

If the UE is configured with a SCG, the UE shall apply the procedures described in this clause for both MCG and SCG.
- When the procedures are applied for MCG, the term 'serving cell' in this clause refers to serving cell belonging to the MCG.
- When the procedures are applied for SCG, the term 'serving cell' in this clause refers to serving cell belonging to the SCG. The term 'primary cell' in this clause refers to the PSCell of the SCG.

If the UE is configured with a PUCCH-SCell, the UE shall apply the procedures described in this clause for both primary PUCCH group and secondary PUCCH group.

ETSI


--- Page 33  ---


3GPP TS 38.213 version 17.1.0 Release 17
32
ETSI TS 138213 V17.1.0 (2022-05)
- When the procedures are applied for the primary PUCCH group, the term 'serving cell' in this clause refers to serving cell belonging to the primary PUCCH group.
- When the procedures are applied for the secondary PUCCH group, the term 'serving cell' in this clause refers to serving cell belonging to the secondary PUCCH group. The term 'primary cell' in this clause refers to the PUCCH-SCell of the secondary PUCCH group. If pdsch-HARQ-ACK-Codebook-secondaryPUCCHgroup-r16 is provided, pdsch-HARQ-ACK-Codebook is replaced by pdsch-HARQ-ACK-Codebook-secondaryPUCCHgrouprl6.

For unpaired spectrum operation, if the UE is provided a PUCCH-sSCell by pucch-sSCell as described in clause 9.A, the UE shall apply the procedures described in this clause for both the primary cell and the PUCCH-sSCell.
7.2.1 UE behaviour

If a UE transmits a PUCCH on active UL BWP \( b \) of carrier \( f \) in the primary cell \( c \) using PUCCH power control adjustment state with index \( l \), the UE determines the PUCCH transmission power \( P_{\text {PUCCH }, b, f, c}\left(i, q_{u}, q_{d}, l\right) \) in PUCCH transmission occasion \( i \) as
\[
\begin{aligned}
P_{\mathrm{PUCCH}, b, f, c}\left(i, q_{u}, q_{d}, /\right)=\min \{ & \left.\begin{array}{l}
P_{\mathrm{CMAX}, f, c}(i), \\
P_{\mathrm{O} \_\mathrm{PUCCH}, b, f, c}\left(q_{u}\right)+10 \log _{10}\left(2^{\mu}, M_{\mathrm{RE}, b, f, c}^{\mathrm{PUCCH}}(i)\right)+P L_{b_{1}, f, c}\left(q_{d}\right)+\Delta_{\mathrm{F} \_\mathrm{PUCCH}}(F)+\Delta_{\mathrm{TF}, b, f, c}(i)+g_{b_{1}, f, c}(i, /)
\end{array}\right\} \\
& \quad[\mathrm{dBm}]
\end{aligned}
\]
where
- \( P_{\text {CMAX }_{1} f, c}(i) \) is the UE configured maximum output power defined in [8-1, TS 38.101-1], [8-2, TS38.101-2] and [8-3, TS38.101-3] for carrier \( f \) of primary cell \( c \) in PUCCH transmission occasion \( i \)
- \( P_{0 \_ \text {PUCCH }, b, f, c}\left(q_{u}\right) \) is a parameter composed of the sum of a component \( P_{0 \_N O M I N A L, P U C C H} \), provided by p 0 -nominal, or \( P_{0 \_N O M I N A L} \) PUCCH \( =0 \mathrm{dBm} \) if \( p 0 \)-nominal is not provided, for carrier \( f \) of primary cell \( c \) and, if provided, a component \( P_{0 \_ \text {UE_PUCCH }}\left(q_{u}\right) \) provided by p0-PUCCH-Value in P0-PUCCH for active UL BWP \( b \) of carrier \( f \) of primary cell \( c \), where \( 0 \leq q_{u}<Q_{u}-Q_{u} \) is a size for a set of \( P_{O_{-} U E \_P U C C H} \) values provided by maxNrofPUCCH\( P 0 \)-PerSet. The set of \( P_{\mathrm{O} \_ \text {UE_PUCCH }} \) values is provided by p0-Set. If \( p 0 \)-Set is not provided to the UE, \( P_{0 \_ \text {РШССН }, b_{1} f_{1} c}\left(q_{u}\right)=0,0 \leq q_{u}<Q_{u} \)
- If the UE is provided PUCCH-SpatialRelationInfo, the UE obtains a mapping, by an index provided by p0-PUCCH-Id, between a set of pucch-SpatialRelationInfold values and set of p0-PUCCH-Value values. If the UE is provided more than one values for pucch-SpatialRelationInfold and the UE receives an activation command [11, TS 38.321] indicating a value of pucch-SpatialRelationInfold, the UE determines the p0-PUCCH-Value value through the link to a corresponding \( p 0-P U C C H-I d \) index. The UE applies the activation command in the first slot that is after slot \( k+3 \cdot N_{\text {slot }}^{\text {sub frame }, \mu} \) where \( k \) is the slot where the UE would transmit a PUCCH with HARQ-ACK information for the PDSCH providing the activation command and \( \mu \) is the SCS configuration for the PUCCH
- If the UE is provided more than one sets of power control parameters for operation in FR1, and the UE receives an activation command [11, TS 38.321 ] indicating one or two of the more than one sets of power control parameters, the UE determines p0-PUCCH-Value value according to the corresponding one or two sets of power control parameters. The UE applies the activation command in the first slot that is after slot \( k+ 3 \cdot N_{\text {slot }}^{\text {sub frame, } \mu} \) where \( k \) is the slot where the UE would transmit a PUCCH with HARQ-ACK information for the PDSCH providing the activation command and \( \mu \) is the SCS configuration for the PUCCH.
- If the UE is not provided PUCCH-SpatialRelationInfo and is not provided more than one sets of power control parameters for operation in FR1, the UE obtains the \( p 0-P U C C H-V a l u e \) value from the PO-PUCCH with \( p 0-P U C C H-I d \) value equal to the minimum \( p 0-P U C C H-I d \) value in \( p 0-S e t \)
- \( \quad M_{\mathrm{RB}, b_{1} f, c}^{\mathrm{PUCC}}(i) \) is a bandwidth of the PUCCH resource assignment expressed in number of resource blocks for PUCCH transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of primary cell \( c \) and \( \mu \) is a SCS configuration defined in [4, TS 38.211]
- \( P L_{b_{1} f_{1} c}\left(q_{d}\right) \) is a downlink pathloss estimate in dB calculated by the UE using RS resource index \( q_{d} \) as described in clause 7.1.1 for the active DL BWP \( b \) of carrier \( f \) of the primary cell \( c \) as described in clause 12

ETSI


--- Page 34  ---


3GPP TS 38.213 version 17.1.0 Release 17
33
ETSI TS 138213 V17.1.0 (2022-05)
- If the UE is not provided pathlossReferenceRSs or before the UE is provided dedicated higher layer parameters, the UE calculates \( P L_{b, f, c}\left(q_{d}\right) \) using a RS resource obtained from an SS/PBCH block with same SS/PBCH block index as the one the UE uses to obtain MIB
- If the UE is provided a number of RS resource indexes, the UE calculates \( P L_{b, f, c}\left(q_{d}\right) \) using RS resource with index \( q_{d} \), where \( 0 \leq q_{d}<Q_{d}-Q_{d} \) is a size for a set of RS resources provided by maxNrofPUCCHPathlossReferenceRSs. The set of RS resources is provided by pathlossReferenceRSs. The set of RS resources can include one or both of a set of SS/PBCH block indexes, each provided by ssb-Index in PUCCH-PathlossReferenceRS when a value of a corresponding pucch-PathlossReferenceRS-Id maps to a SS/PBCH block index, and a set of CSI-RS resource indexes, each provided by csi-RS-Index when a value of a corresponding pucch-PathlossReferenceRS-Id maps to a CSI-RS resource index. The UE identifies a RS resource in the set of RS resources to correspond either to a SS/PBCH block index or to a CSI-RS resource index as provided by pucch-PathlossReferenceRS-Id in PUCCH-PathlossReferenceRS
- If the UE is provided pathlossReferenceRSs and PUCCH-SpatialRelationInfo, the UE obtains a mapping, by indexes provided by corresponding values of pucch-PathlossReferenceRS-Id, between a set of pucchSpatialRelationInfold values and a set of referenceSignal values provided by PUCCH-PathlossReferenceRS. If the UE is provided more than one values for pucch-SpatialRelationInfold and the UE receives an activation command [11, TS 38.321] indicating a value of pucch-SpatialRelationInfold, the UE determines the referenceSignal value in PUCCH-PathlossReferenceRS through the link to a corresponding pucch-PathlossReferenceRS-Id index. The UE applies the activation command in the first slot that is after slot \( k+ 3 \cdot N_{\text {slot }}^{\text {sub frame, } \mu} \) where \( k \) is the slot where the UE would transmit a PUCCH with HARQ-ACK information for the PDSCH providing the activation command and \( \mu \) is the SCS configuration for the PUCCH
- If PUCCH-SpatialRelationInfo includes servingCellld indicating a serving cell, the UE receives the RS for resource index \( q_{d} \) on the active DL BWP of the serving cell
- If the UE is provided pathlossReferenceRSs and more than one sets of power control parameters for operation in FR1, and the UE receives an activation command [11, TS 38.321] indicating one or two of the more than one sets of power control parameters, the UE determines the referenceSignal values in PUCCHPathlossReferenceRS that are indicated in the one or two sets of power control parameter
- If the UE is provided pathlossReferenceRSs and is not provided PUCCH-SpatialRelationInfo and is not provided more than one sets of power control parameters for operation in FR1, the UE obtains the referenceSignal value in PUCCH-PathlossReferenceRS from the pucch-PathlossReferenceRS-Id with index 0 in PUCCH-PathlossReferenceRS where the RS resource is either on the primary cell or, if provided, on a serving cell indicated by a value of pathlossReferenceLinking
- If the UE
- is not provided pathlossReferenceRSs, and
- is not provided PUCCH-SpatialRelationInfo, and
- is provided enableDefaultBeamPL-ForPUCCH, and
- is not provided coresetPoollndex value of 1 for any CORESET, or is provided coresetPoollndex value of 1 for all CORESETs, in ControlResourceSet and no codepoint of a TCI field, if any, in a DCI format of any search space set maps to two TCI states [5, TS 38.212]
the UE determines a RS resource index \( q_{d} \) providing a periodic RS resource configured with qcl-Type set to 'typeD' in the TCI state or the QCL assumption of a CORESET with the lowest index in the active DL BWP of the primary cell. If the CORESET has two activated TCI states, as described in clause 10.1, the UE determines the RS resource index \( q_{d} \) based on the first activated TCI state. For a PUCCH transmission over multiple slots, a same \( q_{d} \) applies to the PUCCH transmission in each of the multiple slots.
- The parameter \( \Delta_{\mathrm{F}_{\mathrm{P}} \mathrm{PCCH}}(F) \) is a value of deltaF-PUCCH-fofor PUCCH format 0 , deltaF-PUCCH-fl for PUCCH format 1, deltaF-PUCCH-f2 for PUCCH format 2, deltaF-PUCCH-f3 for PUCCH format 3, and deltaF-PUCCH-f4 for PUCCH format 4, if provided; otherwise \( \Delta_{\mathrm{F}_{-} \mathrm{PUCCH}}(F)=0 \).
- \( \quad \Delta_{\mathrm{TF}, b, f, c}(i) \) is a PUCCH transmission power adjustment component on active UL BWP \( b \) of carrier \( f \) of primary cell \( c \)

ETSI


--- Page 35  ---


3GPP TS 38.213 version 17.1.0 Release 17
34
ETSI TS 138213 V17.1.0 (2022-05)
- For a PUCCH transmission using PUCCH format 0 or PUCCH format \( 1, \Delta_{\mathrm{TF}, b, f, c}(i)= 10 \log _{10}\left(\frac{N_{\mathrm{ref}}^{\mathrm{PUCCH}}}{N_{\mathrm{symb}}^{\mathrm{PUCCH}}(i)}\right)+\Delta_{\mathrm{UCI}}(i) \) where
- \( \quad N_{\text {symb }}^{\text {PUCCH }}(i) \) is a number of PUCCH format 0 symbols or PUCCH format 1 symbols for the PUCCH transmission as described in clause 9.2.
- \( N_{\text {ref }}^{\text {PUCCH }}=2 \) for PUCCH format 0
- \( \quad N_{\text {ref }}^{\text {PUCCH }}=N_{\text {symb }}^{\text {slot }} \) for PUCCH format 1
- \( \quad \Delta_{\mathrm{UCI}}(i)=0 \) for PUCCH format 0
- \( \Delta_{\mathrm{UCI}}(i)=10 \log _{10}\left(O_{\mathrm{UCI}}(i)\right) \) for PUCCH format 1 , where \( O_{\mathrm{UCI}}(i) \) is a number of UCI bits in PUCCH transmission occasion \( i \)
- For a PUCCH transmission using PUCCH format 2 or PUCCH format 3 or PUCCH format 4 and for a number of UCI bits smaller than or equal to \( 11, \Delta_{\mathrm{TF}, b_{1}, f_{1} c}(i)=10 \log _{10}\left(K_{1}\right. \). \( \left.\left(n_{\text {HARQ-ACK }}(i)+O_{\text {SR }}(i)+O_{\text {CSI }}(i)\right) / N_{\text {RE }}(i)\right) \), where
- \( K_{1}=6 \)
- \( n_{\text {HARQ-ACK }}(i) \) is a number of HARQ-ACK information bits that the UE determines as described in clause 9.1.2.1 or 16.5.1.1 for Type-1 HARQ-ACK codebook and as described in clause 9.1.3.1 or 9.1.3.3 or 16.5.2.1 for Type-2 HARQ-ACK codebook. \( n_{\text {HARQ-ACK }}(i) \) is the same as \( O_{\text {ACK }}(i) \) as described in clause 9.1.4 for Type-3 HARQ-ACK codebook. If the UE is not provided any of pdsch-HARQ-ACK-Codebook, pdsch-HARQ-ACK-Codebook-r16, or pdsch-HARQ-ACK-OneShotFeedback, \( n_{\text {HARQ-ACK }}(i)=1 \) if the UE includes a HARQ-ACK information bit in the PUCCH transmission; otherwise, \( n_{\text {HARQ-ACK }}(i)=0 \)
- \( O_{\mathrm{SR}}(i) \) is a number of SR information bits that the UE determines as described in clause 9.2.5.1
- \( O_{\mathrm{CSI}}(i) \) is a number of CSI information bits that the UE determines as described in clause 9.2.5.2
- \( \quad N_{\mathrm{RE}}(i) \) is a number of resource elements determined as \( N_{\mathrm{RE}}(i)=M_{\mathrm{RB}, b, f, c}^{\mathrm{PUCCH}}(i) \cdot N_{\mathrm{sc}, \mathrm{ctrl}}^{\mathrm{RB}}(i) \). \( N_{\text {symb-UCI }, b_{1}, c, c}^{\text {PUCCH }}(i) \), where \( N_{\text {sc }, \text { ctrl }}^{\mathrm{RB}}(i) \) is a number of subcarriers per resource block excluding subcarriers used for DM-RS transmission, and \( \cdot N_{\text {symb-UCI }, b, f, c}^{\text {PUCC }}(i) \) is a number of symbols excluding symbols used for DM-RS transmission, as defined in clause 9.2.5.2, for PUCCH transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of primary cell \( c \)
- For a PUCCH transmission using PUCCH format 2 or PUCCH format 3 or PUCCH format 4 and for a number of UCI bits larger than \( 11, \Delta_{\mathrm{TF}, b, f, c}(i)=10 \log _{10}\left(2^{\mathrm{BPRE} \cdot K_{2}}-1\right) \), where
- \( K_{2}=2.4 \)
- \( \operatorname{BPRE}(\mathrm{i})=\left(O_{\mathrm{ACK}}(i)+O_{\mathrm{SR}}(i)+O_{\mathrm{CSI}}(i)+O_{\mathrm{CRC}}(i)\right) / N_{R E}(i) \)
- \( O_{\mathrm{ACK}}(i) \) is a number of HARQ-ACK information bits that the UE determines as described in clause 9.1.2.1 or 16.5.1.1 for Type-1 HARQ-ACK codebook and as described in clause 9.1.3.1 or 9.1.3.3 or 16.5.2.1 for Type-2 HARQ-ACK codebook, or as described in clause 9.1.4 for Type-3 HARQ-ACK codebook. If the UE is not provided any of pdsch-HARQ-ACK-Codebook, pdsch-HARQ-ACK-Codebookr16, or pdsch-HARQ-ACK-OneShotFeedback, \( O_{\mathrm{ACK}}=1 \) if the UE includes a HARQ-ACK information bit in the PUCCH transmission; otherwise, \( O_{\mathrm{ACK}}=0 \)
- \( O_{\mathrm{SR}}(i) \) is a number of SR information bits that the UE determines as described in clause 9.2.5.1
- \( O_{\mathrm{CSI}}(i) \) is a number of CSI information bits that the UE determines as described in clause 9.2.5.2
- \( O_{\mathrm{CRC}}(i) \) is a number of CRC bits that the UE determines as described in clause 9.2
- \( \quad N_{\mathrm{RE}}(i) \) is a number of resource elements that the UE determines as \( N_{\mathrm{RE}}(i)=M_{\mathrm{RB}, b_{1} f, c}^{\mathrm{PUCC}}(i) \). \( N_{\mathrm{sc}, \mathrm{ctrl}}^{\mathrm{RB}}(i) \cdot N_{\mathrm{symb}-\mathrm{UCl}, b, f, c}^{\mathrm{PUCCH}}(i) \), where \( N_{\mathrm{sc}, \mathrm{ctrl}}^{\mathrm{RB}}(i) \) is a number of subcarriers per resource block excluding

ETSI


--- Page 36  ---


3GPP TS 38.213 version 17.1.0 Release 17
35
ETSI TS 138213 V17.1.0 (2022-05)

subcarriers used for DM-RS transmission, and \( N_{\text {symb-UCI }, b_{1}, c}^{\text {PUCCH }}(i) \) is a number of symbols excluding symbols used for DM-RS transmission, as defined in clause 9.2.5.2, for PUCCH transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of primary cell \( c \).
- For the PUCCH power control adjustment state \( g_{b, f, c}(i, l) \) for active UL BWP \( b \) of carrier \( f \) of primary cell \( c \) and PUCCH transmission occasion \( i \)
- \( \quad \delta_{\mathrm{PUCCH}, b, f, c}(i, l) \) is a TPC command value included in a DCI format associated with the PUCCH transmission for active UL BWP \( b \) of carrier \( f \) of the primary cell \( c \) that the UE detects for PUCCH transmission occasion \( i \), or is jointly coded with other TPC commands in a DCI format \( 2 \_2 \) with CRC scrambled by TPC-PUCCHRNTI [5, TS 38.212], as described in clause 11.3
- \( l \in\{0,1\} \) if the UE is provided twoPUCCH-PC-AdjustmentStates and PUCCH-SpatialRelationInfo, or more than one sets of power control parameters for operation in FR1, and \( l=0 \) if the UE is not provided twoPUCCH-PC-AdjustmentStates or PUCCH-SpatialRelationInfo, and more than one sets of power control parameters
- If the UE obtains a TPC command value from a DCI format associated with the PUCCH transmission and if the UE is provided PUCCH-SpatialRelationInfo, the UE obtains a mapping, by an index provided by p0-PUCCH-Id, between a set of pucch-SpatialRelationInfold values and a set of values for closedLoopIndex that provide the \( l \) value(s). If the UE receives an activation command indicating a value of pucch-SpatialRelationInfold, the UE determines the value closedLoopIndex that provides the value of \( l \) through the link to a corresponding p0-PUCCH-Id index
- If the UE obtains a TPC command from a DCI format 2 _ 2 with CRC scrambled by a TPC-PUCCHRNTI, the \( l \) value is provided by the closed loop indicator field in DCI format 2_2
- If the UE transmits the PUCCH with \( N_{\text {PUCCH }}^{\text {repeat }}>1 \) repetitions, as described in clause 9.2.6, and the UE is provided twoPUCCH-PC-AdjustmentStates by pucch-PowerControl
- If the DCI format includes two TPC command values and the PUCCH resource of the PUCCH transmission is associated with \( l=0 \) and \( l=1 \), the UE applies the first TPC command value for \( l= \) 0 and applies the second TPC command value for \( l=1 \)
- If the DCI format includes two TPC command values and the PUCCH resource of the PUCCH transmission is associated with \( l=0 \), the UE applies the first TPC command value for \( l=0 \) and ignores the second TPC command value
- If the DCI format includes two TPC command values and the PUCCH resource of the PUCCH transmission is associated with \( l=1 \), the UE applies the second TPC command value for \( l=1 \) and ignores the first TPC command value
- If the DCI format includes one TPC command value, the UE applies the TPC command value for all \( l \) associated with the PUCCH resource of the PUCCH transmission
- \( g_{b, f, c}(i, l)=g_{b, f, c}\left(i-i_{0}, l\right)+\sum_{m=0}^{\ell\left(C_{i}\right)-1} \delta_{\mathrm{PUCCH}, b, f, c}(m, l) \) is the current PUCCH power control adjustment state \( l \) for active UL BWP \( b \) of carrier \( f \) of primary cell \( c \) and PUCCH transmission occasion \( i \), where
- The \( \delta_{\text {PUCCH }, b, f, c} \) values are given in Table 7.1.2-1
- \( \sum_{m=0}^{\ell\left(C_{i}\right)-1} \delta_{\text {PUCCH, } b, f, c}(m, l) \) is a sum of TPC command values in a set \( C_{i} \) of TPC command values with cardinality \( C\left(C_{i}\right) \) that the UE receives between \( K_{\text {PUCCH }}\left(i-i_{0}\right)-1 \) symbols before PUCCH transmission occasion \( i-i_{0} \) and \( K_{\text {PUCCH }}(i) \) symbols before PUCCH transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of primary cell \( c \) for PUCCH power control adjustment state, where \( i_{0}>0 \) is the smallest integer for which \( K_{\text {PUCCH }}\left(i-i_{0}\right) \) symbols before PUCCH transmission occasion \( i-i_{0} \) is earlier than \( K_{\text {PUCCH }}(i) \) symbols before PUCCH transmission occasion \( i \)
- If the PUCCH transmission is in response to a detection by the UE of a DCI format, \( K_{\mathrm{PUCCH}}(i) \) is a number of symbols for active UL BWP \( b \) of carrier \( f \) of primary cell \( c \) after a last symbol of a corresponding PDCCH reception and before a first symbol of the PUCCH transmission

ETSI


--- Page 37  ---


3GPP TS 38.213 version 17.1.0 Release 17
36
ETSI TS 138213 V17.1.0 (2022-05)
- If the PUCCH transmission is not in response to a detection by the UE of a DCI format, \( K_{\mathrm{PUCCH}}(i) \) is a number of \( K_{\mathrm{PUCCH} \text { min }} \) symbols equal to the product of a number of symbols per slot, \( N_{\text {symb }}^{\text {slot }} \), and the minimum of the values provided by \( k 2 \) in PUSCH-ConfigCommon for active UL BWP \( b \) of carrier \( f \) of primary cell \( c \)
- If the UE has reached maximum power for active UL BWP \( b \) of carrier \( f \) of primary cell \( c \) at PUCCH transmission occasion \( i-i_{0} \) and \( \sum_{m=0}^{\ell\left(c_{i}\right)-1} \delta_{\mathrm{PUCCH}_{1} b_{1} f_{1} c}(m, l) \geq 0 \), then \( g_{b_{1}, f, c}(i, l)=g_{b_{1}, f, c}\left(i-i_{0}, l\right) \)
- If UE has reached minimum power for active UL BWP \( b \) of carrier \( f \) of primary cell \( c \) at PUCCH transmission occasion \( i-i_{0} \) and \( \sum_{m=0}^{\ell\left(C_{i}\right)-1} \delta_{\text {PUCCH }_{1} b_{1}, c, c}(m, l) \leq 0 \), then \( g_{b_{1}, f, c}(i, l)=g_{b_{1}, f, c}\left(i-i_{0}, l\right) \)
- If a configuration of a \( P_{0 \_\mathrm{PUCCH}, b, f, c}\left(q_{u}\right) \) value for a corresponding PUCCH power control adjustment state \( l \) for active UL BWP \( b \) of carrier \( f \) of primary cell \( c \) is provided by higher layers,
- \( \quad g_{b, f, c}(k, l)=0, \quad k=0,1, \ldots, i \)
- if the UE is provided PUCCH-SpatialRelationInfo, the UE determines the value of \( l \) from the value of \( q_{u} \) based on a pucch-SpatialRelationInfold value associated with the p0-PUCCH-Id value corresponding to \( q_{u} \) and with the closedLoopIndex value corresponding to \( l \);
- else, if the UE is provided more than one sets of power control parameters for operation in FR1, and if the UE receives an activation command for a PUCCH resource that indicates one or two sets of the more than one sets of power control parameters, the UE determines the value of \( l \) based on the closedLoopIndex value in the one or two sets of power control parameters;
- else, \( l=0 \)
- Else,
- \( \quad g_{b_{1} f_{1} c}(0, l)=\Delta P_{\text {rampup }, b_{1}, c, c}+\delta_{b_{1}, f, c} \), where \( l=0 \), and \( \delta_{b_{1} f_{1} c} \) is
- the TPC command value indicated in a random access response grant corresponding to a PRACH transmission according to Type-1 random access procedure, or in a random access response grant corresponding to MsgA transmissions according to Type-2 random access procedure with RAR message(s) for fallbackRAR, or
- the TPC command value indicated in a successRAR corresponding to MsgA transmissions for Type-2 random access procedure, or
- the TPC command value in a DCI format with CRC scrambled by C-RNTI or MCS-C-RNTI that the UE detects in a first PDCCH reception in a search space set provided by recoverySearchSpaceld if the PUCCH transmission is a first PUCCH transmission after 28 symbols from a last symbol of the first PDCCH reception,
and, if the UE transmits PUCCH on active UL BWP \( b \) of carrier \( f \) of primary cell \( c \),
\( \Delta P_{\text {rampup }, b_{1} f_{1} c}=\min \left[\max \left(0, P_{\text {CMAX }_{1} f_{1} c}-\left(P_{0_{-} \text {PUCCH }_{1} b_{1} f_{1} c}+P L_{b_{1} f_{1} c}\left(q_{d}\right)+\Delta_{\text {F_PUCCH }_{-}}+\Delta_{T F_{1} b_{1} f_{1} c}+\right.\right.\right. \left.\left.\left.\delta_{b_{1}, f_{1} c}\right)\right), \Delta P_{\text {rampup_requested }, b_{1}, c, c}\right] ; \)
otherwise,
\( \Delta P_{\text {rampup } b_{1} f_{1} c}=\min \left[\max \left(0, P_{\text {CMAX }_{1} f_{1} c}-\left(P_{0_{-} \text {PUCCH }_{1} b_{1} f_{1} c}+P L_{b_{1} f_{1} c}\left(q_{d}\right)\right)\right), \Delta P_{\text {rampup_requested } b_{1} f_{1} c}\right] \)
where \( \Delta P_{\text {rampup_requested, } b_{1} f, c} \) is provided by higher layers and corresponds to the total power ramp-up requested by higher layers from the first to the last preamble for active UL BWP \( b \) of carrier \( f \) of primary cell \( c \), and \( \Delta_{\mathrm{F}_{\mathrm{F}} \mathrm{PCCH}} \) corresponds to PUCCH format 0 or PUCCH format 1

ETSI


--- Page 38  ---


3GPP TS 38.213 version 17.1.0 Release 17
37
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 7.2.1-1: Mapping of TPC Command Field in a DCI format to accumulated \( \delta_{\text {PUCCH, } b, c} \) values}
\begin{tabular}{|c|c|}
\hline TPC Command Field & Accumulated \( \boldsymbol{\delta}_{\text {PUCCH, } \boldsymbol{b}, \boldsymbol{f}, \boldsymbol{c}} \) [dB] \\
\hline 0 & -1 \\
\hline 1 & 0 \\
\hline 2 & 1 \\
\hline 3 & 3 \\
\hline
\end{tabular}
\end{table}
7.3 Sounding reference signals

For SRS, a UE splits a linear value \( \hat{P}_{\text {SRS }, b, f, c}\left(i, q_{s}, l\right) \) of the transmit power \( P_{\text {SRS }, b, f, c}\left(i, q_{s}, l\right) \) on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) equally across the configured antenna ports for SRS.
7.3.1 UE behaviour

If a UE transmits SRS based on a configuration by SRS-ResourceSet on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) using SRS power control adjustment state with index \( l \), the UE determines the SRS transmission power \( P_{S R S, b, f, c}\left(i, q_{s}, l\right) \) in SRS transmission occasion \( i \) as
\[
P_{\mathrm{SRS}, b, f, c}\left(i, q_{s}, l\right)=\min \left\{\begin{array}{l}
P_{\mathrm{OMAX}, f, c}(i), \\
P_{\mathrm{O} \_\mathrm{SRS}, b, f, c}\left(q_{s}\right)+10 \log _{10}\left(2^{\mu} \cdot M_{\mathrm{SRS}, b, f, c}(i)\right)+\alpha_{\mathrm{SRS}, b, f, c}\left(q_{s}\right) \cdot P L_{b, f, c}\left(q_{d}\right)+h_{b, f, c}(i, l)
\end{array}\right\}[\mathrm{dBm}]
\]
where,
- \( P_{\mathrm{CMAX}_{1}, f_{1}}(i) \) is the UE configured maximum output power defined in [8, TS 38.101-1], [8-2, TS38.101-2] and [TS 38.101-3] for carrier \( f \) of serving cell \( c \) in SRS transmission occasion \( i \)
- \( \quad P_{0 \_\mathrm{SRS}, b, f, c}\left(q_{s}\right) \) is provided by \( p 0 \) for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) and SRS resource set \( q_{s} \) provided by SRS-ResourceSet and SRS-ResourceSetld
- \( M_{\text {SRS }, b, f, c}(i) \) is a SRS bandwidth expressed in number of resource blocks for SRS transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) and \( \mu \) is a SCS configuration defined in [4, TS 38.211]
- \( \quad \alpha_{\mathrm{SRS}, b, f, c}\left(q_{s}\right) \) is provided by alpha for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) and SRS resource set \( q_{s} \)
- \( P L_{b, f, c}\left(q_{d}\right) \) is a downlink pathloss estimate in dB calculated by the UE using RS resource index \( q_{d} \) as described in clause 7.1.1 for the active DL BWP of serving cell \( c \) and SRS resource set \( q_{s}[6 \), TS 38.214]. The RS resource index \( q_{d} \) is provided by pathlossReferenceRS associated with the SRS resource set \( q_{s} \) and is either an ssb-Index providing a SS/PBCH block index or a csi-RS-Index providing a CSI-RS resource index. If the UE is provided enablePL-RS-UpdateForPUSCH-SRS, a MAC CE [11, TS 38.321] can provide by SRS-PathlossReferenceRS-Id a corresponding RS resource index \( q_{d} \) for aperiodic or semi-persistent SRS resource set \( q_{s} \)
- If the UE is not provided pathlossReferenceRS or SRS-PathlossReferenceRS-Id, or before the UE is provided dedicated higher layer parameters, the UE calculates \( P L_{b_{1}, f, c}\left(q_{d}\right) \) using a RS resource obtained from an SS/PBCH block with same SS/PBCH block index as the one the UE uses to obtain MIB
- If the UE is provided pathlossReferenceLinking, the RS resource is on a serving cell indicated by a value of pathlossReferenceLinking
- If the UE
- is not provided pathlossReferenceRS or SRS-PathlossReferenceRS-Id,
- is not provided spatialRelationInfo, and
- is provided enableDefaultBeamPL-ForSRS, and
- is not provided coresetPoollndex value of 1 for any CORESET, or is provided coresetPoollndex value of 1 for all CORESETs, in ControlResourceSet and no codepoint of a TCI field, if any, in a DCI format of any search space set maps to two TCI states [5, TS 38.212]

ETSI


--- Page 39  ---


3GPP TS 38.213 version 17.1.0 Release 17
38
ETSI TS 138213 V17.1.0 (2022-05)

the UE determines a RS resource index \( q_{d} \) providing a periodic RS resource configured with qcl-Type set to 'typeD' in
- the TCI state or the QCL assumption of a CORESET with the lowest index in the active DL BWP, if CORESETs are provided in the active DL BWP of serving cell \( c \). If the CORESET has two activated TCI states, as described in clause 10.1 , the UE determines the RS resource index \( q_{d} \) based on the first TCI state.
- the active PDSCH TCI state with lowest ID [6, TS 38.214] in the active DL BWP, if CORESETs are not provided in the active DL BWP of serving cell \( c \)
- For the SRS power control adjustment state for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) and SRS transmission occasion \( i \)
- \( \quad h_{b_{1} f_{1} c}(i, l)=f_{b_{1} f_{1} c}(i, l) \), where \( f_{b_{1} f_{1} c}(i, l) \) is the current PUSCH power control adjustment state as described in clause 7.1.1, if srs-PowerControlAdjustmentStates indicates a same power control adjustment state for SRS transmissions and PUSCH transmissions; or
- \( \quad h_{b, f, c}(i)=h_{b, f, c}\left(i-i_{0}\right)+\sum_{m=0}^{c\left(S_{i}\right)-1} \delta_{\text {SRS }, b, f, c}(m) \) if the UE is not configured for PUSCH transmissions on active UL

BWP \( b \) of carrier \( f \) of serving cell \( c \), or if srs-PowerControlAdjustmentStates indicates separate power control adjustment states between SRS transmissions and PUSCH transmissions, and if tpc-Accumulation is not provided, where
- The \( \delta_{\mathrm{SRS}, b, f, c} \) values are given in Table 7.1.1-1
- \( \quad \delta_{\mathrm{SRS}, b_{1} f, c}(m) \) is jointly coded with other TPC commands in a PDCCH with DCI format 2_3, as described in clause 11.4
- \( \quad \sum_{m=0}^{\ell\left(S_{i}\right)-1} \delta_{\text {SRS }, b_{1}, c_{1} c}(m) \) is a sum of TPC command values in a set \( S_{i} \) of TPC command values with cardinality \( C\left(S_{i}\right) \) that the UE receives between \( K_{S R S}\left(i-i_{0}\right)-1 \) symbols before SRS transmission occasion \( i-i_{0} \) and \( K_{\text {SRS }}(i) \) symbols before SRS transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) for SRS power control adjustment state, where \( i_{0}>0 \) is the smallest integer for which \( K_{\text {SRS }}(i) \) symbols before SRS transmission occasion \( i-i_{0} \) is earlier than \( K_{\text {SRS }}\left(i-i_{0}\right) \) symbols before SRS transmission occasion \( i \)
- if the SRS transmission is aperiodic, \( K_{\text {SRS }}(i) \) is a number of symbols for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) after a last symbol of a corresponding PDCCH triggering the SRS transmission and before a first symbol of the SRS transmission
- if the SRS transmission is semi-persistent or periodic, \( K_{S R S}(i) \) is a number of \( K_{S R S, \text { min }} \) symbols equal to the product of a number of symbols per slot, \( N_{\text {symb }}^{\text {slot }} \), and the minimum of the values provided by \( k 2 \) in PUSCH-ConfigCommon for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \)
- If the UE has reached maximum power for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) at SRS transmission occasion \( i-i_{0} \) and \( \sum_{m=0}^{\ell\left(S_{i}\right)-1} \delta_{\mathrm{SRS}, b_{1}, f_{1} c}(m) \geq 0 \), then \( h_{b_{1}, f_{1} c}(i)=h_{b_{1}, c}\left(i-i_{0}\right) \)
- If UE has reached minimum power for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) at SRS transmission occasion \( i-i_{0} \) and \( \sum_{m=0}^{\ell\left(S_{i}\right)-1} \delta_{\mathrm{SRS}, b_{1} f_{1} c}(m) \leq 0 \), then \( h_{b_{1} f_{1} c}(i)=h_{b_{1} f_{1} c}\left(i-i_{0}\right) \)
- If a configuration for a \( P_{0 \_ \text {SRS }, b_{1} f, c}\left(q_{s}\right) \) value or for a \( \alpha_{\text {SRS }, b_{1} f, c}\left(q_{s}\right) \) value for a corresponding SRS power control adjustment state \( l \) for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) is provided by higher layers - \( \quad h_{b, f, c}(k)=0, k=0,1, \ldots, i \)
- Else - \( h_{b, f, c}(0)=\Delta P_{\text {rampup }, b, f, c}+\delta_{\text {msg } 2, b, f, c} \)
where

ETSI


--- Page 40  ---


3GPP TS 38.213 version 17.1.0 Release 17
39
ETSI TS 138213 V17.1.0 (2022-05)

\( \delta_{\mathrm{msg} 2, b, f, c} \) is the TPC command value indicated in the random access response grant corresponding to the random access preamble that the UE transmitted on active UL BWP \( b \) of carrier \( f \) of the serving cell \( c \), and
\[
\begin{array}{r}
\Delta P_{\text {rampup }, b_{1}, f_{1} c}=\min \left[\operatorname { m a x } \left(0, P_{\mathrm{CMAX}_{1} f_{1} c}-\left(P_{0 \_\mathrm{SRS}_{1} b_{1} f_{1} c}\left(q_{s}\right)+10 \log _{10}\left(2^{\mu} \cdot M_{\mathrm{SRS}_{1} b_{1} f_{1} c}(i)\right)+\alpha_{S R S_{1} b_{1} f_{1} c}\left(q_{s}\right) .\right.\right.\right. \\
\left.\left.\left.P L_{b_{1} f_{1} c}\left(q_{d}\right)\right)\right), \Delta P_{\text {rampup_requested } b_{1} f_{1} c}\right] ;
\end{array}
\]
where \( \Delta P_{\text {rampup_requested, } b_{1} f_{1} c} \) is provided by higher layers and corresponds to the total power ramp-up requested by higher layers from the first to the last preamble for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \).
- \( h_{b_{1} f_{1} c}(i)=\delta_{\text {SRS }, b_{1} f_{1} c}(i) \) if the UE is not configured for PUSCH transmissions on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \), or if srs-PowerControlAdjustmentStates indicates separate power control adjustment states between SRS transmissions and PUSCH transmissions, and tpc-Accumulation is provided, and the UE detects a DCI format \( 23 K_{\mathrm{SRS}, \min } \) symbols before a first symbol of SRS transmission occasion \( i \), where absolute values of \( \delta_{\mathrm{SRS}, b, f, c} \) are provided in Table 7.1.1-1
- if srs-PowerControlAdjustmentStates indicates a same power control adjustment state for SRS transmissions and PUSCH transmissions, the update of the power control adjustment state for SRS transmission occasion \( i \) occurs at the beginning of each SRS resource in the SRS resource set \( q_{s} \); otherwise, the update of the power control adjustment state SRS transmission occasion \( i \) occurs at the beginning of the first transmitted SRS resource in the SRS resource set \( q_{s} \).

If a UE transmits SRS based on a configuration by SRS-PosResourceSet on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \), the UE determines the SRS transmission power \( P_{S R S_{1} b_{1} f_{1} c}\left(i, q_{s}\right) \) in SRS transmission occasion \( i \) as
\[
P_{\mathrm{SRS}, b, f, c}\left(i, q_{s}\right)=\min \left\{\begin{array}{l}
P_{\mathrm{CMAX}, f, c}(i), \\
P_{\mathrm{O} \_\mathrm{SRS}, b, f, c}\left(q_{s}\right)+10 \log _{10}\left(2^{\mu} \cdot M_{\mathrm{SRS}, b, f, c}(i)\right)+\alpha_{\mathrm{SRS}, b, f, c}\left(q_{s}\right) \cdot P L_{b, f, c}\left(q_{d}\right)
\end{array}\right\}[\mathrm{dBm}]
\]
where,
- \( \quad P_{0 \_\mathrm{SRS}, b, f, c}\left(q_{s}\right) \) and \( \alpha_{\mathrm{SRS}, b, f, c}\left(q_{s}\right) \) are provided by \( p 0-r 16 \) and \( a \) lpha-r 16 respectively, for active UL BWP \( b \) of carrier \( f \) of serving cell \( c \), and SRS resource set \( q_{s} \) is indicated by SRS-PosResourceSetld from SRSPosResourceSet, and
- \( P L_{b, f, c}\left(q_{d}\right) \) is a downlink pathloss estimate in dB calculated by the UE, as described in clause 7.1.1 in case of an active DL BWP of a serving cell \( c \), using RS resource indexed \( q_{d} \) in a serving or non-serving cell for SRS resource set \( q_{s}\left[6\right. \), TS 38.214]. A configuration for RS resource index \( q_{d} \) associated with SRS resource set \( q_{s} \) is provided by pathlossReferenceRS-Pos
- if a ssb-IndexNcell is provided, referenceSignalPower is provided by ss-PBCH-BlockPower-r16
- if a \( d l \)-PRS-Resourceld is provided, referenceSignalPower is provided by dl-PRS-ResourcePower

If the UE is in the RRC_CONNECTED state and determines that the UE is not able to accurately measure \( P L_{b, f, c}\left(q_{d}\right) \), or the UE is not provided with pathlossReferenceRS-Pos, the UE calculates \( P L_{b, f, c}\left(q_{d}\right) \) using a RS resource obtained from the SS/PBCH block of the serving cell that the UE uses to obtain MIB. If the UE is in the RRC_INACTIVE state and determines that the UE is not able to accurately measure \( P L_{b_{1} f_{1} c}\left(q_{d}\right) \), the UE does not transmit SRS for the SRS resource set.

The UE may indicate a capability for a number of pathloss estimates that the UE can simultaneously maintain for all SRS resource sets provided by SRS-PosResourceSet in addition to the up to four pathloss estimates that the UE maintains per serving cell for PUSCH/PUCCH transmissions and for SRS transmissions configured by SRS-Resource-

ETSI


--- Page 41  ---


3GPP TS 38.213 version 17.1.0 Release 17
40
ETSI TS 138213 V17.1.0 (2022-05)
7.4 Physical random access channel

A UE determines a transmission power for a physical random access channel (PRACH), \( P_{\text {PRACH }, b, f, c}(i) \), on active UL BWP \( b \) of carrier \( f \) of serving cell \( C \) based on DL RS for serving cell \( C \) in transmission occasion \( i \) as
\[
P_{\text {PRACHh }, f, c}(i)=\min \left\{P_{\text {CMAX } f, c}(i), P_{\text {PRACHarget } f, c}+P L_{b, f c}\right\}[\mathrm{dBm}]
\]
where \( P_{\text {CMAX, } f c}(i) \) is the UE configured maximum output power defined in [8-1, TS 38.101-1], [8-2, TS 38.101-2] and [8-3, TS 38.101-3] for carrier \( f \) of serving cell \( \mathcal{C} \) within transmission occasion \( i, P_{\text {PRACH, largel, } 46} \) is the PRACH target reception power PREAMBLE_RECEIVED_TARGET_POWER provided by higher layers [11, TS 38.321] for the active UL BWP \( b \) of carrier \( f \) of serving cell \( C \), and \( P L_{b, f, c} \) is a pathloss for the active UL BWP \( b \) of carrier \( f \) based on the DL RS associated with the PRACH transmission on the active DL BWP of serving cell \( C \) and calculated by the UE in dB as referenceSignalPower - higher layer filtered RSRP in dBm , where RSRP is defined in [7, TS 38.215] and the higher layer filter configuration is defined in [12, TS 38.331]. If the active DL BWP is the initial DL BWP and for SS/PBCH block and CORESET multiplexing pattern 2 or 3, as described in clause 13, the UE determines \( P L_{b, f, c} \) based on the SS/PBCH block associated with the PRACH transmission.

If a PRACH transmission from a UE is not in response to a detection of a PDCCH order by the UE, or is in response to a detection of a PDCCH order by the UE that triggers a contention based random access procedure, or is associated with a link recovery procedure where a corresponding index \( q_{\text {new }} \) is associated with a SS/PBCH block, as described in clause 6, referenceSignalPower is provided by ss-PBCH-BlockPower.

If a PRACH transmission from a UE is in response to a detection of a PDCCH order by the UE that triggers a contention-free random access procedure and depending on the DL RS that the DM-RS of the PDCCH order is quasicollocated with as described in clause 10.1, referenceSignalPower is provided by ss-PBCH-BlockPower or, if the UE is configured resources for a periodic CSI-RS reception or the PRACH transmission is associated with a link recovery procedure where a corresponding index \( q_{\text {new }} \) is associated with a periodic CSI-RS configuration as described in clause 6, referenceSignalPower is obtained by ss-PBCH-BlockPower and powerControlOffsetSS where powerControlOffsetSS provides an offset of CSI-RS transmission power relative to SS/PBCH block transmission power [6, TS 38.214]. If powerControlOffsetSS is not provided to the UE, the UE assumes an offset of 0 dB . If the active TCI state for the PDCCH that provides the PDCCH order includes two RS, the UE expects that one RS is configured with qcl-Type set to 'typeD' and the UE uses the one RS when applying a value provided by power ControlOffsetSS.

If within a random access response window, as described in clause 8.2, the UE does not receive a random access response that contains a preamble identifier corresponding to the preamble sequence transmitted by the UE, the UE determines a transmission power for a subsequent PRACH transmission, if any, as described in [11, TS 38.321].

If prior to a PRACH retransmission, a UE changes the spatial domain transmission filter, Layer 1 notifies higher layers to suspend the power ramping counter as described in [11, TS 38.321].

If due to power allocation to PUSCH/PUCCH/PRACH/SRS transmissions as described in clause 7.5 , or due to power allocation in EN-DC or NE-DC or NR-DC operation, or due to slot format determination as described in clause 11.1, or due to the PUSCH/PUCCH/PRACH/SRS transmission occasions are in the same slot or the gap between a PRACH transmission and PUSCH/PUCCH/SRS transmission is small as described in clause 8.1, the UE does not transmit a PRACH in a transmission occasion, Layer 1 notifies higher layers to suspend the corresponding power ramping counter. If due to power allocation to PUSCH/PUCCH/PRACH/SRS transmissions as described in clause 7.5 , or due to power allocation in EN-DC or NE-DC or NR-DC operation, the UE transmits a PRACH with reduced power in a transmission occasion, Layer 1 may notify higher layers to suspend the corresponding power ramping counter.
7.5 Prioritizations for transmission power reductions

For single cell operation with two uplink carriers or for operation with carrier aggregation, if a total UE transmit power for PUSCH or PUCCH or PRACH or SRS transmissions on serving cells in a frequency range in a respective transmission occasion \( i \) would exceed \( \hat{P}_{\text {CMAX }}(i) \), where \( \hat{P}_{\text {CMAX }}(i) \) is the linear value of \( P_{C M A X}(i) \) in transmission occasion \( i \) as defined in [8-1, TS 38.101-1] for FR1 and [8-2, TS38.101-2] for FR2, the UE allocates power to PUSCH/PUCCH/PRACH/SRS transmissions according to the following priority order (in descending order) so that the

ETSI


--- Page 42  ---


3GPP TS 38.213 version 17.1.0 Release 17
41
ETSI TS 138213 V17.1.0 (2022-05)

total UE transmit power for transmissions on serving cells in the frequency range is smaller than or equal to \( \hat{P}_{\text {cmax }} \) ( \( i \) ) for that frequency range in every symbol of transmission occasion \( i \). When determining a total transmit power for serving cells in a frequency range in a symbol of transmission occasion \( i \), the UE does not include power for transmissions starting after the symbol of transmission occasion \( i \). The total UE transmit power in a symbol of a slot is defined as the sum of the linear values of UE transmit powers for PUSCH, PUCCH, PRACH, and SRS in the symbol of the slot.
- PRACH transmission on the PCell
- PUCCH or PUSCH transmissions with higher priority index according to clause 9
- For PUCCH or PUSCH transmissions with same priority index
- PUCCH transmission with HARQ-ACK information, and/or SR, and/or LRR, or PUSCH transmission with HARQ-ACK information
- PUCCH transmission with CSI or PUSCH transmission with CSI
- PUSCH transmission without HARQ-ACK information or CSI and, for Type-2 random access procedure, PUSCH transmission on the PCell
- SRS transmission, with aperiodic SRS having higher priority than semi-persistent and/or periodic SRS, or PRACH transmission on a serving cell other than the PCell

In case of same priority order and for operation with carrier aggregation, the UE prioritizes power allocation for transmissions on the primary cell of the MCG or the SCG over transmissions on a secondary cell. In case of same priority order and for operation with two UL carriers, the UE prioritizes power allocation for transmissions on the carrier where the UE is configured to transmit PUCCH. If PUCCH is not configured for any of the two UL carriers, the UE prioritizes power allocation for transmissions on the non-supplementary UL carrier.
7.6 Dual connectivity
7.6.1 EN-DC

If a UE is configured with a MCG using E-UTRA radio access and with a SCG using NR radio access, the UE is configured a maximum power \( P_{\mathrm{LTe}} \) for transmissions on the MCG by \( p \)-MaxEUTRA and a maximum power \( P_{\mathrm{NR}} \) for transmissions in FR1 on the SCG by \( p-N R-F R I \).

The UE determines a transmission power for the MCG as described in [13, TS 36.213] using \( P_{\text {LTE }} \) as the maximum transmission power. The UE determines transmission power for the SCG in FR1 as described in clauses 7.1 through 7.5 using \( P_{\mathrm{NR}} \) as the maximum transmission power. The UE determines transmission power for the SCG in FR2 as described in clauses 7.1 through 7.5 .

A UE does not expect to be configured for operation with shortened TTI and/or processing time [13, TS 36.213] on a cell that is included in an EN-DC configuration.

If a UE is configured with \( \hat{P}_{\text {LTE }}+\hat{P}_{\text {NR }}>\hat{P}_{\text {Total }}^{\text {EN-DC }} \), where \( \hat{P}_{\text {LTE }} \) is the linear value of \( P_{\text {LTE }}, \hat{P}_{\text {NR }} \) is the linear value of \( P_{\text {NR }} \), and \( \hat{P}_{\text {Total }}^{\mathrm{EN}-\mathrm{DC}} \) is the linear value of a configured maximum transmission power for EN-DC operation as defined in [8-3, TS 38.101-3] for FR1, the UE determines a transmission power for the SCG as follows.
- If the UE is configured with reference TDD configuration for E-UTRA (by \( t d m \)-Pattern Config or by \( t d m \) PatternConfig2 in [13, TS 36.213])
- If the UE does not indicate a capability for dynamic power sharing between E-UTRA and NR for EN-DC, the UE does not transmit in a slot on the SCG in FR1 when a corresponding subframe on the MCG is an UL subframe in the reference TDD configuration.
- If the UE indicates a capability for dynamic power sharing between E-UTRA and NR for EN-DC, and does not indicate a capability tdm-restrictionDualTX-FDD-endc-r16 in [16, TS 38.306], and is configured with tdm-PatternConfig2, the UE does not transmit on the SCG in FR1 when the UE has overlapped transmission on a subframe on the MCG.

ETSI


--- Page 43  ---


3GPP TS 38.213 version 17.1.0 Release 17
42
ETSI TS 138213 V17.1.0 (2022-05)
- If the UE indicates a capability for dynamic power sharing between E-UTRA and NR for EN-DC and
- if UE transmission(s) in subframe \( i_{1} \) of the MCG overlap in time with UE transmission(s) in slot \( i_{2} \) of the SCG in FR1, and
- if \( \hat{P}_{\text {MCG }}\left(i_{1}\right)+\hat{P}_{\text {SCG }}\left(i_{2}\right)>\hat{P}_{\text {Total }}^{\mathrm{EN}-\mathrm{DC}} \) in any portion of slot \( i_{2} \) of the SCG,
the UE reduces transmission power in any portion of slot \( i_{2} \) of the SCG so that \( \hat{P}_{\text {MCG }}\left(i_{1}\right)+\hat{P}_{\text {SCG }}\left(i_{2}\right) \leq \hat{P}_{\text {Total }}^{\text {EN-DC }} \) in any portion of slot \( i_{2} \), where \( \hat{P}_{\text {MCG }}\left(i_{1}\right) \) and \( \hat{P}_{\text {SCG }}\left(i_{2}\right) \) are the linear values of the total UE transmission powers in subframe \( i_{1} \) of the MCG and in slot \( i_{2} \) of the SCG in FR1, respectively. The UE is not required to transmit in any portion of slot \( i_{2} \) of the SCG if \( \hat{P}_{\text {SCG }}\left(i_{2}\right) \) would need to be reduced by more than the value provided by \( X_{\text {SCALE }} \) in order for \( \hat{P}_{\text {MCG }}\left(i_{1}\right)+\hat{P}_{\text {SCG }}\left(i_{2}\right) \leq \hat{P}_{\text {Total }}^{\mathrm{EM}-\mathrm{DC}} \) in any portion of slot \( i_{2} \) of the SCG. The UE is required to transmit in slot \( i_{2} \) of the SCG if \( \hat{P}_{\text {SCG }}\left(i_{2}\right) \) would not need to be reduced by more than the value provided by \( X_{\text {SCALE }} \) in order for \( \hat{P}_{\text {MCG }}\left(i_{1}\right)+\hat{P}_{\text {SCG }}\left(i_{2}\right) \leq \hat{P}_{\text {Total }}^{\text {EN-DC }} \) in all portions of slot \( i_{2} \).
- If the UE does not indicate a capability for dynamic power sharing between E-UTRA and NR for EN-DC, the UE expects to be configured with reference TDD configuration for E-UTRA by tdm-PatternConfig in [13, TS 36.213].
7.6.1A NE-DC

If a UE is configured with an MCG using NR radio access and with a SCG using E-UTRA radio access, the UE is configured a maximum power \( P_{\mathrm{NR}} \) for transmissions in FR1 on the MCG by \( p-N R-F R I \) and a maximum power \( P_{\mathrm{LTE}} \) for transmissions on the SCG by p-MaxEUTRA.

The UE determines transmission power for the MCG in FR1 as described in clauses 7.1 through 7.5 using \( P_{\mathrm{NR}} \) as the maximum transmission power for \( P_{\mathrm{CMAX}} \leq P_{\mathrm{NR}} \). The UE determines transmission power for the MCG in FR2 as described in clauses 7.1 through 7.5.

If the UE is not provided tdd-UL-DL-ConfigurationCommon for the MCG, the UE determines a transmission power for the SCG as described in [13, TS 36.213] using \( P_{\text {LTE }} \) as the maximum transmission power.

If at least one symbol of slot \( i_{1} \) of the MCG that is indicated as uplink or flexible by tdd-UL-DL-ConfigurationCommon or tdd-UL-DL-ConfigurationDedicated overlaps with subframe \( i_{2} \) of the SCG
- for subframe \( i_{2} \), the UE determines a transmission power for the SCG as described in [13, TS 36.213] using \( P_{\text {LTE }} \) as the maximum transmission power
otherwise
- the UE determines a transmission power for the SCG as described in [13, TS 36.213] without considering \( P_{\text {LTE }} \) as the maximum transmission power

If a UE is configured with \( \hat{P}_{\text {LTE }}+\hat{P}_{\text {NR }}>\hat{P}_{\text {Total }}^{\text {NE-DC }} \), where \( \hat{P}_{\text {LTE }} \) is the linear value of \( P_{\text {LTE }}, \hat{P}_{\text {NR }} \) is the linear value of \( P_{\mathrm{NR}} \), and \( \hat{P}_{\mathrm{Tolal}}^{\mathrm{NE}-\mathrm{DC}} \) is the linear value of a configured maximum transmission power for NE-DC operation as defined in [8-3, TS 38.101-3] for FR1, the UE determines a transmission power for the MCG as follows
- If the UE is configured with reference TDD configuration for E-UTRA (by tdm-PatternConfigNE-DC-r 15 in [13, TS 36.213])
- If the UE does not indicate a capability for dynamic power sharing between E-UTRA and NR for NE-DC, the UE does not expect to transmit in a slot on the MCG in FR1 when a corresponding subframe on the SCG is an UL subframe in the reference TDD configuration.
- If the UE indicates a capability for dynamic power sharing between E-UTRA and NR for NE-DC and
- if the UE transmission(s) in slot \( i_{1} \) of the MCG in FR1 overlap in time with UE transmission(s) in subframe \( i_{2} \) of the SCG, and

ETSI


--- Page 44  ---


3GPP TS 38.213 version 17.1.0 Release 17
43
ETSI TS 138213 V17.1.0 (2022-05)
- if \( \hat{P}_{\mathrm{MCG}}\left(i_{1}\right)+\hat{P}_{\mathrm{SCG}}\left(i_{2}\right)>\hat{P}_{\text {Total }}^{\text {NE-DC }} \) in any portion of slot \( i_{1} \) of the MCG,
the UE reduces transmission power in any portion of slot \( i_{1} \) of the MCG so that \( \hat{P}_{\text {MCG }}\left(i_{1}\right)+\hat{P}_{\text {SCG }}\left(i_{2}\right) \leq \hat{P}_{\text {Total }}^{\text {NE-DC }} \) in all portions of slot \( i_{1} \), where \( \hat{P}_{\text {MCG }}\left(i_{1}\right) \) and \( \hat{P}_{\text {SCG }}\left(i_{2}\right) \) are the linear values of the total UE transmission powers in slot \( i_{1} \) of the MCG in FR1 and in subframe \( i_{2} \) of the SCG, respectively.
- If the UE does not indicate a capability for dynamic power sharing between E-UTRA and NR for NE-DC, the UE expects to be configured with reference TDD configuration for E-UTRA (by tdm-PatternConfigNE-DC-r 15 in [13, TS 36.213]).
7.6.2 NR-DC

If a UE is configured with an MCG using NR radio access in FR1 or in FR2 and with a SCG using NR radio access in FR2 or in FR1, respectively, the UE performs transmission power control independently per cell group as described in clauses 7.1 through 7.5 .

If a UE is configured with an MCG and a SCG using NR radio access in FR1 and/or in FR2, the UE is configured a maximum power \( P_{\mathrm{MCG}} \) for transmissions on the MCG by \( p-N R-F R 1 \) and/or by \( p-N R-F R 2 \) and a maximum power \( P_{\mathrm{SCG}} \) for transmissions on the SCG by \( p-N R-F R I \) and/or by \( p-N R-F R 2 \) and with an inter-CG power sharing mode by nrdc-PCmode-FR1 for FR1 and/or by nrdc-PCmode-FR2 for FR2. The UE determines a transmission power on the MCG and a transmission power on the SCG per frequency range.

If a UE is provided semi-static-model for nrdc-PCmode-FRI or for nrdc-PCmode-FR2, or semi-static-mode2 for nrdc-PCmode-FRI or for nrdc-PCmode-FR2, the UE does not expect \( P_{\text {MCG }} \) and \( P_{\text {SCG }} \) to be configured such that \( \hat{P}_{\text {MCG }}+ \widehat{P}_{\text {SCG }}>\widehat{P}_{\text {Total }}^{N R-D C} \), where \( \widehat{P}_{\text {MCG }} \) is the linear value of \( P_{\text {MCG }}, \widehat{P}_{S C G} \) is the linear value of \( P_{\text {SCG }} \), and \( \widehat{P}_{\text {Total }}^{N R-D C} \) is the linear value of a configured maximum transmission power for NR-DC operation in FR1 or FR2 as defined in [8-3, TS 38.101-3].

If a UE is provided semi-static-model for nrdc-PCmode-FR1 or for nadc-PCmode-FR2, the UE determines a transmission power for the MCG or for the SCG as described in clauses 7.1 through 7.5 using \( P_{\text {MCG }} \) or \( P_{\text {SCG }} \) as the maximum transmission power, respectively.

If a UE is provided semi-static-mode2 for nrdc-PCmode-FR1 or for nrdc-PCmode-FR2
- if the UE is not provided tdd-UL-DL-ConfigurationCommon for the MCG or SCG, the UE determines a transmission power for the MCG or for the SCG as described in clauses 7.1 through 7.5 using \( P_{\text {MCG }} \) or \( P_{\text {SCG }} \) as the maximum transmission power, respectively
- if at least one symbol of slot \( i_{1} \) of the MCG or of the SCG that is indicated as uplink or flexible to a UE by tdd-UL-DL-ConfigurationCommon and tdd-UL-DL-ConfigurationDedicated, if provided, overlaps with a symbol for any ongoing transmission overlapping with slot \( i_{2} \) of the SCG or of the MCG, respectively, the UE determines a power for the transmission on the SCG or the MCG overlapping with slot \( i_{2} \) as described in clauses 7.1 through 7.5 using \( P_{\text {SCG }} \) or \( P_{\text {MCG }} \), respectively, as the maximum transmission power
- otherwise, the UE determines a power for the transmission on SCG or the MCG overlapping with slot \( i_{2} \), as described in [8-3, TS 38.101-3] and in clauses 7.1 through 7.5 without considering \( P_{\text {SCG }} \) or \( P_{\text {MCG }} \) respectively

The UE expects to be provided semi-static-mode2 for nrdc-PCmode-FRI or for nadc-PCmode-FR2 only for synchronous NR-DC operation [10, TS 38.133].

If a UE
- is provided dynamic for nrdc-PCmode-FRI or for nrdc-PCmode-FR2, and
- indicates a capability to support dynamic power sharing for intra-FR NR DC,
the UE determines a maximum transmission power on the SCG at a first symbol of a transmission occasion on the SCG by determining transmissions on the MCG that
- are scheduled by DCI formats in PDCCH receptions with a last symbol that is earlier by at least \( T_{\text {off set }} \) from the first symbol of the transmission occasion on the SCG, or are configured by higher layers, and
- overlap with the transmission occasion on the SCG

ETSI


--- Page 45  ---


3GPP TS 38.213 version 17.1.0 Release 17
44
ETSI TS 138213 V17.1.0 (2022-05)

the maximum transmission power on the SCG is determined as
- \( \min \left(\widehat{P}_{\text {SCG }}, \widehat{P}_{\text {Total }}^{\text {NR-DC }}-\widehat{P}_{\text {MCG }}^{\text {actual }}\right) \), if the UE determines transmissions on the MCG with a \( \widehat{P}_{\text {MCG }}^{\text {actual }} \) total power
- \( \quad \hat{P}_{\text {Total }}^{\text {NR-DC }} \), if the UE does not determine any transmissions on the MCG
where
- \( T_{\text {offset }}=\max \left\{T_{\text {proc }, M C G}^{\max }, T_{\text {proc }, S C G}^{\max }\right\} \),
- \( T_{\text {proc }, M C G}^{\max } \) and \( T_{\text {proc }, S C G}^{\max } \) is the maximum of \( T_{\text {proc }, 2}, T_{\text {proc }, C S I}, T_{\text {proc }, \text { release }}^{\operatorname{mux}}, T_{\text {proc }, 2}^{\operatorname{mux}} \), and \( T_{\text {proc }, C S I}^{\operatorname{mux}} \) based on the configurations on the MCG and the SCG, respectively, when the UE indicates the value of 'long' for the capability,
- \( T_{\text {proc }, \text { MCG }}^{\max } \) and \( T_{\text {proc }, \text { SCG }}^{\max } \) is the maximum of \( T_{\text {proc }, 2}, T_{\text {proc }, \text { release }}^{\operatorname{mux}}, T_{\text {proc }, 2}^{\operatorname{mux}} \) based on the configurations on the MCG and the SCG, respectively, when the UE indicates the value of 'short' for the capability, and
- \( \hat{P}_{\text {MCG }}^{\text {actual }} \) is the total power for the transmissions on the MCG that overlap with the transmission occasion on the SCG where \( \hat{P}_{\text {MCG }}^{\text {actual }} \) is determined based on transmissions configured by higher layers and on transmissions scheduled by DCI formats in PDCCH receptions with a last symbol that is at least \( T_{\text {offset }} \) before the first symbol of the transmission occasion on the SCG.

The UE does not expect to have PUSCH, PUCCH, PRACH, or SRS transmissions on the MCG that
- are scheduled/triggered by DCI formats in PDCCH receptions with a last symbol that is earlier by less than \( T_{\text {offset }} \) from the first symbol of the transmission occasion on the SCG, and
- overlap with the transmission occasion on the SCG

The UE does not expect to receive a positive TPC command value in a DCI format \( 2 \_2 \) or a DCI format \( 2 \_3 \) in a PDCCH reception with a last symbol that is less than \( T_{\text {offset }} \) before the first symbol of the transmission occasion on the SCG, if the transmission on the MCG overlaps with the transmission occasion on the SCG.

The UE is not required to apply a TPC command the UE receives in a DCI format \( 2 \_2 \) or a DCI format \( 2 \_3 \) in a PDCCH reception with a last symbol that is less than \( T_{\text {offset }} \) before the first symbol of the transmission occasion on the SCG, if the transmission on the MCG overlaps with the transmission occasion on the SCG.
7.7 Power headroom report

The types of UE power headroom reports are the following. A Type 1 UE power headroom \( P H \) that is valid for PUSCH transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \). A Type 3 UE power headroom PH that is valid for SRS transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \).

A UE determines whether a power headroom report for an activated serving cell [11, TS 38.321] is based on an actual transmission or a reference format based on the higher layer signalling of configured grant and periodic/semi-persistent sounding reference signal transmissions and downlink control information the UE received until and including the PDCCH monitoring occasion where the UE detects the first DCI format scheduling an initial transmission of a transport block since a power headroom report was triggered if the power headroom report is reported on a PUSCH triggered by the first DCI format. Otherwise, a UE determines whether a power headroom report is based on an actual transmission or a reference format based on the higher layer signalling of configured grant and periodic/semi-persistent sounding reference signal transmissions and downlink control information the UE received until the first uplink symbol of a configured PUSCH transmission minus \( T_{\text {proc. } 2}=T_{\text {proc. } 2} \) where \( T_{\text {proc. } 2} \) is determined according to [6, TS 38.214] assuming \( d_{2, l}=1, d_{2,2}=0 \), and with \( \mu_{D L} \) corresponding to the subcarrier spacing of the active downlink BWP of the scheduling cell for a configured grant if the power headroom report is reported on the PUSCH using the configured grant.

If a UE
- is configured with two UL carriers for a serving cell, and
- determines a Type 1 power headroom report and a Type 3 power headroom report for the serving cell
the UE

ETSI


--- Page 46  ---


3GPP TS 38.213 version 17.1.0 Release 17
45
ETSI TS 138213 V17.1.0 (2022-05)
- provides the Type 1 power headroom report if both the Type 1 and Type 3 power headroom reports are based on respective actual transmissions or on respective reference transmissions
- provides the power headroom report that is based on a respective actual transmission if either the Type 1 report or the Type 3 report is based on a respective reference transmission

If a UE is configured with a SCG and if \( p h r-M o d e O t h e r C G \) for a CG indicates 'virtual' then, for power headroom reports transmitted on the CG, the UE computes \( P H \) assuming that the UE does not transmit PUSCH/PUCCH on any serving cell of the other CG. For NR-DC when both the MCG and the SCG operate either in FR1 or in FR2 and for a power headroom report transmitted on the MCG or the SCG, the UE computes \( P H \) assuming that the UE does not transmit PUSCH/PUCCH on any serving cell of the SCG or the MCG, respectively.

If the UE is configured with a SCG,
- For computing power headroom for cells belonging to MCG, the term 'serving cell' in this clause refers to serving cell belonging to the MCG.
- For computing power headroom for cells belonging to SCG, the term 'serving cell' in this clause refers to serving cell belonging to the SCG. The term 'primary cell' in this clause refers to the PSCell of the SCG.

If the UE is configured with a PUCCH-SCell,
- For computing power headroom for cells belonging to primary PUCCH group, the term 'serving cell' in this clause refers to serving cell belonging to the primary PUCCH group.
- For computing power headroom for cells belonging to secondary PUCCH group, the term 'serving cell' in this clause refers to serving cell belonging to the secondary PUCCH group. The term 'primary cell' in this clause refers to the PUCCH-SCell of the secondary PUCCH group.

For a UE configured with EN-DC/NE-DC and capable of dynamic power sharing, if E-UTRA Dual Connectivity PHR [14, TS 36.321] is triggered and,
- if the duration of NR slot on active UL BWP is different from that of E-UTRA subframe carrying the Dual Connectivity PHR, the UE provides power headroom of the first NR slot that fully overlaps with the E-UTRA subframe;
- if the duration of NR slot on active UL BWP is the same as that of E-UTRA subframe carrying the Dual Connectivity PHR for asynchronous EN-DC/NE-DC [10, TS 38.133], the UE provides power headroom of the first NR slot that overlaps with the E-UTRA subframe.
7.7.1 Type 1 PH report

If a UE determines that a Type 1 power headroom report for an activated serving cell is based on an actual PUSCH transmission then, for PUSCH transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \), the UE computes the Type 1 power headroom report as
\[
\begin{array}{c}
P H_{\text {lypel }, b, f, c}\left(i, j, q_{d}, l\right)=P_{\text {CMAX }, f, c}(i)-\left\{P_{\text {o_PUSCH }_{1}, f, c}(j)+10 \log _{10}\left(2^{\mu} \cdot M_{\text {RB }, b, f, c}^{\text {PUSCH }}(i)\right)+\alpha_{b, f, c}(j) \cdot P L_{b, f, c}\left(q_{d}\right)+\Delta_{\text {TF }, b, f, c}(i)+f_{b, f, c}(i, l)\right\} \\
{[\mathrm{dB}]}
\end{array}
\]
where \( P_{\mathrm{CMAX}_{1} f_{1} c}(i), P_{0_{-} \mathrm{PUSCH}, b_{1} f, c}(j), M_{\mathrm{RB}, b_{1} f, c}^{\mathrm{PUSCH}}(i), \alpha_{b_{1} f, c}(j), P L_{b_{1} f, c}\left(q_{d}\right), \Delta_{\mathrm{TF}, b_{1} f, c}(i) \) and \( f_{b_{1} f, c}(i, l) \) are defined in clause 7.1.1.

If a UE is configured with multiple cells for PUSCH transmissions, where a SCS configuration \( \mu_{1} \) on active UL BWP \( b_{1} \) of carrier \( f_{1} \) of serving cell \( c_{1} \) is smaller than a SCS configuration \( \mu_{2} \) on active UL BWP \( b_{2} \) of carrier \( f_{2} \) of serving cell \( c_{2} \), and if the UE provides a Type 1 power headroom report in a PUSCH transmission in a slot on active UL BWP \( b_{1} \) that overlaps with multiple slots on active UL BWP \( b_{2} \), the UE provides a Type 1 power headroom report for the first PUSCH, if any, on the first slot of the multiple slots on active UL BWP \( b_{2} \) that fully overlaps with the slot on active UL BWP \( b_{1} \) - If a UE is configured with multiple cells for PUSCH transmissions, where a same SCS configuration on active UL BWP \( b_{1} \) of carrier \( f_{1} \) of serving cell \( c_{1} \) and active UL BWP \( b_{2} \) of carrier \( f_{2} \) of serving cell \( c_{2} \), and if the UE provides a Type 1 power headroom report in a PUSCH transmission in a slot on active UL BWP \( b_{1} \), the UE provides a Type 1 power headroom report for the first PUSCH, if any, on the slot on active UL BWP \( b_{2} \) that overlaps with the slot on active UL BWP \( b_{1} \).

ETSI


--- Page 47  ---


3GPP TS 38.213 version 17.1.0 Release 17
46
ETSI TS 138213 V17.1.0 (2022-05)

If a UE is configured with multiple cells for PUSCH transmissions and provides a Type 1 power headroom report in a PUSCH transmission with PUSCH repetition Type B having a nominal repetition that spans multiple slots on active UL BWP \( b_{1} \) and overlaps with one or more slots on active UL BWP \( b_{2} \), the UE provides a Type 1 power headroom report for the first PUSCH, if any, on the first slot of the one or more slots on active UL BWP \( b_{2} \) that overlaps with the multiple slots of the nominal repetition on active UL BWP \( b_{1} \).

For a UE configured with EN-DC/NE-DC and capable of dynamic power sharing, if E-UTRA Dual Connectivity PHR [14, TS 36.321] is triggered, the UE provides power headroom of the first PUSCH, if any, on the determined NR slot as described in clause 7.7.

If a UE is configured with multiple cells for PUSCH transmissions, the UE does not consider for computation of a Type 1 power headroom report in a first PUSCH transmission that includes an initial transmission of transport block on active UL BWP \( b_{1} \) of carrier \( f_{1} \) of serving cell \( c_{1} \), a second PUSCH transmission on active UL BWP \( b_{2} \) of carrier \( f_{2} \) of serving cell \( c_{2} \) that overlaps with the first PUSCH transmission if
- the second PUSCH transmission is scheduled by a DCI format in a PDCCH received in a second PDCCH monitoring occasion, and
- the second PDCCH monitoring occasion is after a first PDCCH monitoring occasion where the UE detects the earliest DCI format scheduling an initial transmission of a transport block after a power headroom report was triggered
or
- the second PUSCH transmission is after the first uplink symbol of the first PUSCH transmission minus \( T_{\text {proc. } 2}^{\prime}=T_{\text {proc. } 2} \) where \( T_{\text {proc. } 2} \) is determined according to \( \left[6\right. \), TS 38.214] assuming \( d_{2,1}=1, d_{2,2}=0 \), and with \( \mu_{D L} \) corresponding to the subcarrier spacing of the active downlink BWP of the scheduling cell for a configured grant if the first PUSCH transmission is on a configured grant after a power headroom report was triggered.

If the UE determines that a Type 1 power headroom report for an activated serving cell is based on a reference PUSCH transmission then, for PUSCH transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \), the UE computes the Type 1 power headroom report as
\[
P H_{\text {type } 1 b, f, c}\left(i, j, q_{d}, l\right)=\widetilde{P}_{\mathrm{CMAX}, f, c}(i)-\left\{P_{\mathrm{O} \geq \mathrm{PUSCH} b, f, c}(j)+\alpha_{b, f, c}(j) \cdot P L_{b, f, c}\left(q_{d}\right)+f_{b, f, c}(i, l)\right\}
\]
where \( \tilde{P}_{\mathrm{CMAX}, f_{,} c}(i) \) is computed assuming \( \mathrm{MPR}=0 \mathrm{~dB}, \mathrm{~A}-\mathrm{MPR}=0 \mathrm{~dB}, \mathrm{P}-\mathrm{MPR}=0 \mathrm{~dB} . \triangle \mathrm{T}_{\mathrm{C}}=0 \mathrm{~dB} \). MPR, A-MPR, PMPR and \( \Delta \mathrm{T}_{\mathrm{C}} \) are defined in [8-1, TS 38.101-1], [8-2, TS38.101-2] and [8-3, TS 38.101-3]. The remaining parameters are defined in clause 7.1.1 where \( P_{0 \_ \text {PUSCH }, b, f, c}(j) \) and \( \alpha_{b_{1}, c, c}(j) \) are obtained using \( P_{0 \_ \text {NOMINAL }, \text { PUSCH }, f, c}(0) \) and \( p 0 \) -PUSCH-AlphaSetld \( =0, P L_{b_{1} f_{1} c}\left(q_{d}\right) \) is obtained using pusch-PathlossReferenceRS-Id \( =0 \), and \( l=0 \).

If a UE is configured with two UL carriers for a serving cell and the UE determines a Type 1 power headroom report for the serving cell based on a reference PUSCH transmission, the UE computes a Type 1 power headroom report for the serving cell assuming a reference PUSCH transmission on the UL carrier provided by pusch-Config. If the UE is provided pusch-Config for both UL carriers, the UE computes a Type 1 power headroom report for the serving cell assuming a reference PUSCH transmission on the UL carrier provided by pucch-Config. If pucch-Config is not provided to the UE for any of the two UL carriers, the UE computes a Type 1 power headroom report for the serving cell assuming a reference PUSCH transmission on the non-supplementary UL carrier.

If a UE transmits a PUSCH associated with a RS resource index \( q_{d} \), as described in clause 7.1.1, on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) in slot \( n \) and provides a Type 1 power headroom report for an actual PUSCH repetition associated with the RS resource index \( q_{d} \), the Type 1 power headroom report is for the first PUSCH repetition associated with the RS resource index \( q_{d} \) that overlaps with slot \( n \).

If a UE transmits a PUSCH associated with a first RS resource index \( q_{d} \), as described in clause 7.1.1, on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) in slot \( n \) and is provided twoPHRMode, the UE provides a Type 1 power headroom report for PUSCH repetition associated with a second RS resource index \( q_{d} \), as described in clause 7.1.1, where
- if the UE provides a Type 1 power headroom report for an actual PUSCH repetition associated with the first RS resource index \( q_{d} \),
- if the UE transmits PUSCH repetitions associated with the second RS resource index \( q_{d} \) in slot \( n \), the UE provides a Type 1 power headroom report for a first actual PUSCH repetition associated with the second RS resource index \( q_{d} \) that overlaps with slot \( n \)

ETSI


--- Page 48  ---


3GPP TS 38.213 version 17.1.0 Release 17
47
ETSI TS 138213 V17.1.0 (2022-05)
- otherwise, the UE provides a Type 1 power headroom report for a reference PUSCH transmission associated with the second RS resource index \( q_{d} \)
- otherwise, if the UE provides a Type 1 power headroom report for a reference PUSCH transmission associated with the first RS resource index \( q_{d} \), the UE provides a Type 1 power headroom report for a reference PUSCH transmission associated with the second RS resource index \( q_{d} \)
7.7.2 Type 2 PH report

This clause is reserved.
7.7.3 Type 3 PH report

If a UE determines that a Type 3 power headroom report for an activated serving cell is based on an actual SRS transmission then, for SRS transmission occasion \( i \) on active UL BWP \( b \) of carrier \( f \) of serving cell \( c \) and if the UE is not configured for PUSCH transmissions on carrier \( f \) of serving cell \( c \) and the resource for the SRS transmission is provided by SRS-Resource, the UE computes a Type 3 power headroom report as
\[
\begin{array}{c}
P H_{\mathrm{type} 3, b, f, c}\left(i, q_{s}\right)=P_{\mathrm{CMAX}, f, c}(i)-\left\{P_{\mathrm{O}_{-} \mathrm{SRS}, b, f, c}\left(q_{s}\right)+10 \log _{10}\left(2^{\mu} \cdot M_{\mathrm{SRS}, b, f, c}(i)\right)+\alpha_{\mathrm{SRS}, b, f, c}\left(q_{s}\right) \cdot P L_{b, f, c}\left(q_{d}\right)+h_{b, f, c}(i)\right\} \\
{[\mathrm{dB}]}
\end{array}
\]
where \( P_{\text {CMAX, }, c}(i), P_{\text {osRs, }_{1} b, f, c}\left(q_{s}\right), M_{\text {SRS, } b, f, c}(i), \alpha_{\text {SRS, } b, f, c}\left(q_{s}\right), P L_{b, f, c}\left(q_{d}\right) \) and \( h_{b, f, c}(i) \) are defined in clause 7.3.1 with corresponding values provided by SRS-ResourceSet.

If the UE determines that a Type 3 power headroom report for an activated serving cell is based on a reference SRS transmission then, for SRS transmission occasion \( i \) on UL BWP \( b \) of carrier \( f \) of serving cell \( c \), and if the UE is not configured for PUSCH transmissions on UL BWP \( b \) of carrier \( f \) of serving cell \( c \) and a resource for the reference SRS transmission is provided by SRS-Resource, the UE computes a Type 3 power headroom report as
\[
P H_{\text {type } 3, b, f, c}\left(i, q_{s}\right)=\widetilde{P}_{\mathrm{CMAX}_{s}, c}(i)-\left\{P_{\mathrm{O}_{-} \mathrm{SRSS}, b, f, c}\left(q_{s}\right)+\alpha_{\mathrm{SRS}, b, f, c}\left(q_{s}\right) \cdot P L_{b, f, c}\left(q_{d}\right)+h_{b, f, c}(i)\right\} \quad[\mathrm{dB}]
\]
where \( q_{s} \) is an SRS resource set corresponding to SRS-ResourceSetld \( =0 \) for UL BWP \( b \) and \( P_{0 \_ \text {SRSb, }, c}\left(q_{s}\right) \), \( \alpha_{\mathrm{SRS}, f, c}\left(q_{s}\right), P L_{b, f, c}\left(q_{d}\right) \) and \( h_{b, f, c}(i) \) are defined in clause 7.3 .1 with corresponding values obtained from \( S R S \) ResourceSetld \( =0 \) for UL BWP \( b . \widetilde{P}_{\mathrm{CMAX}, f, c}(i) \) is computed assuming \( \mathrm{MPR}=0 \mathrm{~dB}, \mathrm{~A}-\mathrm{MPR}=0 \mathrm{~dB}, \mathrm{P}-\mathrm{MPR}=0 \mathrm{~dB} \) and \( \Delta \mathrm{T}_{\mathrm{C}}=0 \mathrm{~dB} \). MPR, A-MPR, P-MPR and \( \Delta \mathrm{T}_{\mathrm{C}} \) are defined in [8-1, TS 38.101-1], [8-2, TS38.101-2] and [8-3, TS 38.101-3].

If a UE is configured with two UL carriers for a serving cell and the UE determines a Type 3 power headroom report for the serving cell based on a reference SRS transmission and a resource for the reference SRS is provided by SRSResource, the UE computes a Type 3 power headroom report for the serving cell assuming a reference SRS transmission on the UL carrier provided by pucch-Config. If pucch-Config is not provided to the UE for any of the two UL carriers, the UE computes a Type 3 power headroom report for the serving cell assuming a reference SRS transmission on the non-supplementary UL carrier.

8 Random access procedure
Prior to initiation of the physical random access procedure, Layer 1 receives from higher layers a set of SS/PBCH block indexes and provides to higher layers a corresponding set of RSRP measurements.

Prior to initiation of the physical random access procedure, Layer 1 may receive from higher layers an indication to perform a Type-1 random access procedure, as described in clauses 8.1 through 8.4, or a Type-2 random access procedure as described in clauses 8.1 through 8.2A.

Prior to initiation of the physical random access procedure, Layer 1 receives the following information from the higher layers:

ETSI


--- Page 49  ---


3GPP TS 38.213 version 17.1.0 Release 17
48
ETSI TS 138213 V17.1.0 (2022-05)
- Configuration of physical random access channel (PRACH) transmission parameters (PRACH preamble format, time resources, and frequency resources for PRACH transmission).
- Parameters for determining the root sequences and their cyclic shifts in the PRACH preamble sequence set (index to logical root sequence table, cyclic shift ( \( N_{\mathrm{CS}} \) ), and set type (unrestricted, restricted set A , or restricted set B)).

From the physical layer perspective, the Type-1 L1 random access procedure includes the transmission of random access preamble (Msg1) in a PRACH, random access response (RAR) message with a PDCCH/PDSCH (Msg2), and when applicable, the transmission of a PUSCH scheduled by a RAR UL grant, and PDSCH for contention resolution.

From the physical layer perspective, the Type-2 L1 random access procedure includes the transmission of random access preamble in a PRACH and of a PUSCH (MsgA) and the reception of a RAR message with a PDCCH/PDSCH (MsgB), and when applicable, the transmission of a PUSCH scheduled by a fallback RAR UL grant, and PDSCH for contention resolution.

If a random access procedure is initiated by a PDCCH order to the UE, a PRACH transmission is with a same SCS as a PRACH transmission initiated by higher layers.

If a UE is configured with two UL carriers for a serving cell and the UE detects a PDCCH order, the UE uses the UL/SUL indicator field value from the detected PDCCH order to determine the UL carrier for the corresponding PRACH transmission.
8.1 Random access preamble

Physical random access procedure is triggered upon request of a PRACH transmission by higher layers or by a PDCCH order. A configuration by higher layers for a PRACH transmission includes the following:
- A configuration for PRACH transmission [4, TS 38.211].
- A preamble index, a preamble \( \mathrm{SCS}, P_{\text {PRACH,target, a corresponding RA-RNTI, and a PRACH resource. }} \)

A PRACH is transmitted using the selected PRACH format with transmission power \( P_{\mathrm{PRACH}, b, f, c}(i) \), as described in clause 7.4 , on the indicated PRACH resource.

For Type-1 random access procedure, a UE is provided a number \( N \) of SS/PBCH block indexes associated with one PRACH occasion and a number \( R \) of contention based preambles per SS/PBCH block index per valid PRACH occasion by ssb-perRACH-OccasionAndCB-PreamblesPerSSB.

For Type-2 random access procedure with common configuration of PRACH occasions with Type-1 random access procedure, a UE is provided a number \( N \) of SS/PBCH block indexes associated with one PRACH occasion by ssb-perRACH-OccasionAndCB-PreamblesPerSSB and a number \( Q \) of contention based preambles per SS/PBCH block index per valid PRACH occasion by msgA-CB-PreamblesPerSSB-PerSharedRO. The PRACH transmission can be on a subset of PRACH occasions associated with a same SS/PBCH block index within an SSB-RO mapping cycle for a UE provided with a PRACH mask index by msgA-SSB-SharedRO-MaskIndex according to [11, TS 38.321].

For Type-2 random access procedure with separate configuration of PRACH occasions with Type-1 random access procedure, a UE is provided a number \( N \) of SS/PBCH block indexes associated with one PRACH occasion and a number \( R \) of contention based preambles per SS/PBCH block index per valid PRACH occasion by msgA-SSB-PerRACH-OccasionAndCB-PreamblesPerSSB when provided; otherwise, by ssb-perRACH-OccasionAndCBPreamblesPerSSB.

For Type-1 random access procedure, or for Type-2 random access procedure with separate configuration of PRACH occasions from Type 1 random access procedure, if \( N<1 \), one SS/PBCH block index is mapped to \( 1 / N \) consecutive valid PRACH occasions and \( R \) contention based preambles with consecutive indexes associated with the SS/PBCH block index per valid PRACH occasion start from preamble index 0 . If \( N \geq 1, R \) contention based preambles with consecutive indexes associated with SS/PBCH block index \( n, 0 \leq n \leq N-1 \), per valid PRACH occasion start from preamble index \( n \cdot N_{\text {preamble }}^{\text {total }} / N \) where \( N_{\text {preamble }}^{\text {total }} \) is provided by totalNumberOfRA-Preambles for Type-1 random access procedure, or by msgA-TotalNumberOfRA-Preambles for Type-2 random access procedure with separate configuration of PRACH occasions from a Type 1 random access procedure, and is an integer multiple of \( N \).

ETSI


--- Page 50  ---


3GPP TS 38.213 version 17.1.0 Release 17
49
ETSI TS 138213 V17.1.0 (2022-05)

For Type-2 random access procedure with common configuration of PRACH occasions with Type-1 random access procedure, if \( N<1 \), one SS/PBCH block index is mapped to \( 1 / N \) consecutive valid PRACH occasions and \( Q \) contention based preambles with consecutive indexes associated with the SS/PBCH block index per valid PRACH occasion start from preamble index \( R \). If \( N \geq 1, Q \) contention based preambles with consecutive indexes associated with SS/PBCH block index \( n, 0 \leq n \leq N-1 \), per valid PRACH occasion start from preamble index \( n \cdot N_{\text {preamble }}^{\text {total }} / N+R \), where \( N_{\text {preamble }}^{\text {total }} \) is provided by totalNumberOfRA-Preambles for Type-1 random access procedure.

For link recovery, a UE is provided \( N \mathrm{SS} / \mathrm{PBCH} \) block indexes associated with one PRACH occasion by ssb-perRACHOccasion in BeamFailureRecoveryConfig. For a dedicated RACH configuration provided by RACH-ConfigDedicated, if cfra is provided, a UE is provided \( N \) SS/PBCH block indexes associated with one PRACH occasion by ssb-perRACH-Occasion in occasions. If \( N<1 \), one SS/PBCH block index is mapped to \( 1 / N \) consecutive valid PRACH occasions. If \( N \geq 1 \), all consecutive \( N \) SS/PBCH block indexes are associated with one PRACH occasion.

SS/PBCH block indexes provided by ssb-PositionsInBurst in SIBI or in ServingCellConfigCommon are mapped to valid PRACH occasions in the following order where the parameters are described in [4, TS 38.211].
- First, in increasing order of preamble indexes within a single PRACH occasion
- Second, in increasing order of frequency resource indexes for frequency multiplexed PRACH occasions
- Third, in increasing order of time resource indexes for time multiplexed PRACH occasions within a PRACH slot
- Fourth, in increasing order of indexes for PRACH slots

An association period, starting from frame 0 , for mapping SS/PBCH block indexes to PRACH occasions is the smallest value in the set determined by the PRACH configuration period according Table 8.1-1 such that \( N_{\mathrm{Tx}}^{\mathrm{SSB}} \) SS/PBCH block indexes are mapped at least once to the PRACH occasions within the association period, where a UE obtains \( N_{\mathrm{Tx}}^{\mathrm{SSB}} \) from the value of ssb-PositionsInBurst in SIB1 or in ServingCellConfigCommon. If after an integer number of SS/PBCH block indexes to PRACH occasions mapping cycles within the association period there is a set of PRACH occasions or PRACH preambles that are not mapped to \( N_{\mathrm{Tx}}^{\mathrm{SSB}} \mathrm{SS} / \mathrm{PBCH} \) block indexes, no SS/PBCH block indexes are mapped to the set of PRACH occasions or PRACH preambles. An association pattern period includes one or more association periods and is determined so that a pattern between PRACH occasions and SS/PBCH block indexes repeats at most every 160 msec. PRACH occasions not associated with SS/PBCH block indexes after an integer number of association periods, if any, are not used for PRACH transmissions.

For a PRACH transmission by a UE triggered by a PDCCH order, the PRACH mask index field [5, TS 38.212], if the value of the random access preamble index field is not zero, indicates the PRACH occasion for the PRACH transmission where the PRACH occasions are associated with the SS/PBCH block index indicated by the SS/PBCH block index field of the PDCCH order. If the UE is provided \( K_{\text {cell, offset }} \) by CellSpecific_Koffset, the PRACH occasion is after slot \( n+2^{\mu} \cdot K_{\text {cell, offset }} \) where \( n \) is the slot of the UL BWP for the PRACH transmission that overlaps with the end of the PDCCH order reception assuming \( T_{\mathrm{TA}}=0 \), and \( \mu \) is the SCS configuration for the PRACH transmission. If the PDCCH reception for the PDCCH order includes two PDCCH candidates from two linked search space sets based on searchSpaceLinking, as described in clause 10.1, the last symbol of the PDCCH reception is the last symbol of the PDCCH candidate that ends later. The PDCCH reception includes the two PDCCH candidates also when the UE is not required to monitor one of the two PDCCH candidates as described in clauses 10,11.1, and 11.1.1.

For a PRACH transmission triggered by higher layers, if ssb-ResourceList is provided, the PRACH mask index is indicated by ra-ssb-OccasionMaskIndex which indicates the PRACH occasions for the PRACH transmission where the PRACH occasions are associated with the selected SS/PBCH block index.

The PRACH occasions are mapped consecutively per corresponding SS/PBCH block index. The indexing of the PRACH occasion indicated by the mask index value is reset per mapping cycle of consecutive PRACH occasions per SS/PBCH block index. The UE selects for a PRACH transmission the PRACH occasion indicated by PRACH mask index value for the indicated SS/PBCH block index in the first available mapping cycle.

For the indicated preamble index, the ordering of the PRACH occasions is
- First, in increasing order of frequency resource indexes for frequency multiplexed PRACH occasions
- Second, in increasing order of time resource indexes for time multiplexed PRACH occasions within a PRACH slot

ETSI


--- Page 51  ---


3GPP TS 38.213 version 17.1.0 Release 17
50
ETSI TS 138213 V17.1.0 (2022-05)
- Third, in increasing order of indexes for PRACH slots

For a PRACH transmission triggered upon request by higher layers, a value of ra-OccasionList [12, TS 38.331], if csirs-ResourceList is provided, indicates a list of PRACH occasions for the PRACH transmission where the PRACH occasions are associated with the selected CSI-RS index indicated by csi-RS. The indexing of the PRACH occasions indicated by ra-OccasionList is reset per association pattern period.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 8.1-1: Mapping between PRACH configuration period and SS/PBCH block to PRACH occasion association period}
\begin{tabular}{|c|c|}
\hline PRACH configuration period (msec) & \begin{tabular}{c} 
Association period (number of PRACH \\
configuration periods)
\end{tabular} \\
\hline 10 & \( \{1,2,4,8,16\} \) \\
\hline 20 & \( \{1,2,4,8\} \) \\
\hline 40 & \( \{1,2,4\} \) \\
\hline 80 & \( \{1,2\} \) \\
\hline 160 & \( \{1\} \) \\
\hline
\end{tabular}
\end{table}

For paired spectrum or supplementary uplink band all PRACH occasions are valid.
For unpaired spectrum,
- if a UE is not provided tdd-UL-DL-ConfigurationCommon, a PRACH occasion in a PRACH slot is valid if it does not precede a SS/PBCH block in the PRACH slot and starts at least \( N_{\text {gap }} \) symbols after a last SS/PBCH block reception symbol, where \( N_{\text {gap }} \) is provided in Table 8.1-2 and, if channelAccessMode = "semiStatic" is provided, does not overlap with a set of consecutive symbols before the start of a next channel occupancy time where the UE does not transmit [15, TS 37.213].
- the candidate SS/PBCH block index of the SS/PBCH block corresponds to the SS/PBCH block index provided by ssb-PositionsInBurst in SIBI or in ServingCellConfigCommon, as described in clause 4.1
- If a UE is provided tdd-UL-DL-ConfigurationCommon, a PRACH occasion in a PRACH slot is valid if
- it is within UL symbols, or
- it does not precede a SS/PBCH block in the PRACH slot and starts at least \( N_{\text {gap }} \) symbols after a last downlink symbol and at least \( N_{\text {gap }} \) symbols after a last SS/PBCH block symbol, where \( N_{\text {gap }} \) is provided in Table 8.1-2, and if channelAccessMode = "semiStatic" is provided, does not overlap with a set of consecutive symbols before the start of a next channel occupancy time where there shall not be any transmissions, as described in [15, TS 37.213]
- the candidate SS/PBCH block index of the SS/PBCH block corresponds to the SS/PBCH block index provided by ssb-PositionsInBurst in SIBI or in ServingCellConfigCommon, as described in clause 4.1.

For preamble format B4 [4, TS 38.211], \( N_{\text {gap }}=0 \).

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 8.1-2: \( N_{\text {gap }} \) values for different preamble SCS \( \mu \)}
\begin{tabular}{|c|c|}
\hline Preamble SCS & \( \boldsymbol{N}_{\text {gap }} \) \\
\hline 1.25 kHz or 5 kHz & 0 \\
\hline 15 kHz or 30 kHz or 60 kHz or 120 kHz & 2 \\
\hline 480 kHz & 8 \\
\hline 960 kHz & 16 \\
\hline
\end{tabular}
\end{table}

If a random access procedure is initiated by a PDCCH order, the UE, if requested by higher layers, transmits a PRACH in the selected PRACH occasion, as described in [11, TS 38.321], for which a time between the last symbol of the PDCCH order reception and the first symbol of the PRACH transmission is larger than or equal to \( N_{T, 2}+ \Delta_{\text {BWPSwitching }}+\Delta_{\text {Delay }}+T_{\text {switch }} \mathrm{msec} \), where
- \( N_{T, 2} \) is a time duration of \( N_{2} \) symbols corresponding to a PUSCH preparation time for UE processing capability 1 [6, TS 38.214] assuming \( \mu \) corresponds to the smallest SCS configuration between the SCS configuration of the PDCCH order and the SCS configuration of the corresponding PRACH transmission

ETSI


--- Page 52  ---


3GPP TS 38.213 version 17.1.0 Release 17
51
ETSI TS 138213 V17.1.0 (2022-05)
- \( \Delta_{\text {BWPSwitching }}=0 \) if the active UL BWP does not change and \( \Delta_{\text {BWPSwitching }} \) is defined in [10, TS 38.133] otherwise
- \( \Delta_{\text {Delay }}=0.5 \mathrm{msec} \) for FR1 and \( \Delta_{\text {Delay }}=0.25 \mathrm{msec} \) for FR2
- \( T_{\text {switch }} \) is a switching gap duration as defined in [6, TS 38.214]

For a PRACH transmission using 1.25 kHz or 5 kHz SCS , the UE determines \( N_{2} \) assuming SCS configuration \( \mu=0 \).
For single cell operation or for operation with carrier aggregation in a same frequency band, a UE does not transmit PRACH and PUSCH/PUCCH/SRS in a same slot or when a gap between the first or last symbol of a PRACH transmission in a first slot is separated by less than \( N \) symbols from the last or first symbol, respectively, of a PUSCH/PUCCH/SRS transmission in a second slot where \( N=2 \) for \( \mu=0 \) or \( \mu=1, N=4 \) for \( \mu=2 \) or \( \mu=3, N= \) 16 for \( \mu=5, N=32 \) for \( \mu=6 \), and \( \mu \) is the SCS configuration for the active UL BWP. For a PUSCH transmission with repetition Type B, this applies to each actual repetition for PUSCH transmission [6, TS 38.214].
8.1A PUSCH for Type-2 random access procedure

For a Type-2 random access procedure, a UE transmits a PUSCH, when applicable, after transmitting a PRACH. The UE encodes a transport block provided for the PUSCH transmission using redundancy version number 0 . The PUSCH transmission is after the PRACH transmission by at least \( N \) symbols where \( N=2 \) for \( \mu=0 \) or \( \mu=1, N=4 \) for \( \mu=2 \) or \( \mu=3, N=16 \) for \( \mu=5, N=32 \) for \( \mu=6 \), and \( \mu \) is the SCS configuration for the active UL BWP.

A UE does not transmit a PUSCH in a PUSCH occasion if the PUSCH occasion associated with a DMRS resource is not mapped to a preamble of valid PRACH occasions or if the associated PRACH preamble is not transmitted as described in clause 7.5 or clause 11.1. A UE can transmit a PRACH preamble in a valid PRACH occasion if the PRACH preamble is not mapped to a valid PUSCH occasion.

A mapping between one or multiple PRACH preambles and a PUSCH occasion associated with a DMRS resource is per PUSCH configuration.

A UE determines time resources and frequency resources for PUSCH occasions in an active UL BWP from msgA-PUSCH-Config for the active UL BWP. If the active UL BWP is not the initial UL BWP and msgA-PUSCH-Config is not provided for the active UL BWP, the UE uses the msgA-PUSCH-Config provided for the initial UL BWP.

A UE determines a first interlace or first RB for a first PUSCH occasion in an active UL BWP respectively from interlaceIndexFirstPO-MsgA-PUSCH or from frequencyStartMsgA-PUSCH that provides an offset, in number of RBs in the active UL BWP, from a first RB of the active UL BWP. A PUSCH occasion includes a number of interlaces or a number of RBs provided by nrofInterlacesPerMsgA-PO or by nrofPRBs-perMsgA-PO, respectively. Consecutive PUSCH occasions in the frequency domain of an UL BWP are separated by a number of RBs provided by guardBandMsgA-PUSCH. A number \( N_{f} \) of PUSCH occasions in the frequency domain of an UL BWP is provided by nrofMsgA-PO-FDM.

For operation with shared spectrum channel access, if the PUSCH occasion is provided by higher layer parameters frequencyStartMsgA-PUSCH and nrofPRBs-perMsgA-PO, the UE expects a PUSCH occasion to be confined within the same RB set as the corresponding PRACH transmission.

For operation with shared spectrum channel access, if the PUSCH occasion is provided by higher layer parameters interlaceIndexFirstPO-MsgA-PUSCH and nroflnterlacesPerMsgA-PO, the RB set for the PUSCH occasion in the active UL BWP is the same RB set as the corresponding PRACH transmission. The UE assumes that the RB set is defined as when the UE is not provided intraCellGuardBandsPerSCS for an UL carrier as described in clause 7 of [6, TS 38.214].

If a UE does not have dedicated RRC configuration, or has an initial UL BWP as an active UL BWP, or is not provided startSymbolAndLengthMsgA-PO, msgA-PUSCH-timeDomainAllocation provides a SLIV and a PUSCH mapping type for a PUSCH transmission by indicating
- one of the first maxNrofUL-Allocations values from PUSCH-TimeDomainResourceAllocationList, if PUSCHTimeDomainResourceAllocationList is provided in PUSCH-ConfigCommon
- one of the entries from table 6.1.2.1.1-2 or table 6.1.2.1.1-3 in [6, TS 38.214], if PUSCHTimeDomainResourceAllocationList is not provided in PUSCH-ConfigCommon

ETSI


--- Page 53  ---


3GPP TS 38.213 version 17.1.0 Release 17
52
ETSI TS 138213 V17.1.0 (2022-05)

else, the UE is provided a SLIV by startSymbolAndLengthMsgA-PO, and a PUSCH mapping type by mappingTypeMsgA-PUSCH for a PUSCH transmission.

For mapping one or multiple preambles of a PRACH slot to a PUSCH occasion associated with a DMRS resource, a UE determines a first slot for a first PUSCH occasion in an active UL BWP from msgA-PUSCH-TimeDomainOffset that provides an offset, in number of slots in the active UL BWP, relative to the start of a PUSCH slot including the start of each PRACH slot. The UE does not expect to have a PRACH preamble transmission and a PUSCH transmission with a msgA in a PRACH slot or in a PUSCH slot, or to have overlapping msgA PUSCH occasions for a MsgA PUSCH configuration. The UE expects that a first PUSCH occasion in each slot has a same SLIV for a PUSCH transmission that is provided by startSymbolAndLengthMsgA-PO or msgA-PUSCH-timeDomainAllocation [6, TS 38.214].

Consecutive PUSCH occasions within each slot are separated by guardPeriodMsgA-PUSCH symbols and have same duration. A number \( N_{t} \) of time domain PUSCH occasions in each slot is provided by nrofMsgA-PO-perSlot and a number \( N_{s} \) of consecutive slots that include PUSCH occasions is provided by nrofSlotsMsgA-PUSCH.

A UE is provided a DMRS configuration for a PUSCH transmission in a PUSCH occasion in an active UL BWP by msgA-DMRS-Config.

A UE is provided an MCS for data information in a PUSCH transmission for a PUSCH occasion by msgA-MCS.
For a PUSCH transmission with frequency hopping in a slot, when indicated by msgA-intraSlotFrequencyHopping for the active UL BWP, the frequency offset for the second hop [6, TS 38.214] is determined as described in clause 8.3, Table 8.3-1 using msgA-HoppingBits instead of \( N_{\mathrm{UL}, \mathrm{h} \mathrm{p}} \) - If guardPeriodMsgA-PUSCH is provided, a first symbol of the second hop is separated by guardPeriodMsgA-PUSCH symbols from the end of a last symbol of the first hop; otherwise, there is no time separation of the PUSCH transmission before and after frequency hopping. If a UE is provided with uselnterlacePUCCH-PUSCH in BWP-UplinkCommon, the UE shall transmit PUSCH without frequency hopping. A PUSCH transmission uses a same spatial filter as an associated PRACH transmission.

A UE determines whether or not to apply transform precoding for a PUSCH transmission as described in [6, TS 38.214].

A PUSCH occasion for PUSCH transmission is defined by a frequency resource and a time resource, and is associated with a DMRS resource. The DMRS resources are provided by msgA-DMRS-Config-

Each consecutive number of \( N_{\text {preamble preamble indexes from valid PRACH occasions in a PRACH slot }} \)
- first, in increasing order of preamble indexes within a single PRACH occasion
- second, in increasing order of frequency resource indexes for frequency multiplexed PRACH occasions
- third, in increasing order of time resource indexes for time multiplexed PRACH occasions within a PRACH slot
are mapped to a valid PUSCH occasion and the associated DMRS resource
- first, in increasing order of frequency resource indexes \( f_{i d} \) for frequency multiplexed PUSCH occasions
- second, in increasing order of DMRS resource indexes within a PUSCH occasion, where a DMRS resource index \( D M R S_{i d} \) is determined first in an ascending order of a DMRS port index and second in an ascending order of a DMRS sequence index [4, TS 38.211]
- third, in increasing order of time resource indexes \( t_{i d} \) for time multiplexed PUSCH occasions within a PUSCH slot
- fourth, in increasing order of indexes for \( N_{s} \) PUSCH slots
where \( N_{\text {preamble }}=\operatorname{ceil}\left(T_{\text {preamble }} / T_{\text {PUSCH }}\right), T_{\text {preamble }} \) is a total number of valid PRACH occasions per association pattern period multiplied by the number of preambles per valid PRACH occasion provided by rachConfigCommonTwoStepRA, and \( T_{\text {PUSCH }} \) is a total number of valid PUSCH occasions per PUSCH configuration per association pattern period multiplied by the number of DMRS resource indexes per valid PUSCH occasion provided by msgA-DMRS-Config.

ETSI


--- Page 54  ---


3GPP TS 38.213 version 17.1.0 Release 17
53
ETSI TS 138213 V17.1.0 (2022-05)

A PUSCH occasion is valid if it does not overlap in time and frequency with any valid PRACH occasion associated with either a Type-1 random access procedure or a Type-2 random access procedure. Additionally, for unpaired spectrum and for SS/PBCH blocks with indexes provided by ssb-PositionsInBurst in SIBI or by ServingCellConfigCommon
- if a UE is not provided tdd-UL-DL-ConfigurationCommon, a PUSCH occasion is valid if the PUSCH occasion
- does not precede a SS/PBCH block in the PUSCH slot, and
- starts at least \( N_{\text {gap }} \) symbols after a last SS/PBCH block symbol, where \( N_{\text {gap }} \) is provided in Table 8.1-2 and, if channelAccessMode = "semiStatic" is provided, does not overlap with a set of consecutive symbols before the start of a next channel occupancy time where the UE does not transmit [15, TS 37.213].
- if a UE is provided tdd-UL-DL-ConfigurationCommon, a PUSCH occasion is valid if the PUSCH occasion
- is within UL symbols, or
- does not precede a SS/PBCH block in the PUSCH slot, and
- starts at least \( N_{\text {gap }} \) symbols after a last downlink symbol and at least \( N_{\text {gap }} \) symbols after a last SS/PBCH block symbol, where \( N_{\text {gap }} \) is provided in Table 8.1-2 and, if channelAccessMode = "semiStatic" is provided, does not overlap with a set of consecutive symbols before the start of a next channel occupancy time where the UE does not transmit [15, TS 37.213].
8.2 Random access response - Type-1 random access procedure

In response to a PRACH transmission, a UE attempts to detect a DCI format \( 1 \_0 \) with CRC scrambled by a corresponding RA-RNTI during a window controlled by higher layers [11, TS 38.321]. The window starts at the first symbol of the earliest CORESET the UE is configured to receive PDCCH for Type1-PDCCH CSS set, as defined in clause 10.1, that is at least one symbol, after the last symbol of the PRACH occasion corresponding to the PRACH transmission, where the symbol duration corresponds to the SCS for Type1-PDCCH CSS set as defined in clause 10.1. If \( N_{\mathrm{TA}, \mathrm{adj}}^{\mathrm{UE}} \) or \( N_{\mathrm{TA}, \mathrm{adj}}^{\text {common }} \), as defined in [4, TS 38.211], is not zero, the window starts after an additional \( T_{\mathrm{TA}}+k_{\text {mac }} \) msec where \( T_{\mathrm{TA}} \) is defined in [4, TS 38.211] and \( k_{\mathrm{mac}} \) is provided by \( K \)-Mac or \( k_{\mathrm{mac}}=0 \) if \( K \)-Mac is not provided. The length of the window in number of slots, based on the SCS for Typel-PDCCH CSS set, is provided by raResponseWindow.

If the UE detects the DCI format \( 1 \_0 \) with CRC scrambled by the corresponding RA-RNTI and LSBs of a SFN field in the DCI format 1_0, if included and applicable, are same as corresponding LSBs of the SFN where the UE transmitted PRACH, and the UE receives a transport block in a corresponding PDSCH within the window, the UE passes the transport block to higher layers. The higher layers parse the transport block for a random access preamble identity (RAPID) associated with the PRACH transmission. If the higher layers identify the RAPID in RAR message(s) of the transport block, the higher layers indicate an uplink grant to the physical layer. This is referred to as random access response (RAR) UL grant in the physical layer.

If the UE does not detect the DCI format \( 1 \_0 \) with CRC scrambled by the corresponding RA-RNTI within the window, or if the UE detects the DCI format \( 1 \_0 \) with CRC scrambled by the corresponding RA-RNTI within the window and LSBs of a SFN field in the DCI format 1_0, if included and applicable, are not same as corresponding LSBs of the SFN where the UE transmitted PRACH, or if the UE does not correctly receive the transport block in the corresponding PDSCH within the window, or if the higher layers do not identify the RAPID associated with the PRACH transmission from the UE, the higher layers can indicate to the physical layer to transmit a PRACH. If requested by higher layers, the UE is expected to transmit a PRACH no later than \( N_{T, 1}+0.75 \mathrm{msec} \) after the last symbol of the window, or the last symbol of the PDSCH reception, where \( N_{T, 1} \) is a time duration of \( N_{1} \) symbols corresponding to a PDSCH processing time for UE processing capability 1 assuming \( \mu \) corresponds to the smallest SCS configuration among the SCS configurations for the PDCCH carrying the DCI format \( 1 \_0 \), the corresponding PDSCH when additional PDSCH DMRS is configured, and the corresponding PRACH. For \( \mu=0 \), the UE assumes \( N_{1,0}=14 \) [6, TS 38.214]. For a PRACH transmission using 1.25 kHz or 5 kHz SCS, the UE determines \( N_{1} \) assuming SCS configuration \( \mu=0 \).

If the UE detects a DCI format \( 1 \_0 \) with CRC scrambled by the corresponding RA-RNTI and LSBs of a SFN field in the DCI format \( 1 \_0 \), if included and applicable, are same as corresponding LSBs of the SFN where the UE transmitted the PRACH, and the UE receives a transport block in a corresponding PDSCH, the UE may assume same DM-RS antenna port quasi co-location properties, as described in [6, TS 38.214], as for a SS/PBCH block or a CSI-RS resource

ETSI


--- Page 55  ---


3GPP TS 38.213 version 17.1.0 Release 17
54
ETSI TS 138213 V17.1.0 (2022-05)

the UE used for PRACH association, as described in clause 8.1, regardless of whether or not the UE is provided TCIState for the CORESET where the UE receives the PDCCH with the DCI format \( 1 \_0 \).

If the UE attempts to detect the DCI format \( 1 \_0 \) with CRC scrambled by the corresponding RA-RNTI in response to a PRACH transmission initiated by a PDCCH order that triggers a contention-free random access procedure for the SpCell [11, TS 38.321], the UE may assume that the PDCCH that includes the DCI format \( 1 \_0 \) and the PDCCH order have same DM-RS antenna port quasi co-location properties. If the UE attempts to detect the DCI format \( 1 \_0 \) with CRC scrambled by the corresponding RA-RNTI in response to a PRACH transmission initiated by a PDCCH order that triggers a contention-free random access procedure for a secondary cell, the UE may assume the DM-RS antenna port quasi co-location properties of the CORESET associated with the Typel-PDCCH CSS set for receiving the PDCCH that includes the DCI format \( 1 \_0 \).

A RAR UL grant schedules a PUSCH transmission from the UE. The contents of the RAR UL grant, starting with the MSB and ending with the LSB, are given in Table 8.2-1.

If the value of the frequency hopping flag is 0 , the UE transmits the PUSCH without frequency hopping; otherwise, the UE transmits the PUSCH with frequency hopping.

The UE determines the MCS of the PUSCH transmission from the first sixteen indexes of the applicable MCS index table for PUSCH as described in [6, TS 38.214].

The TPC command value \( \delta_{\mathrm{msg} 2, b, f, c} \) is used for setting the power of the PUSCH transmission, as described in clause 7.1.1, and is interpreted according to Table 8.2-2.

The CSI request field is reserved.
The ChannelAccess-CPext field indicates a channel access type and CP extension for operation with shared spectrum channel access [15, TS 37.213] as defined in Table 7.3.1.1.1-4 in TS 38.212 or Table 7.3.1.1.1-4A in TS 38.212 if ChannelAccessMode-r16 = "semiStatic" is provided.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 8.2-1: Random Access Response Grant Content field size}
\begin{tabular}{|l|l|}
\hline RAR grant field & Number of bits \\
\hline Frequency hopping flag & 1 \\
\hline PUSCH frequency resource allocation & 14, for operation without shared spectrum channel access 12, for operation with shared spectrum channel access \\
\hline PUSCH time resource allocation & 4 \\
\hline MCS & 4 \\
\hline TPC command for PUSCH & 3 \\
\hline CSI request & 1 \\
\hline ChannelAccess-CPext & 0, for operation without shared spectrum channel access 2, for operation with shared spectrum channel access \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 8.2-2: TPC Command \( \boldsymbol{\delta}_{\mathrm{msg} 2, b_{1}, f_{1}} \) for PUSCH}
\begin{tabular}{|c|c|}
\hline TPC Command & Value (in dB) \\
\hline 0 & -6 \\
\hline 1 & -4 \\
\hline 2 & -2 \\
\hline 3 & 0 \\
\hline 4 & 2 \\
\hline 5 & 4 \\
\hline 6 & 6 \\
\hline 7 & 8 \\
\hline
\end{tabular}
\end{table}

Unless the UE is configured a SCS, the UE receives subsequent PDSCH using same SCS as for the PDSCH reception providing the RAR message.

If the UE does not detect the DCI format \( 1 \_0 \) with CRC scrambled by the corresponding RA-RNTI within the window, or if the UE detects the DCI format \( 1 \_0 \) with CRC scrambled by the corresponding RA-RNTI within the window and the LSBs of a SFN field in the DCI format 1_0, if included and applicable, are not same as corresponding LSBs of the

ETSI


--- Page 56  ---


3GPP TS 38.213 version 17.1.0 Release 17
55
ETSI TS 138213 V17.1.0 (2022-05)

SFN where the UE transmitted the PRACH, or the UE does not correctly receive a corresponding transport block within the window, the UE procedure is as described in [11, TS 38.321].
8.2A Random access response - Type-2 random access procedure

In response to a transmission of a PRACH and a PUSCH , or to a transmission of only a PRACH if the PRACH preamble is mapped to a valid PUSCH occasion, a UE attempts to detect a DCI format 10 with CRC scrambled by a corresponding MsgB-RNTI during a window controlled by higher layers [11, TS 38.321]. The window starts at the first symbol of the earliest CORESET the UE is configured to receive PDCCH for Type1-PDCCH CSS set, as defined in clause 10.1, that is at least one symbol, after the last symbol of the PUSCH occasion corresponding to the PRACH transmission, where the symbol duration corresponds to the SCS for Typel-PDCCH CSS set. If \( N_{\mathrm{TA}, \mathrm{adj}}^{\mathrm{UE}} \) or \( N_{\mathrm{TA}, \mathrm{adj}}^{\text {commnon }} \), as defined in [4, TS 38.211], is not zero, the window starts after an additional \( T_{\mathrm{TA}}+k_{\mathrm{mac}} \) msec where \( T_{\mathrm{TA}} \) is defined in [4, TS 38.211] and \( k_{\mathrm{mac}} \) is provided by \( K \)-Mac or \( k_{\mathrm{mac}}=0 \) if \( K \)-Mac is not provided. The length of the window in number of slots, based on the SCS for Type1-PDCCH CSS set, is provided by msgB-ResponseWindow.

In response to a transmission of a PRACH , if the PRACH preamble is not mapped to a valid PUSCH occasion, a UE attempts to detect a DCI format \( 1 \_0 \) with CRC scrambled by a corresponding MsgB-RNTI during a window controlled by higher layers [11, TS 38.321]. The window starts at the first symbol of the earliest CORESET the UE is configured to receive PDCCH for Type1-PDCCH CSS set, as defined in clause 10.1, that is at least one symbol, after the last symbol of the PRACH occasion corresponding to the PRACH transmission, where the symbol duration corresponds to the SCS for Type1-PDCCH CSS set. The length of the window in number of slots, based on the SCS for Type1-PDCCH CSS set, is provided by msgB-ResponseWindow.

If the UE detects the DCI format \( 1 \_0 \), with CRC scrambled by the corresponding MsgB-RNTI and LSBs of a SFN field in the DCI format 1_0, if applicable, are same as corresponding LSBs of the SFN where the UE transmitted PRACH, and the UE receives a transport block in a corresponding PDSCH within the window, the UE passes the transport block to higher layers. The higher layers indicate to the physical layer
- an uplink grant if the RAR message(s) is for fallbackRAR and a random access preamble identity (RAPID) associated with the PRACH transmission is identified, and the UE procedure continues as described in clauses \( 8.2,8.3 \), and 8.4 when the UE detects a RAR UL grant, or
- transmission of a PUCCH with HARQ-ACK information having ACK value if the RAR message(s) is for successRAR, where
- a PUCCH resource for the transmission of the PUCCH is indicated by PUCCH resource indicator field of 4 bits in the successRAR from a PUCCH resource set that is provided by pucch-ResourceCommon
- a slot for the PUCCH transmission is indicated by a HARQ Feedback Timing Indicator field of 3 bits in the successRAR having a value \( k \) from \( \{1,2,3,4,5,6,7,8\} \) for \( \mu \leq 3 \), from \( \{7,8,12,16,20,24,28,32\} \) for \( \mu=5 \), and from \( \{13,16,24,32,40,48,56,64\} \) for \( \mu=6 \) and, with reference to slots for PUCCH transmission having duration \( T_{\text {slot }} \), the slot is determined as \( n+k+\Delta+2^{\mu} \cdot K_{\text {cell, offset }} \), where \( n \) is a slot of the PDSCH reception, \( \Delta \) is as defined for PUSCH transmission in Table 6.1.2.1.1-5 of [6, TS 38.214], \( \mu \) is the SCS configuration of the active UL BWP, and \( K_{\text {cell, offset }} \) is provided by CellSpecific_Koffset; otherwise, if not provided, \( K_{\text {cell, offset }}=0 \)
- the UE does not expect the first symbol of the PUCCH transmission to be after the last symbol of the PDSCH reception by a time smaller than \( N_{T, 1}+0.5 \mathrm{msec} \) where \( N_{T, 1} \) is the PDSCH processing time for UE processing capability 1 [6, TS 38.214]
- for operation with shared spectrum channel access, a channel access type and CP extension [15, TS 37.213] for a PUCCH transmission is indicated by a ChannelAccess-CPext field in the successRAR as defined in Table 7.3.1.1.1-4 in TS 38.212 or Table 7.3.1.1.1-4A in TS 38.212 if ChannelAccessMode-rl6 = "semiStatic" is provided
- the PUCCH transmission is with a same spatial domain transmission filter and in a same active UL BWP as a last PUSCH transmission

If the UE detects the DCI format \( 1 \_0 \) with CRC scrambled by a C-RNTI and a transport block in a corresponding PDSCH within the window, the UE transmits a PUCCH with HARQ-ACK information having ACK value if the UE correctly detects the transport block or NACK value if the UE incorrectly detects the transport block and the time alignment timer is running [11, TS 38.321].

ETSI


--- Page 57  ---


3GPP TS 38.213 version 17.1.0 Release 17
56
ETSI TS 138213 V17.1.0 (2022-05)

If the UE detects a DCI format \( 1 \_0 \) with CRC scrambled by the corresponding MsgB-RNTI and receives a transport block within the window in a corresponding PDSCH, the UE may assume same DM-RS antenna port quasi co-location properties, as described in [6, TS 38.214], as for a SS/PBCH block the UE used for PRACH association, as described in clause 8.1, regardless of whether or not the UE is provided TCI-State for the CORESET where the UE receives the PDCCH with the DCI format \( 1 \_0 \).

The UE does not expect to be indicated to transmit the PUCCH with the HARQ-ACK information at a time that is prior to a time when the UE applies a TA command that is provided by the transport block. If the UE does not detect the DCI format \( 1 \_0 \) with CRC scrambled by the corresponding MsgB-RNTI within the window, or if the UE detects the DCI format 1_0 with CRC scrambled by the corresponding MsgB-RNTI within the window and LSBs of a SFN field in the DCI format 1_0, if applicable, are not same as corresponding LSBs of the SFN where the UE transmitted the PRACH, or if the UE does not correctly receive the transport block in the corresponding PDSCH within the window, or if the higher layers do not identify the RAPID associated with the PRACH transmission from the UE, the higher layers can indicate to the physical layer to transmit only PRACH according to Type-1 random access procedure or to transmit both PRACH and PUSCH according to Type-2 random access procedure [11, TS 38.321]. If requested by higher layers, the UE is expected to transmit a PRACH no later than \( N_{\mathrm{T}, 1}+0.75 \mathrm{msec} \) after the last symbol of the window, or the last symbol of the PDSCH reception, where \( N_{\mathrm{T}, 1} \) is a time duration of \( N_{1} \) symbols corresponding to a PDSCH processing time for UE processing capability 1 when additional PDSCH DM-RS is configured. For \( \mu=0 \), the UE assumes \( N_{1,0}= \) 14 [6, TS 38.214].

Unless the UE is configured a SCS, the UE receives subsequent PDSCH using same SCS as for the PDSCH reception providing the RAR message.

If the UE does not detect the DCI format \( 1 \_0 \) with CRC scrambled by the corresponding MsgB-RNTI within the window, or if the UE detects the \( 1 \_0 \) with CRC scrambled by the corresponding MsgB-RNTI within the window and LSBs of a SFN field in the DCI format 1 0, if applicable, are not same as corresponding LSBs of the SFN where the UE transmitted the PRACH, or the UE does not correctly receive a corresponding transport block within the window, the UE procedure is as described in [11, TS 38.321].
8.3 PUSCH scheduled by RAR UL grant

An active UL BWP with SCS configuration \( \mu \), as described in clause 12 and in [4, TS 38.211], for a PUSCH transmission scheduled by a RAR UL grant is indicated by higher layers.

If useInterlacePUCCH-PUSCH is not provided by BWP-UplinkCommon and BWP-UplinkDedicated, for determining the frequency domain resource allocation for the PUSCH transmission within the active UL BWP
- if the active UL BWP and the initial UL BWP have same SCS and same CP length and the active UL BWP includes all RBs of the initial UL BWP, or the active UL BWP is the initial UL BWP, the initial UL BWP is used
- else, the RB numbering starts from the first RB of the active UL BWP and the maximum number of RBs for frequency domain resource allocation equals the number of RBs in the initial UL BWP

The frequency domain resource allocation is by uplink resource allocation type 1 [6, TS 38.214]. For an initial UL BWP size of \( N_{\text {BWP }}^{\text {size }} \) RBs, a UE processes the frequency domain resource assignment field as follows
- if \( N_{\mathrm{BWP}}^{\text {size }} \leq 180 \), or for operation with shared spectrum channel access if \( N_{\mathrm{BWP}}^{\text {size }} \leq 90 \)
- truncate the frequency domain resource assignment field to its \( \left\lceil\log _{2}\left(N_{\text {BWP }}^{\text {size }} \cdot\left(N_{\text {BWP }}^{\text {size }}+1\right) / 2\right)\right\rceil \) least significant bits and interpret the truncated frequency resource assignment field as for the frequency resource assignment field in DCI format 0_0 as described in [5, TS 38.212]
- else
- insert \( \left[\log _{2}\left(N_{\text {BWP }}^{\text {size }} \cdot\left(N_{\text {BWP }}^{\text {size }}+1\right) / 2\right)\right]-14 \) most significant bits, or for operation with shared spectrum channel access insert \( \left\lceil\log _{2}\left(N_{\mathrm{BWP}}^{\text {size }} \cdot\left(N_{\mathrm{BWP}}^{\text {size }}+1\right) / 2\right)\right\rceil-12 \) most significant bits, with value set to ' 0 ' after the \( N_{\text {UL hop }} \) bits to the frequency domain resource assignment field, where \( N_{\text {ULhop }}=0 \) if the frequency hopping flag is set to ' 0 ' and \( N_{\mathrm{UL}, \mathrm{h} \mathrm{p}} \) is provided in Table 8.3-1 if the hopping flag bit is set to ' 1 ', and interpret the expanded frequency resource assignment field as for the frequency resource assignment field in DCI format \( 0 \_0 \) as described in [5, TS 38.212]

ETSI


--- Page 58  ---


3GPP TS 38.213 version 17.1.0 Release 17
57
ETSI TS 138213 V17.1.0 (2022-05)
- end if

If uselnterlacePUCCH-PUSCH is provided by BWP-UplinkCommon or BWP-UplinkDedicated, the frequency domain resource allocation is by uplink resource allocation type 2 [6, TS 38.214]. A UE processes the frequency domain resource assignment field as follows
- truncate the frequency domain resource assignment field to the \( X=6 \mathrm{LSBs} \) if \( \mu=0 \), or to the \( X=5 \mathrm{LSBs} \) if \( \mu=1 \)
- for interlace allocation of a PUSCH transmission, interpret the X MSBs of the truncated frequency domain resource assignment field for the active UL BWP as for the X MSBs of the frequency domain resource assignment field in DCI format \( 0 \_0[6 \), TS 38.214]
- for RB set allocation of a PUSCH transmission, the RB set of the active UL BWP is the RB set of the PRACH transmission associated with the RAR UL grant. The UE assumes that the RB set is defined as when the UE is not provided intraCellGuardBandsUL-List [6, TS 38.214].

A UE determines whether or not to apply transform precoding as described in [6, TS 38.214].
For a PUSCH transmission with frequency hopping scheduled by RAR UL grant or for a Msg3 PUSCH retransmission, the frequency offset for the second hop [6, TS 38.214] is given in Table 8.3-1.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 8.3-1: Frequency offset for second hop of PUSCH transmission with frequency hopping scheduled by RAR UL grant or of Msg3 PUSCH retransmission}
\begin{tabular}{|l|l|l|}
\hline Number of PRBs in initial UL BWP & Value of \( N_{\text {UL,hop }} \) Hopping Bits & Frequency offset for \( \mathbf{2}^{\text {nd }} \) hop \\
\hline \multirow{2}{*}{\( N_{\text {BWP }}^{\text {size }}<50 \)} & 0 & \( \left\lfloor N_{\text {BWP }}^{\text {size }} / 2\right\rfloor \) \\
\hline & 1 & \( \left\lfloor N_{\text {BWP }}^{\text {size }} / 4\right\rfloor \) \\
\hline \multirow{4}{*}{\( N_{\mathrm{BWP}}^{\text {size }} \geq 50 \)} & 00 & [ \( N_{\text {BWP }}^{\text {size }} / 2 \) ] \\
\hline & 01 & [ \( N_{\text {BWP }}^{\text {size }} / 4 \) ] \\
\hline & 10 & \( -\left\lfloor N_{\text {BWP }}^{\text {size }} / 4\right\rfloor \) \\
\hline & 11 & Reserved \\
\hline
\end{tabular}
\end{table}

A SCS for the PUSCH transmission is provided by subcarrierSpacing in BWP-UplinkCommon. A UE transmits PRACH and the PUSCH on a same uplink carrier of a same serving cell.

A UE transmits a transport block in a PUSCH scheduled by a RAR UL grant in a corresponding RAR message using redundancy version number 0 , if the PUSCH transmission is without repetitions. If a TC-RNTI is provided by higher layers, the scrambling initialization of the PUSCH corresponding to the RAR UL grant in clause 8.2 is by TC-RNTI. Otherwise, the scrambling initialization of the PUSCH corresponding to the RAR UL grant in clause 8.2 is by C-RNTI.

Msg3 PUSCH retransmissions, if any, of the transport block, are scheduled by a DCI format \( 0 \_0 \) with CRC scrambled by a TC-RNTI provided in the corresponding RAR message [11, TS 38.321].

With reference to slots for a PUSCH transmission scheduled by a RAR UL grant, if a UE receives a PDSCH with a RAR message ending in slot \( n \) for a corresponding PRACH transmission from the UE, the UE transmits the PUSCH in slot \( n+k_{2}+\Delta+2^{\mu} \cdot K_{\text {cell, offset, }} \) where \( k_{2} \) and \( \Delta \) are provided in \( [6, \mathrm{TS} 38.214] \) and \( K_{\text {cell, offset }} \) is provided by CellSpecific_Koffset; otherwise, if not provided, \( K_{\text {cell }, \text { offset }}=0 \).

A UE can be provided in RACH-ConfigCommon a set of numbers of repetitions for a PUSCH transmission with PUSCH repetition Type A that is scheduled by a RAR UL grant or by a DCI format \( 0 \_0 \) with CRC scrambled by a TCRNTI. If the UE requests repetitions for the PUSCH transmission [11, TS 38.321], the UE transmits the PUSCH over \( N_{\text {PUSCH }}^{\text {repeat }} \) slots, where \( N_{\text {PUSCH }}^{\text {repeat }} \) is indicated by the 2 MSBs of the MCS field in the RAR UL grant or in the DCI format \( 0 \_0 \) from a set of four values provided by numberOfMsg3Repetitions or from \( \{1,2,3,4\} \) if numberOfMsg3Repetitions is not provided. The UE determines an MCS for the PUSCH transmission by the 2 LSBs of the MCS field in the RAR UL grant or by the 3 LSBs of the MCS field in the DCI format \( 0 \_0 \), and determines a redundancy version and RBs for each repetition as described in [6, TS 38.214]. For unpaired spectrum operation, the UE determines the \( N_{\text {PUSCH }}^{\text {repeat }} \) slots as the first \( N_{\text {PUSCH }}^{\text {repeat }} \) slots starting from slot \( n+k_{2}+\Delta \) where a repetition of the PUSCH transmission does not include a symbol

ETSI


--- Page 59  ---


3GPP TS 38.213 version 17.1.0 Release 17
58
ETSI TS 138213 V17.1.0 (2022-05)

indicated as downlink by tdd-UL-DL-ConfigurationCommon or indicated as a symbol of an SS/PBCH block with index provided by ssb-PositionsInBurst.

The UE may assume a minimum time between the last symbol of a PDSCH reception conveying a RAR message with a RAR UL grant and the first symbol of a corresponding PUSCH transmission scheduled by the RAR UL grant is equal to \( N_{T, 1}+N_{T, 2}+0.5 \mathrm{msec} \), where \( N_{T, 1} \) is a time duration of \( N_{1} \) symbols corresponding to a PDSCH processing time for UE processing capability 1 when additional PDSCH DM-RS is configured, \( N_{T, 2} \) is a time duration of \( N_{2} \) symbols corresponding to a PUSCH preparation time for UE processing capability 1 [6, TS 38.214] and, for determining the minimum time, the UE considers that \( N_{1} \) and \( N_{2} \) correspond to the smaller of the SCS configurations for the PDSCH and the PUSCH. For \( \mu=0 \), the UE assumes \( N_{1,0}=14[6, \mathrm{TS} 38.214] \).
8.4 PDSCH with UE contention resolution identity

In response to a PUSCH transmission scheduled by a RAR UL grant when a UE has not been provided a C-RNTI, the UE attempts to detect a DCI format \( 1 \_0 \) with CRC scrambled by a corresponding TC-RNTI scheduling a PDSCH that includes a UE contention resolution identity [11, TS 38.321]. In response to the PDSCH reception with the UE contention resolution identity, the UE transmits HARQ-ACK information in a PUCCH. The PUCCH transmission is within a same active UL BWP as the PUSCH transmission. A minimum time between the last symbol of the PDSCH reception and the first symbol of the corresponding PUCCH transmission with the HARQ-ACK information is equal to \( N_{T, 1}+0.5 \mathrm{msec} . N_{T, 1} \) is a time duration of \( N_{1} \) symbols corresponding to a PDSCH processing time for UE processing capability 1 when additional PDSCH DM-RS is configured. For \( \mu=0 \), the UE assumes \( N_{1,0}=14[6 \), TS 38.214].

When detecting a DCI format in response to a PUSCH transmission scheduled by a RAR UL grant, as described in [11, TS 38.321], or corresponding PUSCH retransmission scheduled by a DCI format \( 0 \_0 \) with CRC scrambled by a TCRNTI provided in the corresponding RAR message [11, TS 38.321], the UE may assume the PDCCH carrying the DCI format has the same DM-RS antenna port quasi co-location properties, as described in [6, TS 38.214], as for a SS/PBCH block the UE used for PRACH association, as described in clause 8.1, regardless of whether or not the UE is provided TCI-State for the CORESET where the UE receives the PDCCH with the DCI format.

9 UE procedure for reporting control information
If a UE is configured with a SCG, the UE shall apply the procedures described in this clause for both MCG and SCG.
- When the procedures are applied for MCG, the terms 'secondary cell', 'secondary cells', 'serving cell', 'serving cells' in this clause refer to secondary cell, secondary cells, serving cell, serving cells belonging to the MCG respectively.
- When the procedures are applied for SCG, the terms 'secondary cell', 'secondary cells', 'serving cell', 'serving cells' in this clause refer to secondary cell, secondary cells (not including PSCell), serving cell, serving cells belonging to the SCG respectively. The term 'primary cell' in this clause refers to the PSCell of the SCG.

If a UE is configured with a PUCCH-SCell, the UE shall apply the procedures described in this clause for both primary PUCCH group and secondary PUCCH group
- When the procedures are applied for the primary PUCCH group, the terms 'secondary cell', 'secondary cells', 'serving cell', 'serving cells' in this clause refer to secondary cell, secondary cells, serving cell, serving cells belonging to the primary PUCCH group respectively.
- When the procedures are applied for secondary PUCCH group, the terms 'secondary cell', 'secondary cells', 'serving cell', 'serving cells' in this clause refer to secondary cell, secondary cells (not including the PUCCHSCell), serving cell, serving cells belonging to the secondary PUCCH group respectively. The term 'primary cell' in this clause refers to the PUCCH-SCell of the secondary PUCCH group. If pdsch-HARQ-ACK-Codebook-secondaryPUCCHgroup-r16 is provided, pdsch-HARQ-ACK-Codebook is replaced by pdsch-HARQ-ACK-Codebook-secondaryPUCCHgroup-r16. If harq-ACK-SpatialBundlingPUCCH-secondaryPUCCHgroup is provided, harq-ACK-SpatialBundlingPUCCH is replaced by harq-ACK-SpatialBundlingPUCCHsecondaryPUCCHgroup. If harq-ACK-SpatialBundlingPUSCH-secondaryPUCCHgroup is provided, harq-ACK-SpatialBundlingPUSCH is replaced by harq-ACK-SpatialBundingPUSCH-secondaryPUCCHgroup-If UCI-MuxWithDifferentPriority-secondaryPUCCHgroup is provided, UCI-MuxWithDifferentPriority is replaced by UCI-MuxWithDifferentPriority-secondaryPUCCHgroup. If simultaneousPUCCH-PUSCH-

ETSI


--- Page 60  ---


3GPP TS 38.213 version 17.1.0 Release 17
59
ETSI TS 138213 V17.1.0 (2022-05)

secondaryPUCCHgroup is provided, simultaneousPUCCH-PUSCH is replaced by simultaneousPUCCH-PUSCH-secondaryPUCCHgroup.

For unpaired spectrum operation, if a UE is provided a PUCCH-sSCell as described in clause 9.A, the UE shall apply the procedures described in this clause for both the primary cell and the PUCCH-sSCell.

If a UE is provided pdsch-HARQ-ACK-CodebookList-r16, pdsch-HARQ-ACK-Codebook is replaced by the relevant entry in pdsch-HARQ-ACK-CodebookList-r16.

In the remaining of this clause, when a PDCCH reception by a UE includes two PDCCH candidates from corresponding search space sets, as described in clause 10.1
- a PDCCH monitoring occasion is the union of the PDCCH monitoring occasions for the two PDCCH candidates
- the start of the PDCCH reception is the start of the earlier PDCCH candidate
- the end of the PDCCH reception is the end of the PDCCH candidate that ends later

The PDCCH reception includes the two PDCCH candidates also when the UE is not required to monitor one of the two PDCCH candidates as described in clauses 10, 11.1, and 11.1.1.

In the remaining of this clause, a last DCI format is the DCI format that a UE detects in a last PDCCH monitoring occasion from the PDCCH monitoring occasions for which the UE would provide HARQ-ACK information in a PUCCH in a same slot.

If a UE
- is not provided coresetPoollndex or is provided coresetPoollndex with a value of 0 for first CORESETs on active DL BWPs of serving cells, and
- is provided coresetPoollndex with a value of 1 for second CORESETs on active DL BWPs of the serving cells, and
- is provided ackNackFeedbackMode = separate
the UE shall separately apply the procedures described in clauses 9.1 and 9.2 for reporting HARQ-ACK information associated with the first CORESETs on active DL BWP of the serving cells and for reporting HARQ-ACK information associated with the second CORESETs on active DL BWP of the serving cells, and the UE does not expect to be provided with subslotLengthForPUCCH or to be indicated by pdsch-HARQ-ACK-CodebookList to generate two HARQ-ACK codebooks on active DL BWP of the serving cells. HARQ-ACK information reporting is associated with a CORESET through a reception of a PDCCH with a DCI format triggering the reporting of the HARQ-ACK information by the UE.

For NR-DC when both the MCG and the SCG operate either in FR1 or in FR2 and for a power headroom report transmitted on the MCG or the SCG, the UE computes \( P H \) assuming that the UE does not transmit PUSCH/PUCCH on any serving cell of the SCG or the MCG, respectively.

If a UE is configured for NR-DC operation, the UE does not expect to be configured with a PUCCH-SCell.
A PUSCH or a PUCCH transmission other than PUCCH transmissions with SL HARQ-ACK reports, including repetitions if any, can be of priority index 0 or of priority index 1 . For a configured grant PUSCH transmission, a UE determines a priority index from phy-PriorityIndex, if provided. For a PUCCH transmission with HARQ-ACK information corresponding to a SPS PDSCH reception or a SPS PDSCH release, a UE determines a priority index from harq-CodebookID, if provided. For a PUCCH transmission with SR, a UE determines the corresponding priority as described in clause 9.2.4. For a PUSCH transmission with semi-persistent CSI report, a UE determines a priority index from a priority indicator field, if provided, in a DCI format that activates the semi-persistent CSI report. If a priority index is not provided to a UE for a PUSCH or a PUCCH transmission other than PUCCH transmissions with SL HARQ-ACK reports, the priority index is 0 .

If a UE is provided one PUCCH-Config
- if the UE is provided subslotLengthForPUCCH in the PUCCH-Config, the PUCCH resource for any SR configuration with priority index 0 or any CSI report configuration in the PUCCH-Config is within the subslotLengthForPUCCH symbols in the PUCCH-Config
If a UE is provided two PUCCH-Config

ETSI


--- Page 61  ---


3GPP TS 38.213 version 17.1.0 Release 17
60
ETSI TS 138213 V17.1.0 (2022-05)
- if the UE is provided subslotLengthForPUCCH in the first PUCCH-Config, the PUCCH resource for any SR configuration with priority index 0 or any CSI report configuration in any PUCCH-Config is within the subslotLengthForPUCCH symbols in the first PUCCH-Config
- if the UE is provided subslotLengthForPUCCH in the second PUCCH-Config, the PUCCH resource for any SR configuration with priority index 1 in any PUCCH-Config is within the subslotLengthForPUCCH symbols in the second PUCCH-Config

If a UE is provided subslotLengthForPUCCH in a PUCCH-Config of a given priority index, in a slot of \( N_{\text {sym }}^{\text {slot }} \) symbols [4, TS 38.211 ] with HARQ-ACK, the UE does not expect that HARQ-ACK information in response to SPS PDSCH reception(s) only (if any) or SR (if any) of the given priority index in a slot of subslotLengthForPUCCH symbols is moved to a different slot of subslotLengthForPUCCH symbols after multiplexing overlapping PUCCHs.

If in an active \( \mathrm{DL} B W P \) a UE monitors PDCCH for detection of DCI format that includes a priority indicator field, a priority index can be provided by the priority indicator field. If a UE indicates a capability to monitor, in an active DL BWP, PDCCH for detection of DCI format that includes a priority indicator field, the DCI format can schedule a PUSCH transmission of any priority, or a PDSCH reception and/or trigger a PUCCH transmission with corresponding HARQ-ACK information of any priority, and DCI format \( 1 \_1 \) or DCI format \( 1 \_2 \) can indicate a TCI state update and trigger a PUCCH transmission with corresponding HARQ-ACK information of any priority.

A DCI format indicating a SPS PDSCH release, or SCell dormancy without scheduling a PDSCH reception, or indicating a TCI state update without scheduling PDSCH reception, is referred to as a DCI format having associated HARQ-ACK information without scheduling a PDSCH reception.

When a UE determines overlapping for PUCCH transmissions with SL HARQ-ACK reports and PUCCH of larger and/or smaller priority index, the UE resolves the overlapping for PUCCH transmissions with SL HARQ-ACK reports and PUCCH of each priority index as described in clause 9.2.5 and 9.2.6 before resolving the overlapping for PUCCH transmissions without SL HARQ-ACK or the overlapping for PUCCH transmissions and PUSCH transmissions.

If a UE
- is provided simultaneousPUCCH-PUSCH and would transmit a PUCCH with a first priority index and PUSCHs with a second priority index that is different than the first priority index, where the PUCCH and the PUSCHs overlap in time
- can simultaneously transmit the PUCCH and the PUSCHs [16, TS 38.306],
the UE excludes the PUSCHs for resolving the time overlapping between the PUCCH and PUSCHs, where the timeline conditions are not required for the excluded PUSCHs.

When a UE determines overlapping for PUCCH and/or PUSCH transmissions of different priority indexes other than PUCCH transmissions with SL HARQ-ACK reports before considering limitations for UE transmission as described in clause 11.1 and clause 11.1.1, including repetitions if any, if the UE is provided UCI-MuxWithDifferentPriority and the timeline conditions in clause 9.2.5 for multiplexing UCI in a PUCCH or a PUSCH are satisfied
- first, the UE resolves overlapping for PUCCH and/or PUSCH transmissions of a same priority index as described in clauses 9.2.5 and 9.2.6
- second, the UE resolves the overlapping for PUCCH transmissions of different priority indexes, and
- if the UE is provided subslotLengthForPUCCH in the second PUCCH-Config, a PUCCH transmission of smaller priority index is associated with the first overlapping slot with subslotLengthForPUCCH symbols of larger priority index; otherwise, the PUCCH transmission of smaller priority index is associated with the overlapping slot with \( N_{\text {sym }}^{\text {slot }} \) symbols [4, TS 38.211] of larger priority index.
- the UE first resolves the overlapping for PUCCH transmissions, where at least one of the PUCCH transmissions is with \( N_{\text {PUCCH }}^{\text {repeat }}>1 \) repetitions, within a slot of larger priority index as is subsequently described in this clause, if any, and then the UE resolves the overlapping for PUCCH transmissions without repetitions within the slot using the pseudo-code in clause 9.2.5
- if the UE determines that a first PUCCH transmission of the smaller priority index is not dropped and the UCI of the first PUCCH transmission is not multiplexed in a second PUCCH transmission of larger priority index in an overlapping slot with subslotLengthForPUCCH symbols, the first PUCCH transmission is

ETSI


--- Page 62  ---


3GPP TS 38.213 version 17.1.0 Release 17
61
ETSI TS 138213 V17.1.0 (2022-05)

associated with the next overlapping slot with subslotLengthForPUCCH symbols for PUCCH transmissions with the larger priority index
- the UE does not expect a PUCCH transmission that includes UCI of different priority indexes to overlap with a PUCCH transmission with \( N_{\text {PUCCH }}^{\text {repeat }}>1 \) repetitions after resolving the overlapping for PUCCH transmissions without repetitions within a slot
- the UE does not expect a PUCCH transmission with UCI of first and second priority indexes to overlap with a PUCCH transmission with HARQ-ACK information of the first priority index, or with a PUCCH transmission or with a PUSCH transmission of the second priority index when the second priority index is larger than the first priority index
- the UE does not expect a PUCCH transmission with HARQ-ACK information of larger priority index to overlap with more than one PUCCH transmissions with HARQ-ACK information of smaller priority index
- third, the UE resolves the overlapping for PUCCH and PUSCH transmissions of different priority indexes
- the UE drops PUSCH transmissions of smaller priority index that overlap with a PUCCH transmission with positive SR of larger priority index prior to multiplexing UCI in a PUSCH transmission of smaller priority index, if any
- the UE drops PUSCH transmissions of smaller priority index that overlap with a PUCCH transmission with \( N_{\text {PUCCH }}^{\text {repeat }}>1 \) repetitions of larger priority index prior to multiplexing UCI in a PUSCH transmission of smaller priority index, if any
- the UE multiplexes HARQ-ACK information in a PUSCH transmission, as is subsequently described in this clause for multiplexing HARQ-ACK information from a PUCCH transmission in a PUSCH transmission of a same priority index, if a PUCCH transmission with HARQ-ACK information of a first priority index overlaps with one or more PUSCH transmissions of a second priority index that is different than the first priority index
- if \( / / \) this is for cases the UE supports multiplexing information of different priorities in a PUCCH/PUSCH transmission
- a PUCCH transmission with HARQ-ACK information, without repetitions, with smaller priority index overlaps with a PUCCH transmission only with HARQ-ACK information, without repetitions, with larger priority index, or
- a PUCCH transmission without repetitions that includes HARQ-ACK information of smaller priority index overlaps with a PUCCH transmission without repetitions using a PUCCH resource with PUCCH format 2/3/4 with HARQ-ACK information and SR of larger priority index, or
- a PUCCH transmission with HARQ-ACK information, without repetitions, with smaller or larger priority index overlaps, respectively, with a PUSCH transmission with larger or smaller priority index
the UE
- multiplexes HARQ-ACK information of different priority indexes and SR information of larger priority index, if any, in a same PUCCH transmission of larger priority index, or multiplexes HARQ-ACK information the UE would provide in a PUCCH transmission of smaller or larger priority index in a PUSCH transmission of larger or smaller priority index, respectively, and applies the procedures in clause 9.2.5.3 or 9.3 , respectively, and
- drops CSI and/or SR carried in the PUCCH of smaller priority index, if any
- drops HARQ-ACK information of smaller priority index if the UE would multiplex the HARQ-ACK information of smaller priority index in a PUSCH where the UE multiplexes Part 1 CSI reports and Part 2 CSI reports of larger priority index
- drops Part 2 CSI reports of smaller priority index if the UE would multiplex the HARQ-ACK information of smaller and larger priority indexes in a PUSCH where the UE multiplexes Part 1 CSI reports and Part 2 CSI reports of smaller priority index
- else

ETSI


--- Page 63  ---


3GPP TS 38.213 version 17.1.0 Release 17
62
ETSI TS 138213 V17.1.0 (2022-05)
- if the UE would transmit the following channels that would overlap in time where, if a channel transmission is with repetitions, the following are applicable per repetition
- a first PUCCH transmission of larger priority index and a second PUCCH transmission of smaller priority index
- a first PUCCH transmission of larger priority index and a second PUSCH transmission of smaller priority index when the UE cannot simultaneously transmit the first PUCCH and second PUSCH
- a first PUCCH transmission of smaller priority index and a second PUSCH transmission of larger priority index when the UE cannot simultaneously transmit the first PUCCH and second PUSCH
the UE
- transmits the PUCCH or the PUSCH of the larger priority index, and
- does not transmit a PUCCH or a PUSCH of smaller priority index

When a UE determines overlapping for PUCCH and/or PUSCH transmissions of different priority indexes, other than PUCCH transmissions with SL HARQ-ACK reports, before considering limitations for transmissions including with repetitions, if any, as described in clauses 11.1 and 11.1.1, if the UE is not provided UCI-MuxWithDifferentPriority, the UE first resolves overlapping for PUCCH and/or PUSCH transmissions of smaller priority index as described in clauses 9.2.5 and 9.2.6. Then,
- if a transmission of a first PUCCH of larger priority index scheduled by a DCI format in a PDCCH reception would overlap in time with a repetition of a transmission of a second PUSCH or a second PUCCH of smaller priority index, the UE cancels the repetition of a transmission of the second PUSCH or the second PUCCH before the first symbol that would overlap with the first PUCCH transmission
- if a transmission of a first PUSCH of larger priority index scheduled by a DCI format in a PDCCH reception would overlap in time with a repetition of the transmission of a second PUCCH of smaller priority index, the UE cancels the repetition of the transmission of the second PUCCH before the first symbol that would overlap with the first PUSCH transmission
where
- the overlapping is applicable before or after resolving overlapping among channels of larger priority index, if any, as described in clauses 9.2.5 and 9.2.6
- any remaining PUCCH and/or PUSCH transmission after overlapping resolution is subjected to the limitations for UE transmission as described in clause 11.1 and clause 11.1.1
- the UE expects that the transmission of the first PUCCH or the first PUSCH, respectively, would not start before \( T_{\text {proc }, 2} \) after a last symbol of the corresponding PDCCH reception
- \( T_{\text {proc }, 2} \) is the PUSCH preparation time for a corresponding UE processing capability assuming \( d_{2,1}=d_{1}[6, \mathrm{TS} \) 38.214], based on \( \mu \) and \( N_{2} \) as subsequently defined in this clause, and \( d_{1} \) is determined by a reported UE capability

If a UE is scheduled by a DCI format in a first PDCCH reception to transmit a first PUCCH or a first PUSCH of larger priority index that overlaps with a second PUCCH or a second PUSCH transmission of smaller priority index that, if any, is scheduled by a DCI format in a second PDCCH
- \( T_{\text {proc }, 2} \) is based on a value of \( \mu \) corresponding to the smallest SCS configuration of the first PDCCH, the second PDCCHs, the first PUCCH or the first PUSCH, and the second PUCCHs or the second PUSCHs
- if the overlapping group includes the first PUCCH
- if processingType2Enabled of PDSCH-ServingCellConfig is set to enable for the serving cell where the UE receives the first PDCCH and for all serving cells where the UE receives the PDSCHs corresponding to the second PUCCHs, and if processingType2Enabled of PUSCH-ServingCellConfig is set to enable for the serving cells with the second PUSCHs, \( N_{2} \) is 5 for \( \mu=0,5.5 \) for \( \mu=1 \) and 11 for \( \mu=2 \)
- else, \( N_{2} \) is 10 for \( \mu=0,12 \) for \( \mu=1,23 \) for \( \mu=2,36 \) for \( \mu=3,144 \) for \( \mu=5 \), and 288 for \( \mu=6 \);

ETSI


--- Page 64  ---


3GPP TS 38.213 version 17.1.0 Release 17
63
ETSI TS 138213 V17.1.0 (2022-05)
- if the overlapping group includes the first PUSCH
- if processingType2Enabled of PUSCH-ServingCellConfig is set to enable for the serving cells with the first PUSCH and the second PUSCHs and if processingType2Enabled of PDSCHServingCellConfig is set to enable for all serving cells where the UE receives the PDSCHs corresponding to the second PUCCHs, \( N_{2} \) is 5 for \( \mu=0,5.5 \) for \( \mu=1 \) and 11 for \( \mu=2 \)
- else, \( N_{2} \) is 10 for \( \mu=0,12 \) for \( \mu=1,23 \) for \( \mu=2,36 \) for \( \mu=3,144 \) for \( \mu=5 \), and 288 for \( \mu=6 \);

If a UE would transmit the following channels, including repetitions if any, that would overlap in time
- a first PUCCH of larger priority index with SR and a second PUCCH or PUSCH of smaller priority index, or
- a configured grant PUSCH of larger priority index and a PUCCH of smaller priority index, or
- a first PUCCH of larger priority index with HARQ-ACK information only in response to PDSCH(s) reception without corresponding PDCCH(s) and a second PUCCH of smaller priority index with HARQACK information only in response to PDSCH(s) reception without corresponding PDCCH(s), or a second PUCCH of smaller priority index with SR and/or CSI, or a configured grant PUSCH with smaller priority index, or a PUSCH of smaller priority index with SP-CSI report(s) without a corresponding PDCCH, or
- a PUSCH of larger priority index with SP-CSI reports(s) without a corresponding PDCCH and a PUCCH of smaller priority index with SR, or CSI, or HARQ-ACK information only in response to PDSCH(s) reception without corresponding PDCCH(s), or
- a configured grant PUSCH of larger priority index and a configured grant PUSCH of smaller priority index on a same serving cell
- a PUSCH of smaller priority index scheduled by a DCI format and a configured grant PUSCH of larger priority index on a same serving cell if the UE is provided prioritizationBetweenLP-DG-PUSCHandHP-CGPUSCH
the UE is expected to cancel a repetition of the PUCCH/PUSCH transmissions of smaller priority index before the first symbol overlapping with the PUCCH/PUSCH transmission of larger priority index if the repetition of the PUCCH/PUSCH transmissions of smaller priority index overlaps in time with the PUCCH/PUSCH transmissions of larger priority index. In case of a PUSCH of larger priority index scheduled by a DCI format in a PDCCH reception and a configured grant PUSCH of smaller priority index on a same serving cell and the UE is provided prioritizationBetweenHP-DG-PUSCHandLP-CG-PUSCH
- the UE expects that the transmission of the PUSCH of larger priority index would not start before \( T_{p r o c, 2} \) after a last symbol of the corresponding PDCCH reception
- \( T_{\text {proc, } 2} \) is the PUSCH preparation time for a corresponding UE processing capability assuming \( d_{2,1}=d_{1}+ d_{3}\left[6\right. \), TS 38.214], based on \( \mu \) and \( N_{2} \) as subsequently defined in this clause, and \( d_{1} \) and \( d_{3} \) are determined by a reported UE capability

When a UE determines overlapping for PUCCH transmissions with SL HARQ-ACK reports and PUSCH of smaller priority index, including repetitions if any, after resolving the overlapping PUCCH other than PUCCH transmissions with SL HARQ-ACK reports and/or PUSCH transmissions, if the PUSCH includes no UCI, the UE resolves the overlapping for PUCCH transmissions with SL HARQ-ACK reports and PUSCH of smaller priority index as described in clauses 9.2.5 and 9.2.6.

When a UE determines overlapping for PUCCH transmissions with SL HARQ-ACK reports and PUSCH of larger priority index only, including repetitions if any, after resolving the overlapping PUCCH other than PUCCH transmissions with SL HARQ-ACK reports and/or PUSCH transmissions, the UE does not transmit the PUCCH with SL HARQ-ACK reports
where
- the UE expects that the transmission of the PUSCH would not start before \( T_{p r o c, 2}+d_{1} \) after a last symbol of the corresponding PDCCH reception;
- \( T_{\text {proc }, 2} \) is the PUSCH preparation time for a corresponding UE processing capability assuming \( d_{2,1}=0[6 \), TS 38.214], based on \( \mu \) and \( N_{2} \) as subsequently defined in this clause, and \( d_{1} \) is determined by a reported UE capability.

ETSI


--- Page 65  ---


3GPP TS 38.213 version 17.1.0 Release 17
64
ETSI TS 138213 V17.1.0 (2022-05)

The UE expects the PUCCH and PUSCH transmissions to fulfill the conditions in clause 9 and clause 9.2 .5 for UCI multiplexing replacing the reference time of "end of PDSCH" with "end of the last symbol of a last PSFCH reception occasion" as described in 16.5 and \( T_{p r o c .1} \) with \( T_{p r e p} \) -

A UE does not expect that a PUCCH carrying SL HARQ-ACK reports overlaps with PUSCH with aperiodic or semipersistent CSI reports.

A UE does not expect to be scheduled to transmit a PUCCH or a PUSCH with smaller priority index that would overlap in time with a PUCCH of larger priority index with HARQ-ACK information only in response to a PDSCH reception without a corresponding PDCCH unless the UE is provided UCI-MuxWithDifferentPriority. A UE does not expect to be scheduled to transmit a PUCCH of smaller priority index that would overlap in time with a PUSCH of larger priority index with SP-CSI report(s) without a corresponding PDCCH unless the UE is provided UCI-
MuxWithDifferentPriority.
In the remaining of this clause, a UE multiplexes UCIs with same priority index in a PUCCH or a PUSCH before considering limitations for UE transmission as described in clause 11.1, clause 11.1.1, and clause 17.2. A PUCCH or a PUSCH is assumed to have a same priority index as a priority index of UCIs a UE multiplexes in the PUCCH or the PUSCH.

In the remaining of this clause, the multiplexing or prioritization for overlapping channels are for overlapping channels with same priority index or for overlapping channels with a PUCCH carrying SL HARQ-ACK information.

In the remaining of this clause, if a UE is provided subslotLengthForPUCCH, a slot for an associated PUCCH resource of a PUCCH transmission with HARQ-ACK information includes a number of symbols indicated by subslotLengthForPUCCH, unless stated otherwise.

If a UE would transmit on a serving cell a PUSCH without UL-SCH that overlaps with a PUCCH transmission on a serving cell that includes positive SR information, the UE does not transmit the PUSCH.

If a UE would transmit CSI reports on overlapping physical channels, the UE applies the priority rules described in [6, TS 38.214] for the multiplexing of CSI reports.

If a UE has overlapping resources for PUCCH transmissions in a slot and at least one of the PUCCH transmissions is with repetitions over multiple slots, the UE first follows the procedures described in clause 9.2.6 for resolving the overlapping among the resources for the PUCCH transmissions.

If a UE
- would multiplex UCI in a PUCCH transmission that overlaps with a PUSCH transmission, and
- the PUSCH and PUCCH transmissions fulfill the conditions in clause 9.2.5 for UCI multiplexing,
the UE
- multiplexes only HARQ-ACK information, if any, from the UCI in the PUSCH transmission and does not transmit the PUCCH if the UE multiplexes aperiodic or semi-persistent CSI reports in the PUSCH;
- multiplexes only HARQ-ACK information and CSI reports, if any, from the UCI in the PUSCH transmission and does not transmit the PUCCH if the UE does not multiplex aperiodic or semi-persistent CSI reports in the PUSCH.

A UE does not expect to multiplex in a PUSCH transmission in one slot with SCS configuration \( \mu_{1} \) UCI of same type that the UE would transmit in PUCCHs in different slots with SCS configuration \( \mu_{2} \) if \( \mu_{1}<\mu_{2} \).

A UE does not expect to multiplex in a PUSCH transmission or in a PUCCH transmission HARQ-ACK information that the UE would transmit in different PUCCHs of a same priority index.

A UE does not expect a PUCCH resource that results from multiplexing overlapped PUCCH resources, if applicable, to overlap with more than one PUSCHs if each of the more than one PUSCHs includes aperiodic CSI reports.

A UE does not expect to detect a DCI format scheduling a PDSCH reception or having associated HARQ-ACK information report without scheduling a PDSCH reception, and indicating a resource for a PUCCH transmission with corresponding HARQ-ACK information in a slot if the UE previously detects a DCI format scheduling a PUSCH transmission in the slot and if the UE multiplexes HARQ-ACK information in the PUSCH transmission.

ETSI


--- Page 66  ---


3GPP TS 38.213 version 17.1.0 Release 17
65
ETSI TS 138213 V17.1.0 (2022-05)

If a UE multiplexes aperiodic CSI in a PUSCH and the UE would multiplex UCI that includes HARQ-ACK information in a PUCCH that overlaps with the PUSCH and the timing conditions for overlapping PUCCHs and PUSCHs in clause 9.2.5 are fulfilled, the UE multiplexes only the HARQ-ACK information in the PUSCH and does not transmit the PUCCH.

If a UE transmits multiple PUSCHs in a slot on respective serving cells that include first PUSCHs that are scheduled by DCI formats and second PUSCHs configured by respective ConfiguredGrantConfig or semiPersistentOnPUSCH, and the UE would multiplex UCI in one of the multiple PUSCHs, and the multiple PUSCHs fulfil the conditions in clause 9.2.5 for UCI multiplexing, the UE multiplexes the UCI in a PUSCH from the first PUSCHs.

If a UE transmits multiple PUSCHs in a slot on respective serving cells and the UE would multiplex UCI in one of the multiple PUSCHs and the UE does not multiplex aperiodic CSI in any of the multiple PUSCHs, the UE multiplexes the UCI in a PUSCH of the serving cell with the smallest ServCelllndex subject to the conditions in clause 9.2.5 for UCI multiplexing being fulfilled. If the UE transmits more than one PUSCHs in the slot on the serving cell with the smallest ServCellIndex that fulfil the conditions in clause 9.2.5 for UCI multiplexing, the UE multiplexes the UCI in the earliest PUSCH that the UE transmits in the slot.

If a UE transmits a PUSCH over multiple slots and the UE would transmit a PUCCH with HARQ-ACK and/or CSI information over a single slot that overlaps with the PUSCH transmission in one or more slots of the multiple slots, and the PUSCH transmission in the one or more slots fulfills the conditions in clause 9.2 .5 for multiplexing the HARQACK and/or CSI information, the UE multiplexes the HARQ-ACK and/or CSI information in the PUSCH transmission in the one or more slots. The UE does not multiplex HARQ-ACK and/or CSI information in the PUSCH transmission in a slot from the multiple slots if the UE would not transmit a single-slot PUCCH with HARQ-ACK and/or CSI information in the slot in case the PUSCH transmission was absent.

If a UE transmits a PUSCH with repetition Type B and the UE would transmit a PUCCH with HARQ-ACK and/or CSI information over a single slot that overlaps with the PUSCH transmission in one or more slots, the UE expects all actual repetitions of the PUSCH transmission [6, TS 38.214] that would overlap with the PUCCH transmission to fulfill the conditions in clause 9.2.5 for multiplexing the HARQ-ACK and/or CSI information, and the UE multiplexes the HARQ-ACK and/or CSI information in the earliest actual PUSCH repetition of the PUSCH transmission that would overlap with the PUCCH transmission and includes more than one symbol. The UE does not expect that all actual repetitions that would overlap with the PUCCH transmission do not include more than one symbol.

If the PUSCH transmission over the multiple slots is scheduled by a DCI format that includes a DAI field, the value of the DAI field is applicable for multiplexing HARQ-ACK information in the PUSCH transmission in any slot from the multiple slots where the UE multiplexes HARQ-ACK information.

When a UE would multiplex HARQ-ACK information in a PUSCH transmission that is configured by a ConfiguredGrantConfig, and includes CG-UCI [5, TS 38.212], the UE multiplexes the HARQ-ACK information in the PUSCH transmission if the UE is provided cg-UCI-Multiplexing; otherwise, if the HARQ-ACK information and the PUSCH have same priority index, the UE does not transmit the PUSCH and multiplexes the HARQ-ACK information in a PUCCH transmission or in another PUSCH transmission; if the HARQ-ACK information and the PUSCH have different priority indexes, the UE does not transmit the channel with the smaller priority index.

In the following, DCI formats with CRC scrambled by C-RNTI or CS-RNTI or MCS-C-RNTI are also referred to as unicast DCI formats and DCI formats with CRC scrambled by G-RNTI or G-CS-RNTI are also referred to as multicast DCI formats. Corresponding unicast DCI formats are DCI formats \( 0 \_0 / 0 \_1 / 0 \_2 / 1 \_0 / 1 \_1 / 1 \_2 \) and multicast DCI formats are DCI formats 4_1/4_2 [4, TS 38.212]. PDSCH receptions scheduled by unicast or multicast DCI formats or HARQACK information associated with unicast or multicast DCI formats are also respectively referred as unicast or multicast PDSCH receptions or unicast or multicast HARQ-ACK information.

For the remaining of this clause, if a UE is provided \( K_{\text {cell, offset }} \) by CellSpecific_Koffset or \( K_{\text {UE }, \text { offset }} \) by a MAC CE command, reference to a slot \( n+k \) for a PUCCH transmission or PUSCH transmission corresponds to a slot \( n+k+ 2^{\mu-\mu_{K_{0}}} \) ffset \( \cdot K_{\text {offset }} \) for the PUSCH or the PUCCH transmission, where \( \mu \) is the SCS configuration for the PUCCH transmission or PUSCH transmission, \( K_{\text {offset }} \) is defined in clause 4.2, and \( \mu_{K_{\text {offset }}}=0 \) in FR1. If Koffset or if the MAC CE command is not provided, \( K_{\text {cell, offset }}=0 \) or \( K_{\mathrm{UE}, \text { offset }}=0 \), respectively. If the PUCCH transmission or the PUSCH transmission is scheduled by a DCI format with CRC scrambled by TC-RNTI, \( K_{\mathrm{UE}, \text { offset }}=0 \). If the UE is provided a \( K_{\mathrm{UE}, \text { offset }} \) value by a MAC CE command, the UE applies the MAC command in the first slot that is after slot \( k+ 3 N_{\text {slot }}^{\text {sub frame }, \mu} \) where \( k \) is the slot where the UE would transmit a PUCCH with HARQ-ACK information for the PDSCH providing the MAC CE command, \( \mu \) is the SCS configuration for the PUCCH transmission that is determined in the slot when the MAC CE command is applied.

ETSI


--- Page 67  ---


3GPP TS 38.213 version 17.1.0 Release 17
66
ETSI TS 138213 V17.1.0 (2022-05)
9.A PUCCH cell switching

This clause is applicable when a UE is provided a PUCCH-sSCell by pucch-sSCell and the PUCCH-sSCell is activated and does not have a dormant UL/DL active BWP.

A UE can be provided a periodic cell switching pattern for PUCCH transmissions by pucch-sSCellPattern. Each bit of the pattern corresponds to a slot for a reference SCS configuration provided by tdd-UL-DL-ConfigurationCommon for the PCell with a value of ' 0 ' or a value of ' 1 ' indicating, respectively, the PCell or the PUCCH-sSCell as the cell for PUCCH transmissions during the slot of the reference SCS configuration. A slot on the active UL BWP of the PUCCHsSCell does not overlap with more than one slot on the active UL BWP of the Pcell. If a slot for the active UL BWP of the PCell overlaps with more than one slot on the active BWP of the PUCCH-sSCell and the UE would transmit a PUCCH on the PUCCH-sSCell, the UE considers the first of the overlapping slots for the PUCCH transmission on the PUCCH-sSCell.

If a UE is provided pucch-sSCellDyn or pucch-sSCellDynDCI-1-2, a corresponding DCI format associated with generation of HARQ-ACK information by the UE can include a PUCCH cell indicator field [5, TS 38.212] with a value of ' 0 ' or a value of ' 1 ' indicating, respectively, whether a PUCCH transmission with the HARQ-ACK information by the UE is on the Pcell or on the PUCCH-sSCell.

A UE transmits a PUCCH on a PUCCH-sSCell with a power that the UE determines as described in clause 7.2.1, where the UE applies
- a p0-PUCCH-Value from pucch-PowerControl in PUCCH-Config for the PUCCH-sSCell for the determination of \( P_{O, P \cup C C H, b, f, c}\left(q_{u}\right) \)
- a pucch-PathlossReferenceRS-Id from pucch-PowerControl in PUCCH-Config for the PUCCH-sSCell for the determination of \( P L_{b, f, c}\left(q_{d}\right) \)
- a PUCCH power control adjustment state \( g_{b, 0, c}(i, 0) \) for active UL BWP \( b \) of the UL carrier of PUCCH-sSCell \( c \) and PUCCH transmission occasion \( i \) where \( \delta_{\mathrm{PUCCH}, b, 0_{c} c}(i, 0) \) is a TPC command value included in a DCI format associated with generation of HARQ-ACK information for multiplexing in a PUCCH transmission on the PUCCH-sSCell as indicated either by a pucch-sSCellPattern or by a PUCCH cell indicator field in the DCI format, or provided by DCI format 2_2 with CRC scrambled by TPC-PUCCH-RNTI for the PUCCH-sSCell as described in clause 11.3
9.1 HARQ-ACK codebook determination

If a UE is provided pdsch-HARQ-ACK-CodebookList, the UE can be indicated by pdsch-HARQ-ACK-CodebookList to generate one or two HARQ-ACK codebooks. If the UE is indicated to generate one HARQ-ACK codebook, the HARQACK codebook is associated with a PUCCH of priority index 0 . If a UE is provided pdsch-HARQ-ACK-CodebookList, the UE multiplexes in a same HARQ-ACK codebook only HARQ-ACK information associated with a same priority index. If the UE is indicated to generate two HARQ-ACK codebooks
- a first HARQ-ACK codebook is associated with a PUCCH of priority index 0 and a second HARQ-ACK codebook is associated with a PUCCH of priority index 1
- the UE is provided first and second for each of (PUCCH-Config, UCI-OnPUSCH, PDSCHcodeBlockGroupTransmission) by \{PUCCH-ConfigurationList, UCI-OnPUSCH-ListDCI-0-1, PDSCHCodeBlockGroupTransmissionList\} or \{PUCCH-ConfigurationList, UCI-OnPUSCH-ListDCI-0-2, PDSCHCodeBlockGroupTransmissionList\}, respectively, for use with the first and second HARQ-ACK codebooks, respectively

If a UE receives a PDSCH without receiving a corresponding PDCCH, or if the UE receives a PDCCH indicating a SPS PDSCH release, the UE generates one corresponding HARQ-ACK information bit. If the UE generates two HARQACK codebooks, the UE is indicated by harq-CodebookID, per SPS PDSCH configuration, a HARQ-ACK codebook index for multiplexing the corresponding HARQ-ACK information bit.

If a UE is provided pdsch-HARQ-ACK-OneShotFeedback and the UE detects a DCI format in any PDCCH monitoring occasion that includes a One-shot HARQ-ACK request field with value 1
- the UE includes the HARQ-ACK information in a Type-3 HARQ-ACK codebook, as described in clause 9.1.4

ETSI


--- Page 68  ---


3GPP TS 38.213 version 17.1.0 Release 17
67
ETSI TS 138213 V17.1.0 (2022-05)
- the UE does not expect that the PDSCH-to-HARQ_feedback timing indicator field of the DCI format provides an inapplicable value from dl-DataToUL-ACK-r16

In the remaining of this clause, reference is to one HARQ-ACK codebook and to DCI formats that schedule PDSCH reception, or have associated HARQ-ACK information without scheduling a PDSCH reception and are associated with the HARQ-ACK codebook.

If a UE is required to receive SPS PDSCHs in a slot according to Clause 5.1 of [6] and Clause 11.1 for SPS configurations that are indicated to be released by a DCI format, the UE is not expected to receive the DCI format in the slot if the end of the last symbol of the PDCCH reception is after the end of a last symbol of any of the SPS PDSCH receptions. For a SPS configuration subject to pdsch-AggregationFactor or pdsch-AggregationFactor-r16, the UE is not expected to receive the DCI format in a slot containing a SPS PDSCH transmission occasion other than the first transmission occasion required to be received by the UE for a TB.

If a UE is configured to receive SPS PDSCHs in a slot for SPS configurations that are indicated to be released by a DCI format, and if the UE receives the PDCCH providing the DCI format in the slot, and if HARQ-ACK information for the SPS PDSCH release and the SPS PDSCH receptions would be multiplexed in a same PUCCH, the UE does not expect to receive the SPS PDSCHs, does not generate HARQ-ACK information for the SPS PDSCH receptions, and generates a HARQ-ACK information bit for the SPS PDSCH release.

If a UE is configured to receive SPS PDSCH(s) in a slot for SPS configuration(s), the UE does not expect to receive a PDCCH providing a DCI format in the slot to indicate SPS PDSCH release of these SPS configuration(s), if HARQACK information for the SPS PDSCH release and the SPS PDSCH reception(s) would map to different PUCCHs.

If a UE detects a DCI format 1 _ 1 indicating
- SCell dormancy without scheduling a PDSCH reception, as described in clause 10.3, and
- is provided pdsch-HARQ-ACK-Codebook = dynamic or pdsch-HARQ-ACK-Codebook-r16
the UE generates a HARQ-ACK information bit as described in clause 9.1 s for a DCI format 1 _ 1 indicating SCell dormancy and the HARQ-ACK information bit value is ACK.

If a UE is not provided PDSCH-CodeBlockGroupTransmission, the UE generates one HARQ-ACK information bit per transport block.

For a HARQ-ACK information bit, a UE generates a positive acknowledgement (ACK) if the UE detects a DCI format that provides a SPS PDSCH release or correctly decodes a transport block, and generates a negative acknowledgement (NACK) if the UE does not correctly decode the transport block. A HARQ-ACK information bit value of 0 represents a NACK while a HARQ-ACK information bit value of 1 represents an ACK.

In the following, the CRC for a DCI format is scrambled with a C-RNTI, an MCS-C-RNTI, or a CS-RNTI, or a GRNTI, or a G-CS-RNTI.
9.1.1 CBG-based HARQ-ACK codebook determination

If a UE is provided PDSCH-CodeBlockGroupTransmission for a serving cell, the UE receives a PDSCH scheduled by DCI format 1_1, that includes code block groups (CBGs) of a transport block. The UE is also provided maxCodeBlockGroupsPerTransportBlock indicating a maximum number \( N_{\mathrm{HARQACK}}^{\mathrm{CBGTE} \text {, max }} \) of CBGs for generating respective HARQ-ACK information bits for a transport block reception for the serving cell.

For a number of \( C \) code blocks (CBs) in a transport block, the UE determines a number of CBGs \( M \) according to clause 5.1.7.1 of [6, TS 38.214] and determines a number of HARQ-ACK bits for the transport block as \( N_{\text {HARQ-ACK }}^{\mathrm{CBGTB}}=M \).

The UE generates an ACK for the HARQ-ACK information bit of a CBG if the UE correctly received all code blocks of the CBG and generates a NACK for the HARQ-ACK information bit of a CBG if the UE incorrectly received at least one code block of the CBG. If the UE receives two transport blocks, the UE concatenates the HARQ-ACK information bits for CBGs of the second transport block after the HARQ-ACK information bits for CBGs of the first transport block.

ETSI


--- Page 69  ---


3GPP TS 38.213 version 17.1.0 Release 17
68
ETSI TS 138213 V17.1.0 (2022-05)

The HARQ-ACK codebook includes the \( N_{\text {HARQ-ACK }}^{\mathrm{CBGTB}, \text { max }} \) HARQ-ACK information bits and, if \( N_{\text {HARQ-ACK }}^{\mathrm{CBGTB}}<N_{\text {HARQ-ACK }}^{\mathrm{CBG} / \mathrm{TB}, \text { max }} \) for a transport block, the UE generates a NACK value for the last \( N_{\text {HARQ-ACK }}^{\mathrm{CBG} / \mathrm{TB}, \text { max }}-N_{\text {HARQ-ACK }}^{\mathrm{CBG} / \mathrm{TB}} \) HARQ-ACK information bits for the transport block in the HARQ-ACK codebook.

If the UE generates a HARQ-ACK codebook in response to a retransmission of a transport block, corresponding to a same HARQ process as a previous transmission of the transport block, the UE generates an ACK for each CBG that the UE correctly decoded in a previous transmission of the transport block.

If a UE correctly detects each of the \( N_{\text {HARQ-ACK }}^{\mathrm{CBGTB}} \) CBGs and does not correctly detect the transport block for the \( N_{\text {HARQ-ACK }}^{\mathrm{CBGTB}} \) CBGs, the UE generates a NACK value for each of the \( N_{\text {HARQ-ACK }}^{\mathrm{CBGTB}} \) CBGs.
9.1.2 Type-1 HARQ-ACK codebook determination

This clause applies if the UE is configured with pdsch-HARQ-ACK-Codebook \( = \) semi-static. In clauses 9.1.2, 9.1.2.1, and 9.1.2.2, if the UE is configured with pdsch-HARQ-ACK-Codebook = semi-static for only one of unicast or multicast HARQ-ACK codebook, the Type-1 HARQ-ACK codebook is generated considering only one of respective unicast or multicast configurations for PDSCH receptions or for PDCCH monitoring for detection of DCI formats.

If a UE is provided HARQ-feedbackEnabling-disablingperHARQprocess indicating disabled HARQ-ACK information for a HARQ process associated with a transport block in PDSCH reception occasion \( m \) on serving cell \( c \), the UE reports a NACK value for a HARQ-ACK information bit corresponding to the transport block in a Type-1 HARQ-ACK codebook and does not consider the transport block as received in the determination of \( N_{m, c}^{\text {received }} \) in clause 9.1.2.1. If the UE is also provided PDSCH-CodeBlockGroupTransmission, the UE reports NACK values for HARQ-ACK information bits corresponding to CBGs of the transport block in the Type-1 HARQ-ACK codebook and does not consider the CBGs as received in the determination of \( N_{m, c}^{\text {received, CBG }} \) in clause 9.1.2.1. If the UE is also provided HARQfeedbackEnablingforSPSactive, the UE considers a HARQ process associated with a transport block in a first SPS PDSCH reception, after an activation of SPS PDSCH receptions, to have enabled HARQ-ACK information and the UE provides a HARQ-ACK information bit according to a decoding outcome for the transport block in the first SPS PDSCH reception.

A UE reports HARQ-ACK information for a corresponding PDSCH reception or SPS PDSCH release or TCI state update only in a HARQ-ACK codebook that the UE transmits in a slot indicated by a value of a PDSCH-toHARQ_feedback timing indicator field in a corresponding DCI format or provided by dl-DataToUL-ACK or dl-DataToUL-ACK-r16 or dl-DataToUL-ACK-ForDCI-Formatl-2 if the PDSCH-to-HARQ_feedback timing indicator field is not present in the DCI format as described in clause 9.2.3. The UE reports NACK value(s) for HARQ-ACK information bit(s) in a HARQ-ACK codebook that the UE transmits in a slot not indicated by a value of a PDSCH-toHARQ_feedback timing indicator field in a corresponding DCI format.

If a UE is not provided pdsch-HARQ-ACK-OneShotFeedback, the UE does not expect to receive a PDSCH scheduled by a DCI format that the UE detects in any PDCCH monitoring occasion and includes a PDSCH-to-HARQ_feedback timing indicator field providing an inapplicable value from \( d l \)-DataToUL-ACK-r 16 .

If the UE is provided pdsch-AggregationFactor-r16 in SPS-Config or pdsch-AggregationFactor in PDSCH-Config and no entry in pdsch-TimeDomainAllocationList and pdsch-TimeDomainAllocationListDCI-1-2 includes repetitionNumber in PDSCH-TimeDomainResourceAllocation-r 16, \( N_{\text {PDSCH }}^{\text {repeat }}{ }^{\text {max }} \) is a maximum value of pdsch-AggregationFactor-r 16 in SPS-Config or pdsch-AggregationFactor in PDSCH-Config; otherwise \( N_{\text {PDSCH }}^{\text {repeat }} \) max \( =1 \). The UE reports HARQ-ACK information for a PDSCH reception
- from DL slot \( n_{D}-N_{\text {PDSCH }}^{\text {repeat }}+1 \) to DL slot \( n_{D} \), if \( N_{\text {PDSCH }}^{\text {repeat }} \) is provided by pdsch-AggregationFactor or pdsch-AggregationFactor-r16 [6, TS 38.214], or
- from DL slot \( n_{D} \)-repetitionNumber +1 to DL slot \( n_{D} \), if the time domain resource assignment field in the DCI format scheduling the PDSCH reception indicates an entry containing repetitionNumber, or
- in DL slot \( n_{D} \), otherwise
only in a HARQ-ACK codebook that the UE includes in a PUCCH or PUSCH transmission in slot \( n+k \), where \( n \) is
- an UL slot overlapping with the end of the PDSCH reception in DL slot \( n_{D} \) if the UE is provided subslotLengthForPUCCH for the HARQ-ACK codebook

ETSI


--- Page 70  ---


3GPP TS 38.213 version 17.1.0 Release 17
69
ETSI TS 138213 V17.1.0 (2022-05)
- the last UL slot for PUCCH transmission overlapping with DL slot \( n_{D} \) if the UE is not provided subslotLengthForPUCCH for the HARQ-ACK codebook
and \( k \) is a number of slots indicated by the PDSCH-to-HARQ_feedback timing indicator field in a corresponding DCI format, or provided by dl-DataToUL-ACK or dl-DataToUL-ACK-r16 or dl-DataToUL-ACK-ForDCI-Formatl-2 if the PDSCH-to-HARQ_feedback timing indicator field is not present in the DCI format. If the UE reports HARQ-ACK information for the PDSCH reception in a slot other than slot \( n+k \), the UE sets a value for each corresponding HARQACK information bit to NACK.

If a UE reports HARQ-ACK information in a PUCCH only for
- a SPS PDSCH release indicated by DCI format \( 1 \_0 \) or by DCI format \( 4 \_1 \), with counter DAI field value of 1 , or
- a PDSCH reception scheduled by DCI format \( 1 \_0 \) or by DCI format \( 4 \_1 \) having enabled associated HARQ-ACK information report as described in clause 18, with counter DAI field value of 1 on the PCell, or
- SPS PDSCH receptions associated with a CS-RNTI or with G-CS-RNTIs having enabled associated HARQACK information reports as described in clause 18
within the \( M_{A, c} \) occasions for candidate PDSCH receptions as determined in clause 9.1.2.1, the UE determines a HARQACK codebook only for the SPS PDSCH release, or only for the PDSCH reception, or only for SPS PDSCH receptions according to corresponding \( M_{A, c} \) occasions on respective serving cells, where the value of counter DAI in DCI format \( 1 \_0 \) or in DCI format 4_1 is according to Table 9.1.3-1 and HARQ-ACK information bits in response to more than one SPS PDSCH receptions that the UE is configured to receive are ordered according to the following pseudo-code; otherwise, the procedures in clause 9.1.2.1 and clause 9.1.2.2 for a HARQ-ACK codebook determination apply.

In the following pseudo-code, SPS PDSCH receptions associated with a SPS PDSCH configuration are activated by a DCI format with CRC scrambled by a CS-RNTI or by a DCI format with CRC scrambled by a G-CS-RNTI.

Set \( N_{\text {cells }}^{\mathrm{DL}} \) to the number of serving cells configured to the UE
Set \( N_{\mathrm{c}}^{\text {SPS }} \) to the number of SPS PDSCH configurations configured to the UE for serving cell \( c \)
Set \( N_{\mathrm{c}}^{\mathrm{DL}} \) to the number of DL slots for SPS PDSCH receptions on serving cell \( c \) with HARQ-ACK information multiplexed on the PUCCH

Set \( j=0- \) HARQ-ACK information bit index
Set \( c=0 \)-serving cell index: lower indexes correspond to lower RRC indexes of corresponding cell
while \( c<N_{\text {cells }}^{\mathrm{DL}} \)
Set \( s=0 \)-SPS PDSCH configuration index: lower indexes correspond to lower RRC indexes of corresponding
SPS configurations
while \( s<N_{\mathrm{c}}^{\text {SPS }} \)
Set \( n_{D}=0- \) slot index
while \( n_{D}<N_{\mathrm{c}}^{\text {DL }} \)
if \{
a UE is configured to receive SPS PDSCHs from slot \( n_{D}-N_{\text {PDSCH }}^{\text {repeat }}+1 \) to slot \( n_{D} \) for SPS PDSCH configuration \( s \) on serving cell \( c \), excluding SPS PDSCHs that are not required to be received in any slot among overlapping SPS PDSCHs, if any according to [6, TS 38.214], or based on a UE capability for a number of PDSCH receptions in a slot according to [6, TS 38.214], or due to overlapping with a set of symbols indicated as uplink by tdd-UL-DL-ConfigurationCommon or by tdd-UL-DL-ConfigurationDedicated where \( N_{\text {PDSCH }}^{\text {repeat }} \) is provided by pdsch-AggregationFactor\( r 16 \) in sps-Config or, if pdsch-AggregationFactor-r16 is not included in sps-Config, by pdschAggregationFactor in pdsch-config, and

HARQ-ACK information for the SPS PDSCH is associated with the PUCCH
\}

ETSI


--- Page 71  ---


3GPP TS 38.213 version 17.1.0 Release 17
70
ETSI TS 138213 V17.1.0 (2022-05)
```
    \( \tilde{o}_{j}^{A C K}= \) HARQ-ACK information bit for this SPS PDSCH reception
    \( j=j+1 ; \)
end if
\( n_{D}=n_{D}+1 ; \)
```

end while
\[
s=s+1 ;
\]
end while
\[
c=c+1 ;
\]
end while
9.1.2.1 Type-1 HARQ-ACK codebook in physical uplink control channel

For a serving cell \( c \), an active DL BWP, and an active UL BWP, as described in clause 12, the UE determines a set of \( M_{A, C} \) occasions for candidate PDSCH receptions for which the UE can transmit corresponding HARQ-ACK information in a PUCCH in slot \( n_{U} \). If serving cell \( c \) is deactivated, the UE uses as the active DL BWP for determining the set of \( M_{A, c} \) occasions for candidate PDSCH receptions a DL BWP provided by firstActiveDowninkBWP-Id. The determination is based:
a) on a set of slot timing values \( K_{1} \) associated with the active UL BWP on the primary cell or, if the PUCCH transmission is indicated by a DCI format to be on the PUCCH-sSCell as described in clause 9 A , on a set of slot timing values \( K_{1} \) associated with the active UL BWP on the PUCCH-sSCell
- If the UE is configured to monitor PDCCH for DCI format \( 1 \_0 \) and is not configured to monitor PDCCH for either DCI format \( 1 \_1 \) or DCI format \( 1 \_2 \) for serving cell \( c, \bar{K}_{1} \) is provided by the slot timing values \( \{1,2,3 \), \( 4,5,6,7,8\} \) for SCS configuration of PUCCH transmission \( \mu \leq 3,\{7,8,12,16,20,24,28,32\} \) for \( \mu=5 \), and \( \{13,16,24,32,40,48,56,64\} \) for \( \mu=6 \)
- If the UE is configured to monitor PDCCH for DCI format \( 1 \_1 \) and is not configured to monitor PDCCH for DCI format \( 1 \_2 \) for serving cell \( c, K_{1} \) is provided by dl-DataToUL-ACK or dl-DataToUL-ACK-r 16
- If the UE is configured to monitor PDCCH for DCI format \( 1 \_2 \) and is not configured to monitor PDCCH for DCI format \( 1 \_1 \) for serving cell \( c, K_{1} \) is provided by \( d l \)-DataToUL-ACK-DCI-1-2
- If the UE is configured to monitor PDCCH for DCI format \( 1 \_1 \) and DCI format \( 1 \_2 \) for serving cell \( c, K_{1} \) is provided by the union of dl-DataToUL-ACK or dl-DataToUL-ACK-r16 and dl-DataToUL-ACK-DCI-1-2
- If an inapplicable value in \( d l \)-DataToUL-ACK-r16 is provided, the value is excluded from \( K_{1} \)
- If the UE is configured to monitor PDCCH for multicast DCI formats for serving cell \( c \)
- if the UE is not provided typel-Codebook-Generation-Mode \( = \) 'model', \( K_{1} \) is additionally provided by the union of dl-DataToUL-ACK from pucch-ConfigurationListMulticastl or pucchConfigurationListMulticast2 and dl-DataToUL-ACK-ForDCI Format4_1
- if the UE is not provided dl-DataToUL-ACK-ForDCIFormat4_l, \( K_{1} \) is provided by the union of \( d l \) -DataToUL-ACK from pucch-ConfigurationListMulticast I or pucch-ConfigurationListMulticast 2 and the slot timing values \( \{1,2,3,4,5,6,7,8\} \)
- if the UE is provided typel-Codebook-Generation-Mode = 'model', the UE
- determines a first \( K_{1, \mathrm{UM}} \) set as \( K_{1} \cap K_{1, \mathrm{M}} \), where \( K_{1, \mathrm{M}} \) is a set of slot timing values for the multicast DCI formats, a second \( K_{1, \mathrm{U} \backslash \mathrm{M}} \) set as \( K_{1} \backslash K_{1, \mathrm{UM}} \), and a third \( K_{1, \mathrm{M} \backslash \mathrm{U}} \) set as \( K_{1, \mathrm{M}} \backslash K_{1, \mathrm{UM}} \)
b) on a set of row indexes \( R \) of a table that is associated with the active DL BWP and defining respective sets of slot offsets \( K_{0} \), start and length indicators SLIV, and PDSCH mapping types for PDSCH reception as described in [6, TS 38.214], where the row indexes \( R \) of the table are provided by

ETSI


--- Page 72  ---


3GPP TS 38.213 version 17.1.0 Release 17
71
ETSI TS 138213 V17.1.0 (2022-05)
- the union of row indexes of time domain resource allocation tables for DCI formats the UE is configured to monitor PDCCH for serving cell \( c \) if the UE is not configured to monitor PDCCH for multicast DCI formats for serving cell \( c \), or is not provided typel-Codebook-Generation-Mode = 'model', or, if any, for the first \( K_{1, \mathrm{UM}} \) set
- the union of row indexes of time domain resource allocation tables for DCI format \( 1 \_0 \) and/or DCI format 1_1 and/or DCI format 1_2 for serving cell \( c \) for the second \( K_{1, U \backslash M} \) set, if any
- the union of row indexes of time domain resource allocation tables for multicast DCI formats the UE is configured to monitor PDCCH for serving cell \( c \) for the third \( K_{1, \mathrm{M} \backslash \mathrm{U}} \) set, if any
- if the UE is provided referenceOfSLIVDCI-1-2, for each row index with slot offset \( K_{0}=0 \) and PDSCH mapping Type B in a set of row indexes of a table for DCI format 1 _ 2 [6, TS 38.214], for any PDCCH monitoring occasion in any slot where the UE monitors PDCCH for DCI format \( 1 \_2 \) and with starting symbol \( S_{0}>0 \), if \( S+S_{0}+L \leq 14 \) for nomal cyclic prefix and \( S+S_{0}+L \leq 12 \) for extended cyclic prefix, add a new row index in the set of row indexes of the table by replacing the starting symbol \( S \) of the row index by \( S+S_{0} \)
c) on the ratio \( 2^{\mu_{\mathrm{DL}}-\mu_{\mathrm{UL}}} \) between the downlink SCS configuration \( \mu_{\mathrm{DL}} \) and the uplink SCS configuration \( \mu_{\mathrm{UL}} \) provided by subcarrierSpacing in BWP-Downlink and BWP-Uplink for the active DL BWP and the active UL BWP, respectively
d) if provided, on tdd-UL-DL-ConfigurationCommon and tdd-UL-DL-ConfigurationDedicated as described in clause 11.1
e) if ca-SlotOffset is provided, on \( N_{\text {slot, offset, } \mathrm{C}}^{\mathrm{DL}} \) and \( \mu_{\text {off set, } \mathrm{DL}, \mathrm{c}} \) provided by ca-SlotOffset for serving cell \( c \), or on \( N_{\text {slot, offset }}^{\text {UL }} \) and \( \mu_{\text {offset,UL }} \) provided by ca-SlotOffset for the primary cell, as described in [4, TS 38.211].

If a UE
- is not provided coresetPoollndex or is provided coresetPoollndex with a value of 0 for first CORESETs on active DL BWPs of serving cells, and
- is provided coresetPoollndex with a value of 1 for second CORESETs on active DL BWPs of the serving cells, and
- is provided ackNackFeedbackMode = joint
where
- a serving cell is placed in a first set \( S_{0} \) of \( N_{\text {cells }}^{\text {DL }, 0} \) serving cells if the serving cell includes a first CORESET, and
- a serving cell is placed in a second set \( S_{1} \) of \( N_{\text {cells }}^{\text {DL1 }} \) serving cells if the serving cell includes a second CORESET, and
- serving cells are placed in a set according to an ascending order of a serving cell index
the UE generates a Type-1 HARQ-ACK codebook for the set \( S_{0} \) and the set \( S_{1} \) of serving cells separately by setting \( N_{\text {cells }}^{\mathrm{DL}}=N_{\text {cells }}^{\mathrm{DL} 0} \) and \( N_{\text {cells }}^{\mathrm{DL}}=N_{\text {cells }}^{\mathrm{DL} 1} \) in the following pseudo-code. The UE concatenates the HARQ-ACK codebook generated for the set \( S_{0} \) followed by the HARQ-ACK codebook generated for the set \( S_{1} \) to obtain a total number of \( O_{\text {ACK }} \) HARQ-ACK information bits.

If a UE is provided fdmed-Reception-Multicast and the UE is configured to monitor PDCCH for detection of unicast DCI formats and to monitor PDCCH for detection of multicast DCI formats
- a serving cell is placed in a first set \( S_{\mathrm{U}} \) of \( N_{\text {cells }}^{\text {DLU }} \) serving cells if the UE is configured to monitor PDCCH for DCI formats \( 1 \_0 / 1 \_1 / 1 \_2 \) for scheduling on serving cell \( c \), and
- a serving cell is placed in a second set \( S_{\mathrm{M}} \) of \( N_{\text {cells }}^{\mathrm{DL} \mathrm{M}} \) serving cells if the UE is configured to monitor PDCCH for detection of DCI format 4_1/4_2 for scheduling on serving cell \( c \), and
- serving cells are placed in a set according to an ascending order of a serving cell index

ETSI


--- Page 73  ---


3GPP TS 38.213 version 17.1.0 Release 17
72
ETSI TS 138213 V17.1.0 (2022-05)

the UE generates a Type-1 HARQ-ACK codebook for the set \( S_{\mathrm{U}} \) and the set \( S_{\mathrm{M}} \) of serving cells separately by setting \( N_{\text {cells }}^{\mathrm{DL}}=N_{\text {cells }}^{\mathrm{DL}, \mathrm{U}} \) and \( N_{\text {cells }}^{\mathrm{DL}}=N_{\text {cells }}^{\mathrm{DL}, \mathrm{M}} \) in the following pseudo-code. The UE concatenates the HARQ-ACK codebook generated for the set \( S_{\mathrm{U}} \) followed by the HARQ-ACK codebook generated for the set \( S_{\mathrm{M}} \) to obtain a total number of \( O_{\text {ACK }} \) HARQ-ACK information bits.

If the UE is configured to monitor PDCCH for DCI formats with CRC scrambled by G-RNTI or G-CS-RNTI and is provided typel-Codebook-Generation-Mode \( = \) 'model', the UE separately applies the following pseudo-code for each of the first \( K_{1, \mathrm{UM}} \) set, the second \( K_{1, \mathrm{U} \backslash \mathrm{M}} \) set, and third \( K_{1, \mathrm{M} \backslash \mathrm{U}} \) set as the set of slot timing values \( K_{1} \), and for the corresponding sets of row indexes as \( R \) to obtain first, second, and third Type-1 HARQ-ACK sub-codebooks, and concatenates the first, second, and third, Type-1 HARQ-ACK sub-codebooks to obtain the Type-1 HARQ-ACK codebook.

If enableTimeDomainHARQ-Bundling is provided
- \( \quad \operatorname{set} R_{T}^{\prime}=R \)
- set \( R_{T} \) to the set of row indexes that include the last SLIV of each row of set \( R_{T}^{\prime} \)

If the set of rows \( R \) includes a row with more than one SLIV entry as described in [6, TS 38.214] and enableTimeDomainHARQ-Bundling is not provided, the set of rows \( R \) and the set of slot timing values \( K_{1} \) are updated in this clause according to the following pseudo-code.
set \( R \) to the set of rows
set \( C(R) \) to the cardinality of \( R \)
set \( r=0 \) - index of row in set \( R \)
set \( R_{T}=\emptyset \)
set \( K_{1, T}=\emptyset \)
while \( r<\mathscr{C}(R) \)
set \( P_{r} \) to the set of entries for row \( r \)
set \( K_{0, r} \) to the set of \( K_{0} \) values of entries for row \( r \)
set \( \Delta K_{0, r}=\max _{K_{0}}\left(K_{0, r}\right)-K_{0, r} \)
set \( C\left(P_{r}\right) \) to the cardinality of \( P_{r} \)
set \( \mathcal{C}\left(\Delta K_{0, r}\right) \) to the cardinality of \( \Delta K_{0, r} \)
set \( p=0 \) - index of element in \( P_{r} \) set \( d=0 \) - index of element in \( \Delta K_{0, r} \)
while \( p<\mathscr{C}\left(P_{r}\right) \)
\[
\begin{array}{l}
R_{T}=R_{T} \cup P_{r}(p) \\
p=p+1
\end{array}
\]
end while
while \( d<\mathscr{C}\left(\Delta K_{0, r}\right) \)
\[
K_{1, T}=K_{1, T} \cup\left(K_{1}+\left[\Delta K_{0, \mathrm{r}}(d) \cdot 2^{\mu_{\mathrm{UL}}-\mu_{\mathrm{DL}}}\right]\right) \cup\left(K_{1}+\left\lfloor\Delta K_{0, \mathrm{r}}(d) \cdot 2^{\mu_{\mathrm{UL}}-\mu_{\mathrm{DL}}}\right\rfloor\right) ;
\]
\[
d=d+1 ;
\]
end while
\( r=r+1 ; \)
end while

ETSI


--- Page 74  ---


3GPP TS 38.213 version 17.1.0 Release 17
73
ETSI TS 138213 V17.1.0 (2022-05)

\( K_{1}=K_{1, T} ; \)
For the set of slot timing values \( K_{1} \), the UE determines a set of \( M_{A, C} \) occasions for candidate PDSCH receptions or SPS PDSCH releases or TCI state update according to the following pseudo-code. A location in the Type-1 HARQ-ACK codebook for HARQ-ACK information corresponding to a single SPS PDSCH release is same as for a corresponding SPS PDSCH reception. A location in the Type-1 HARQ-ACK codebook for HARQ-ACK information corresponding to multiple SPS PDSCH releases by a single DCI format is same as for a corresponding SPS PDSCH reception with the lowest SPS configuration index among the multiple SPS PDSCH releases. If a UE provides HARQ-ACK information corresponding to detection of a DCI format that provides TCI state update without scheduling PDSCH reception, as described in [6, TS 38.214], a location in the Type-1 HARQ-ACK codebook for the HARQ-ACK information is same as when the DCI format schedules a PDSCH reception with CBGs or with transport blocks that are correctly decoded.

Set \( j=0 \) - index of occasion for candidate PDSCH reception or SPS PDSCH release or TCI state update
Set \( B=\emptyset \)
Set \( M_{A, c}=\emptyset \)
Set \( \mathcal{C}\left(K_{1}\right) \) to the cardinality of set \( K_{1} \)
Set \( k=0 \)-index of slot timing values \( K_{1, k} \), in descending order of the slot timing values, in set \( K_{1} \) for serving cell \( c \)
If a UE is not provided ca-SlotOffset for any serving cell of PDSCH receptions and for the serving cell of corresponding PUCCH transmission with HARQ-ACK information
while \( k<\mathscr{C}\left(K_{1}\right) \)
if \( \bmod \left(n_{\mathrm{U}}-K_{1, k}+1, \max \left(2^{\mu_{\mathrm{UL}}-\mu_{\mathrm{DL}}}, 1\right)\right)=0 \) or subslotLengthForPUCCH is provided for the HARQ-ACK
codebook
Set \( n_{\mathrm{D}}=0 \) - index of a DL slot overlapping with an UL slot
Set \( N_{k} \) to a number of DL slots overlapping with UL slot \( n_{U}-K_{1, k} \) if subslotLengthForPUCCH is provided for the HARQ-ACK codebook; otherwise, \( N_{k}=\max \left(2^{\mu_{D L}-\mu_{U L}}, 1\right) \)
while \( n_{D}<N_{k} \)
if PDSCH-TimeDomainResourceAllocationListForMultiPDSCH and enableTimeDomainHARQ-Bundling are provided for serving cell \( c \)
\( R=R_{\mathrm{T}} ; \)
\( R^{\prime}=R_{T}^{\prime} ; \)
elseif PDSCH-TimeDomainResourceAllocationListForMultiPDSCH is provided and enableTimeDomainHARQ-Bundling is not provided for serving cell \( c \)
\( R=R_{\mathrm{T}} ; \)
else
Set \( R \) to the set of rows
end if
Set \( \mathscr{C}(R) \) to the cardinality of \( R \)
Set \( r=0 \) - index of row in set \( R \)
if slot \( n_{\mathrm{U}} \) starts at a same time as or after a slot for an active DL BWP change on serving cell \( c \) or an active UL BWP change on the PCell and slot \( n_{0, k}+n_{D} \) is before the slot for the active DL BWP change on serving cell \( c \) or the active UL BWP change on the PCell, or subslotLengthForPUCCH is provided for the HARQACK codebook and slot \( n_{0, k}+n_{D} \) overlaps with UL slot \( n_{U}-K_{1, k-1}, k>0 \), where \( n_{0, k} \) is a DL slot with a smallest index among DL slots overlapping with UL slot \( n_{U}-K_{1, k} \),

ETSI


--- Page 75  ---


3GPP TS 38.213 version 17.1.0 Release 17
74
ETSI TS 138213 V17.1.0 (2022-05)
\[
n_{D}=n_{D}+1 ;
\]
else
while \( r<\mathscr{C}(R) \)
if the UE is not provided enableTimeDomainHARQ-Bunding and is provided tdd-UL-DLConfigurationCommon, or tdd-UL-DL-ConfigurationDedicated and, for each slot from slot \( n_{0, k}+ n_{D}-N_{\text {PDSCH }}^{\text {repeat, max }}+1 \) to slot \( n_{0, k}+n_{D} \), at least one symbol of the PDSCH time resource derived by row \( r \) is configured as UL where \( K_{1, k} \) is the \( k \)-th slot timing value in set \( K_{1} \), where \( n_{0, k} \) is a DL slot with a smallest index among DL slots overlapping with UL slot \( n_{U}-K_{1, k} \), or subslotLengthForPUCCH is provided for the HARQ-ACK codebook and the end of the PDSCH time resource for row \( r \) is not within any UL slot \( n_{U}-K_{1, l}, 0 \leq l<\mathscr{C}\left(K_{1}\right) \), or if PDSCH-
TimeDomainResourceAllocationListForMultiPDSCH is provided and HARQ-ACK information for PDSCH time resource derived by row \( r \) in slot \( \left\lfloor\left(n_{U}-K_{1, k}\right) \cdot 2^{\mu_{D L}-\mu_{U L}}\right\rfloor+n_{D} \) cannot be provided in slot \( n_{U} \)
\[
R=R \backslash r ;
\]
elseif the UE is provided enableTimeDomainHARQ-Bundling and tdd-UL-DL-ConfigurationCommon, or tdd-UL-DL-ConfigurationDedicated and, for each slot \( \left\lfloor\left(n_{U}-K_{1, k}\right) \cdot 2^{\mu_{D L}-\mu_{U L}}\right\rfloor+n_{D}-\Delta K_{0, r}(d) \), at least one symbol of each PDSCH time resource derived by row \( r \) of set \( R^{\prime} \) is configured as UL, where \( d=0,1, \ldots, C\left(\Delta K_{0, r}\right)-1, \Delta K_{0, r}=\max _{K_{0}}\left(K_{0, r}\right)-K_{0, r} \) and \( \mathcal{C}\left(\Delta K_{0, r}\right) \) is the cardinality of \( \Delta K_{0, r} \) -
\[
\begin{array}{l}
R=R \backslash r ; \\
R^{\prime}=R^{\prime} \backslash r ;
\end{array}
\]
else
\[
r=r+1 ;
\]
end if
end while
if the UE does not indicate a capability to receive more than one unicast PDSCH or multicast PDSCH per slot and \( R \neq \emptyset \),
\( M_{A, c}=M_{A, c} \cup j ; \)
\( j=j+1 ; \)
else
Set \( C(R) \) to the cardinality of \( R \) Set \( m \) to the smallest last OFDM symbol index, as determined by the SLIV, among all rows of \( R \)
while \( R \neq \emptyset \)
Set \( r=0 \)
while \( r<\mathscr{C}(R) \)
if \( S \leq m \) for start OFDM symbol index \( S \) for row \( r \)
\( b_{r, k, n_{D}}=j \);-index of occasion for candidate PDSCH reception, or SPS PDSCH release, or TCI state update associated with row \( r \)
\( R=R \backslash r ; \)
\( B=B \cup b_{r, k, n_{D}} ; \)
else

ETSI


--- Page 76  ---


3GPP TS 38.213 version 17.1.0 Release 17
75
ETSI TS 138213 V17.1.0 (2022-05)
```
                                \( r=r+1 ; \)
                            end if
                        end while
                        \( M_{A, c}=M_{A, c} \cup j \)
                        \( j=j+1 \);
                        Set \( m \) to the smallest last OFDM symbol index among all rows of \( R \);
                    end while
                end if
                \( n_{D}=n_{D}+1 ; \)
            end if
        end while
    end if
    \( k=k+1 ; \)
end while
else
while \( k<\mathcal{C}\left(K_{1}\right) \)
    if \( \bmod \left(n_{U}-K_{1, k}+\left\lfloor\left(\frac{N_{\text {slot }, \text { offset }}^{U L}}{2^{\mu_{\text {offset }, U L}}}-\frac{N_{\text {slot }, \text { offset }, c}^{\text {DL }}}{2^{\mu_{\text {offset }, D L, c}}}\right) \cdot 2^{\mu_{U L}}\right\rfloor+1, \max \left(2^{\mu_{U L}-\mu_{D L}}, 1\right)\right)=0 \) or subslotLengthForPUCCH
        is provided for the HARQ-ACK codebook
        Set \( n_{\mathrm{D}}=0 \) - index of a DL slot overlapping with an UL slot
        Set \( N_{k} \) to a number of DL slots overlapping with UL slot \( n_{U}-K_{1, k} \) if subslotLengthForPUCCH is provided for
        the HARQ-ACK codebook; otherwise, \( N_{k}=\max \left(2^{\mu_{D L}-\mu_{U L}}, 1\right) \)
        while \( n_{D}<N_{k} \)
            if PDSCH-TimeDomainResourceAllocationListForMultiPDSCH and enableTimeDomainHARQ-Bundling are
            provided for serving cell \( c \)
                \( R=R_{\mathrm{T}} ; \)
                \( R^{\prime}=R_{T}^{\prime} ; \)
            elseif PDSCH-TimeDomainResourceAllocationListForMultiPDSCH is provided and
            enableTimeDomainHARQ-Bundling is not provided for serving cell \( c \)
                \( R=R_{\mathrm{T}} ; \)
            else
                Set \( R \) to the set of rows
            end if
            Set \( \mathcal{C}(R) \) to the cardinality of \( R \)
            Set \( r=0 \) - index of row in set \( R \)
            if slot \( n_{U} \) starts at a same time as or after a slot for an active DL BWP change on serving cell \( c \) or an active
            UL BWP change on the PCell and slot \( n_{0, k}+n_{D} \) is before the slot for the active DL BWP change on serving
```


ETSI


--- Page 77  ---


3GPP TS 38.213 version 17.1.0 Release 17
76
ETSI TS 138213 V17.1.0 (2022-05)

cell \( c \) or the active UL BWP change on the PCell where \( n_{0, k} \) is a DL slot with a smallest index among DL slots overlapping with UL slot \( n_{U}-K_{1, k} \), or subslotLengthForPUCCH is provided for the HARQ-ACK codebook and slot \( n_{0, k}+n_{D} \) overlaps with UL slot \( n_{U}-K_{1, k-1}, k>0 \),
```
    \( n_{D}=n_{D}+1 ; \)
else
    while \( r<\mathscr{C}(R) \)
```

        if the UE is not provided enableTimeDomainHARQ-Bundling and is provided tdd-UL-DL-
        ConfigurationCommon, or tdd-UL-DL-ConfigurationDedicated and, for each slot from slot \( n_{0, k}+ \)
        \( n_{D}-N_{\text {PDSCH }}^{\text {repeat,max }}+1 \) to slot \( n_{0, k}+n_{D} \), at least one symbol of the PDSCH time resource derived by
        row \( r \) is configured as UL where \( K_{1, k} \) is the \( k \)-th slot timing value in set \( K_{1} \), where \( n_{0, k} \) is a DL slot
        with a smallest index among DL slots overlapping with UL slot \( n_{U}-K_{1, k} \), or
        subslotLengthForPUCCH is provided for the HARQ-ACK codebook and the end of the PDSCH time
        resource for row \( r \) is not within any UL slot \( n_{U}-K_{1, l}, 0 \leq l<\mathscr{C}\left(K_{1}\right) \) or if PDSCH-
        TimeDomainResourceAllocationListForMultiPDSCH is provided and HARQ-ACK information for
        PDSCH time resource derived by row \( r \) in slot \( \left\lfloor\left(n_{U}-K_{1, k}\right) \cdot 2^{\mu_{D L}-\mu_{U L}}\right\rfloor+\left\lfloor\left(\frac{N_{\text {slot,offset }}^{U L}}{2^{\mu_{\text {offset }, U L}}}-\right.\right. \)
        \( \left.\left.\frac{N_{\text {slot, offset, } c}^{\text {DL }}}{2^{\mu_{\text {offset, } D L, c}}}\right) \cdot 2^{\mu_{D L}}\right]+n_{D} \) cannot be provided in slot \( n_{U} \)
            \( R=R \backslash r ; \)
        elseif the UE is provided enableTimeDomainHARQ-Bundling and tdd-UL-DL-ConfigurationCommon,
        or tdd-UL-DL-ConfigurationDedicated and, for each slot \( \left[\left(n_{U}-K_{1, k}\right) \cdot 2^{\mu_{D L}-\mu_{U L}}\right]+ \)
        \( \left\lfloor\left(\frac{N_{\text {slot, offset }}^{U L}}{2^{\mu_{\text {offset, } U L}}}-\frac{N_{\text {slot, offset, } c}^{\text {DL }}}{2^{\mu_{\text {Offset, } D L, c}}}\right) \cdot 2^{\mu_{D L}}\right\rfloor+n_{D}-\Delta K_{0, r}(d) \), at least one symbol of each PDSCH time
        resource derived by row \( r \) of set \( R^{\prime} \) is configured as UL, where \( d=0,1, \ldots, C\left(\Delta K_{0, r}\right)-1 \).
            \( R=R \backslash r ; \)
            \( R^{\prime}=R^{\prime} \backslash r ; \)
        else
            \( r=r+1 ; \)
        end if
    end while
if the UE does not indicate a capability to receive more than one unicast PDSCH or multicast PDSCH per
slot and \( R \neq \emptyset \),
\( M_{A, c}=M_{A, c} \cup j ; \)
\( j=j+1 ; \)
else

Set \( C(R) \) to the cardinality of \( R \)
Set \( m \) to the smallest last OFDM symbol index, as determined by the SLIV, among all rows of \( R \)
while \( R \neq \emptyset \)
Set \( r=0 \)
while \( r<\mathscr{C}(R) \)
if \( S \leq m \) for start OFDM symbol index \( S \) for row \( r \)

ETSI


--- Page 78  ---


3GPP TS 38.213 version 17.1.0 Release 17
77
ETSI TS 138213 V17.1.0 (2022-05)
```
                                \( b_{r, k, n_{D}}=j \); - index of occasion for candidate PDSCH reception, or SPS PDSCH release, or
                                    TCI state update associated with row \( r \)
                                \( R=R \backslash r ; \)
                                \( B=B \cup b_{r, k, n_{D}} ; \)
                            else
                                \( r=r+1 ; \)
                            end if
                        end while
                        \( M_{A, C}=M_{A, C} \cup j ; \)
                        \( j=j+1 ; \)
                        Set \( m \) to the smallest last OFDM symbol index among all rows of \( R \);
                    end while
                end if
                \( n_{D}=n_{D}+1 ; \)
            end if
        end while
    end if
    \( k=k+1 ; \)
end while
end if
```


If the UE indicates a capability to receive more than one PDSCH per slot, for occasions of candidate PDSCH receptions corresponding to rows of \( R \) associated with a same value of \( b_{r, k, n_{D}} \), where \( b_{r, k, n_{D}} \in B \), the UE does not expect to receive more than one PDSCH in a same DL slot associated with a same coresetPoollndex value if provided, or if coresetPoollndex is not provided.

If a UE receives a SPS PDSCH, or a SPS PDSCH release, or TCI state update, or a PDSCH that is scheduled by a DCI format that does not support CBG-based PDSCH receptions and if
- the UE is configured with one serving cell, and
- \( C\left(M_{A, c}\right)=1 \), and
- PDSCH-CodeBlockGroupTransmission is provided to the UE
the UE generates HARQ-ACK information only for the transport block in the PDSCH, or only for the SPS PDSCH release, or only for the TCI state update.

If a UE receives a SPS PDSCH, or a SPS PDSCH release, or TCI state update, or a PDSCH that is scheduled by a DCI format that does not support CBG-based PDSCH receptions and if
- the UE is configured with more than one serving cells, or
- \( \quad C\left(M_{A, c}\right)>1 \), and
- PDSCH-CodeBlockGroupTransmission is provided to the UE
the UE repeats \( N_{\text {HARQ-ACK }}^{\text {CBG/TB, } m a x} \) times the HARQ-ACK information for the transport block in the PDSCH, or for the SPS PDSCH release, or for the TCI state update.

ETSI


--- Page 79  ---


3GPP TS 38.213 version 17.1.0 Release 17
78
ETSI TS 138213 V17.1.0 (2022-05)

A UE does not expect to detect a DCI format switching a DL BWP within \( N_{3} \) symbols prior to a first symbol of a PUCCH transmission where the UE multiplexes HARQ-ACK information, where \( N_{3} \) is defined in clause 9.2.3.

If a UE is provided dl-DataToUL-ACK or dl-DataToUL-ACK-r16 or dl-DataToUL-ACK-DCI-1-2, the UE does not expect to be indicated by DCI format \( 1 \_0 \) a slot timing value for transmission of HARQ-ACK information that does not belong to the intersection of the set of slot timing values \( \{1,2,3,4,5,6,7,8\} \) for SCS configuration of PUCCH transmission \( \mu \leq 3,\{7,8,12,16,20,24,28,32\} \) for \( \mu=5 \), and \( \{13,16,24,32,40,48,56,64\} \) for \( \mu=6 \), and the set of slot timing values provided by \( K_{1} \) for the active DL BWP of a corresponding serving cell.

If maxNrofCodeWordsScheduledByDCI indicates reception of two transport blocks, when the UE receives a PDSCH with one transport block or a SPS PDSCH release or a TCI state update, the HARQ-ACK information is associated with the first transport block and the UE generates a NACK for the second transport block if harq-ACKSpatialBundlingPUCCH is not provided and generates HARQ-ACK information with value of ACK for the second transport block if harq-ACK-SpatialBundlingPUCCH is provided.

A UE determines \( \tilde{o}_{0}^{A C K}, \tilde{o}_{1}^{A C K}, \ldots, \tilde{o}_{O_{A C K}-1}^{A C K} \) HARQ-ACK information bits, for a total number of \( O_{A C K} \) HARQ-ACK information bits, of a HARQ-ACK codebook for transmission in a PUCCH according to the following pseudo-code. In the following pseudo-code, if the UE does not receive a transport block or a CBG, due to the UE not detecting a corresponding DCI format, the UE generates a NACK value for the transport block or the CBG. The cardinality of the set \( M_{A, C} \) defines a total number \( M_{c} \) of occasions for PDSCH reception or SPS PDSCH release or TCI state update for serving cell \( c \) corresponding to the HARQ-ACK information bits.

Set \( c=0 \)-serving cell index: lower indexes correspond to lower RRC indexes of corresponding cells including, when applicable, cells in the set \( S_{0} \) and the set \( S_{1} \)

Set \( j=0 \) - HARQ-ACK information bit index
Set \( N_{\text {cells }}^{\mathrm{DL}} \) to the number of serving cells configured by higher layers for the UE
while \( c<N_{\text {cells }}^{\mathrm{DL}} \)
Set \( m=0 \) - index of occasion for candidate PDSCH reception, or SPS PDSCH release, or TCI state update
while \( m<M_{c} \)
if enableTimeDomainHARQ-Bundling is provided for serving cell \( c \) and a PDSCH associated with occasion \( m \) is scheduled by a DCI format indicating a TDRA row that includes more than one SLIV entry
if harq-ACK-SpatialBundlingPUCCH is not provided and the UE is configured by maxNrofCodeWordsScheduledByDCI with reception of two transport blocks for the active DL BWP of serving cell \( c \)
if the PDSCH is associated with the last SLIV in the TDRA row
\( \tilde{O}_{j}^{A C K}= \) binary AND operation of the HARQ-ACK information bits corresponding to first transport blocks in PDSCH receptions, that do not overlap with an uplink symbol indicated by \( t d d-U L-D L- \) ConfigurationCommon or tdd-UL-DL-ConfigurationDedicated, scheduled by the DCI format on serving cell \( c \);
\( j=j+1 ; \)
\( \tilde{o}_{j}^{\text {ACK }}= \) binary AND operation of the HARQ-ACK information bits corresponding to second transport blocks in PDSCH receptions, that do not overlap with an uplink symbol indicated by tdd-UL-DL-ConfigurationCommon or tdd-UL-DL-ConfigurationDedicated, scheduled by the DCI format on serving cell \( c \);
else
\( \tilde{o}_{j}^{\text {ACK }}=\mathrm{NACK} ; \)
\( j=j+1 ; \)
\( \tilde{o}_{j}^{\text {ACK }}=\mathrm{NACK} ; \)

ETSI


--- Page 80  ---


3GPP TS 38.213 version 17.1.0 Release 17
79
ETSI TS 138213 V17.1.0 (2022-05)
\[
\begin{array}{l}
\text { end if } \\
j=j+1 ;
\end{array}
\]
elseif harq-ACK-SpatialBundlingPUCCH is provided and the UE is configured by maxNrofCodeWordsScheduledByDCI with reception of two transport blocks for the active DL BWP of serving cell \( c \)
if the PDSCH is associated with the last SLIV in the TDRA row;
\( \tilde{o}_{j}^{A C K}= \) binary AND operation of the HARQ-ACK information bits corresponding to all transport blocks in PDSCHs, that do not overlap with an uplink symbol indicated by \( t d d-U L-D L- \) Configuration Common or tdd-UL-DL-ConfigurationDedicated, scheduled by the DCI format of serving cell \( c \)
if the UE receives one transport block, the UE assumes ACK for the second transport block;
else
\[
\tilde{o}_{j}^{A C K}=\mathrm{NACK}
\]
end if
\[
j=j+1 ;
\]
else
if the PDSCH is associated with the last SLIV in the TDRA row;
\[
\begin{array}{l}
\tilde{O}_{j}^{A C K}=\text { binary AND operation of the HARQ-ACK information bits corresponding to all transport } \\
\text { blocks in PDSCHs, that do not overlap with an uplink symbol indicated by tdd- } U L-D L- \\
\text { Configuration Common or tdd- } U L-D L \text {-ConfigurationDedicated, scheduled by the DCI format of } \\
\text { serving cell } c
\end{array}
\]
else
\[
\tilde{o}_{j}^{A C K}=\mathrm{NACK} ;
\]
end if
\[
j=j+1 ;
\]
end if
else
if harq-ACK-SpatialBundingPUCCH is not provided, PDSCH-CodeBlockGroupTransmission is not provided, and the UE is configured by maxNrofCodeWordsScheduledByDCI with reception of two transport blocks for the active DL BWP of serving cell \( c \),
\( \tilde{o}_{j}^{A C K}= \) HARQ-ACK information bit corresponding to a first transport block of this cell;
\( j=j+1 ; \)
\( \tilde{o}_{j}^{A C K}= \) HARQ-ACK information bit corresponding to a second transport block of this cell;
\[
j=j+1 ;
\]
elseif harq-ACK-SpatialBundlingPUCCH is provided, and the UE is configured by maxNrofCodeWordsScheduledByDCI with reception of two transport blocks for the active DL BWP of serving cell \( c \),
\( \tilde{o}_{j}^{\text {ACK }}= \) binary AND operation of the HARQ-ACK information bits corresponding to first and second transport blocks of this cell
if the UE receives one transport block, the UE assumes ACK for the second transport block;

ETSI


--- Page 81  ---


3GPP TS 38.213 version 17.1.0 Release 17
80
ETSI TS 138213 V17.1.0 (2022-05)
\[
j=j+1
\]
elseif PDSCH-CodeBlockGroupTransmission is provided, and \( N_{\mathrm{HARQ}-\mathrm{ACK}, c}^{\mathrm{CBG} / \mathrm{TB} \text { max }} \) CBGs are indicated by maxCodeBlockGroupsPerTransportBlock for serving cell \( c \),

Set \( n_{\text {CBG }}=0- \) CBG index
while \( n_{\mathrm{CBG}}<N_{\mathrm{HARQ}-\mathrm{ACK}_{1} \mathrm{c}}^{\mathrm{CBG} / \mathrm{TB}_{1} \text { max }} \)
\( \tilde{o}_{j+n_{\text {CBG }}}^{A C K}= \) HARQ-ACK information bit corresponding to CBG \( n_{\text {CBG }} \) of the first transport block;
if the UE is configured by maxNrofCodeWordsScheduledByDCI with reception of two transport blocks for the active DL BWP of serving cell \( c \)
\( \tilde{o}_{j+n_{\text {CBG }}+N_{\text {HARQ-ACK }, c}^{\text {CBG } / \text { TB, } \max }}^{\text {ACK }}= \) HARQ-ACK information bit corresponding to CBG \( n_{\text {CBG }} \) of the second transport block;
end if
\[
n_{\mathrm{CBG}}=n_{\mathrm{CBG}}+1
\]
end while
\( j=j+N_{\mathrm{TB}, c}^{\mathrm{DL}} \cdot N_{\mathrm{HARQ}-\mathrm{ACK}_{1} c}^{\mathrm{CBG} / \mathrm{TB}_{1} \max } \), where \( N_{\mathrm{TB}, c}^{\mathrm{DL}} \) is the value of maxNrofCodeWordsScheduledByDCI for the active DL BWP of serving cell \( c \);
else
\( \tilde{o}_{j}^{A C K}= \) HARQ-ACK information bit of serving cell \( c \);
\( j=j+1 ; \)
end if
end if
\( m=m+1 ; \)
end while
\( c=c+1 ; \)
end while
If \( O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}} \leq 11 \), the UE determines a number of HARQ-ACK information bits \( n_{\mathrm{HARQ}-\mathrm{ACK}} \) for obtaining a transmission power for a PUCCH, as described in clause 7.2.1, as \( n_{\text {HARQ-ACK }}=\sum_{c=0}^{N_{\text {cells }}^{\text {DL }} \sum_{m=0}^{M_{c}-1} N_{m, c}^{\text {received }}}+ \sum_{c=0}^{N_{\text {cells }}^{\mathrm{DL}}{ }^{-1}} \sum_{m=0}^{M_{c}-1} N_{m, c}^{\text {received, CBG }} \) where
- \( \quad N_{\text {cells }}^{\text {DL }} \) are all DL cells where the UE is configured to receive unicast or multicast PDSCHs
- \( M_{c} \) is the cardinality for the union of all sets \( M_{A, C} \) of occasions for unicast or multicast PDSCH receptions or SPS PDSCH releases for serving cell \( c \)
- \( \quad N_{m, c}^{\text {received }} \) is the number of transport blocks the UE receives in PDSCH reception occasion \( m \) for serving cell \( c \) if harq-ACK-SpatialBundlingPUCCH and PDSCH-CodeBlockGroupTransmission are not provided, or the number of transport blocks the UE receives in PDSCH reception occasion \( m \) for serving cell \( c \) if PDSCHCodeBlockGroupTransmission is provided and the PDSCH reception is scheduled by a DCI format that does not support CBG-based PDSCH receptions, or the number of PDSCH receptions if harq-ACKSpatialBundlingPUCCH is provided or SPS PDSCH release or TCI state update in PDSCH reception occasion \( m \) for serving cell \( c \) and the UE reports corresponding HARQ-ACK information in the PUCCH.

ETSI


--- Page 82  ---


3GPP TS 38.213 version 17.1.0 Release 17
81
ETSI TS 138213 V17.1.0 (2022-05)
- If enableTimeDomainHARQ-Bundling is provided for serving cell \( c \) and for a DCI format indicating a TDRA row that includes more than one SLIV entry on the serving cell \( c \), the UE considers as received only a PDSCH associated with the last SLIV.
- \( \quad N_{m, c}^{\text {received, CBG }} \) is the number of CBGs the UE receives in a PDSCH reception occasion \( m \) for serving cell \( c \) if PDSCH-CodeBlockGroupTransmission is provided and the PDSCH reception is scheduled by a DCI format that supports CBG-based PDSCH receptions and the UE reports corresponding HARQ-ACK information in the PUCCH.
9.1.2.2 Type-1 HARQ-ACK codebook in physical uplink shared channel

If a UE is not provided pdsch-HARQ-ACK-Codebook = 'semi-static' for unicast or multicast HARQ-ACK information, the UE does not multiplex the unicast or multicast HARQ-ACK information in the PUSCH transmission, respectively.

If a UE is provided pdsch-HARQ-ACK-Codebook = 'semi-static' for unicast and/or multicast HARQ-ACK information, and would multiplex HARQ-ACK information in a PUSCH transmission that is not scheduled by a DCI format or is scheduled by a DCI format that does not include a DAI field, then
- if the UE has not received any PDSCH or SPS PDSCH release or TCI state update that the UE multiplexes corresponding HARQ-ACK information in the PUSCH, based on a value of a respective PDSCH-toHARQ_feedback timing indicator field in a DCI format scheduling the PDSCH reception or the SPS PDSCH release or the TCI state update, or on the value of dl-DataToUL-ACK or dl-DataToUL-ACK-r16 if the PDSCH-to-HARQ_feedback timing indicator field is not present in DCI format \( 1 \_1 \) or on the value of dl-DataToUL-ACK-DCI-1-2 if the PDSCH-to-HARQ_feedback timing indicator field is not present in DCI format 1 _ 2 and the UE is provided pdsch-HARQ-ACK-Codebook = 'semi-static' for unicast HARQ-ACK information, or on the value of dl-DataToUL-ACK if the PDSCH-to-HARQ_feedback timing indicator field is not present in DCI format \( 4 \_2 \) and the UE is provided pdsch-HARQ-ACK-Codebook = 'semi-static' for multicast HARQ-ACK information, in any of the \( M_{c} \) occasions for candidate PDSCH receptions by a DCI format or SPS PDSCH on any serving cell \( c \), as described in clause 9.1.2.1, the UE does not multiplex HARQ-ACK information in the PUSCH transmission
- else the UE generates the HARQ-ACK codebook as described in clause 9.1.2.1, except that harq-ACKSpatialBundlingPUCCH is replaced by harq-ACK-SpatialBundlingPUSCH, unless the UE receives only a SPS PDSCH release, or only a SPS PDSCH reception, or only a TCI state update, or only a PDSCH that is scheduled by DCI format \( 1 \_0 \) with a counter DAI field value of 1 if the UE is provided pdsch-HARQ-ACK-Codebook \( = \) 'semi-static' for unicast HARQ-ACK information, or is scheduled by DCI format \( 4 \_1 \) with a counter DAI field value of 1 if the UE is provided pdsch-HARQ-ACK-Codebook = 'semi-static' for multicast HARQ-ACK information, on the PCell in the \( M_{c} \) occasions for candidate PDSCH receptions in which case the UE generates HARQ-ACK information only for the SPS PDSCH release or only for the PDSCH reception or only for the TCI state update as described in clause 9.1.2.

A UE sets to NACK value in the HARQ-ACK codebook any HARQ-ACK information corresponding to PDSCH reception or SPS PDSCH release or TCI state update that the UE detects in a PDCCH monitoring occasion that starts after a PDCCH monitoring occasion where the UE detects a DCI format scheduling the PUSCH transmission.

A UE does not expect to detect a DCI format switching a DL BWP within \( N_{2} \) symbols prior to a first symbol of a PUSCH transmission where the UE multiplexes HARQ-ACK information, where \( N_{2} \) is defined in [6, TS 38.214].

If a UE multiplexes HARQ-ACK information in a PUSCH transmission that is scheduled by DCI format that includes a DAI field, and
- is not provided famed-Reception-Multicast and is provided pdsch-HARQ-ACK-Codebook = 'semi-static' for both unicast and multicast HARQ-ACK information, or
- is provided pdsch-HARQ-ACK-Codebook = 'semi-static' only for one of unicast and multicast HARQ-ACK information
the UE generates the HARQ-ACK codebook as described in clause 9-1.2.1 when a value of the DAI field is \( V_{T-D A I}^{U L}=1 \) except that harq-ACK-SpatialBundlingPUCCH is replaced by harq-ACK-SpatialBundlingPUSCH. The UE does not generate a HARQ-ACK codebook for multiplexing in the PUSCH transmission when \( V_{\text {T-DAI }}^{\text {UL }}=0 \) unless the UE receives only a SPS PDSCH release, or only SPS PDSCH(s), or only a TCI state update, or only a PDSCH that is scheduled by a DCI format 1_0 if the UE is provided pdsch-HARQ-ACK-Codebook = 'semi-static' for unicast HARQ-ACK information, or scheduled by a DCI format \( 4 \_1 \) if the UE is provided pdsch-HARQ-ACK-Codebook \( = \) 'semi-static' for

ETSI


--- Page 83  ---


3GPP TS 38.213 version 17.1.0 Release 17
82
ETSI TS 138213 V17.1.0 (2022-05)

multicast HARQ-ACK information, with a counter DAI field value of 1 on the PCell in the \( M_{c} \) occasions for candidate PDSCH receptions in which case the UE generates HARQ-ACK information only for the SPS PDSCH release or only for the TCI state update or only for the PDSCH reception as described in clause 9.1.2.
\( V_{\mathrm{T}-\mathrm{DAI}}^{\mathrm{UL}}=0 \) if the PUSCH is scheduled by a DCI format that includes a DAI field and the DAI field is set to ' 0 '; otherwise, \( V_{\mathrm{T}-\mathrm{DAl}}^{\mathrm{UL}}=1 \).

If a UE is provided fdmed-Reception-Multicast and is provided pdsch-HARQ-ACK-Codebook = 'semi-static' for both unicast and multicast HARQ-ACK information, the UE generates the HARQ-ACK codebook as described in clause 9.1.2.1, except that harq-ACK-SpatialBundlingPUCCH is replaced by harq-ACK-SpatialBundlingPUSCH
- for the first set \( S_{\mathrm{U}} \) of \( N_{\text {cells }}^{\mathrm{DL}, \mathrm{U}} \) serving cells if a value \( V_{\mathrm{T}-\mathrm{DAl}}^{\mathrm{ULU}} \) of the DAI field associated with unicast HARQ-ACK information is \( V_{\text {T-DAI }}^{\mathrm{UL}, \mathrm{U}}=1[5, \mathrm{TS} 38.212] \)
- for the second set \( S_{\mathrm{M}} \) of \( N_{\text {cells }}^{\mathrm{DLM}} \) serving cells if a value \( V_{\mathrm{T}-\mathrm{DAl}}^{\mathrm{ULM}} \) of the DAI field associated with multicast HARQACK information is \( V_{\text {T-DAI }}^{\text {UL,M }}=1[5, \mathrm{TS} 38.212] \)

The UE does not generate unicast or multicast HARQ-ACK information for multiplexing in the PUSCH transmission when \( V_{\mathrm{T}-\mathrm{DAl}}^{\mathrm{UL}, \mathrm{U}}=0 \) or \( V_{\mathrm{T}-\mathrm{DAl}}^{\mathrm{UL} \mathrm{M}}=0 \), respectively, unless the UE receives respectively
- only a unicast or a multicast SPS PDSCH release, or
- only unicast SPS PDSCH(s) or multicast SPS PDSCH(s) having enabled associated HARQ-ACK information reports as described in clause 18, or
- only a TCI state update or a PDSCH that is scheduled by a DCI format \( 1 \_0 \) with a counter DAI field value of 1 on the PCell, or only a PDSCH that is scheduled by a DCI format \( 4 \_1 \) having enabled associated HARQ-ACK information report, as described in clause 18, and counter DAI field value of 1 on the PCell
in the \( M_{c} \) occasions for candidate PDSCH receptions in which case the UE generates only the corresponding unicast or multicast HARQ-ACK information.
\( V_{\mathrm{T}-\mathrm{DAl}}^{\mathrm{ULU}}=0 \) if the corresponding value of the DAI field is set to ' 0 '; otherwise, \( V_{\mathrm{T}-\mathrm{DAl}}^{\mathrm{UL}, \mathrm{U}}=1 . V_{\mathrm{T}-\mathrm{DAl}}^{\mathrm{UL}, \mathrm{M}}=0 \) if the corresponding value of the DAI field is set to ' 0 '; otherwise, \( V_{\text {T-DAI }}^{\mathrm{UL}, \mathrm{M}}=1[5, \mathrm{TS} 38.212] \).
9.1.3 Type-2 HARQ-ACK codebook determination

This clause applies if the UE is configured with pdsch-HARQ-ACK-Codebook = dynamic or with pdsch-HARQ-ACK-Codebook-r16. Unless stated otherwise, a PDSCH-to-HARQ_feedback timing indicator field provides an applicable value.

A UE does not expect to multiplex in a Type-2 HARQ-ACK codebook HARQ-ACK information that is in response to a detection of a DCI format that does not include a counter DAI field.

If a UE is provided HARQ-feedbackEnabling-disablingperHARQprocess indicating disabled HARQ-ACK information for a HARQ process associated with a transport block for PDCCH monitoring occasion \( m \) or for SPS PDSCH receptions on serving cell \( c \), the UE does not multiplex a HARQ-ACK information bit corresponding to the transport block in a Type-2 HARQ-ACK codebook and does not consider the transport block as received in the determination of \( N_{m, c}^{\text {received }} \) or of \( N_{\mathrm{SPS}, c} \) in clause 9.1.3.1. If the UE is also provided PDSCH-CodeBlockGroupTransmission, the UE does not multiplex HARQ-ACK information bits corresponding to CBGs of the transport block in the Type-2 HARQ-ACK codebook and does not consider the CBGs as received in the determination of \( N_{m, c}^{\text {received }} \) CBG in clause 9.1.3.1. If the UE is also provided \( H A R Q \)-feedbackEnablingforSPSactive, the UE considers a HARQ process associated with a transport block in a first SPS PDSCH reception, after an activation of SPS PDSCH receptions, to have enabled HARQ-ACK information and the UE provides a HARQ-ACK information bit according to a decoding outcome for the transport block in the first SPS PDSCH reception.

If a UE is indicated to not provide multicast HARQ-ACK information, as described in clause 18, associated with PDCCH monitoring occasion \( m \) or for SPS PDSCH receptions on serving cell \( c \), the UE does not multiplex corresponding HARQ-ACK information bits in a Type-2 HARQ-ACK codebook and does not consider any transport blocks as received in the determination of \( N_{m, c}^{\text {received }} \) or of \( N_{\mathrm{SPS}, c} \) in clause 9.1.3.1.

ETSI


--- Page 84  ---


3GPP TS 38.213 version 17.1.0 Release 17
83
ETSI TS 138213 V17.1.0 (2022-05)

If a UE receives a first DCI format that the UE detects in a first PDCCH monitoring occasion and includes a PDSCH-to-HARQ_feedback timing indicator field providing an inapplicable value from \( d l \)-DataToUL-ACK-r16,
- if the UE detects a second DCI format, the UE multiplexes the corresponding HARQ-ACK information in a PUCCH or PUSCH transmission in a slot that is indicated by a value of a PDSCH-to-HARQ_feedback timing indicator field in the second DCI format, where
- if the UE is not provided pdsch-HARQ-ACK-Codebook-r16, the UE detects the second DCI format in any PDCCH monitoring occasion after the first one, and where the slot indicated by the value of the PDSCH-toHARQ_feedback timing indicator field in the second DCI format is no later than a slot for HARQ-ACK information in response to a SPS PDSCH reception, if any, received after the PDSCH scheduled by the first DCI format.
- if the UE is provided pdsch-HARQ-ACK-Codebook-r16, the UE detects the second DCI format in any PDCCH monitoring occasion after the first one, and the second DCI format indicates a HARQ-ACK information report for a same PDSCH group index as indicated by the first DCI format as described in clause 9.1.3.3, and where the slot indicated by the value of the PDSCH-to-HARQ_feedback timing indicator field in the second DCI format is no later than a slot for HARQ-ACK information in response to a SPS PDSCH reception, if any, received after the PDSCH scheduled by the first DCI format.
- if the UE is provided pdsch-HARQ-ACK-Codebook-r16, the UE receives the second DCI format later than the slot for HARQ-ACK information in response to a SPS PDSCH reception received after the PDSCH scheduled by the first DCI format, and the second DCI format indicates a HARQ-ACK information report for a same PDSCH group index as indicated by the first DCI format as described in clause 9.1.3.3.
- if the UE is provided pdsch-HARQ-ACK-OneShotFeedback, the first DCI format does not have associated HARQ-ACK information without scheduling a PDSCH reception or TCI state update, the UE detects the second DCI format in any PDCCH monitoring occasion after the first one, and the second DCI format includes a One-shot HARQ-ACK request field with value 1, the UE includes the HARQ-ACK information in a Type-3 HARQ-ACK codebook, as described in clause 9.1.4, and where the slot indicated by the value of the PDSCH-to-HARQ_feedback timing indicator field in the second DCI format is no later than a slot for HARQ-ACK information in response to a SPS PDSCH reception, if any, received after the PDSCH scheduled by the first DCI format.
- if the UE is provided pdsch-HARQ-ACK-OneShotFeedback-r16, the first DCI format does not have associated HARQ-ACK information without scheduling a PDSCH reception or TCI state update, and the UE receives the second DCI format later than the slot for HARQ-ACK information in response to a SPS PDSCH reception received after the PDSCH scheduled by the first DCI format, and the second DCI format includes a One-shot HARQ-ACK request field with value 1, the UE includes the HARQ-ACK information in a Type-3 HARQ-ACK codebook, as described in clause 9.1.4.
- otherwise, the UE does not multiplex the corresponding HARQ-ACK information in a PUCCH or PUSCH transmission.
9.1.3.1 Type-2 HARQ-ACK codebook in physical uplink control channel

If a UE is configured to monitor PDCCH for multicast DCI formats with CRC scrambled by one or more G-RNTIs that the UE generates a Type-2 HARQ-ACK codebook, the UE separately applies the procedures in this clause per G-RNTI and determines the Type-2 HARQ-ACK codebook by concatenating the Type-2 HARQ-ACK codebook for unicast DCI formats followed by the HARQ-ACK codebooks for the multicast DCI formats in ascending order of the corresponding G-RNTI values.

A UE determines monitoring occasions for PDCCH with DCI format scheduling PDSCH receptions, or having associated HARQ-ACK information without scheduling PDSCH reception, on an active DL BWP of a serving cell \( c \), as described in clause 10.1, and for which the UE transmits HARQ-ACK information in a same PUCCH in slot \( n \) based on
- PDSCH-to-HARQ_feedback timing indicator field values, or a dl-DataToUL-ACK, dl-DataToUL-ACK-r16 or dl-DataToUL-ACK-ForDCI-Formatl-2 value if the PDSCH-to-HARQ_feedback timing indicator field is not present in a DCI format, for PUCCH transmission with HARQ-ACK information in slot \( n \), as described in clause 9.2.3, in response to PDSCH receptions, or in response to a DCI format having associated HARQ-ACK information without scheduling PDSCH reception

ETSI


--- Page 85  ---


3GPP TS 38.213 version 17.1.0 Release 17
84
ETSI TS 138213 V17.1.0 (2022-05)
- slot offsets \( K_{0} \) [6, TS 38.214] provided by time domain resource assignment field in a DCI format scheduling PDSCH receptions and by pdsch-AggregationFactor, or pdsch-AggregationFactor-r16, or repetitionNumber, when provided.

The set of PDCCH monitoring occasions for DCI formats scheduling PDSCH receptions, or having associated HARQACK information without scheduling PDSCH reception, is defined as the union of PDCCH monitoring occasions across active DL BWPs of configured serving cells. PDCCH monitoring occasions are indexed in an ascending order of their start times. The cardinality of the set of PDCCH monitoring occasions defines a total number \( M \) of PDCCH monitoring occasions.

A value of the counter downlink assignment indicator (DAI) field in DCI formats denotes the accumulative number of \{serving cell, PDCCH monitoring occasion\}-pairs in which PDSCH receptions, or HARQ-ACK information bits that are not in response for PDSCH receptions, associated with the DCI formats, excluding the SPS activation DCI, is present up to the current serving cell and current PDCCH monitoring occasion,
- first, if the UE indicates by type2-HARQ-ACK-Codebook support for more than one PDSCH reception on a serving cell that are scheduled from a same PDCCH monitoring occasion, in increasing order of the PDSCH reception starting time for the same \{serving cell, PDCCH monitoring occasion) pair,
- second in ascending order of serving cell index, and
- third in ascending order of PDCCH monitoring occasion index \( m \), where \( 0 \leq m<M \).

If, for an active DL BWP of a serving cell, the UE is not provided coresetPoollndex or is provided coresetPoollndex with value 0 for one or more first CORESETs and is provided coresetPoollndex with value 1 for one or more second CORESETs, and is provided ackNackFeedbackMode \( = \) joint, the value of the counter DAI is in the order of the first CORESETs and then the second CORESETs for a same serving cell index and a same PDCCH monitoring occasion index.

The value of the total DAI, when present [5, TS 38.212], in a DCI format denotes the total number of serving cell, PDCCH monitoring occasion\}-pair(s) in which PDSCH reception(s), or HARQ-ACK information that does not correspond to PDSCH receptions, associated with DCI formats, excluding the SPS activation DCI, is present, up to the current PDCCH monitoring occasion \( m \) and is updated from PDCCH monitoring occasion to PDCCH monitoring occasion. If, for an active DL BWP of a serving cell, the UE is not provided coresetPoollndex or is provided coresetPoollndex with value 0 for one or more first CORESETs and is provided coresetPoollndex with value 1 for one or more second CORESETs, and is provided ackNackFeedbackMode = joint, the total DAI value counts the \{serving cell, PDCCH monitoring occasion\}-pair(s) for both the first CORESETs and the second CORESETs.

Denote by \( N_{C-\mathrm{DAl}}^{\mathrm{DL}} \) the number of bits for the counter DAl and set \( T_{D}=2^{N_{C-\mathrm{DAl}}^{\mathrm{DL}}} \). Denote by \( V_{\mathrm{C}-\mathrm{DAl}, c, m}^{\mathrm{DL}} \) the value of the counter DAI in a DCI format scheduling PDSCH reception, or having associated HARQ-ACK information without scheduling PDSCH reception, on serving cell \( c \) in PDCCH monitoring occasion \( m \) according to Table 9.1.3-1 or Table 9.1.3-1A. Denote by \( V_{\mathrm{T}-\mathrm{DAl}, m}^{\mathrm{DL}} \) the value of the total DAI in a DCI format in PDCCH monitoring occasion \( m \) according to Table 9.1.3-1. The UE assumes a same value of total DAI in all DCI formats that include a total DAI field in PDCCH monitoring occasion \( m \). A UE does not expect to multiplex, in a same Type-2 HARQ-ACK codebook, HARQ-ACK information that is in response to detection of DCI formats with different number of bits for the counter DAI field.

If the UE transmits HARQ-ACK information in a PUCCH in slot \( n \) and for any PUCCH format, the UE determines the \( \tilde{o}_{0}^{A C K}, \tilde{o}_{1}^{A C K}, \cdots, \tilde{o}_{O_{\mathrm{ACK}}-1}^{A C K} \), for a total number of \( O_{\mathrm{ACK}} \) HARQ-ACK information bits, according to the following pseudocode:

Set \( m=0-\mathrm{PDCCH} \), with DCI format scheduling PDSCH reception, or having associated HARQ-ACK information without scheduling a PDSCH reception, monitoring occasion index: lower index corresponds to earlier PDCCH monitoring occasion

Set \( j=0 \)
Set \( V_{\text {temp }}=0 \)
Set \( V_{\text {temp } 2}=0 \)
Set \( V_{s}=\emptyset \)
Set \( N_{\text {cells }}^{\mathrm{DL}} \) to the number of serving cells configured by higher layers for the UE

ETSI


--- Page 86  ---


3GPP TS 38.213 version 17.1.0 Release 17
85
ETSI TS 138213 V17.1.0 (2022-05)
- if, for an active DL BWP of a serving cell, the UE is not provided coresetPoollndex or is provided coresetPoollndex with value 0 for one or more first CORESETs and is provided coresetPoollndex with value 1 for one or more second CORESETs, and is provided ackNackFeedbackMode = joint, the serving cell is counted two times where the first time corresponds to the first CORESETs and the second time corresponds to the second CORESETS
- if the UE indicates type2-HARQ-ACK-Codebook, a serving cell is counted \( N_{\text {PDSCH }}^{\mathrm{MO}} \) times where \( N_{\text {PDSCH }}^{\mathrm{MO}} \) is the number of PDSCH receptions that can be scheduled for the serving cell by DCI formats in PDCCH receptions at a same PDCCH monitoring occasion based on the reported value of type2-HARQ-ACK-Codebook

Set \( M \) to the number of PDCCH monitoring occasion(s)
while \( m<M \)
Set \( c=0 \)-serving cell index: lower indexes correspond to lower RRC indexes of corresponding cell while \( c<N_{\text {cells }}^{\mathrm{DL}} \)
if PDCCH monitoring occasion \( m \) is before an active DL BWP change on serving cell \( c \) or an active UL BWP change on the PCell and an active DL BWP change is not triggered in PDCCH monitoring occasion \( m \)
\[
c=c+1 ;
\]
else
if there is a PDSCH providing a transport block for a HARQ process with enabled HARQ-ACK information on serving cell \( c \) associated with PDCCH in PDCCH monitoring occasion \( m \), or there is a PDCCH providing a DCI format associated with HARQ-ACK information without scheduling PDSCH reception on serving cell \( c \)
```
if \( V_{C-\mathrm{DAJ}, c, m}^{\mathrm{DL}} \leq V_{\text {temp }} \)
    \( \mathrm{j}=\mathrm{j}+1 \)
end if
\( V_{\text {temp }}=V_{C-\mathrm{DAI}, c, m}^{\mathrm{DL}} \)
if \( V_{\mathrm{T}-\mathrm{DAJ}, m}^{\mathrm{DL}}=\emptyset \)
    \( V_{\text {temp }, 2}=V_{C-\mathrm{DAI}_{1}, m}^{\mathrm{DL}} \)
else
    \( V_{\text {temp }, 2}=V_{T-\mathrm{DA}, m}^{\mathrm{DL}} \)
end if
```

if harq-ACK-SpatialBundlingPUCCH is not provided and the UE is configured by maxNrofCode WordsScheduledByDCI with reception of two transport blocks for at least one configured DL BWP of at least one serving cell,
```
\( \tilde{o}_{2 \cdot T_{D} \cdot j+2\left(V_{C-D A I, c, m}^{D L-1}\right)}^{A C K} \) = HARQ-ACK information bit corresponding to the first transport block of
    this cell
\( \tilde{o}_{2 \cdot T_{D} \cdot j+2\left(V_{C-D A I, c, m}^{D L}-1\right)+1}^{A C K}= \) HARQ-ACK information bit corresponding to the second transport
block of this cell
\( V_{s}=V_{s} \cup\left\{2 \cdot T_{D} \cdot j+2\left(V_{C-D A I, c, m}^{\mathrm{DL}}-1\right), 2 \cdot T_{D} \cdot j+2\left(V_{C-D A I, c, m}^{\mathrm{DL}}-1\right)+1\right\} \)
```

elseif harq-ACK-SpatialBundlingPUCCH is provided to the UE and \( m \) is a monitoring occasion for PDCCH with a DCI format that supports PDSCH reception with two transport blocks and the UE is configured by maxNrofCodeWordsScheduledByDCI with reception of two transport blocks in at least one configured DL BWP of a serving cell,

ETSI


--- Page 87  ---


3GPP TS 38.213 version 17.1.0 Release 17
86
ETSI TS 138213 V17.1.0 (2022-05)

\( \tilde{o}_{T_{D} \cdot j+V_{C-\mathrm{DA}, c, m}-1}^{A C K}= \) binary AND operation of the HARQ-ACK information bits corresponding to the first and second transport blocks of this cell
\[
V_{s}=V_{s} \cup\left\{T_{D} \cdot j+V_{C-\mathrm{DA}, c, m}^{\mathrm{DL}}-1\right\}
\]
else
\[
\begin{array}{l}
\tilde{o}_{T_{D} \cdot j+V_{C-D A I, c, m-1}}^{A C K}=\text { HARQ-ACK information bit of this cell } \\
V_{s}=V_{s} \cup\left\{T_{D} \cdot j+V_{C-\mathrm{DAI}, m}^{\mathrm{DL}}-1\right\}
\end{array}
\]
end if
end if
\[
c=c+1
\]
end if
end while
\[
m=m+1
\]
end while
\[
V_{\text {temp }}=\left(j \bmod \left(\frac{4}{T_{D}}\right)\right) \times\left(\frac{4}{T_{D}}\right)+V_{\text {temp }}
\]
if UE does not set \( V_{\text {temp } 2}=V_{\mathrm{T}-D A I}^{U L} \) and \( T_{D}=2 \)
\[
V_{t e m p 2}=V_{t e m p}
\]
end if
\[
\begin{array}{l}
j=\left[\frac{j \times T_{D}}{4}\right] \\
\text { if } V_{\text {temp } 2}<V_{\text {temp }} \\
\quad j=j+1
\end{array}
\]
end if
if harq-ACK-SpatialBundlingPUCCH is not provided to the UE and the UE is configured by
maxNrofCodeWordsScheduledByDCI with reception of two transport blocks for at least one configured DL BWP of a serving cell,
\[
O^{A C K}=2 \cdot\left(4 \cdot j+V_{\text {temp } 2}\right)
\]
else
\[
O^{A C K}=4 \cdot j+V_{\text {temp } 2}
\]
end if
\( \tilde{o}_{i}^{A C K}= \) NACK for any \( i \in\left\{0,1, \cdots, O^{A C K}-1\right\} \backslash V_{s} \)
If a UE is configured to receive SPS PDSCH and the UE multiplexes HARQ-ACK information for one activated SPS PDSCH reception, including the ones associated with the corresponding activation DCI, in the PUCCH in slot \( n \), the UE generates one HARQ-ACK information bit associated with the SPS PDSCH reception and appends it to the \( O^{A C K} \) HARQ-ACK information bits.

If a UE is configured to receive SPS PDSCH and the UE multiplexes HARQ-ACK information for multiple activated SPS PDSCH receptions, including the ones associated with the corresponding activation DCI, in the PUCCH in slot \( n \),

ETSI


--- Page 88  ---


3GPP TS 38.213 version 17.1.0 Release 17
87
ETSI TS 138213 V17.1.0 (2022-05)

the UE generates the HARQ-ACK information as described in clause 9.1.2 and appends it to the \( O^{\text {ACK }} \) HARQ-ACK information bits.

The UE generates HARQ-ACK information with ACK value in response to a detection of a DCI format that does not trigger a Type-3 HARQ-ACK codebook report and has associated HARQ-ACK information without scheduling a PDSCH reception.

For a PDCCH monitoring occasion with DCI format scheduling PDSCH reception, or having associated HARQ-ACK information without scheduling a PDSCH reception, in the active DL BWP of a serving cell, when a UE receives a PDSCH with one transport block, or detects a DCI format having associated HARQ-ACK information without scheduling PDSCH reception, and the value of maxNrofCodeWordsScheduledByDCI is 2 , the HARQ-ACK information is associated with the first transport block and the UE generates a NACK for the second transport block if harq-ACKSpatialBundlingPUCCH is not provided and generates HARQ-ACK information with value of ACK for the second transport block if harq-ACK-SpatialBundlingPUCCH is provided.

If a UE is
- not provided PDSCH-CodeBlockGroupTransmission for any serving cell, or
- not provided PDSCH-TimeDomainResourceAllocationListForMultiPDSCH for any serving cell, or
- provided PDSCH-TimeDomainResourceAllocationListForMultiPDSCH and numberOfHARQ-BundlingGroups with \( N_{\mathrm{HARQ}-\mathrm{ACK}}^{\mathrm{TBG}, \max }=1 \) for a serving cell
for PDSCH receptions scheduled by a DCI format that does not support CBG-based PDSCH receptions, or for SPS PDSCH reception, or for a DCI format having associated HARQ-ACK information without scheduling PDSCH reception, and if \( O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}} \leq 11 \), the UE determines a number of HARQ-ACK information bits \( n_{\mathrm{HARQ} \text {-ACK }} \) for obtaining a transmission power for a PUCCH, as described in clause 7.2.1, as
\( n_{\text {HARQ-ACK }}=n_{\text {HARQ-ACKTB }}=\left(\left(V_{\text {DAl }, m_{\text {last }}}^{\mathrm{DL}}-\sum_{c=0}^{N_{\text {cells }}^{\mathrm{DL}}-1} U_{\text {DAl }, c}\right) \bmod \left(T_{D}\right)\right) N_{\text {TB }, \text { max }}^{\mathrm{DL}}+\sum_{c=0}^{N_{\text {chells }}^{\mathrm{DL}}-1}\left(\sum_{m=0}^{M-1} N_{m, c}^{\text {re ceived }}+N_{\mathrm{SPS}, c}\right)+ \sum_{g=0}^{G-1}\left(\left(\left(V_{\mathrm{DAl}, m_{\mathrm{last}}, g}^{\mathrm{DL}}-\sum_{c=0}^{N_{\mathrm{cells}, g}^{\mathrm{DL}}-1} U_{\mathrm{DAl}, c, g}\right) \bmod \left(T_{D, g}\right)\right) N_{\mathrm{TB}, \max , g}^{\mathrm{DL}}+\sum_{c=0}^{N_{\text {cells }, g}^{\mathrm{DL}}-1}\left(\sum_{m=0}^{M_{g}-1} N_{m, c, g}^{\text {received }}+N_{\mathrm{SPS}, c, g}\right)\right) \)
where
- \( \quad N_{\text {cells }}^{\mathrm{DL}} \) is a number of serving cells where the UE is configured to receive unicast PDSCHs
- \( \quad N_{\text {cell } s_{,} g}^{\mathrm{DL}} \) is a number of serving cells where the UE is configured to receive multicast PDSCHs for a G-RNTI \( g \) or a G-CS-RNTI \( g \)
- \( G \) is a total number of G-RNTIs or G-CS-RNTIs configured to the UE
- \( M \) is the number of PDCCH monitoring occasions for unicast DCI formats
- \( M_{g} \) is the number of PDCCH monitoring occasions for multicast DCI formats with CRC scrambled by G-RNTI \( g \) or G-CS-RNTI \( g \)
- \( T_{D}=2^{N_{C-\text { DAI }}^{\mathrm{DL}}} \) where \( N_{C-\mathrm{DAl}}^{\mathrm{DL}} \) the number of bits for the counter DAI field in unicast DCI formats
- \( T_{D, g}=2^{N_{C-\mathrm{DA}, g}^{\mathrm{DL}}} \) where \( N_{C-\mathrm{DAl}, g}^{\mathrm{DL}} \) the number of bits for the counter DAI field in multicast DCI formats with CRC scrambled by G-RNTI \( g \) or G-CS-RNTI \( g \)
- if \( N_{\text {cells }}^{\mathrm{DL}}=1, V_{\mathrm{DAL}, m_{\text {last }}}^{\mathrm{DL}} \) is the value of the counter DAI in the last DCI format scheduling PDSCH reception or having associated HARQ-ACK information without scheduling PDSCH reception, that the UE detects within the \( M \) PDCCH monitoring occasions.
- if \( N_{\text {cell }, g}^{\mathrm{DL}}=1, V_{\mathrm{DAL}, m_{\text {last }, g}}^{\mathrm{DL}} \) is the value of the counter DAI in the last multicast DCI format with G-RNTI \( g \), or G-CS-RNTI \( g \), scheduling PDSCH reception or having associated HARQ-ACK information without scheduling a PDSCH reception, that the UE detects within the \( M_{g} \) PDCCH monitoring occasions
- if \( N_{\text {cells }}^{\mathrm{DL}}>1 \) or if \( N_{\text {cells }, g}^{\mathrm{DL}}>1 \)

ETSI


--- Page 89  ---


3GPP TS 38.213 version 17.1.0 Release 17
88
ETSI TS 138213 V17.1.0 (2022-05)
- if the UE does not detect any DCI format that includes a total DAI field in a last PDCCH monitoring occasion within the \( M \) or \( M_{g} \) PDCCH monitoring occasions where the UE detects at least one DCI format scheduling PDSCH reception, or having associated HARQ-ACK information without scheduling PDSCH reception, for any serving cell \( c, V_{\mathrm{DAI}, m_{\mathrm{last}}}^{\mathrm{DL}} \) or \( V_{\mathrm{DAL}, m_{\mathrm{last}, g}}^{\mathrm{DL}} \), respectively, is the value of the counter DAI in a last DCI format the UE detects in the last PDCCH monitoring occasion
- if the UE detects at least one DCI format that includes a total DAI field in a last PDCCH monitoring occasion within the \( M \) or \( M_{g} \), for G-RNTI \( g \) or G-CS-RNTI \( g \), PDCCH monitoring occasions where the UE detects at least one DCI format scheduling PDSCH reception, or having associated HARQ-ACK information without scheduling PDSCH reception, for any serving cell \( c, V_{\mathrm{DAL}, m_{\text {last }}}^{\mathrm{DL}} \) or \( V_{\mathrm{DAL}, m_{\text {last }, g}}^{\mathrm{DL}} \), respectively, is the value of the total DAI in the at least one DCI format that includes a total DAI field
- \( V_{\mathrm{DAI}, m_{\text {last }}}^{\mathrm{DL}}=0 \) or \( V_{\mathrm{DAL}, m_{\text {last }, g}}^{\mathrm{DL}}=0 \) if the UE does not detect any DCI format scheduling PDSCH reception, or having associated HARQ-ACK information without scheduling PDSCH reception, for any serving cell \( c \) in any of the \( M \) or \( M_{g} \) PDCCH monitoring occasions, respectively.
- \( U_{\mathrm{DAl}, c} \) or \( U_{\mathrm{DAl}, c, g} \), for G-RNTI \( g \) or G-CS-RNTI \( g \), is the total number of DCI formats scheduling PDSCH receptions, or having associated HARQ-ACK information without scheduling a PDSCH reception, that the UE detects within the \( M \) or \( M_{g} \mathrm{PDCCH} \) monitoring occasions, respectively, for serving cell \( c . U_{\mathrm{DAL}, c}=0 \) or \( U_{\mathrm{DA}, c, g}=0 \) if the UE does not detect any DCI format scheduling PDSCH reception, or having associated HARQ-ACK information without scheduling PDSCH reception, for serving cell \( c \) in any of the \( M \) or \( M_{g} \), respectively, PDCCH monitoring occasions.
- \( \quad N_{\mathrm{TB}, \max }^{\mathrm{DL}}=2 \) if the value of maxNrofCodeWordsScheduledByDCI is 2 for any serving cell \( c \) and harq-ACKSpatialBundlingPUCCH is not provided; otherwise, \( N_{\mathrm{TB}, \max }^{\mathrm{DL}}=1 \).
- \( \quad N_{\mathrm{TB}, \max , g}^{\mathrm{DL}}=2 \) if the value of maxNrofCodeWordsScheduledByDCI is 2 for any serving cell \( c \) and harq-ACKSpatialBundlingPUCCH is not provided for G-RNTI \( g \) or G-CS-RNTI \( g \); otherwise, \( N_{\mathrm{TB}, \max , g}^{\mathrm{DL}}=1 \).
- \( \quad N_{m, c}^{\text {received }} \) or \( N_{m, c, g}^{\text {received }} \), for G-RNTI \( g \) or G-CS-RNTI \( g \), is
- if harq-ACK-SpatialBundingPUCCH is not provided, the number of transport blocks the UE receives in a PDSCH, or the number of transport block groups in PDSCHs if numberOfHARQ-BundlingGroups with \( N_{\mathrm{HARQ}-\mathrm{ACK}}^{\mathrm{TBG}}=1 \) is provided, scheduled by a DCI format that the UE detects in PDCCH monitoring occasion \( m \) for serving cell \( c \)
- else if harq-ACK-SpatialBundlingPUCCH is provided, the number of PDSCHs, or the number of PDSCH groups if numberOfHARQ-BundlingGroups with \( N_{\mathrm{HARQ}-\mathrm{ACK}}^{\mathrm{TBG}}=1 \) is provided, scheduled by a DCI format that the UE detects in PDCCH monitoring occasion \( m \) for serving cell \( c \)
- else, the number of DCI formats that the UE detects and have associated a HARQ-ACK information without scheduling PDSCH reception in PDCCH monitoring occasion \( m \) for serving cell \( c \).
- \( \quad N_{\mathrm{SPS}, c} \) or \( N_{\mathrm{SPS}, c, g} \), for G-RNTI \( g \) or G-CS-RNTI \( g \), is the number of SPS PDSCH receptions by the UE on serving cell \( c \) for which the UE transmits corresponding HARQ-ACK information in the same PUCCH as for HARQACK information corresponding to PDSCH receptions within the \( M \) or \( M_{g} \) PDCCH monitoring occasions, respectively.

If a UE
- is provided PDSCH-CodeBlockGroupTransmission for \( N_{\text {cells }}^{\text {DLCBG }} \) serving cells; and
- is not provided PDSCH-CodeBlockGroupTransmission, for \( N_{\text {cells }}^{\mathrm{DLTB}} \) serving cells where \( N_{\text {cells }}^{\mathrm{DL}, \mathrm{TB}}+N_{\text {cells }}^{\mathrm{DL}, \mathrm{CBG}}= N_{\text {cells }}^{\text {DL }} \)
the UE determines the \( \tilde{o}_{0}^{A C K}, \tilde{o}_{1}^{A C K}, \cdots, \tilde{o}_{O_{\mathrm{ACK}}-1}^{A C K} \) according to the previous pseudo-code with the following modifications
- \( \quad N_{\text {cells }}^{\mathrm{DL}} \) is used for the determination of a first HARQ-ACK sub-codebook for
- SPS PDSCH reception,

ETSI


--- Page 90  ---


3GPP TS 38.213 version 17.1.0 Release 17
89
ETSI TS 138213 V17.1.0 (2022-05)
- a DCI format having associated HARQ-ACK information without scheduling PDSCH reception,
- TCI state update, and
- TB-based PDSCH receptions on the \( N_{\text {cells }}^{\text {DL,CBG }} \) serving cells and on the \( N_{\text {cells }}^{\text {DL,TB }} \) serving cells,
- \( \quad N_{\text {cells }}^{\text {DL }} \) is replaced by \( N_{\text {cells }}^{\text {DL,CBG }} \) for the determination of a second HARQ-ACK sub-codebook corresponding to the \( N_{\text {cells }}^{\text {DL, CBG }} \) serving cells for CBG-based PDSCH receptions, and
- if, for an active DL BWP of a serving cell, the UE is not provided coresetPoollndex or is provided coresetPoollndex with value 0 for one or more first CORESETs and is provided coresetPoollndex with value 1 for one or more second CORESETs, and is provided ackNackFeedbackMode = joint, the serving cell is counted as two times where the first time corresponds to the first CORESETs and the second time corresponds to the second CORESETs, and
- instead of generating one HARQ-ACK information bit per transport block for a serving cell from the \( N_{\text {cells }}^{\text {DL }} \) serving cells, the UE generates \( N_{\text {HARQ-ACK, max }}^{\mathrm{CBG} / \mathrm{TB} / \max } \) HARQ-ACK information bits, where \( N_{\text {HARQ-ACK, max }}^{\mathrm{CBG} / \mathrm{TB} / \max } \) is the maximum value of \( N_{\mathrm{TB}, c}^{\mathrm{DL}} \cdot N_{\mathrm{HARQ}-\mathrm{ACK}, c}^{\mathrm{CBG} / \mathrm{TB}, \max } \) across all \( N_{\text {cells }}^{\mathrm{DL}, \mathrm{CBG}} \) serving cells and \( N_{\mathrm{TB}, c}^{\mathrm{DL}} \) is the value of maxNrofCodeWordsScheduledByDCI for serving cell \( c \). If for a serving cell \( c \) it is \( N_{\mathrm{TB}, c}^{\mathrm{DL}} \cdot N_{\mathrm{HARQ}-\mathrm{ACK}, c}^{\mathrm{CBG} / \mathrm{TB} \text { max }}< N_{\text {HARQ-ACK, max, }}^{\mathrm{CBG} / \mathrm{TB}, \mathrm{max}_{2}} \), the UE generates NACK for the last \( N_{\text {HARQ-ACK, max }}^{\mathrm{CBG} / \mathrm{TB}, \max }-N_{\mathrm{TB}, c}^{\mathrm{DL}} \cdot N_{\text {HARQ-ACK }, c}^{\mathrm{CBG} / \mathrm{TB}, \max } \) HARQ-ACK information bits for serving cell \( c \)
- the pseudo-code operation when harq-ACK-SpatialBundlingPUCCH is provided is not applicable
- The counter DAI value and the total DAI value apply separately for each HARQ-ACK sub-codebook
- The UE generates the HARQ-ACK codebook by appending the second HARQ-ACK sub-codebook to the first HARQ-ACK sub-codebook

If \( O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}} \leq 11 \), the UE also determines \( n_{\text {HARQ-ACK }}=n_{\text {HARQ-ACK,TB }}+n_{\text {HARQ-ACK,CBG }} \) for obtaining a PUCCH transmission power, as described in clause 7.2.1, with
\[
n_{\text {HARQ-ACK,CBG }, \mathrm{CBG}}=\left(\left(V_{\mathrm{DAI}, m_{\text {last }}}^{\mathrm{DL}}-\sum_{c=0}^{N_{\text {cells }}^{\mathrm{DL}, \mathrm{CBG}}}-1 U_{\mathrm{DAI}, c}^{\mathrm{CBG}}\right) \bmod \left(T_{D}\right)\right) N_{\mathrm{HARQ}-\mathrm{ACK}, \max }^{\mathrm{CBG} / \mathrm{TB}, \max }+\sum_{c=0}^{N_{\text {cells }}^{\mathrm{DL}}-1} \sum_{m=0}^{M-1} N_{m, c}^{\text {received,CBG }}
\]
where
- if \( N_{\text {cells }}^{\mathrm{DL}}=1, V_{\mathrm{DAI}, m_{\text {last }}}^{\mathrm{DL}} \) is the value of the counter DAI in the last DCI format scheduling CBG-based PDSCH reception that the UE detects within the \( M \mathrm{PDCCH} \) monitoring occasions
- if \( N_{\text {cells }}^{\mathrm{DL}}>1, V_{\mathrm{DAI}, m_{\text {last }}}^{\mathrm{DL}} \) is the value of the total DAI in the last DCI format scheduling CBG-based PDSCH reception for any serving cell \( c \) that the UE detects within the \( M \mathrm{PDCCH} \) monitoring occasions
- \( V_{\mathrm{DAL}, m_{\text {last }}}^{\mathrm{DL}}=0 \), if the UE does not detect any DCI format scheduling CBG-based PDSCH reception for any serving cell \( c \) in any of the \( M \) PDCCH monitoring occasions
- \( U_{\mathrm{DAL}, C}^{\mathrm{CBG}} \) is the total number of DCI formats scheduling CBG-based PDSCH receptions that the UE detects within the \( M \mathrm{PDCCH} \) monitoring occasions for serving cell \( c . U_{\mathrm{DAI}, c}^{\mathrm{CBG}}=0 \) if the UE does not detect any DCI format scheduling CBG-based PDSCH reception for serving cell \( c \) in any of the \( M \) PDCCH monitoring occasions
- \( N_{m, c}^{\text {received, }{ }^{\text {CBG }}} \) is the number of CBGs the UE receives in a PDSCH scheduled by a DCI format that supports CBG-based PDSCH reception that the UE detects in PDCCH monitoring occasion \( m \) for serving cell \( c \) and the UE reports corresponding HARQ-ACK information in the PUCCH

If a UE is not provided numberOfHARQ-BundlingGroups, detects a first DCI format scheduling one PDSCH reception or having associated HARQ-ACK information without scheduling a PDSCH reception, if any, and a second DCI format scheduling more than one PDSCH reception on a serving cell from the \( N_{\text {cells }}^{\text {DL }} \) serving cells, if any, and the UE would provide corresponding HARQ-ACK information in a same PUCCH, the UE determines the \( \tilde{o}_{0}^{\text {ACK }}, \tilde{o}_{1}^{\text {ACK }}, \cdots, \tilde{o}_{o_{\text {ACK }}-1}^{\text {ACK }} \) according to the previous pseudo-code with the following modifications

ETSI


--- Page 91  ---


3GPP TS 38.213 version 17.1.0 Release 17
90
ETSI TS 138213 V17.1.0 (2022-05)
- the UE determines a first HARQ-ACK sub-codebook based on each detected DCI format scheduling one PDSCH reception or having associated HARQ-ACK information without scheduling a PDSCH reception, or SPS PDSCH receptions, if any, and
- the UE determines a second HARQ-ACK sub-codebook based on each detected DCI format scheduling more than one PDSCH reception, and
- instead of generating one HARQ-ACK information bit per transport block for serving cell \( c \), the UE generates \( N_{\text {HARQ-ACK }}^{\max } \) HARQ-ACK information bits where \( N_{\text {HARQ-ACK }}^{\max } \) is the maximum value of \( N_{\text {TB }, c}^{\mathrm{DL}} \). \( N_{\text {PDSCH }, c}^{\max } \) across all \( N_{\text {cells }}^{\text {DL }} \) serving cells, \( N_{\text {PDSCH }, c}^{\max } \) is a maximum number of PDSCH receptions that can be scheduled by a DCI format on serving cell \( c \) as described in [6, TS 38.214], and \( N_{\mathrm{TB}, c}^{\mathrm{DL}} \) is the value of maxNrofCode WordsScheduledByDCI for serving cell \( c \) if harq-ACK-SpatialBundlingPUCCH is not provided; else, \( N_{\mathrm{TB}, c}^{\mathrm{DL}}=1 \). The UE generates the \( N_{\mathrm{HARQ} \text {-ACK }}^{\max } \) HARQ-ACK information bits in ascending order of the \( N_{\text {PDSCH }, C} \) PDSCHs, including any PDSCH that overlaps with UL symbols indicated by \( t d d \)-UL-DL-ConfigurationCommon, or by tdd-UL-DL-ConfigurationDedicated if provided. If, for serving cell \( c \), the UE detects a DCI format that schedules \( N_{\text {PDSCH }, c} \) PDSCH receptions and \( N_{\text {TB }, c}^{\mathrm{DL}} \cdot N_{\text {PDSCH }, c}<N_{\text {HARQ-ACK }}^{\text {max }} \), the UE generates NACK for the last \( N_{\text {HARQ-ACK }}^{\max }-N_{\text {TB }, c}^{\text {DL }} \cdot N_{\text {PDSCH }, c} \) HARQ-ACK information bits
- The pseudo-code operation when PDSCH-CodeBlockGroupTransmission is provided is not applicable.
- The counter DAI value and the total DAI value apply separately for each HARQ-ACK sub-codebook.
- The UE generates the HARQ-ACK codebook by appending the second HARQ-ACK sub-codebook to the first HARQ-ACK sub-codebook.

If a UE is provided numberOfHARQ-BundlingGroups and is not provided harq-ACK-SpatialBundlingPUCCH for a serving cell \( c \), the UE generates HARQ-ACK information over transport block groups (TBGs) for PDSCH receptions where, for a maximum number of \( N_{\text {PDSCH }}^{\max } \) PDSCH receptions scheduled by a DCI format on the serving cell, a maximum number of TBGs \( N_{\mathrm{HARQ}-\mathrm{ACK}, c}^{\mathrm{TBG}, \mathrm{max}} \) is provided by numberOfHARQ-BundlingGroups. If the UE detects a DCI format scheduling \( N_{\text {PDSCH }, c} \) PDSCH receptions on the serving cell \( c \), the UE generates \( N_{\text {HARQ-ACK }, c}^{\text {TBG, }} \) HARQ-ACK information bits for first TBs and, if applicable, generates \( N_{\text {HARQ-ACK }, c}^{\text {TBG }} \) HARQ-ACK information bits for second TBs in the \( N_{\mathrm{PDSCH}, c} \mathrm{PDSCH} \) receptions as described in clause 9.1.1 by setting \( N_{\mathrm{HARQ}-\mathrm{ACK}}^{\mathrm{CBG} / \mathrm{TB}, \mathrm{max}}=N_{\mathrm{HARQ}-\mathrm{ACK}, c}^{\mathrm{TBG}, \mathrm{max}} \) and \( C=N_{\mathrm{PDSCH}, c} \) For a TBG associated with at least one PDSCH that does not overlap with an UL symbol indicated by tdd-UL-DLConfigurationCommon, or by tdd-UL-DL-ConfigurationDedicated if provided, the UE assumes that TB(s) provided by a PDSCH that overlaps with an UL symbol indicated by tdd-UL-DL-ConfigurationCommon, or by tdd-UL-DLConfigurationDedicated if provided, are correctly received. For a TBG associated only with PDSCHs that overlap with UL symbols indicated by tdd-UL-DL-ConfigurationCommon, or by tdd-UL-DL-ConfigurationDedicated if provided, the UE generates a NACK value for the TBG.

If a UE is provided numberOfHARQ-BundlingGroups and harq-ACK-SpatialBundlingPUCCH for a serving cell \( c \), the UE generates HARQ-ACK information over PDSCH reception groups for PDSCH receptions scheduled by a DCI format on the serving cell \( c \) where a maximum number of PDSCH reception groups, \( N_{\text {HARQ-ACK }, c}^{\text {TBG, }} \), is provided by numberOfHARQ-BundlingGroups. If the UE detects a DCI format scheduling \( N_{\mathrm{PDSCH}, c} \mathrm{PDSCH} \) receptions on the serving cell \( c \), the UE generates \( N_{\text {HARQ-ACK }, c}^{\text {TBG }} \) HARQ-ACK information bits for the \( N_{\text {PDSCH }, c} \) PDSCH receptions as described in clause 9.1.1 by setting \( N_{\mathrm{HARQ}-\mathrm{ACK}}^{\mathrm{CBG} / \mathrm{TB}, \max }=N_{\mathrm{HARQ}-\mathrm{ACK}, c}^{\mathrm{TBG}, \max } \) and \( C=N_{\mathrm{PDSCH}, c} \) - For a PDSCH reception group associated with at least one PDSCH that does not overlap with an UL symbol indicated by tdd-UL-DLConfigurationCommon, or by tdd-UL-DL-ConfigurationDedicated if provided, the UE assumes that TBs provided by a PDSCH that overlaps with an UL symbol indicated by tdd-UL-DL-ConfigurationCommon, or by tdd-UL-DLConfigurationDedicated if provided, are correctly received. For a PDSCH reception group associated only with PDSCHs that overlap with UL symbols indicated by tdd-UL-DL-ConfigurationCommon, or by tdd-UL-DLConfigurationDedicated if provided, the UE generates a NACK value for the PDSCH reception group.

If a UE
- is provided PDSCH-TimeDomainResourceAllocationListForMultiPDSCH and, if provided, numberOfHARQBundlingGroups with value \( N_{\text {HARQ-ACK }}^{\text {TBG }}>1 \) for \( N_{\text {cells }}^{\text {DLTBG }} \) serving cells; and
- is not provided PDSCH-TimeDomainResourceAllocationListForMultiPDSCH or is provided numberOfHARQBundlingGroups with value \( N_{\mathrm{HARQ}-\mathrm{ACK}}^{\mathrm{TBG}}=1 \), for \( N_{\text {cells }}^{\mathrm{DL}, \mathrm{TB}} \) serving cells where \( N_{\text {cells }}^{\mathrm{DLTB}}+N_{\text {cells }}^{\mathrm{DLTBG}}=N_{\text {cells }}^{\mathrm{DL}} \)

ETSI


--- Page 92  ---


3GPP TS 38.213 version 17.1.0 Release 17
91
ETSI TS 138213 V17.1.0 (2022-05)

the UE determines the \( \tilde{o}_{0}^{A C K}, \tilde{o}_{1}^{A C K}, \cdots, \tilde{o}_{O_{\mathrm{ACK}}-1}^{A C K} \) according to the previous pseudo-code with the following modifications
- \( \quad N_{\text {cells }}^{\mathrm{DL}} \) is used for the determination of a first HARQ-ACK sub-codebook for
- SPS PDSCH reception,
- any DCI format having associated HARQ-ACK information without scheduling PDSCH reception, and
- PDSCH reception scheduled by a DCI format scheduling one PDSCH
- PDSCH reception with \( N_{\text {HARQ-ACK }}^{\text {TBG, max }}=1 \) for TBG-based HARQ-ACK information on the \( N_{\text {cells }}^{\text {DLTB }} \) serving cells,
- \( \quad N_{\text {cells }}^{\text {DL }} \) is replaced by \( N_{\text {cells }}^{\text {DLTBG }} \) for the determination of a second HARQ-ACK sub-codebook corresponding to the \( N_{\text {cells }}^{\text {DLTBG }} \) serving cells for TBG-based HARQ-ACK information, or for TB-based HARQ-ACK information corresponding to multiple PDSCH receptions scheduled by a single DCI format, and
- if, for an active DL BWP of a serving cell, the UE is not provided coresetPoollndex or is provided coresetPoollndex with value 0 for one or more first CORESETs and is provided coresetPoollndex with value 1 for one or more second CORESETs, and is provided ackNackFeedbackMode = joint, the serving cell is counted as two times where the first time corresponds to the first CORESETs and the second time corresponds to the second CORESETs, and
- instead of generating one HARQ-ACK information bit per transport block for a serving cell from the \( N_{\text {cells }}^{\text {DLTBG }} \) serving cells, the UE generates \( N_{\text {HARQ-ACK, max }}^{\text {TBG, max }} \) HARQ-ACK information bits, where \( N_{\text {HARQ-ACK, max }}^{\text {TBG, is the }} \) maximum value between \( N_{\mathrm{TB}, c}^{\mathrm{DL}} \cdot N_{\mathrm{HARQ}-\mathrm{ACK}, c}^{\mathrm{TBG}} \) across all \( N_{\text {cells }}^{\mathrm{DL}, \mathrm{TBG}} \) serving cells if the UE is provided numberOfHARQ-BundlingGroups, and \( N_{\mathrm{TB}, c}^{\mathrm{DL}} \cdot N_{\mathrm{PDSCH}, c}^{\max } \) across all \( N_{\mathrm{cells}}^{\mathrm{DL}} \) serving cells where the UE is not provided numberOfHARQ-BundingGroups, and \( N_{\mathrm{TB}, c}^{\mathrm{DL}} \) is the value of maxNrofCodeWordsScheduledByDCI for serving cell \( c \) if harq-ACK-SpatialBundlingPUCCH is not provided; else, \( N_{\mathrm{TB}, c}^{\mathrm{DL}}=1 \). If for a serving cell \( c \) where the UE is provided numberOfHARQ-BundingGroups, it is \( N_{\mathrm{TB}, c}^{\mathrm{DL}} \cdot N_{\mathrm{HARQ}-\mathrm{ACK}, c}^{\mathrm{TBG}}<N_{\mathrm{HARQ}-\mathrm{ACK}, \max }^{\mathrm{TBG}} \), the UE generates NACK for the last \( N_{\text {HARQ-ACK },_{\text {max }}}^{\text {TBG }}-N_{\text {TB }, c}^{\text {DL }} \cdot N_{\text {HARQ-ACK }, c}^{\text {TBG },_{\text {max }}} \) HARQ-ACK information bits for serving cell \( c \). If for a serving cell \( c \) where the UE is not provided numberOfHARQ-BundlingGroups, it is \( N_{\mathrm{TB}, c}^{\mathrm{DL}} \cdot N_{\mathrm{PDSC}, c}^{\max }<N_{\mathrm{HARQ}-\mathrm{AC}, \max }^{\mathrm{TBG}, \max } \), the UE generates NACK for the last \( N_{\mathrm{HARQ}-\mathrm{ACK}, \max }^{\mathrm{TBG}}-N_{\mathrm{TB}, c}^{\mathrm{DL}} \cdot N_{\mathrm{PDSCH}, c}^{\max } \) HARQ-ACK information bits for serving cell \( c \).
- The pseudo-code operation when PDSCH-CodeBlockGroupTransmission is provided is not applicable.
- The counter DAI value and the total DAI value apply separately for each HARQ-ACK sub-codebook.
- The UE generates the HARQ-ACK codebook by appending the second HARQ-ACK sub-codebook to the first HARQ-ACK sub-codebook.

If \( O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}} \leq 11 \) and \( N_{\text {cells }}^{\mathrm{DL}, \mathrm{TBG}}>0 \), the UE also determines \( n_{\text {HARQ-ACK }}=n_{\text {HARQ-ACK,TB }}+n_{\text {HARQ-ACK,TBG }} \) for obtaining a PUCCH transmission power, as described in clause 7.2.1, with
\[
n_{\mathrm{HARQ}-\mathrm{ACK}, \mathrm{TBG}}=\left(\left(V_{\mathrm{DA}, m_{\text {last }}}^{\mathrm{DL}}-\sum_{c=0}^{N_{\text {cells }}^{\mathrm{DL}, \mathrm{TBG}}}-1 U_{\mathrm{DAJ}, c}^{\mathrm{TBG}}\right) \bmod \left(T_{D}\right)\right) N_{\mathrm{HARQ}-\mathrm{ACK}, \max }^{\mathrm{TBG}, \max }+\sum_{c=0}^{N_{\text {cells }}^{\mathrm{DL}, \mathrm{TBG}}-1} \sum_{m=0}^{M-1} N_{m, c}^{\text {received,TBG }}
\]
where
- if \( N_{\text {cells }}^{\mathrm{DL}}=1, V_{\mathrm{DAI} m_{\text {last }}}^{\mathrm{DL}} \) is the value of the counter DAI in the last DCI format scheduling more than one PDSCH receptions for any serving cell \( c \) from the \( N_{\text {cells }}^{\text {DLTBG }} \) serving cells with TBG-based HARQ-ACK information or with TB-based HARQ-ACK information that the UE detects within the \( M \) PDCCH monitoring occasions
- if \( N_{\text {cells }}^{\mathrm{DL}}>1, V_{\mathrm{DAI}, m_{\text {last }}}^{\mathrm{DL}} \) is the value of the total DAI in the last DCI format scheduling more than one PDSCH receptions with TBG-based HARQ-ACK information or with TB-based HARQ-ACK information for any serving cell \( c \) from the \( N_{\text {cells }}^{\text {DLTBG }} \) serving cells that the UE detects within the \( M \) PDCCH monitoring occasions
- \( \quad V_{\mathrm{DAI}, m_{\text {last }}}^{\mathrm{DL}}=0 \), if the UE does not detect any DCI format scheduling more than one PDSCH receptions with TBG-based HARQ-ACK information or with TB-based HARQ-ACK information for any serving cell \( c \) from the \( N_{\text {cells }}^{\text {DLTBG }} \) serving cells in any of the \( M \) PDCCH monitoring occasions

ETSI


--- Page 93  ---


3GPP TS 38.213 version 17.1.0 Release 17
92
ETSI TS 138213 V17.1.0 (2022-05)
- \( \quad U_{\mathrm{DAI}, C}^{\mathrm{TBG}} \) is the total number of DCI formats scheduling more than one PDSCH receptions with TBG-based HARQACK information or with TB-based HARQ-ACK information for any serving cell \( c \) from the \( N_{\text {cells }}^{\text {DLTBG }} \) serving cells that the UE detects within the \( M \) PDCCH monitoring occasions for serving cell \( c . U_{\mathrm{DAL}, c}^{\mathrm{TBG}}=0 \) if the UE does not detect any DCI format scheduling more than one PDSCH receptions for serving cell \( c \) in any of the \( M \) PDCCH monitoring occasions
- if harq-ACK-SpatialBundlingPUCCH is provided,
- if numberOfHARQ-BundlingGroups is provided, \( N_{m, c}^{\text {received,TBG }} \) is the number of PDSCH groups that include at least one PDSCH not overlapping with a UL symbol indicated by tdd-UL-DL-ConfigurationCommon, or tdd-UL-DL-ConfigurationDedicated if provided, that the UE receives in serving cell \( c \) from the \( N_{\text {cells }}^{\text {DL } \mathrm{TBG}} \) serving cells in PDCCH monitoring occasion \( m \) and the UE reports corresponding HARQ-ACK information in the PUCCH
- if numberOfHARQ-BundlingGroups is not provided, \( N_{m, c}^{\text {received,TBG }} \) is the number of PDSCHs that the UE receives in serving cell \( c \) from the \( N_{\text {cells }}^{\text {DLTBG }} \) serving cells in PDCCH monitoring occasion \( m \) and the UE reports corresponding HARQ-ACK information in the PUCCH
- if harq-ACK-SpatialBundlingPUCCH is not provided,
- if numberOfHARQ-BundlingGroups is provided, \( N_{m, c}^{\text {received,TBG }} \) is the number of TBGs including at least one PDSCH not overlapping with an UL symbol indicated by tdd-UL-DL-ConfigurationCommon, or by tdd-UL-DL-ConfigurationDedicated if provided, that the UE receives in serving cell \( c \) from the \( N_{\text {cells }}^{\text {DLTBG }} \) serving cells in PDCCH monitoring occasion \( m \) and the UE reports corresponding HARQ-ACK information in the PUCCH
- if numberOfHARQ-BundlingGroups is not provided, \( N_{m, c}^{\text {received,TBG }} \) is the number of transport blocks in PDSCHs that the UE receives in serving cell \( c \) from the \( N_{\text {cells }}^{\text {DLTBG }} \) serving cells in PDCCH monitoring occasion \( m \) and the UE reports corresponding HARQ-ACK information in the PUCCH.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.1.3-1: Value of counter DAI for \( N_{C-\mathrm{DAl}}^{\mathrm{DL}}=2 \) and of total DAI}
\begin{tabular}{|l|l|l|}
\hline DAI MSB, LSB & \( \boldsymbol{V}_{\mathrm{C}-\mathrm{DA}}^{\mathrm{DL}} \) or \( \boldsymbol{V}_{\mathrm{T}-\mathrm{DA}}^{\mathrm{DL}} \) & Number of (serving cell, PDCCH monitoring occasion)-pair(s) in which PDSCH transmission(s) associated with PDCCH or PDCCH generating a HARQ-ACK information bit without scheduling a PDSCH reception or providing TCI state update is present, denoted as \( Y \) and \( Y \geq 1 \) \\
\hline 0,0 & 1 & \( (Y-1) \bmod T_{D}+1=1 \) \\
\hline 0,1 & 2 & \( (Y-1) \bmod T_{D}+1=2 \) \\
\hline 1,0 & 3 & \( (Y-1) \bmod T_{D}+1=3 \) \\
\hline 1,1 & 4 & \( (Y-1) \bmod T_{D}+1=4 \) \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.1.3-1A: Value of counter DAI for \( N_{C-D A I}^{\mathrm{DL}}=1 \)}
\begin{tabular}{|l|l|l|}
\hline DAI & \( V_{\mathrm{C}-\mathrm{DAl}}^{\mathrm{DL}} \) & Number of (serving cell, PDCCH monitoring occasion)-pair(s) in which PDSCH transmission(s) associated with PDCCH or PDCCH generating a HARQ-ACK information bit without scheduling a PDSCH reception or providing TCI state update is present, denoted as \( Y \) and \( Y \geq 1 \) \\
\hline 0 & 1 & \( (Y-1) \bmod T_{D}+1=1 \) \\
\hline 1 & 2 & \( (Y-1) \bmod T_{D}+1=2 \) \\
\hline
\end{tabular}
\end{table}
9.1.3.2 Type-2 HARQ-ACK codebook in physical uplink shared channel

If a UE would multiplex HARQ-ACK information in a PUSCH transmission that is not scheduled by a DCI format or is scheduled by a DCI format that does not include a DAI field, then
- if the UE has not received any PDCCH within the monitoring occasions for DCI formats scheduling PDSCH receptions, or providing a DCI format having associated HARQ-ACK information without scheduling a PDSCH reception, on any serving cell \( c \) and the UE does not have HARQ-ACK information in response to a SPS

ETSI


--- Page 94  ---


3GPP TS 38.213 version 17.1.0 Release 17
93
ETSI TS 138213 V17.1.0 (2022-05)

PDSCH reception to multiplex in the PUSCH, as described in clause 9.1.3.1, the UE does not multiplex HARQACK information in the PUSCH transmission;
- else, the UE generates the HARQ-ACK codebook as described in clause 9.1.3.1, except that harq-ACKSpatialBundlingPUCCH is replaced by harq-ACK-SpatialBundlingPUSCH.

If a UE multiplexes HARQ-ACK information in a PUSCH transmission that is scheduled by a DCI format that includes a DAI field, the UE generates the HARQ-ACK codebook as described in clause 9.1.3.1, with the following modifications:
- For the pseudo-code for the HARQ-ACK codebook generation in clause 9.1.3.1, after the completion of the \( c \) and \( m \) loops, the UE sets \( V_{\text {temp } 2}=V_{\mathrm{T}-\mathrm{DA}}^{\mathrm{UL}} \) where \( V_{\mathrm{T}-\mathrm{DA}}^{\mathrm{UL}} \) is the value of the DAI field according to Table 9.1.3-2
- For the case of first and second HARQ-ACK sub-codebooks, the DCI format includes a first DAI field corresponding to the first HARQ-ACK sub-codebook and a second DAI field corresponding to the second HARQ-ACK sub-codebook
- harq-ACK-SpatialBundlingPUCCH is replaced by harq-ACK-SpatialBundlingPUSCH.

If a UE is not provided PDSCH-CodeBlockGroupTransmission and the UE is scheduled for a PUSCH transmission by DCI format that includes a DAI field with value \( V_{\text {T-DAI }}^{\text {UL }}=4 \) and the UE has not received any PDCCH within the monitoring occasions for PDCCH with DCI format scheduling PDSCH receptions or having associated HARQ-ACK information without scheduling PDSCH receptions on any serving cell \( c \) and the UE does not have HARQ-ACK information in response to a SPS PDSCH reception to multiplex in the PUSCH, as described in clause 9.1.3.1, the UE does not multiplex HARQ-ACK information in the PUSCH transmission.

If a UE is provided PDSCH-CodeBlockGroupTransmission and the UE is scheduled for a PUSCH transmission by DCI format that includes a DAI field with first value \( V_{\mathrm{T}-\mathrm{DAI}}^{\mathrm{UL}}=4 \) or with second value \( V_{\mathrm{T}-\mathrm{DA}}^{\mathrm{UL}}=4 \) and the UE has not received any PDCCH within the monitoring occasions for PDCCH with DCI format scheduling PDSCH reception or having associated HARQ-ACK information without scheduling PDSCH reception, on any serving cell \( c \) and the UE does not have HARQ-ACK information in response to a SPS PDSCH reception to multiplex in the PUSCH, as described in clause 9.1.3.1, the UE does not multiplex HARQ-ACK information for the first sub-codebook or for the second subcodebook, respectively, in the PUSCH transmission.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.1.3-2: Value of DAI}
\begin{tabular}{|l|l|l|}
\hline DAI MSB, LSB & \( \boldsymbol{V}_{\text {T-DAI }}^{\mathrm{UL}} \) & Number of (serving cell, PDCCH monitoring occasion)-pair(s) in which PDSCH transmission(s) associated with PDCCH or PDCCH indicating SPS PDSCH release or providing TCI state update or DCI format 1_1 indicating SCell dormancy is present, denoted as \( X \) and \( X \geq 1 \) \\
\hline 0,0 & 1 & \( (X-1) \bmod 4+1=1 \) \\
\hline 0,1 & 2 & \( (X-1) \bmod 4+1=2 \) \\
\hline 1,0 & 3 & \( (X-1) \bmod 4+1=3 \) \\
\hline 1,1 & 4 & \( (X-1) \bmod 4+1=4 \) \\
\hline
\end{tabular}
\end{table}
9.1.3.3 Type-2 HARQ-ACK codebook grouping and HARQ-ACK retransmission

If a UE is provided pdsch-HARQ-ACK-Codebook-r16, the UE determines HARQ-ACK information for multiplexing in a PUCCH transmission occasion according to the following procedure.

Set \( g \) to the value of a PDSCH group index field in a last DCI format that provides a value of \( g \) and indicates a PUCCH transmission occasion.

Set \( i(g) \) to denote a PUCCH transmission occasion for multiplexing HARQ-ACK information
Set \( k \) to the value of a PDSCH-to-HARQ_feedback timing field, if any, in a DCI format providing a value of \( g \)
- If the DCI format does not include a PDSCH-to-HARQ_feedback timing field, set \( k \) to the value provided by \( d l \) -DataToUL-ACK or dl-DataToUL-ACK-r16

Set \( h(g) \) to the value of a first New feedback indicator field in the last DCI format providing the value of \( g \)
Set \( h^{(g+1) \bmod 2}(g) \) to a value of a second New feedback indicator field in the last DCI format providing the value of \( g \)

ETSI


--- Page 95  ---


3GPP TS 38.213 version 17.1.0 Release 17
94
ETSI TS 138213 V17.1.0 (2022-05)

Set \( V_{D A I}^{(g+1) \bmod 2} \) to the value of a total DAI field for group \( (g+1) \bmod 2 \) in the last DCI format providing the value of \( g \)
- If \( g=1 \) and the UE detects a DCI format that does not include a PDSCH group index field in a PDCCH reception that is after the PDCCH reception for the last DCI format detection providing the value of \( g \) and indicating a same slot for a PUCCH transmission occasion, set \( V_{\mathrm{DAI}}^{(g+1) \bmod 2}=\emptyset \)

Set \( q \) to the value of a number of requested PDSCH group(s) field in the last DCI format providing the value of \( g \)
A UE does not expect to detect DCI formats with respective
- Number of requested PDSCH group(s) field values of 0 , and
- PDSCH-to-HARQ_feedback timing field values that indicate a same PUCCH transmission occasion, and
- PDSCH group index field values that are different

Generate first HARQ-ACK information for PUCCH transmission occasion \( i(g) \) in a slot, as described in clause 9.1.3.1, where
- the first HARQ-ACK information corresponds only to detections of DCI formats each providing a same value of \( g \), of \( h(g) \), and to detections of DCI formats that do not provide a value of \( g \) and \( h(g) \) and are associated with a same value of \( g \), of \( h(g) \), and at least one of the DCI formats providing a value of \( k \) indicating the slot
- at least one of the DCI formats provides a \( h(g) \) value
- \( m=0 \) corresponds to a PDCCH monitoring occasion, where the UE detects a DCI format that provides a value of \( g \) or is associated with a value of \( g \), that is the first PDCCH monitoring occasion after a PDCCH monitoring occasion where the UE detects another DCI format that provides a value different than \( h(g) \)

The generation of the first HARQ-ACK information for PUCCH transmission occasion \( i(g) \) in a slot, as described in clause 9.1.3.1, excludes the generation of HARQ-ACK information for SPS PDSCH receptions.

If \( h^{(g+1) \bmod 2}(g)=\emptyset \) or \( h^{(g+1) \bmod 2}(g)=h((g+1) \bmod 2) \), generate second HARQ-ACK information for PUCCH transmission occasion \( i((g+1) \bmod 2) \) in a slot, as described in clause 9.1.3.1, where
- the second HARQ-ACK information corresponds to detections of DCI formats each providing a same value of \( (g+1) \bmod 2 \), of \( h((g+1) \bmod 2) \) and to detections of DCI formats that do not provide a value of \( (g+1) \bmod 2 \), of \( h((g+1) \bmod 2) \), but are associated with a same value of \( (g+1) \bmod 2 \), of \( h((g+1) \bmod 2) \)
- at least one of the DCI formats provides a \( h((g+1) \bmod 2) \) value
- \( m=0 \) corresponds to a PDCCH monitoring occasion, where the UE detects a DCI format that provides a value of \( (g+1) \bmod 2 \) or that is associated with a value of \( (g+1) \bmod 2 \), that is the first PDCCH monitoring occasion after a PDCCH monitoring occasion where the UE detects another DCI format that provides a value different than \( h((g+1) \bmod 2) \)
- the PUCCH transmission occasion \( i((g+1) \bmod 2) \) is a last one for multiplexing second HARQ-ACK information and it is not after PUCCH transmission occasion \( i(g) \)
- if \( V_{\mathrm{DAI}}^{(g+1) \bmod 2} \neq \emptyset \), after the completion of the \( c \) and \( m \) loops for the pseudo-code for the second HARQ-ACK codebook generation in clause 9.1.3.1, set \( V_{\text {temp } 2}=V_{D A I}^{(g+1) m o d 2} \). If the UE is provided PDSCHCodeBlockGroupTransmission for \( N_{\text {cells }}^{\text {DLCBG }} \) serving cells, set \( V_{\text {temp } 2}=V_{D A I}^{(g+1) \bmod 2} \) for both sub-codebooks before appending the second sub-codebook to the first sub-codebook.

If \( h^{(g+1) \bmod 2}(g) \neq \emptyset \) and \( h^{(g+1) \bmod 2}(g) \neq h((g+1) \bmod 2) \), generate second HARQ-ACK information as described in clause 9.1.3.1 by setting \( M=0 \) and, after the completion of the \( c \) and \( m \) loops for the pseudo-code for the second HARQ-ACK codebook generation in clause 9.1.3.1, setting \( V_{\text {temp } 2}=V_{D A I}^{(g+1) \bmod 2} \).

The generation of the second HARQ-ACK information for PUCCH transmission occasion \( i((g+1) \bmod 2) \) in a slot, as described in clause 9.1.3.1, excludes the generation of HARQ-ACK information for SPS PDSCH receptions.

If \( q=0 \), the UE
includes only the first HARQ-ACK information for multiplexing in PUCCH transmission occasion \( i(g) \)

ETSI


--- Page 96  ---


3GPP TS 38.213 version 17.1.0 Release 17
95
ETSI TS 138213 V17.1.0 (2022-05)
```
elseif \( q=1 \)
    if \( \mathrm{g}=1 \)
        appends the first HARQ-ACK information to the second HARQ-ACK information for multiplexing in PUCCH
        transmission occasion \( i(g) \)
    else
        append the second HARQ-ACK information to the first HARQ-ACK information for multiplexing in PUCCH
        transmission occasion \( i(g) \)
    end if
end if
```


The UE appends the HARQ-ACK information corresponding to SPS PDSCH receptions, if any, as described in clause 9.1.3.1, after the first and second, if any, HARQ-ACK information.

If the HARQ-ACK information is multiplexed in a PUSCH transmission, the HARQ-ACK information is determined as
- for multiplexing in PUCCH transmission occasion \( i(g) \), if the PUSCH transmission is not scheduled by a DCI format or is scheduled by a DCI format that does not include a DCI field with value \( V_{\mathrm{DAI}}^{\mathrm{UL}} \)
- for multiplexing in PUCCH transmission occasion \( i(g) \), if the PUSCH transmission is scheduled by a DCI format without ul-TotalDAI-Included configured except that for PDSCH group \( g \), the DCI field with value \( V_{\mathrm{DAI}}^{\mathrm{UL}} \) in the DCI format is used after the completion of the \( c \) and \( m \) loops for the pseudo-code for the HARQ-ACK codebook generation in clause 9.1.3.1, and when the HARQ-ACK information multiplexed in the PUCCH transmission occasion \( i(g) \) does not include HARQ-ACK information for PDSCH group \( (g+1) \bmod 2 \)
- for multiplexing in PUCCH transmission occasion \( i(g) \), if the PUSCH transmission is scheduled by a DCI format without \( u \)-TotalDAI-Included configured except that for PDSCH group \( g=0 \), the DCI field with value \( V_{\mathrm{DAI}}^{\mathrm{UL}} \) in the DCI format is used after the completion of the \( c \) and \( m \) loops for the pseudo-code for the HARQACK codebook generation in clause 9.1.3.1, and when the HARQ-ACK information multiplexed in the PUCCH transmission occasion \( i(g) \) includes HARQ-ACK information for PDSCH groups \( g \) and \( (g+1) \bmod 2 \)
- for multiplexing in PUCCH transmission occasion \( i(g) \), if the PUSCH transmission is scheduled by a DCI format without \( u \)-TotalDAI-Included configured except that for PDSCH group \( g=0 \), the DCI field with value \( V_{\mathrm{DA}}^{\mathrm{LL}} \) in the DCI format is used after the completion of the \( c \) and \( m \) loops for the pseudo-code for the HARQACK codebook generation in clause 9.1.3.1, and when the UE has not detected any DCI format scheduling PDSCH receptions, and the UE has not detected any DCI format with a request for HARQ-ACK information for any PDSCH group
- for multiplexing in PUCCH transmission occasion \( i(g) \), if the PUSCH transmission is scheduled by a DCI format with \( u \) l-TotalDAI-Included configured except that MSBs of the DCI field with value \( V_{\mathrm{DAI}}^{\mathrm{UL}} \) in the DCI format are used for PDSCH group \( g=0 \), and LSBs of DCI field with value \( V_{\mathrm{DAI}}^{\mathrm{UL}} \) in the DCI format are used for PDSCH group \( g=1 \), after the completion of the \( c \) and \( m \) loops for the pseudo-code for the HARQ-ACK codebook generation in clause 9.1.3.1.

If a UE is scheduled a PUSCH transmission by DCI format 01 having a DAI field value \( V_{\mathrm{DAI}}^{\mathrm{UL}}=4 \) for a PDSCH group index, and the UE has not detected any DCI format scheduling PDSCH receptions for the PDSCH group index, and the UE has not detected any DCI format with a request for HARQ-ACK information for the PDSCH group index, the UE does not multiplex HARQ-ACK information in the PUSCH transmission for the PDSCH group index.

If a UE detects DCI formats with respective PDSCH-to-HARQ_feedback timing field values indicating a same PUCCH transmission occasion and none of the DCI formats that the UE detects after a last PUCCH transmission occasion for \( g=0 \) includes a New feedback indicator field for \( g=0 \), and at least one of the DCI formats is DCI format \( 1 \_0 \), the UE generates HARQ-ACK information only for PDSCH receptions scheduled by detections of DCI format \( 1 \_0 \) and SPS PDSCH releases indicated by detections of DCI format 1.0 , as described in clause 9.1.3.1 or 9.1.3.2 for multiplexing in the PUCCH transmission occasion.

If a DCI format indicating a slot for a PUCCH transmission occasion does not include a New feedback indicator field, a PDSCH reception scheduled by the DCI format or a SPS PDSCH release indicated by the DCI format is associated with

ETSI


--- Page 97  ---


3GPP TS 38.213 version 17.1.0 Release 17
96
ETSI TS 138213 V17.1.0 (2022-05)

PDSCH group 0 and a value of \( h(g) \) associated with the DCI format is set only if \( h(g) \) is provided by another DCI format that provides a value of \( h(g) \) for PDSCH group 0 and indicates the slot for the PUCCH transmission occasion.

For PUCCH transmission occasion \( i(g) \), the UE determines a PUCCH or a PUSCH transmission to multiplex the HARQ-ACK information according to the procedures in clauses 9.2.3 and 9.2.5.

If \( O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}} \leq 11 \), the UE determines a number of HARQ-ACK information bits \( n_{\mathrm{HARQ}-\mathrm{ACK}, g} \) for group \( g \) and a number of HARQ-ACK information bits \( n_{\text {HARQ-ACK }(g+1) \bmod 2} \) for group \( (g+1) \bmod 2 \) as described in clause 9.1.3.1 where \( N_{\mathrm{SPS}, c} \) is included in \( n_{\mathrm{HARQ}-\mathrm{ACK}, g} \) and, if \( q=1 \) and \( V_{\mathrm{DAI}}^{(g+1) \bmod 2} \neq \emptyset \), the UE determines \( n_{\text {HARQ-ACK }(g+1) \bmod 2} \) by setting \( V_{\text {DAI } \mathrm{m}_{\text {last }}}^{\mathrm{DL}}=V_{D A I}^{(g+1) \bmod 2} \). For obtaining a PUCCH transmission power, if \( q=0 \), \( n_{\text {HARQ-ACK }}=n_{\text {HARQ-ACK }, g} \); else, \( n_{\text {HARQ-ACK }}=n_{\text {HARQ-ACK }, g}+n_{\left.\text {HARQ-ACK }_{( } g+1\right) \bmod 2} \) -
9.1.4 Type-3 HARQ-ACK codebook determination

If a UE is provided pdsch-HARQ-ACK-OneShotFeedback, the UE determines \( \tilde{o}_{0}^{A C K}, \tilde{o}_{1}^{A C K}, \ldots, \tilde{o}_{O_{A C K}-1}^{A C K} \) HARQ-ACK information bits, for a total number of \( O_{A C K} \) HARQ-ACK information bits, of a Type-3 HARQ-ACK codebook according to the following procedure. If the UE is provided pdsch-HARQ-ACK-enhType3List and a DCI format scheduling PDSCH reception and triggering the Type-3 HARQ-ACK codebook includes a Type3-subcodebook-index field that provides a value for \( p d s c h \)-HARQ-ACK-enhType3Index, the UE determines a number of indicated serving cells \( N_{\text {cells }}^{\text {DLind }} \) and a number of indicated HARQ processes \( N_{\text {HARQ, }}^{\text {DLind }} \) for each indicated serving cell \( c \) from the entry in pdsch-HARQ-ACK-enhType3List corresponding to the pdsch-HARQ-ACK-enhType3Index value. If the DCI format does not include the Type3-subcodebook-index field, the pdsch-HARQ-ACK-enhType3Index value is zero.

Set \( N_{\text {cells }}^{\text {DL }} \) to the number of configured serving cells or, when applicable, to \( N_{\text {cells }}^{\text {DL }} \)
Set \( N_{\mathrm{HARQ}, c}^{\mathrm{DL}} \) to the value of nrofHARQ-ProcessesForPDSCH for serving cell \( c \), if provided; else, set \( N_{\mathrm{HARQ}, c}^{\mathrm{DL}}=8 \).
When applicable, set \( N_{\mathrm{HARQ}, c}^{\mathrm{DL}} \) to \( N_{\mathrm{HARQ}, c}^{\mathrm{DL} \text { ind }} \)
Set \( N_{\mathrm{TB}, c}^{\mathrm{DL}} \) to the value of maxNrofCodeWordsScheduledByDCI for serving cell \( c \) if harq-ACK-SpatialBundlingPUCCH is provided and \( N D I_{\text {HARQ }}=0 \), or if harq-ACK-SpatialBundlingPUCCH is not provided, or if maxCodeBlockGroupsPerTransportBlock is provided for serving cell \( c \); else, set \( N_{\mathrm{TB}, c}^{\mathrm{DL}}=1 \)

Set \( N_{\text {HARQ-ACK }} \) CBG/TB, to the number of HARQ-ACK information bits per TB for PDSCH receptions on serving cell \( c \) as described in clause 9.1.1 if maxCodeBlockGroupsPerTransportBlock is provided for serving cell \( c \) and pdsch-HARQ-ACK-OneShotFeedbackCBG or pdsch-HARQ-ACK-enhType3CBG is provided; else, set \( N_{\text {HARQ-ACK }, c}^{\text {CBG/TB }}=0 \)

Set \( N D I_{\mathrm{HARQ}}=0 \) if pdsch-HARQ-ACK-OneShotFeedbackNDI or pdsch-HARQ-ACK-enhType3NDI is provided; else set \( N D I_{\text {HARQ }}=1 \)

Set \( c=0 \)-serving cell index
Set \( h=0- \) HARQ process number
Set \( t=0- \) TB index
Set \( g=0- \) CBG index
Set \( j=0 \)
while \( c<N_{\text {cells }}^{\mathrm{DL}} \)
while \( h<N_{\text {HARQ } c}^{\text {DL }} \)
if HARQ-feedbackEnabling-disablingperHARQprocess is not provided, or is provided and indicates enabled HARQ-ACK information for \( h \), or HARQ-feedbackEnablingforSPSactive is provided and \( h \) corresponds to a transport block in a first SPS PDSCH reception after an activation of SPS PDSCH receptions
if \( N D I_{\mathrm{HARQ}}=0 \)
if \( N_{\mathrm{HARQ}-\mathrm{ACK}_{1} c}^{\mathrm{CBG} / \mathrm{TB}, \max }>0 \)

ETSI


--- Page 98  ---


3GPP TS 38.213 version 17.1.0 Release 17
97
ETSI TS 138213 V17.1.0 (2022-05)
```
        while \( t<N_{\mathrm{TB}, c}^{\mathrm{DL}} \)
            while \( g<N_{\text {HARQ-ACK }, c}^{\mathrm{CBG} / \mathrm{TB}, \max ^{2}} \)
                \( \tilde{o}_{j}^{A C K}= \) HARQ-ACK information bit for CBG \( g \) of TB \( t \) for HARQ process number \( h \) of
                    serving cell \( c \), if any; else, \( \tilde{o}_{j}^{A C K}=0 \)
                \( j=j+1 \)
                \( g=g+1 \)
            end while
        \( \tilde{o}_{j}^{\text {ACK }}= \) NDI value indicated in the DCI format corresponding to the HARQ-ACK information bit(s)
        for TB \( t \) for HARQ process number \( h \) on serving cell \( c \), if any; else, \( \tilde{o}_{j}^{A C K}=0 \)
        \( g=0 \)
        \( j=j+1 \)
        \( t=t+1 \)
        end while
    else
        while \( t<N_{\mathrm{TB}, c}^{\mathrm{DL}} \)
            \( \tilde{o}_{j}^{\text {ACK }}= \) HARQ-ACK information bit for TB \( t \) for HARQ process \( h \) of serving cell \( c \), if any;
            else, \( \tilde{o}_{j}^{\text {ACK }}=0 \)
            \( j=j+1 \)
            \( \tilde{o}_{j}^{\text {ACK }}= \) NDI value indicated in the DCI format corresponding to the HARQ-ACK information
            bit(s) for TB \( t \) for HARQ process number \( h \) on serving cell \( c \), if any; else, \( \tilde{o}_{j}^{A C K}=0 \)
            \( j=j+1 \)
            \( t=t+1 \)
        end while
    end if
    \( t=0 \)
else
    if \( N_{\mathrm{HARQ}-\mathrm{ACK}_{1} c}^{\mathrm{CBG} / \mathrm{TB}, \max _{1}}>0 \)
        while \( t<N_{\mathrm{TB}, c}^{\mathrm{DL}} \)
            if UE has obtained HARQ-ACK information for TB \( t \) for HARQ process number \( h \) on serving
            cell \( c \) corresponding to a PDSCH reception and has not reported the HARQ-ACK information
            corresponding to the PDSCH reception
                while \( g<N_{\text {HARQ-ACK }, c}^{\mathrm{CBG} / \mathrm{TB}, \max } \)
                    \( \tilde{o}_{j}^{A C K}= \) HARQ-ACK information bit for CBG \( g \) of TB \( t \) for HARQ process number \( h \) of
                    serving cell \( c \)
                    \( j=j+1 \)
                    \( g=g+1 \)
```


ETSI


--- Page 99  ---


3GPP TS 38.213 version 17.1.0 Release 17
98
ETSI TS 138213 V17.1.0 (2022-05)
```
                    end while
                else
                    while \( g<N_{\text {HARQ-ACK }, c}^{\text {CBG } / \mathrm{TB}, \text { max }} \)
                        \( \tilde{o}_{j}^{A C K}= \) NACK
                        \( j=j+1 \)
                        \( g=g+1 \)
                    end while
                end if
                \( g=0 \)
                \( t=t+1 \)
            end while
        else
            while \( t<N_{\mathrm{TB}, c}^{\mathrm{DL}} \)
                if UE has obtained HARQ-ACK information for TB \( t \) for HARQ process number \( h \) on serving
                cell \( c \) corresponding to a PDSCH reception and has not reported the HARQ-ACK information
                corresponding to the PDSCH reception
                    if harq-ACK-SpatialBundlingPUCCH is not provided
                    \( \tilde{o}_{j}^{\text {ACK }}= \) HARQ-ACK information bit for TB \( t \) for HARQ process \( h \) of serving cell \( c \)
                    else
                    \( \tilde{\sigma}_{j}^{\text {ACK }}= \) binary AND operation of the HARQ-ACK information bits corresponding to first
                    and second transport blocks for HARQ process \( h \) of serving cell \( c \). If the UE receives one
                    transport block, the UE assumes ACK for the second transport block
                    end if
                    \( j=j+1 \)
                    \( t=t+1 \)
                else
                    \( \tilde{o}_{j}^{\text {ACK }}= \) NACK
                    \( j=j+1 \)
                    \( t=t+1 \)
                end if
            end while
        end if
        \( t=0 \)
    end if
end if
\( h=h+1 \)
```


ETSI


--- Page 100  ---


3GPP TS 38.213 version 17.1.0 Release 17
99
ETSI TS 138213 V17.1.0 (2022-05)

end while
\[
\begin{array}{l}
h=0 \\
c=c+1
\end{array}
\]
end while
If \( N_{\mathrm{TB}, c}^{\mathrm{DL}}>1 \), when a UE receives a PDSCH with one transport block, the HARQ-ACK information is associated with the first transport block.

If a UE receives a SPS PDSCH, or a PDSCH that is scheduled by a DCI format that does not support CBG-based PDSCH receptions for a serving cell \( c \), and if maxCodeBlockGroupsPerTransportBlock is provided for serving cell \( c \), and pdsch-HARQ-ACK-OneShotFeedbackCBG or pdsch-HARQ-ACK-enhType3CBG is provided, the UE repeats \( N_{\text {HARQ-ACK }, c}^{\text {CBG/TB } \text { max }} \) times the HARQ-ACK information for the transport block, if any, in the PDSCH.

If a UE detects a DCI format that includes a One-shot HARQ-ACK request field with value 1 , the UE determines a PUCCH or a PUSCH to multiplex a Type-3 HARQ-ACK codebook for transmission in a slot as described in clauses 9.2.3 and 9.2.5. If the UE is provided a periodic cell switching pattern for PUCCH transmissions by pucchsSCellPattern, the UE determines the slot and a corresponding cell based on the periodic cell switching pattern as described in clause 9. A. The UE multiplexes only the Type-3 HARQ-ACK codebook in the PUCCH or the PUSCH for transmission in the slot.

If
- a UE detects a DCI format that includes a One-shot HARQ-ACK request field with value 1 , and
- the CRC of the DCI is scrambled by a C-RNTI or an MCS-C-RNTI, and
- resourceAllocation \( = \) resourceAllocationType0 and all bits of the frequency domain resource assignment field in the DCI format are equal to 0 , or
- resourceAllocation \( = \) resourceAllocationTypel and all bits of the frequency domain resource assignment field in the DCI format are equal to 1 , or
- resourceAllocation = dynamicSwitch and all bits of the frequency domain resource assignment field in the DCI format are equal to 0 or 1
the DCI format provides a request for a Type-3 HARQ-ACK codebook report and does not schedule a PDSCH reception. If the UE is provided pdsch-HARQ-ACK-enhType3List and the DCI format includes a Type3-subcodebookindex field that provides a value for pdsch-HARQ-ACK-enhType3Index, the UE determines a number of indicated serving cells \( N_{\text {cells }}^{\text {DL ind }} \) and a number of indicated HARQ processes \( N_{\text {HARQ } c}^{\text {DL }} \) for each indicated serving cell \( c \) from the entry in pdsch-HARQ-ACK-enhType3List corresponding to the pdsch-HARQ-ACK-enhType3Index value. If the DCI format does not include the Type3-subcodebook-index field, the pdsch-HARQ-ACK-enhType3Index value is provided by the value of MCS field in the DCI format. The UE is expected to provide HARQ-ACK information in response to the request for the Type-3 HARQ-ACK codebook after \( N \) symbols from the last symbol of a PDCCH providing the DCI format, where the value of \( N \) for \( \mu=0,1,2 \) is provided in clause 10.2 by replacing "SPS PDSCH release" with "DCI format".

If a UE multiplexes HARQ-ACK information in a PUSCH transmission, the UE generates the HARQ-ACK codebook as described in this clause except that harq-ACK-SpatialBundlingPUCCH is replaced by harq-ACKSpatialBundlingPUSCH.
9.1.5 HARQ-ACK codebook retransmission

With reference to slots of PUCCH transmissions on the primary cell and for Type-1 or Type-2 HARQ-ACK codebooks, a UE that transmitted or would transmit a PUCCH or a PUSCH with a first HARQ-ACK codebook in slot \( m \) can be indicated by a DCI format with CRC scrambled by a C-RNTI or a MCS-C-RNTI that does not schedule a PDSCH reception [4, TS 38.212] and is received in a PDCCH ending in slot \( n \), to transmit a PUCCH with the first HARQ-ACK codebook in slot \( n+k \), where slot \( n+k \) is after slot \( m \). The UE determines \( k \) and a resource for the PUCCH transmission as described in clauses 9.23 and 9.2.5. If the UE is provided a periodic cell switching pattern for PUCCH transmissions by pucch-sSCellPattern, the UE further determines a corresponding cell based on the periodic cell switching pattern as described in clause 9.A.

ETSI


--- Page 101  ---


3GPP TS 38.213 version 17.1.0 Release 17
100
ETSI TS 138213 V17.1.0 (2022-05)

If the \( p d s c h-H A R Q-A C K-r e t x \) or \( p d s c h-H A R Q-A C K-r e t x D C I-1-2 \) field value in the DCI format \( 1 \_1 \) or \( 1 \_2 \), respectively, is ' 1 ', the UE determines slot \( m \) as \( m=n-l \) where \( l \) is determined by a one-to-one mapping in ascending order among the values of the MCS field in the DCI format 1_1 or 1_2 and the values from -7 to 24 .

If the DCI format 1_1 or \( 1 \_2 \) includes a priority indicator field having a value, a priority value of first HARQ-ACK information in the first HARQ-ACK codebook is same as the value of the priority indicator field; otherwise, the priority value of the first HARQ-ACK information is zero.

If the UE would also multiplex in the PUCCH transmission in slot \( n+k \) a second HARQ-ACK codebook with second HARQ-ACK information of same priority value as for the first HARQ-ACK information in the first HARQ-ACK codebook, the UE appends the first HARQ-ACK codebook to the second HARQ-ACK codebook. The UE determines to multiplex the second HARQ-ACK information in the PUCCH transmission in slot \( n+k \) as described in clause 9.2.3.

If in slot \( m \) the UE performs a procedure for deferring first HARQ-ACK information for SPS PDSCH receptions, as described in clause 9.2.5.4, and the first HARQ-ACK information has same priority value as a priority value indicated by the DCI format triggering the PUCCH transmission in slot \( n+k \), the UE multiplexes in the PUCCH transmission in slot \( n+k \) second HARQ-ACK information with the priority value that results in slot \( n+k \) according to the procedure in this clause, by appending the first HARQ-ACK information to the second HARQ-ACK information. If the UE would also multiplex in the PUCCH transmission in slot \( n+k \) third HARQ-ACK information with the priority value, the UE appends the second HARQ-ACK information followed by the first HARQ-ACK information to the third HARQ-ACK information. The UE determines to multiplex the third HARQ-ACK information in the PUCCH transmission in slot \( n+ k \) as described in clause 9.2.3.

If in slot \( m \) the UE would transmit a first PUCCH with first HARQ-ACK information over more than one slot and a second PUCCH with second HARQ-ACK information over one or more slots, where the first and second HARQ-ACK information have same priority value, the UE multiplexes in the PUCCH transmission in slot \( n+k \) one of
- the first HARQ-ACK information if the first PUCCH starts at an earlier slot than the second PUCCH, or
- the second HARQ-ACK information if the second PUCCH starts at an earlier slot than the first PUCCH.
9.2 UCI reporting in physical uplink control channel

UCI types reported in a PUCCH include HARQ-ACK information, SR, LRR, and CSI. UCI bits include HARQ-ACK information bits, if any, SR information bits, if any, LRR information bit, if any, and CSI bits, if any. The HARQ-ACK information bits correspond to a HARQ-ACK codebook as described in clause 9.1. For the remaining of this clause, any reference to \( S R \) is applicable for \( S R \) and/or for \( L R R \).

A UE may transmit one or two PUCCHs on a serving cell in different symbols within a slot. When the UE transmits two PUCCHs in a slot and the UE is not provided ackNackFeedbackMode \( = \) separate, at least one of the two PUCCHs uses PUCCH format 0 or PUCCH format 2.

If a UE is provided ackNackFeedbackMode = separate, the UE may transmit up to two PUCCHs with HARQ-ACK information in different symbols within a slot.

In clauses 9.2.3, 9.2.5.1 and 9.2.5.2, a UE assumes 11 CRC bits if a number of respective UCI bits is larger than or equal to 360 ; otherwise, the UE determines a number of CRC bits based on the number of respective UCI bits as described in [5, TS 38.212].
9.2.1 PUCCH Resource Sets

If a UE does not have dedicated PUCCH resource configuration, provided by PUCCH-ResourceSet in PUCCH-Config, a PUCCH resource set is provided by pucch-ResourceCommon through an index to a row of Table 9.2.1-1 for transmission of HARQ-ACK information on PUCCH in an initial UL BWP of \( N_{\text {BWP }}^{\text {size }} \) PRBs. For operation in FR2-2, pucch-ResourceCommon can also provide a number of \( N_{R B} \) RBs for the PUCCH resource set; otherwise \( N_{R B}=1 \).

The PUCCH resource set includes sixteen resources, each corresponding to a PUCCH format, a first symbol, a duration, a PRB offset \( R B_{\mathrm{BWP}}^{\text {offset }} \), and a cyclic shift index set for a PUCCH transmission.

The UE transmits a PUCCH using frequency hopping if not provided uselnterlacePUCCH-PUSCH in BWPUplinkCommon; otherwise, the UE transmits a PUCCH without frequency hopping.

ETSI


--- Page 102  ---


3GPP TS 38.213 version 17.1.0 Release 17
101
ETSI TS 138213 V17.1.0 (2022-05)

An orthogonal cover code with index 0 is used for a PUCCH resource with PUCCH format 1 in Table 9.2.1-1 except when index 3, 7, or 11 is indicated by pucch-ResourceCommon and useInterlacePUCCH-PUSCH in BWPUplinkCommon is provided.

The UE transmits the PUCCH using the same spatial domain transmission filter as for a PUSCH transmission scheduled by a RAR UL grant as described in clause 8.3.

If a UE is not provided any of pdsch-HARQ-ACK-Codebook, pdsch-HARQ-ACK-Codebook-r16, or pdsch-HARQ-ACKOneShotFeedback, the UE generates at most one HARQ-ACK information bit.

If the UE provides HARQ-ACK information in a PUCCH transmission in response to detecting a DCI format scheduling a PDSCH reception or having associated HARQ-ACK information without scheduling a PDSCH reception, the UE determines a PUCCH resource with index \( r_{\text {PUCCH }}, 0 \leq r_{\text {PUCCH }} \leq 15 \), as \( r_{\text {PUCCH }}=\left\lfloor\frac{2 \cdot n_{\text {CCE }, 0}}{N_{\text {CCE }}}\right\rfloor+2 \cdot \Delta_{\text {PRI }} \), where \( N_{\text {CCE }} \) is a number of CCEs in a CORESET of a PDCCH reception with the DCI format, as described in clause 10.1, \( n_{\text {CCE }, 0} \) is the index of a first CCE for the PDCCH reception, and \( \Delta_{\text {PRI }} \) is a value of the PUCCH resource indicator field in the DCI format.

When the PDCCH reception by a UE includes first and second PDCCH candidates from respective first and second search space sets, as described in clause 10.1 , the CORESET and \( n_{\text {CCE }, 0} \) are associated with the search space set having the smaller index. If
- the first search space set has larger index than the second search space set and includes the first PDCCH candidate and a third PDCCH candidate that have same first CCE index and CCE aggregation levels 8 and 16, or 16 and 8, respectively,
- the second search space set includes the second PDCCH candidate that has same index and same CCE aggregation level as the first PDCCH candidate, and a fourth PDCCH candidate that has same index and same CCE aggregation level as the third PDCCH candidate,
- the CORESET associated with the first search space set has cce-REG-MappingType \( = \) 'nonInterleaved' and has duration of one symbol, and
- the second PDCCH candidate has different first CCE index than the fourth PDCCH candidate
the UE determines \( n_{\text {CCE }, 0} \) from the PDCCH candidate with CCE aggregation level 16 among the second PDCCH candidate and the fourth PDCCH candidate.

If \( \left[r_{\text {PUCCH }} / 8\right]=0 \) and a UE is provided a PUCCH resource by pucch-ResourceCommon and is not provided useInterlacePUCCH-PUSCH in BWP-UplinkCommon
- the UE determines the lowest PRB index of the PUCCH transmission in the first hop as \( R B_{\mathrm{BWP}}^{\text {offset }} \cdot N_{R B}+ \left\lfloor r_{\text {PUCCH }} / N_{\mathrm{CS}}\right\rfloor \cdot N_{R B} \) and the lowest PRB index of the PUCCH transmission in the second hop as \( N_{\mathrm{BWP}}^{\text {size }}-R B_{\mathrm{BWP}}^{\text {offset }} \). \( N_{R B}-\left(1+\left\lfloor r_{\text {PUCCH }} / N_{\text {CS }}\right\rfloor\right) \cdot N_{R B} \), where \( N_{\text {CS }} \) is the total number of initial cyclic shift indexes in the set of initial cyclic shift indexes
- the UE determines the initial cyclic shift index in the set of initial cyclic shift indexes as \( r_{\text {PUCCH }} \bmod N_{\text {CS }} \)

If \( \left[r_{\text {PUCCH }} / 8\right]=1 \) and a UE is provided a PUCCH resource by pucch-ResourceCommon and is not provided useInterlacePUCCH-PUSCH in BWP-UplinkCommon
- the UE determines the lowest PRB index of the PUCCH transmission in the first hop as \( N_{\mathrm{BWP}}^{\text {size }}-R B_{\mathrm{BWP}}^{\text {offset }} \cdot N_{R B}- \left(1+\left\lfloor\left(r_{\text {PUCCH }}-8\right) / N_{\text {CS }}\right\rfloor\right) \cdot N_{R B} \) and the lowest PRB index of the PUCCH transmission in the second hop as \( R B_{\text {BWP }}^{\text {offset }} \cdot N_{R B}+\left\lfloor\left(r_{\text {PUCCH }}-8\right) / N_{\text {CS }}\right\rfloor \cdot N_{R B} \)
- the UE determines the initial cyclic shift index in the set of initial cyclic shift indexes as \( \left(r_{\text {PUCCH }}-8\right) \bmod N_{\text {CS }} \)

If a UE is provided a PUCCH resource by pucch-ResourceCommon and is provided useInterlacePUCCH-PUSCH in BWP-UplinkCommon
- the UE determines for the PUCCH resource an interlace index \( m \) as \( m=\left(m_{0}+\left\lfloor r_{\text {PUCCH }} / N_{\text {CS }}\right\rfloor\right) \bmod M \) where \( M \) is a number of interlaces [4, TS 38.211] and \( m_{0}=R B_{\text {BWP }}^{\text {offset }} \) is an interlace index offset and \( R B_{\text {BWP }}^{\text {offset }} \) is as given in Table 9.2.1-1

ETSI


--- Page 103  ---


3GPP TS 38.213 version 17.1.0 Release 17
102
ETSI TS 138213 V17.1.0 (2022-05)
- the UE determines an initial cyclic shift index in a set of initial cyclic shift indexes as \( r_{\text {PUCCH }} \bmod N_{\text {CS }} \), where \( N_{\text {CS }} \) is the total number of initial cyclic shifts indexes in the set of initial cyclic shift indexes in Table 9.2.1-1
- if pucch-ResourceCommon indicates
- index 0: the first symbol is 9 for a PUCCH resource with PUCCH format 0 if \( r_{\text {PUCCH }} \geq 10 \)
- index 1 or 2: the first symbol is 9 for a PUCCH resource with PUCCH format 0 if \( r_{\text {PUCCH }}=15 \)
- index 3,7, or 11: an orthogonal cover code with index 1 is used for a PUCCH resource with PUCCH format 1 if \( r_{\text {PUCCH }} \geq 10 \); otherwise, an orthogonal cover code with index 0 is used for a PUCCH resource with PUCCH format 1
- the UE does not expect pucch-ResourceCommon to indicate index 15

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.2.1-1: PUCCH resource sets before dedicated PUCCH resource configuration}
\begin{tabular}{|l|l|l|l|l|l|}
\hline Index & PUCCH format & First symbol & Number of symbols & PRB offset \( R B_{\mathrm{BWP}}^{\text {offset }} \) & Set of initial CS indexes \\
\hline 0 & 0 & 12 & 2 & 0 & \{0, 3\} \\
\hline 1 & 0 & 12 & 2 & 0 & \{0, 4, 8\} \\
\hline 2 & 0 & 12 & 2 & 3 & \{0, 4, 8\} \\
\hline 3 & 1 & 10 & 4 & 0 & \{0, 6\} \\
\hline 4 & 1 & 10 & 4 & 0 & \{0, 3, 6, 9\} \\
\hline 5 & 1 & 10 & 4 & 2 & \{0, 3, 6, 9\} \\
\hline 6 & 1 & 10 & 4 & 4 & \{0, 3, 6, 9\} \\
\hline 7 & 1 & 4 & 10 & 0 & \{0, 6\} \\
\hline 8 & 1 & 4 & 10 & 0 & \{0, 3, 6, 9\} \\
\hline 9 & 1 & 4 & 10 & 2 & \{0, 3, 6, 9\} \\
\hline 10 & 1 & 4 & 10 & 4 & \{0, 3, 6, 9\} \\
\hline 11 & 1 & 0 & 14 & 0 & \{0, 6\} \\
\hline 12 & 1 & 0 & 14 & 0 & (0, 3, 6, 9) \\
\hline 13 & 1 & 0 & 14 & 2 & \{0, 3, 6, 9\} \\
\hline 14 & 1 & 0 & 14 & 4 & \{0, 3, 6, 9\} \\
\hline 15 & 1 & 0 & 14 & \( N_{\text {BWP }}^{\text {size }} / 4 \) & \{0, 3, 6, 9\} \\
\hline
\end{tabular}
\end{table}

If a UE has dedicated PUCCH resource configuration, the UE is provided by higher layers with one or more PUCCH resources.

A PUCCH resource includes the following parameters:
- a PUCCH resource index provided by pucch-Resourceld
- an index of the first PRB prior to frequency hopping or for no frequency hopping by startingPRB, if a UE is not provided useInterlacePUCCH-PUSCH in BWP-UplinkDedicated
- an index of the first PRB after frequency hopping by secondHopPRB, if a UE is not provided useInterlacePUCCH-PUSCH in BWP-UplinkDedicated
- an indication for intra-slot frequency hopping by intraSlotFrequencyHopping, if a UE is not provided useInterlacePUCCH-PUSCH in BWP-UplinkDedicated
- an index of a first interlace by interlacet, if a UE is provided uselnterlacePUCCH-PUSCH in BWPUplinkDedicated
- if provided, an index of a second interlace by interlacel, if a UE is provided uselnterlacePUCCH-PUSCH in BWP-UplinkDedicated
- an index of an RB set by rb-SetIndex, if a UE is provided useInterlacePUCCH-PUSCH in BWPUplinkDedicated
- a configuration for a PUCCH format provided by format

ETSI


--- Page 104  ---


3GPP TS 38.213 version 17.1.0 Release 17
103
ETSI TS 138213 V17.1.0 (2022-05)

For operation with shared spectrum channel access, the UE does not expect that two hops of a PUCCH transmission are in different RB sets.

The UE expects that uselnterlacePUCCH-PUSCH in BWP-UplinkCommon and uselnterlacePUCCH-PUSCH in BWPUplinkDedicated are provided either in all UL BWPs or in none of the UL BWPs for a serving cell.

If a UE is provided useInterlacePUCCH-PUSCH in BWP-UplinkDedicated, the UE determines available RBs for PUCCH transmissions within the active UL BWP as the intersection of RBs corresponding to an interlace index provided by interlace0 and, if provided, interlacel, and RBs of an RB set provided by rb-SetIndex. The intersection results in \( M_{\text {interlace }, 0}^{\text {PUCCH }} \) RBs in the first interlace and the UE expects that \( M_{\text {interlace }, 0}^{\text {PUCCH }} \) is either 10 or 11 . If interlacel is provided, the intersection results in \( M_{\text {interlace, } 1}^{\text {PUCCH }} \) RBs in the second interlace and the UE expects that \( M_{\text {interlace, } 1}^{\text {PUCCH }} \) is either 10 or 11.

If the format indicates PUCCH-format0, the PUCCH format configured for a PUCCH resource is PUCCH format 0 , where the PUCCH resource also includes an index for an initial cyclic shift provided by initialCyclicShift, a number of symbols for a PUCCH transmission provided by nrofSymbols, a first symbol for the PUCCH transmission provided by startingSymbollndex. For PUCCH transmission in FR2-2, the PUCCH resource can also include a number of PRBs \( M_{\mathrm{RB}}^{\mathrm{PUCCH}, 0} \) provided by nrofPRBs; otherwise, \( M_{\mathrm{RB}}^{\mathrm{PUCCH}, 0}=1 \).

If the format indicates PUCCH-formatl, the PUCCH format configured for a PUCCH resource is PUCCH format 1, where the PUCCH resource also includes an index for an initial cyclic shift provided by initialCyclicShift, a number of symbols for a PUCCH transmission provided by nrofSymbols, a first symbol for the PUCCH transmission provided by startingSymbollndex, and an index for an orthogonal cover code by timeDomainOCC. For PUCCH transmission in FR2-2, the PUCCH resource can also include a number of PRBs \( M_{\mathrm{RB}}^{\mathrm{PUCCH}, 1} \) provided by nrofPRBs; otherwise, \( M_{\mathrm{RB}}^{\mathrm{PUCCH}, 1}=1 \).

If the format indicates PUCCH-format2 or PUCCH-format3, the PUCCH format configured for a PUCCH resource is PUCCH format 2 or PUCCH format 3, respectively, where the PUCCH resource also includes a number of PRBs provided by nrofPRBs, a number of symbols for a PUCCH transmission provided by nrofSymbols, and a first symbol for the PUCCH transmission provided by startingSymbollndex. If a UE is provided by uselnterlacePUCCH-PUSCH in BWP-UplinkDedicated, and the format indicates PUCCH-format2 or PUCCH-format3 and PUCCH-ResourceExt is provided, the PUCCH resource also includes an index of a second interlace by interlacel, if provided; otherwise, if interlacel is not provided, the PUCCH resource also includes, if provided, an orthogonal cover code length by occLength and an orthogonal cover code index by occ-Index. If the format indicates PUCCH-format 3 and PUCCHResourceExt is provided, the UE assumes that the \( M_{\mathrm{RB}}^{\text {PUCCH,3 }} \) [4, TS38.211] PRBs with the lowest indexes within the first, and if configured, second interlace are used for PUCCH transmission.

If the format indicates PUCCH-format4, the PUCCH format configured for a PUCCH resource is PUCCH format 4, where the PUCCH resource also includes a number of symbols for a PUCCH transmission provided by noffymbols, an orthogonal cover code length by occ-Length, an orthogonal cover code index by occ-Index, and a first symbol for the PUCCH transmission provided by startingSymbollndex. For PUCCH transmission in FR2-2, the PUCCH resource can also include a number of \( \mathrm{PRBs} M_{\mathrm{RB}}^{\mathrm{PUCCH}, 4} \) provided by nrofPRBs; otherwise, \( M_{\mathrm{RB}}^{\mathrm{PUCCH}, 4}=1 \).

If a UE is provided subslotLengthForPUCCH in a PUCCH-Config, the first symbol of a PUCCH resource provided by PUCCH-ResourceSet or SPS-PUCCH-AN-List in PUCCH-Config or by \( n I P U C C H \)-AN in SPS-Config for multiplexing HARQ-ACK in a PUCCH transmission is relative to the first symbol of the subslotLengthForPUCCH symbols [12, TS 38.331]. For the remaining cases, the first symbol of a PUCCH resource is relative to the first symbol of a slot with \( N_{\text {sym }}^{\text {slot }} \) symbols [4, TS 38.211].

A UE can be configured up to four sets of PUCCH resources in a PUCCH-Config. A PUCCH resource set is provided by PUCCH-ResourceSet and is associated with a PUCCH resource set index provided by pucch-ResourceSetld, with a set of PUCCH resource indexes provided by resourceList that provides a set of pucch-Resourceld used in the PUCCH resource set, and with a maximum number of UCI information bits the UE can transmit using a PUCCH resource in the PUCCH resource set provided by maxPayloadSize. For the first PUCCH resource set, the maximum number of UCI information bits is 2 . A maximum number of PUCCH resource indexes for a set of PUCCH resources is provided by maxNrofPUCCH-ResourcesPerSet. The maximum number of PUCCH resources in the first PUCCH resource set is 32 and the maximum number of PUCCH resources in the other PUCCH resource sets is 8 .

If the UE transmits \( O_{\mathrm{UCl}} \mathrm{UCI} \) information bits, that include HARQ-ACK information bits, the UE determines a PUCCH resource set to be

ETSI


--- Page 105  ---


3GPP TS 38.213 version 17.1.0 Release 17
104
ETSI TS 138213 V17.1.0 (2022-05)
- a first set of PUCCH resources with pucch-ResourceSetld \( =0 \) if \( O_{\mathrm{UCl}} \leq 2 \) including 1 or 2 HARQ-ACK information bits and a positive or negative SR on one SR transmission occasion if transmission of HARQ-ACK information and SR occurs simultaneously, or
- a second set of PUCCH resources with pucch-ResourceSetld \( =1 \), if provided by higher layers, if \( 2<O_{\mathrm{UCl}} \leq N_{2} \) where \( \mathrm{N}_{2} \) is equal to maxPayloadSize if maxPayloadSize is provided for the PUCCH resource set with pucchResourceSetId \( =1 \); otherwise \( N_{2} \) is equal to 1706 , or
- a third set of PUCCH resources with pucch-ResourceSetld \( =2 \), if provided by higher layers, if \( N_{2}<O_{\mathrm{UCl}} \leq N_{3} \) where \( \mathrm{N}_{3} \) is equal to maxPayloadSize if maxPayloadSize is provided for the PUCCH resource set with pucchResourceSetId \( =2 \); otherwise \( N_{3} \) is equal to 1706 , or
- a fourth set of PUCCH resources with pucch-ResourceSetld \( =3 \), if provided by higher layers, if \( N_{3}<O_{\mathrm{UCl}} \leq \) 1706.

If the UE is provided SPS-PUCCH-AN-List and transmits \( O_{\mathrm{UCl}} \mathrm{UCI} \) information bits that include only HARQ-ACK information bits in response to one or more SPS PDSCH receptions and SR, if any, the UE determines a PUCCH resource to be
- a PUCCH resource provided by sps-PUCCH-AN-ResourceID obtained from the first entry in sps-PUCCH-ANList if \( O_{\text {UCI }} \leq 2 \) including 1 or 2 HARQ-ACK information bits and a positive or negative SR on one SR transmission occasion if transmission of HARQ-ACK information and SR occurs simultaneously, or
- a PUCCH resource provided by sps-PUCCH-AN-ResourceID obtained from the second entry in sps-PUCCH\( A N \)-List, if provided, if \( 2<O_{\text {UCI }} \leq N_{1, S P S} \) where \( N_{1, S P S} \) is either provided by maxPayloadSize obtained from the second entry in sps-PUCCH-AN-List or is otherwise equal to 1706 , or
- a PUCCH resource provided by sps-PUCCH-AN-ResourceID obtained from the third entry in sps-PUCCH-ANList, if provided, if \( N_{1, S P S}<O_{\mathrm{UCl}} \leq N_{2, S P S} \) where \( N_{2, S P S} \) is either provided by maxPayloadSize obtained from the third entry in sps-PUCCH-AN-List or is otherwise equal to 1706, or
- a PUCCH resource provided by sps-PUCCH-AN-ResourceID obtained from the fourth entry in sps-PUCCH-ANList, if provided, if \( N_{2, S P S}<O_{\mathrm{UCl}} \leq N_{3, S P S} \) where \( N_{3, S P S} \) is equal to 1706 .
9.2.2 PUCCH Formats for UCI transmission

If a UE is not transmitting PUSCH, and the UE is transmitting UCI, the UE transmits UCI in a PUCCH using
- PUCCH format 0 if
- the transmission is over 1 symbol or 2 symbols,
- the number of HARQ-ACK information bits with positive or negative SR (HARQ-ACK/SR bits) is 1 or 2
- PUCCH format 1 if
- the transmission is over 4 or more symbols,
- the number of HARQ-ACK/SR bits is 1 or 2
- PUCCH format 2 if
- the transmission is over 1 symbol or 2 symbols,
- the number of UCI bits is more than 2
- PUCCH format 3 if
- the transmission is over 4 or more symbols,
- the number of UCI bits is more than 2,
- the PUCCH resource does not include an orthogonal cover code, or the UE is provided useInterlacePUCCHPUSCH in BWP-UplinkDedicated

ETSI


--- Page 106  ---


3GPP TS 38.213 version 17.1.0 Release 17
105
ETSI TS 138213 V17.1.0 (2022-05)
- PUCCH format 4 if
- the transmission is over 4 or more symbols,
- the number of UCI bits is more than 2,
- the PUCCH resource includes an orthogonal cover code and the UE is not provided uselnterlacePUCCHPUSCH in BWP-UplinkDedicated

A spatial setting for a PUCCH transmission by a UE is provided by
- an indicated DLorJoint-TCIState or UL-TCIstate, if provided, as described in [6, TS 38.214];
- PUCCH-SpatialRelationInfo if the UE is configured with a single value for pucch-SpatialRelationInfold;
- as described in [11, TS 38.321], if the UE is provided multiple values for PUCCH-SpatialRelationInfo. The UE applies corresponding actions in [11, TS 38.321] and a corresponding setting for a spatial domain filter to transmit PUCCH in the first slot that is after slot \( k+3 \cdot N_{\text {slot }}^{\text {subfame }, \mu} \) where \( k \) is the slot where the UE would transmit a PUCCH with HARQ-ACK information with ACK value corresponding to a PDSCH reception providing the PUCCH-SpatialRelationInfo, each slot consists of \( N_{\text {symb }}^{\text {slot }} \) symbols as defined in [4, TS 38.211], and \( \mu \) is the SCS configuration for the PUCCH
- If PUCCH-SpatialRelationInfo or the indicated UL-TCIstate provides ssb-Index, the UE transmits the PUCCH using a same spatial domain filter as for a reception of a SS/PBCH block with index provided by ssb-Index for a same serving cell or, if servingCellld is provided, for a serving cell indicated by servingCellld
- else if PUCCH-SpatialRelationInfo or the indicated UL-TCIstate provides csi-RS-Index, or the indicated DLorJoint-TCIState provides csi-rs configured with qcl-Type set to 'typeD', the UE transmits the PUCCH using a same spatial domain filter as for a reception of a CSI-RS with resource index provided by csi-RSIndex or csi-rs for a same serving cell or, if servingCellld or cell is provided, for a serving cell indicated by servingCellld or cell
- else PUCCH-SpatialRelationInfo or the indicated UL-TCIstate provides srs, the UE transmits the PUCCH using a same spatial domain filter as for a transmission of a SRS with resource index provided by resource for a same serving cell and/or active UL BWP or, if servingCellld and/or uplinkBWP are provided, for a serving cell indicated by servingCellld and/or for an UL BWP indicated by uplinkBWP

If a UE
- is not provided pathlossReferenceRSs in PUCCH-PowerControl,
- is provided enableDefaultBeamPL-ForPUCCH, and
- is not provided PUCCH-SpatialRelationInfo, and
- is not provided coresetPoollndex value of 1 for any CORESET, or is provided coresetPoollndex value of 1 for all CORESETs, in ControlResourceSet and no codepoint of a TCI field, if any, in a DCI format of any search space set maps to two TCI states [5, TS 38.212]
a spatial setting for a PUCCH transmission from the UE is same as a spatial setting for PDCCH receptions by the UE in the CORESET with the lowest ID on the active DL BWP of the PCell and, if the CORESET has two activated TCI states as described in clause 10.1, the UE determines the spatial setting for the PUCCH transmission based on the first TCI state. For a PUCCH transmission over multiple slots, a same spatial setting applies to the PUCCH transmission in each of the multiple slots.

A number of DMRS symbols for a PUCCH transmission using PUCCH format 3 or 4 is provided by additionalDMRS.
Use of \( \pi / 2 \)-BPSK, instead of QPSK, for a PUCCH transmission using PUCCH format 3 or 4 is indicated by pi2BPSK.
9.2.3 UE procedure for reporting HARQ-ACK

In this clause, for the purpose of determining a PUCCH resource for a PUCCH transmission in a slot using a PUCCH resource indicator field in a DCI format that schedules a PDSCH reception, and for the purpose of determining the slot for the PUCCH transmission, a UE is assumed to generate HARQ-ACK information regardless of whether or not the

ETSI


--- Page 107  ---


3GPP TS 38.213 version 17.1.0 Release 17
106
ETSI TS 138213 V17.1.0 (2022-05)

PDSCH reception provides a transport block for a HARQ process with disabled HARQ-ACK information as indicated by HARQ-feedbackEnabling-disablingperHARQprocess, if provided. The UE determines a number of HARQ-ACK information bits \( O_{\mathrm{ACK}} \) as described in clauses 9.1 through 9.1.5 and a corresponding set of PUCCH resources as described in clause 9.2.1.

A UE does not expect to transmit more than one PUCCH with HARQ-ACK information in a slot per priority index, if the UE is not provided ackNackFeedbackMode = separate.

For DCI format 1_0, the PDSCH-to-HARQ_feedback timing indicator field values map to \( \{1,2,3,4,5,6,7,8\} \) for SCS configuration of PUCCH transmission \( \mu \leq 3 \), to \( \{7,8,12,16,20,24,28,32\} \) for \( \mu=5 \), and to \( \{13,16,24,32,40 \), 48, 56, 64\} for \( \mu=6 \). For a unicast DCI format, other than DCI format \( 1 \_0 \) or requesting Type-3 HARQ-ACK codebook report without scheduling a PDSCH reception as described in clause 9.1.4, the PDSCH-to-HARQ_feedback timing indicator field values, if present, map to values for a set of number of slots provided by \( d l \)-DataToUL-ACK, \( d l \) -DataToUL-ACK-r16, or dl-DataToUL-ACK-DCI-1-2, or dl-DataToUL-ACK-r17 as defined in Table 9.2.3-1. If the DCI format indicates a cell for the PUCCH transmission, as described in clause 9-A, the PDSCH-to-HARQ_feedback timing indicator field value maps to slots of the active UL BWP of the cell; otherwise, the PDSCH-to-HARQ_feedback timing indicator field value maps to slots of the active UL BWP of the PCell. For DCI format 4_1, the PDSCH-toHARQ_feedback timing indicator field values are provided by dl-DataToUL-ACK-MulticastDciFormat4_l or, if dl-DataToUL-ACK-MulticastDciFormat4_ 1 is not provided, by \( \{1,2,3,4,5,6,7,8\} \). For DCI format \( 4 \_2 \), the PDSCH-to-HARQ_feedback timing indicator field values are provided by dl-DataToUL-ACK from pucchConfigurationListMulticast I or pucch-ConfigurationListMulticast2.

If the UE is provided subslotLengthForPUCCH, \( n \) is the last UL slot for PUCCH transmission that overlaps with a PDSCH reception or with a PDCCH reception providing a DCI format having associated HARQ-ACK information without scheduling a PDSCH reception; otherwise, \( n \) is the last UL slot for PUCCH transmission that overlaps with the DL slot \( n_{D} \) for the PDSCH reception or with the DL slot \( n_{D} \) for the PDCCH reception in case of a DCI format that triggers a HARQ-ACK information report and does not schedule a PDSCH reception.

For a SPS PDSCH reception ending in DL slot \( n_{D} \), the UE transmits the PUCCH in UL slot \( n+k \) where \( n \) is the last UL slot for PUCCH transmission that overlaps with slot \( n_{D} \) and \( k \) is provided by the PDSCH-to-HARQ_feedback timing indicator field, if present, in a DCI format activating the SPS PDSCH reception.

If the UE detects a DCI format that does not include a PDSCH-to-HARQ_feedback timing indicator field and schedules a PDSCH reception or activates a SPS PDSCH reception ending in DL slot \( n_{D} \), the UE provides corresponding HARQACK information in a PUCCH transmission within UL slot \( n+k \) where \( n \) is the last UL slot for PUCCH transmission that overlaps with slot \( n_{D} \) and \( k \) is provided by dl-DataToUL-ACK, or dl-DataToUL-ACK-rl6, or dl-DataToUL-ACK-DCI-1-2, or dl-DataToUL-ACK-r17, or dl-DataToUL-ACK-MulticastDciFormat4_1.

If the UE detects a DCI format scheduling a number of PDSCH receptions ending in DL slot \( n_{D} \) or if the UE detects a DCI format generating a HARQ-ACK information bit and does not schedule a PDSCH reception through a PDCCH reception ending in DL slot \( n_{D} \), the UE provides corresponding HARQ-ACK information in a PUCCH transmission within UL slot \( n+k \), where \( n \) is the last UL slot for PUCCH transmission that overlaps with slot \( n_{D} \) and \( k \) is a number of slots and is indicated by the PDSCH-to-HARQ_feedback timing indicator field in the DCI format, if present, or provided by dl-DataToUL-ACK, dl-DataToUL-ACK-r16, or dl-DataToUL-ACK-DCI-1-2, or dl-DataToUL-ACK-r17, or dl-DataToUL-ACK-MulticastDciFormat4_1.

A PUCCH transmission with HARQ-ACK information is subject to the limitations for UE transmissions described in clause 11.1 and clause 11.1.1.

ETSI


--- Page 108  ---


3GPP TS 38.213 version 17.1.0 Release 17
107
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.2.3-1: Mapping of PDSCH-to-HARQ_feedback timing indicator field values to numbers of slots}
\begin{tabular}{|l|l|l|l|}
\hline \multicolumn{3}{|l|}{PDSCH-to-HARQ feedback timing indicator} & Number of slots \( \boldsymbol{k} \) \\
\hline 1 bit & 2 bits & 3 bits & \\
\hline \( 0^{\prime} \) & '00' & '000' & \( 1^{\text {st }} \) value provided by dl-DataToUL-ACK, dl-DataToUL-ACK-r16, dl-DataToUL-ACK-DCl-1-2, or dl-DataToUL-ACK-r17, or dl-DataToUL-ACK-MulticastDciFormat4 1 \\
\hline '1' & '01' & '001' & \( 2^{\text {nd }} \) value provided by dl-DataToUL-ACK, dl-DataToUL-ACK-r16, dl-DataToUL-ACK-DCI-1-2, or dl-DataToUL-ACK-r17, or dl-DataToUL-ACK-MulticastDciFormat4 1 \\
\hline & '10' & '010' & \( 3^{\text {rd }} \) value provided by dl-DataToUL-ACK, dl-DataToUL-ACK-r16, dl-DataToUL-ACK-DCI-1-2, or dl-DataToUL-ACK-r17, or dl-DataToUL-ACK-MulticastDciFormat4 1 \\
\hline & '11' & '011' & \( 4^{\text {th }} \) value provided by dl-DataToUL-ACK, dl-DataToUL-ACK-r16, dl-DataToUL-ACK-DCI-1-2, or dl-DataToUL-ACK-r17, dl-DataToUL-ACK-MulticastDciFormat4 1 \\
\hline & & '100' & \( 5^{\text {th }} \) value provided by dl-DataToUL-ACK, dl-DataToUL-ACK-r16, dl-DataToUL-ACK-DCI-1-2, or dl-DataToUL-ACK-r17, or dl-DataToUL-ACK-MulticastDciFormat4 1 \\
\hline & & '101' & \( 6{ }^{\text {th }} \) value provided by dl-DataToUL-ACK, dl-DataToUL-ACK-r16, dl-DataToUL-ACK-DCl-1-2, or dl-DataToUL-ACK-r17, or dl-DataToUL-ACK-MulticastDciFormat4 1 \\
\hline & & '110' & \( 7^{\text {th }} \) value provided by dl-DataToUL-ACK, dl-DataToUL-ACK-r16, dl-DataToUL-ACK-DCI-1-2, or dl-DataToUL-ACK-r17, or dl-DataToUL-ACK-MulticastDciFormat4 1 \\
\hline & & '111' & \( 8^{\text {th }} \) value provided by dl-DataToUL-ACK, dl-DataToUL-ACK-r16, dl-DataToUL-ACK-DCI-1-2, or dl-DataToUL-ACK-r17, or dl-DataToUL-ACK-MulticastDciFormat4_1 \\
\hline
\end{tabular}
\end{table}

For a PUCCH transmission with HARQ-ACK information, a UE determines a PUCCH resource on the cell of the PUCCH transmission, as described in clause 9-A, after determining a set of PUCCH resources for \( O_{\text {UCI }} \) HARQ-ACK information bits, as described in clause 9.2.1. The PUCCH resource determination is based on a PUCCH resource indicator field [5, TS 38.212], if present, in a last DCI format, excluding the SPS activation DCI, among the DCI formats that have a value of a PDSCH-to-HARQ_feedback timing indicator field, if present, or a value of dl-DataToUL-ACK, or dl-DataToUL-ACK-r16, or dl-DataToUL-ACK-DCI-1-2, or dl-DataToUL-ACK-r17, or dl-DataToUL-ACK-MulticastDciFormat4_1, indicating a same slot for the PUCCH transmission, that the UE detects and for which the UE transmits corresponding HARQ-ACK information in the PUCCH. For PUCCH resource determination, detected DCI formats are first indexed in an ascending order across serving cells indexes for a same PDCCH monitoring occasion and are then indexed in an ascending order across PDCCH monitoring occasion indexes. For indexing DCI formats within a serving cell for a same PDCCH monitoring occasion, if the UE is not provided coresetPoollndex or is provided coresetPoollndex with value 0 for one or more first CORESETs and is provided coresetPoollndex with value 1 for one or more second CORESETs on an active DL BWP of a serving cell, and with ackNackFeedbackMode = joint for the active UL BWP, detected DCI formats from PDCCH receptions in the first CORESETs are indexed prior to detected DCI formats from PDCCH receptions in the second CORESETs.

The PUCCH resource indicator field values map to values of a set of PUCCH resource indexes, as defined in Table 9.2.3-2 for a PUCCH resource indicator field of 3 bits, provided by resourceList for PUCCH resources from a set of PUCCH resources provided by PUCCH-ResourceSet with a maximum of eight PUCCH resources. If the PUCCH resource indicator field includes 1 bit or 2 bits, the values map to the first two values or the first four values, respectively, of Table 9.2.3-2. If the last DCI format does not include a PUCCH resource indicator field, the first value of Table 9.2.3-2 is used.

For the first set of PUCCH resources and when the size \( R_{\text {PUCCH }} \) of resourceList is larger than eight, when a UE provides HARQ-ACK information in a PUCCH transmission in response to detecting a last DCI format in a PDCCH reception, among DCI formats with a value of the PDSCH-to-HARQ_feedback timing indicator field, if present, or a value of dl-DataToUL-ACK, or dl-DataToUL-ACK-r16, or dl-DataToUL-ACK-DCI-1-2, or dl-DataToUL-ACK-r17, or dl-DataToUL-ACK-MulticastDciFormat4_1, indicating a same slot for the PUCCH transmission, the UE determines a PUCCH resource with index \( r_{\text {PUCCH }}, 0 \leq r_{\text {PUCCH }} \leq R_{\text {PUCCH }}-1 \), as

ETSI


--- Page 109  ---


3GPP TS 38.213 version 17.1.0 Release 17
108
ETSI TS 138213 V17.1.0 (2022-05)
\[
r_{\text {PUCCH }}=\left\{\begin{array}{l}
\left\lfloor\frac{n_{\text {CCE }, p} \cdot\left[R_{\text {PUCCH }} / 8\right]}{N_{\text {CCE }, p}}\right\rfloor+\Delta_{\text {PRI }} \cdot\left\lceil\frac{R_{\text {PUCCH }}}{8}\right\rceil \quad \text { if } \quad \Delta_{\text {PRI }}<R_{\text {PUCCH }} \bmod 8 \\
\left\lfloor\frac{n_{\text {CCE }, p} \cdot\left\lfloor R_{\text {PUCCH }} / 8\right\rfloor}{N_{\text {CCE }, p}}\right\rfloor+\Delta_{\text {PRI }} \cdot\left\lfloor\frac{R_{\text {PUCCH }}}{8}\right\rfloor+R_{\text {PUCCH }} \bmod 8 \quad \text { if } \quad \Delta_{\text {PRI }} \geq R_{\text {PUCCH }} \bmod 8
\end{array}\right\}
\]
where \( N_{\text {CCE } p} \) is a number of CCEs in CORESET \( p \) of the PDCCH reception for the DCI format as described in clause 10.1, \( n_{\text {CCE }, p} \) is the index of a first CCE for the PDCCH reception, and \( \Delta_{\text {PRI }} \) is a value of the PUCCH resource indicator field in the DCI format. When the PDCCH reception includes first and second PDCCH candidates from respective first and second search space sets, as described in clause 10.1, the CORESET is associated with the search space set having the smaller index. If
- the first search space set has larger index than the second search space set and includes the first PDCCH candidate and a third PDCCH candidate that have same first CCE index and CCE aggregation levels 8 and 16, or 16 and 8, respectively,
- the second search space set includes the second PDCCH candidate that has same index and same CCE aggregation level as the first PDCCH candidate, and a fourth PDCCH candidate that has same index and same CCE aggregation level as the third PDCCH candidate,
- the CORESET associated with the first search space set has cce-REG-MappingType \( = \) 'nonInterleaved' and has duration of one symbol, and
- the second PDCCH candidate has different first CCE index than the fourth PDCCH candidate
the UE determines \( n_{\text {CCE }, 0} \) from the PDCCH candidate with CCE aggregation level 16 among the second PDCCH candidate and the fourth PDCCH candidate.

If the DCI format does not include a PUCCH resource indicator field, \( \Delta_{\mathrm{PRI}}=0 \).

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.2.3-2: Mapping of PUCCH resource indication field values to a PUCCH resource in a PUCCH resource set with maximum 8 PUCCH resources}
\begin{tabular}{|l|l|l|l|}
\hline \multicolumn{3}{|c|}{PUCCH resource indicator} & PUCCH resource \\
\hline 1 bit & 2 bits & 3 bits & \\
\hline '0' & '00' & '000' & \( 1^{\text {st }} \) PUCCH resource provided by pucch-Resourceld obtained from the \( 1^{\text {st }} \) value of resourceList \\
\hline '1' & '01' & '001' & \( 2^{\text {nd }} \) PUCCH resource provided by pucch-Resourceld obtained from the \( 2^{\text {nd }} \) value of resourceList \\
\hline & '10' & '010' & \( 3{ }^{\text {rd }} \) PUCCH resource provided by pucch-Resourceld obtained from the \( 3{ }^{\text {rd }} \) value of resourceList \\
\hline & '11' & '011' & \( 4{ }^{\text {th }} \) PUCCH resource provided by pucch-Resourceld obtained from the \( 4^{\text {th }} \) value of resourceList \\
\hline & & '100' & \( 5{ }^{\text {th }} \) PUCCH resource provided by pucch-Resourceld obtained from the \( 5^{\text {th }} \) value of resourceList \\
\hline & & '101' & \( 6{ }^{\text {th }} \) PUCCH resource provided by pucch-Resourceld obtained from the \( 6{ }^{\text {th }} \) value of resourceList \\
\hline & & '110' & \( 7^{\text {th }} \) PUCCH resource provided by pucch-Resourceld obtained from the \( 7^{\text {th }} \) value of resourceList \\
\hline & & '111' & \( 8^{\text {th }} \) PUCCH resource provided by pucch-Resourceld obtained from the \( 8{ }^{\text {th }} \) value of resourceList \\
\hline
\end{tabular}
\end{table}

If a UE determines a first resource for a PUCCH transmission with HARQ-ACK information corresponding only to a PDSCH reception without a corresponding PDCCH or detects a first DCI format indicating a first resource for a PUCCH transmission with corresponding HARQ-ACK information in a slot and also detects at a later time a second DCI format indicating a second resource for a PUCCH transmission with corresponding HARQ-ACK information in the slot, the UE does not expect to multiplex HARQ-ACK information corresponding to the second DCI format in a PUCCH resource in the slot if the PDCCH reception that includes the second DCI format is not earlier than \( N_{3} \). \( (2048+144) \cdot \kappa \cdot 2^{-\mu} \cdot T_{c} \) from the beginning of a first symbol of the first resource for PUCCH transmission in the slot where, \( \kappa \) and \( T_{c} \) are defined in clause 4.1 of [4, TS 38.211] and \( \mu \) corresponds to the smallest SCS configuration among the SCS configurations of the PDCCHs providing the DCI formats and the SCS configuration of the PUCCH. If

ETSI


--- Page 110  ---


3GPP TS 38.213 version 17.1.0 Release 17
109
ETSI TS 138213 V17.1.0 (2022-05)

processingType2Enabled of PDSCH-ServingCellConfig is set to enable for the serving cell with the second DCI format and for all serving cells with corresponding HARQ-ACK information multiplexed in the PUCCH transmission in the slot, \( N_{3}=3 \) for \( \mu=0, N_{3}=4.5 \) for \( \mu=1, N_{3}=9 \) for \( \mu=2 \); otherwise, \( N_{3}=8 \) for \( \mu=0, N_{3}=10 \) for \( \mu=1, N_{3}= \) 17 for \( \mu=2, N_{3}=20 \) for \( \mu=3, N_{3}=80 \) for \( \mu=5 \), and \( N_{3}=160 \) for \( \mu=6 \).

If a UE is not provided SPS-PUCCH-AN-List and transmits HARQ-ACK information corresponding only to a PDSCH reception without a corresponding PDCCH, which includes the first SPS PDSCH reception associated with the corresponding activation DCI, a PUCCH resource for corresponding PUCCH transmission with HARQ-ACK information is provided by \( n I P U C C H-A N \).

If a UE transmits a PUCCH with HARQ-ACK information using PUCCH format 0 , the UE determines values \( m_{0} \) and \( m_{\mathrm{CS}} \) for computing a value of cyclic shift \( \alpha \) [4, TS 38.211] where \( m_{0} \) is provided by mittalCyclicShift of PUCCHformat0 or, if initialCyclicShift is not provided, by the initial cyclic shift index as described in clause 9.2.1 and \( m_{\mathrm{CS}} \) is determined from the value of one HARQ-ACK information bit or from the values of two HARQ-ACK information bits as in Table 9.2.3-3 and Table 9.2.3-4, respectively.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.2.3-3: Mapping of values for one HARQ-ACK information bit to sequences for PUCCH format 0}
\begin{tabular}{|c|c|c|}
\hline HARQ-ACK Value & \( \mathbf{0} \) & \( \mathbf{1} \) \\
\hline Sequence cyclic shift & \( m_{C S}=0 \) & \( m_{C S}=6 \) \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.2.3-4: Mapping of values for two HARQ-ACK information bits to sequences for PUCCH format 0}
\begin{tabular}{|c|c|c|c|c|}
\hline HARQ-ACK Value & \( \{\mathbf{0}, \mathbf{0}\} \) & \( \{\mathbf{0}, \mathbf{1}\} \) & \( \{\mathbf{1}, \mathbf{1}\} \) & \( \{\mathbf{1}, \mathbf{0}\} \) \\
\hline Sequence cyclic shift & \( m_{C S}=0 \) & \( m_{C S}=3 \) & \( m_{C S}=6 \) & \( m_{C S}=9 \) \\
\hline
\end{tabular}
\end{table}

If a UE transmits a PUCCH with HARQ-ACK information using PUCCH format 1 , the UE is provided a value for \( m_{0} \) by initialCyclicShift of PUCCH-formatl or, if mittalCyclicShift is not provided, by the initial cyclic shift index as described in clause 9.2.1.

If a UE transmits a PUCCH with \( O_{\mathrm{ACK}} \) HARQ-ACK information bits and \( O_{\mathrm{CRC}} \) bits using PUCCH format 2 or PUCCH format 3 in a PUCCH resource that includes \( M_{\mathrm{RB}}^{\mathrm{PUCCH}} \) PRBs, the UE determines a number of PRBs \( M_{\mathrm{RB}, \mathrm{min}}^{\mathrm{PUCH}} \) for the PUCCH transmission to be the minimum number of PRBs, that is smaller than or equal to a number of PRBs \( M_{\mathrm{RB}}^{\mathrm{PUCCH}} \) provided respectively by nrofPRBs of PUCCH-format 2 or nrofPRBs of PUCCH-format 3 and start from the first PRB from the number of PRBs, that results to \( \left(O_{\mathrm{ACK}}+O_{\mathrm{CRC}}\right) \leq M_{\mathrm{RB}, \mathrm{m} \text { in }}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sc}, \mathrm{crl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \) and, if \( M_{\mathrm{RB}}^{\mathrm{PUCCH}}>1 \), \( \left(O_{\mathrm{ACK}}+O_{\mathrm{CRC}}\right)>\left(M_{\mathrm{RB}, \mathrm{min}}^{\mathrm{PUCH}}-1\right) \cdot N_{\mathrm{sc}, \mathrm{ctrl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCH}} \cdot Q_{m} \cdot r \), where \( N_{\mathrm{sc}, \mathrm{ctrl}}^{\mathrm{RB}}, N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCC}}, Q_{m} \), and \( r \) are defined in clause 9.2.5.2. For PUCCH format 3, if \( M_{\mathrm{RB} \text { min }}^{\mathrm{PUCCH}} \) is not equal \( 2^{\alpha_{2}} \cdot 3^{\alpha_{3}} \cdot 5^{\alpha_{5}} \) according to [4, TS 38.211], \( M_{\mathrm{RB} \text { min }}^{\mathrm{PUCCH}} \) is increased to the nearest allowed value of \( \operatorname{nrof} P R B s[12, \mathrm{TS} 38.331] \). If \( \left(O_{\mathrm{ACK}}+O_{\mathrm{CRC}}\right)>\left(M_{\mathrm{RB}}^{\mathrm{PUCCH}}-1\right) \cdot N_{\mathrm{sc}, \mathrm{ctrl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \). \( r \), the UE transmits the PUCCH over \( M_{\mathrm{RB}}^{\mathrm{PUCCH}} \) PRBs.

If a UE is provided a first interlace of \( M_{\text {Interlace }, 0}^{\text {PUCC }} \) PRBs by interlacet in InterlaceAllocation and transmits a PUCCH with \( O_{\text {ACK }} \) HARQ-ACK information bits and \( O_{\text {CRC }} \) bits using PUCCH format 2 or PUCCH format 3 , the UE transmits the PUCCH over the first interlace if \( \left(O_{\mathrm{ACK}}+O_{\mathrm{CRC}}\right) \leq M_{\mathrm{Interlace}, 0}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sc}, \mathrm{crl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \); otherwise, if the UE is provided a second interlace by interlacel in PUCCH-format2 or PUCCH-format3, the UE transmits the PUCCH over the first and second interlaces.
9.2.4 UE procedure for reporting SR

A UE can be configured by SchedulingRequestResourceConfig a set of configurations for SR in a PUCCH transmission using either PUCCH format 0 or PUCCH format 1 .

A UE can be configured by schedulingRequestID-BFR-SCell a configuration for LRR in a PUCCH transmission using either PUCCH format 0 or PUCCH format 1.

ETSI


--- Page 111  ---


3GPP TS 38.213 version 17.1.0 Release 17
110
ETSI TS 138213 V17.1.0 (2022-05)

A UE can be configured by schedulingRequestIDForMTRPBFR a first configuration for LRR and, if the UE provides twoLRRcapability, a second configuration for LRR in a PUCCH transmission using either PUCCH format 0 or PUCCH format 1 .

A UE can be configured by schedulingRequestID-LBT-SCell a configuration for consistent LBT failure recovery, as described in [11, TS 38.321], in a PUCCH transmission using either PUCCH format 0 or PUCCH format 1. The UE can be provided, by phy-PriorityIndex in SchedulingRequestResourceConfig, a priority index 0 or a priority index 1 for the SR. If the UE is not provided a priority index for SR, the priority index is 0 .

The UE is also configured a periodicity \( S R_{\text {PERIODICITY }} \) in symbols or slots and an offset \( S R_{\text {OFFSET }} \) in slots by periodicityAndOffset for a PUCCH transmission conveying SR. If \( S R_{\text {PERIODICITY }} \) is larger than one slot, the UE determines a SR transmission occasion in a PUCCH to be in a slot with number \( n_{s_{1} f}^{\mu}[4 \), TS 38.211] in a frame with number \( n_{f} \) if \( \left(n_{f} \cdot N_{\text {slot }}^{\text {frame }, \mu}+n_{s_{f} f}^{\mu}-S R_{\text {OFFSET }}\right) \bmod S R_{\text {PERIODICITY }}=0 \).

If \( S R_{\text {PERIODICITY }} \) is one slot, the UE expects that \( S R_{\text {OFFSET }}=0 \) and every slot is a SR transmission occasion in a PUCCH.

If \( S R_{\text {PERIODICITY }} \) is smaller than one slot, the UE determines a SR transmission occasion in a PUCCH to start in a symbol with index \( l[4, \mathrm{TS} 38.211] \) if \( \left(l-l_{0} \bmod S R_{\text {PERIODICITY }}\right) \bmod S R_{\text {PERIODICITY }}=0 \) where \( l_{0} \) is the value of startingSymbollndex.

If the UE determines that, for a SR transmission occasion in a PUCCH, the number of symbols available for the PUCCH transmission in a slot is smaller than the value provided by nrofSymbols, the UE does not transmit the PUCCH in the slot.

SR transmission occasions in a PUCCH are subject to the limitations for UE transmissions described in clause 11.1 and clause 11.1.1.

The UE transmits a PUCCH in the PUCCH resource for the corresponding SR configuration only when the UE transmits a positive SR. For a positive SR transmission using PUCCH format 0 , the UE transmits the PUCCH as described in [4, TS 38.211] by obtaining \( m_{0} \) as described for HARQ-ACK information in clause 9.2.3 and by setting \( m_{\mathrm{cs}}=0 \). For a positive SR transmission using PUCCH format 1 , the UE transmits the PUCCH as described in [4, TS 38.211] by setting \( b(0)=0 \).
9.2.5 UE procedure for reporting multiple UCI types

This clause is applicable to the case that a UE has resources for PUCCH transmissions or for PUCCH and PUSCH transmissions that overlap in time and each PUCCH transmission is over a single slot without repetitions. Any case that a PUCCH transmission is with repetitions over multiple slots is described in clause 9.2.6. If a UE is configured with multiple PUCCH resources in a slot to transmit CSI reports
- if the UE is not provided multi-CSI-PUCCH-ResourceList or if PUCCH resources for transmissions of CSI reports do not overlap in the slot, the UE determines a first resource corresponding to a CSI report with the highest priority [6, TS 38.214]
- if the first resource includes PUCCH format 2, and if there are remaining resources in the slot that do not overlap with the first resource, the UE determines a CSI report with the highest priority, among the CSI reports with corresponding resources from the remaining resources, and a corresponding second resource as an additional resource for CSI reporting
- if the first resource includes PUCCH format 3 or PUCCH format 4, and if there are remaining resources in the slot that include PUCCH format 2 and do not overlap with the first resource, the UE determines a CSI report with the highest priority, among the CSI reports with corresponding resources from the remaining resources, and a corresponding second resource as an additional resource for CSI reporting
- if the UE is provided multi-CSI-PUCCH-ResourceList and if any of the multiple PUCCH resources overlap, the UE multiplexes all CSI reports in a resource from the resources provided by multi-CSI-PUCCH-ResourceList, as described in clause 9.2.5.2.

A UE multiplexes DL HARQ-ACK information, with or without SR, and CSI report(s) in a same PUCCH if the UE is provided simultaneousHARQ-ACK-CSI; otherwise, the UE drops the CSI report(s) and includes only DL HARQ-ACK information, with or without SR, in the PUCCH. If the UE would transmit multiple PUCCHs in a slot that include DL

ETSI


--- Page 112  ---


3GPP TS 38.213 version 17.1.0 Release 17
111
ETSI TS 138213 V17.1.0 (2022-05)

HARQ-ACK information and CSI report(s), the UE expects to be provided a same configuration for simultaneousHARQ-ACK-CSI each of PUCCH formats 2, 3, and 4.

If a UE would multiplex CSI reports that include Part 2 CSI reports in a PUCCH resource, the UE determines the PUCCH resource and a number of PRBs for the PUCCH resource or a number of Part 2 CSI reports assuming that each of the CSI reports indicates rank 1 .

If a UE would transmit multiple overlapping PUCCHs in a slot or overlapping PUCCH(s) and PUSCH(s) in a slot and, when applicable as described in clauses 9.2.5.1 and 9.2.5.2, the UE is configured to multiplex different UCI types in one PUCCH, and at least one of the multiple overlapping PUCCHs or PUSCHs is in response to a DCI format detection by the UE, the UE multiplexes all corresponding UCI types if the following conditions are met. If one of the PUCCH transmissions or PUSCH transmissions is in response to a DCI format detection by the UE, the UE expects that the first symbol \( S_{0} \) of the earliest PUCCH or PUSCH, among a group overlapping PUCCHs and PUSCHs in the slot, satisfies the following timeline conditions
- \( S_{0} \) is not before a symbol with CP starting after \( T_{\text {proc }, 1}^{\text {mux }} \) after a last symbol of any corresponding PDSCH, \( T_{\text {proc }, 1}^{\text {mux }} \) is given by maximum of \( \left\{T_{p r o c, 1}^{m u x, 1}, \cdots, T_{p r o c, 1}^{m u x, i}, \cdots\right\} \) where for the \( i \)-th PDSCH with corresponding HARQ-ACK transmission on a PUCCH which is in the group of overlapping PUCCHs and PUSCHs, \( T_{p r o c, 1}^{m u x, i}= \left(N_{1}+d_{1,1}+1\right) \cdot(2048+144) \cdot \kappa \cdot 2^{-\mu} \cdot T_{C}, d_{1,1} \) is selected for the \( i \)-th PDSCH following [6, TS 38.214], \( N_{1} \) is selected based on the UE PDSCH processing capability of the \( i \)-th PDSCH and SCS configuration \( \mu \), where \( \mu \) corresponds to the smallest SCS configuration among the SCS configurations used for the PDCCH scheduling the \( i \)-th PDSCH, the \( i \)-th PDSCH, the PUCCH with corresponding HARQ-ACK transmission for the \( i \)-th PDSCH, and all PUSCHs in the group of overlapping PUCCHs and PUSCHs.
- \( S_{0} \) is not before a symbol with CP starting after \( T_{\text {proc, release }}^{\text {mux }} \) after a last symbol of a PDCCH reception providing a DCI format having associated HARQ-ACK information without scheduling a PDSCH reception. \( T_{p r o c, r e l e a s e}^{m u x} \) is given by maximum of \( \left\{T_{\text {proc,release }}^{\text {mux } 1}, \cdots, T_{\text {proc,release }}^{\text {mux, } 1} \cdots\right\} \) where for the \( i \)-th PDCCH providing the DCI format with corresponding HARQ-ACK transmission on a PUCCH which is in the group of overlapping PUCCHs and PUSCHs, \( T_{\text {proc,release }}^{\text {mux, }}=(N+1) \cdot(2048+144) \cdot \kappa \cdot 2^{-\mu} \cdot T_{C}, N \) as described in clause 10.2, where \( \mu \) corresponds to the smallest SCS configuration among the SCS configurations used for the PDCCH, the PUCCH with corresponding HARQ-ACK information, and all PUSCHs in the group of overlapping PUCCHs and PUSCHs.
- if there is no aperiodic CSI report multiplexed in a PUSCH in the group of overlapping PUCCHs and PUSCHs, \( S_{0} \) is not before a symbol with CP starting after \( T_{p r o c, 2}^{\operatorname{mux}} \) after a last symbol of
- any PDCCH with the DCI format scheduling an overlapping PUSCH, and
- any PDCCH providing a DCI format with corresponding HARQ-ACK information in an overlapping PUCCH in the slot

If there is at least one PUSCH in the group of overlapping PUCCHs and PUSCHs, \( T_{\text {proc }, 2}^{\text {mux }} \) is given by maximum of \( \left\{T_{\text {proc }, 2}^{\text {mux }, 1}, \cdots, T_{\text {proc }, 2}^{\text {mux },} \cdots\right\} \) where for the i -th PUSCH which is in the group of overlapping PUCCHs and PUSCHs, \( T_{p r o c, 2}^{m u x, i}=\max \left(\left(N_{2}+d_{2,1}+1\right) \cdot(2048+144) \cdot \kappa \cdot 2^{-\mu} \cdot T_{C}+T_{\text {switch }}, d_{2,2}\right), d_{2,1}, d_{2,2} \) and \( T_{\text {switch }} \) are selected for the \( i \)-th PUSCH following [6, TS 38.214], \( N_{2} \) is selected based on the UE PUSCH processing capability of the \( i \)-th PUSCH and SCS configuration \( \mu \), where \( \mu \) corresponds to the smallest SCS configuration among the SCS configurations used for the PDCCH scheduling the \( i \)-th PUSCH, the PDCCHs scheduling the PDSCHs, or providing the DCI formats without scheduling PDSCHs, with corresponding HARQ-ACK information on a PUCCH which is in the group of overlapping PUCCHs/PUSCHs, and all PUSCHs in the group of overlapping PUCCHs and PUSCHs.

If there is no PUSCH in the group of overlapping PUCCHs and PUSCHs, \( T_{\text {proc }, 2}^{\text {mux }} \) is given by maximum of \( \left\{T_{\text {proc }, 2}^{m u x, 1}, \cdots, T_{\text {proc }, 2}^{m u x, i}, \cdots\right\} \) where for the \( i \)-th PDSCH, or the \( i \)-th PDCCH providing a DCI format without scheduling PDSCH, with corresponding HARQ-ACK information on a PUCCH which is in the group of overlapping PUCCHs, \( T_{\text {proc }, 2}^{\text {mux }, i}=\left(N_{2}+1\right) \cdot(2048+144) \cdot \kappa \cdot 2^{-\mu} \cdot T_{C}, N_{2} \) is selected based on the UE PUSCH processing capability of the PUCCH serving cell if configured. \( N_{2} \) is selected based on the UE PUSCH processing capability 1, if PUSCH processing capability is not configured for the PUCCH serving cell. \( \mu \) is selected based on the smallest SCS configuration between the SCS configuration used for the PDCCH

ETSI


--- Page 113  ---


3GPP TS 38.213 version 17.1.0 Release 17
112
ETSI TS 138213 V17.1.0 (2022-05)

scheduling the \( i \)-th PDSCH , or providing the \( i \)-th DCI format without scheduling PDSCH , with corresponding HARQ-ACK information on a PUCCH which is in the group of overlapping PUCCHs, and the SCS configuration for the PUCCH serving cell.
- if there is an aperiodic CSI report multiplexed in a PUSCH in the group of overlapping PUCCHs and PUSCHs, \( S_{0} \) is not before a symbol with CP starting after \( T_{\text {proc }, C S I}^{\text {mux }}=\max \left((Z+d) \cdot(2048+144) \cdot \kappa \cdot 2^{-\mu} \cdot T_{C}+\right. \left.T_{\text {switch }}, d_{2,2}\right) \) after a last symbol of
- any PDCCH with the DCI format scheduling an overlapping PUSCH, and
- any PDCCH scheduling a PDSCH, or providing a DCI format, with corresponding HARQ-ACK information in an overlapping PUCCH in the slot
where \( \mu \) corresponds to the smallest SCS configuration among the SCS configuration of the PDCCHs, the smallest SCS configuration for the group of the overlapping PUSCHs, and the smallest SCS configuration of CSI-RS associated with the DCI format scheduling the PUSCH with the multiplexed aperiodic CSI report, and \( d=2 \) for \( \mu=0,1, d=3 \) for \( \mu=2 \), and \( d=4 \) for \( \mu=3 . T_{\text {sw itch }} \) is defined in [6, TS 38.214] and it is applied only if \( Z_{1} \) of Table 5.4-1 in [6, TS 38.214] is applied to the determination of \( Z \).
- \( \quad N_{1}, N_{2}, d_{1,1}, d_{2,1}, d_{2,2} \), and \( Z \) are defined in [6, TS 38.214] and \( \kappa \) and \( T_{C} \) are defined in [4, TS 38.211].

If a UE would transmit multiple overlapping PUCCHs in a slot or overlapping PUCCH(s) and PUSCH(s) in a slot, one of the PUCCHs includes HARQ-ACK information in response to an SPS PDSCH reception, and any PUSCH is not in response to a DCI format detection, the UE expects that the first symbol \( S_{0} \) of the earliest PUCCH or PUSCH satisfies the first of the previous timeline conditions with the exception that components associated to a SCS configuration for a PDCCH scheduling a PDSCH or a PUSCH are absent from the timeline conditions.

A UE does not expect a PUCCH or a PUSCH that is in response to a DCI format detection to overlap with any other PUCCH or PUSCH that does not satisfy the above timing conditions.

A UE that
- is not provided coresetPoollndex or is provided coresetPoollndex with a value of 0 for first CORESETs on active DL BWPs of serving cells, and
- is provided coresetPoollndex with a value of 1 for second CORESETs on active DL BWPs of the serving cells, and
- is provided ackNackFeedbackMode \( = \) separate
does not expect a PUCCH or a PUSCH transmission triggered by a detection of a DCI format in a PDCCH received in a CORESET from the first CORESETs to overlap in time with a PUCCH or a PUSCH transmission triggered by a detection of a DCI format in a PDCCH received in a CORESET from the second CORESETs.

If there is one or more aperiodic CSI reports multiplexed on a PUSCH in the group of overlapping PUCCHs and PUSCHs and if symbol \( S_{0} \) is before symbol \( Z_{\text {ref }}^{\text {m }} \) that is a next uplink symbol with CP starting after \( Z_{\text {proc, } \mathrm{CSI}}^{\text {mux }}= \left(Z^{\prime}+d\right) \cdot(2048+144) \cdot \kappa \cdot 2^{-\mu} \cdot T_{C} \) after the end of the last symbol of
- the last symbol of aperiodic CSI-RS resource for channel measurements, and
- the last symbol of aperiodic CSI-IM used for interference measurements, and
- the last symbol of aperiodic NZP CSI-RS for interference measurements, when aperiodic CSI-RS is used for channel measurement for triggered CSI report \( n \)
the UE is not required to update the CSI report for the triggered CSI report \( n . Z^{\prime} \) is defined in \( [6, \operatorname{TS} 38.214] \) and \( \mu \) corresponds to the smallest SCS configuration among the SCS configurations of the PDCCHs scheduling the PUSCHs, the smallest SCS configuration of aperiodic CSI-RSs associated with DCI formats provided by the PDCCHs triggering the aperiodic CSI reports, and the smallest SCS configuration of the overlapping PUCCHs and PUSCHs and \( d=2 \) for \( \mu=0,1, d=3 \) for \( \mu=2 \), and \( d=4 \) for \( \mu=3 \).

If a UE would transmit multiple PUCCHs in a slot that include HARQ-ACK information, and/or SR, and/or CSI reports and any PUCCH with HARQ-ACK information in the slot satisfies the above timing conditions and does not overlap with any other PUCCH or PUSCH in the slot that does not satisfy the above timing conditions, the UE multiplexes the

ETSI


--- Page 114  ---


3GPP TS 38.213 version 17.1.0 Release 17
113
ETSI TS 138213 V17.1.0 (2022-05)

HARQ-ACK information, and/or SR, and/or CSI reports and determines corresponding PUCCH(s) for transmission in the slot according to the following pseudo-code. If the multiple PUCCHs do not include HARQ-ACK information and do not overlap with any PUSCH transmission by the UE in response to a DCI format detection by the UE, the timing conditions do not apply.

If
- a UE is not provided multi-CSI-PUCCH-ResourceList, and
- a resource for a PUCCH transmission with HARQ-ACK information in response to SPS PDSCH reception and/or a resource for a PUCCH associated with a SR occasion overlap in time with two resources for respective PUCCH transmissions with two CSI reports, and
- there is no resource for a PUCCH transmission with HARQ-ACK information in response to a DCI format detection that overlaps in time with any of the previous resources, and
- the following pseudo code results to the UE attempting to determine a single PUCCH resource from the HARQACK and/or the SR resource and the two PUCCH resources with CSI reports
the UE
- multiplexes the HARQ-ACK information and/or the SR in the resource for the PUCCH transmission with the CSI report having the higher priority, and
- does not transmit the PUCCH with the CSI report having the lower priority

Set \( Q \) to the set of resources for transmission of corresponding PUCCHs in a single slot without repetitions where
- a resource with earlier first symbol is placed before a resource with later first symbol
- for two resources with same first symbol, the resource with longer duration is placed before the resource with shorter duration
- for two resources with same first symbol and same duration, the placement is arbitrary
- the above three steps for the set \( Q \) are according to a subsequent pseudo-code for a function order \( (Q) \)
- a resource for negative SR transmission that does not overlap with a resource for HARQ-ACK or CSI transmission is excluded from set \( Q \)
- if the UE is not provided simultaneousHARQ-ACK-CSI and resources for transmission of HARQ-ACK information include PUCCH format 0 or PUCCH format 2, resources that include PUCCH format 2, or PUCCH format 3, or PUCCH format 4 for transmission of CSI reports are excluded from the set \( Q \) if they overlap with any resource from the resources for transmission of HARQ-ACK information
- if the UE is not provided simultaneousHARQ-ACK-CSI and at least one of the resources for transmission of HARQ-ACK information includes PUCCH format 1, PUCCH format 3, or PUCCH format 4
- resources that include PUCCH format 3 or PUCCH format 4 for transmission of CSI reports are excluded from the set \( Q \)
- resources that include PUCCH format 2 for transmission of CSI reports are excluded from the set \( Q \) if they overlap with any resource from the resources for transmission of HARQ-ACK information

Set \( C(Q) \) to the cardinality of \( Q \)
Set \( Q(j, 0) \) to be the first symbol of resource \( Q(j) \) in the slot
Set \( L(Q(j)) \) to be the number of symbols of resource \( Q(j) \) in the slot
Set \( j=0 \) - index of first resource in set \( Q \)
Set \( o=0 \) - counter of overlapped resources
while \( j \leq C(Q)-1 \)
if

ETSI


--- Page 115  ---


3GPP TS 38.213 version 17.1.0 Release 17
114
ETSI TS 138213 V17.1.0 (2022-05)

\( j<C(Q)-1 \) and resource \( Q(j-o) \) overlaps with resource \( Q(j+1) \) and the resources in set \( Q \) are of same priority index, or
\( j<C(Q)-1 \) and resource \( Q(j-o) \) overlaps with resource \( Q(j+1), o=0 \), the resources in set \( Q \) are of different priority indexes, and the UE is provided UCI-MuxWithDifferentPriority
then
\( o=o+1 ; \)
\( j=j+1 ; \)
else
if \( o>0 \)
determine a single resource for multiplexing UCl associated with resources \( \{Q(j-o), Q(j-o+ 1), \ldots, Q(j)\} \) as described in clauses \( 9,9.2 .5 .0,9.2 .5 .1,9.2 .5 .2 \), and 9.2.5.3
set the index of the single resource to \( j \)
\[
Q=Q \backslash\{Q(j-o), Q(j-o+1), \ldots, Q(j-1)\}
\]
\( j=0 \% \) start from the beginning after reordering unmerged resources at next step
\( o=0 \);
order \( (Q) \% \) function that re-orders resources in current set \( Q \)
Set \( C(Q) \) to the cardinality of \( Q \)
else
\( j=j+1 ; \)
end if
end if
end while
The function order \( (Q) \) performs the following pseudo-code
\( \{ \)
\( k=0 ; \)
while \( k<\mathscr{C}(Q)-1 \% \) the next two while loops are to re-order the unmerged resources
\( l=0 ; \)
while \( k<\mathscr{C}(Q)-1-k \)
if \( Q(l, 0)>Q(l+1,0) \) OR \( (Q(l, 0)=Q(l+1,0) \& L(Q(l))<L(Q(l+1))) \)
temp \( =Q(l) ; \)
\( Q(l)=Q(l+1) ; \)
\( Q(l+1)= \) temp;
end if
\( l=l+1 ; \)
end while
\( k=k+1 \);

ETSI


--- Page 116  ---


3GPP TS 38.213 version 17.1.0 Release 17
115
ETSI TS 138213 V17.1.0 (2022-05)

end while
\}
For each PUCCH resource in the set \( Q \) that satisfies the aforementioned timing conditions, when applicable,
- the UE transmits a PUCCH using the PUCCH resource if the PUCCH resource does not overlap in time with a PUSCH transmission after multiplexing UCI following the procedures described in clauses 9.2.5.1 and 9.2.5.2
- the UE multiplexes HARQ-ACK information and/or CSI reports in a PUSCH if the PUCCH resource overlaps in time with a PUSCH transmission, as described in clause 9.3, and does not transmit SR. In case the PUCCH resource overlaps in time with multiple PUSCH transmissions, the PUSCH for multiplexing HARQ-ACK information and/or CSI is selected as described in clause 9. If the PUSCH transmission by the UE is not in response to a DCI format detection and the UE multiplexes only CSI reports, the timing conditions are not applicable
- the UE does not expect the resource to overlap with a second resource of a PUCCH transmission over multiple slots if the resource is obtained from a group of resources that do not overlap with the second resource.
clauses 9.2.5.0, 9.2.5.1 and 9.2.5.2 assume the following
- resources for transmissions of UCI types, prior to multiplexing or dropping, overlap in a slot
- multiplexing conditions of corresponding UCI types in a single PUCCH are satisfied, and
- the UE does not transmit any PUSCH time-overlapping with PUCCH in the slot.
9.2.5.0 UE procedure for prioritization between SL HARQ-ACK information in a PUCCH and DL HARQ-ACK or SR or CSI in a PUCCH

The priority value of a PUCCH transmission is as described in clause 16.2.4.3.1.
For prioritization between SL HARQ-ACK information in a first PUCCH and DL HARQ-ACK or SR or CSI in a second PUCCH
- if the second PUCCH has priority index 1 ,
- if sl-PriorityThreshold-UL-URLLC is provided
- the UE transmits the first PUCCH if a smallest priority value of the first PUCCH is smaller than \( s l \) -PriorityThreshold-UL-URLLC; otherwise, the UE transmits the second PUCCH
- else
- the UE transmits the second PUCCH
- else
- the UE transmits the first PUCCH if the smallest priority value of the first PUCCH is smaller than slPriorityThreshold; otherwise, the UE transmits the second PUCCH

When the UE determines to transmit the second PUCCH, the UE determines a single resource for multiplexing UCI in the second PUCCH as described in clauses 9.2.5.1 and 9.2.5.2.
9.2.5.1 UE procedure for multiplexing HARQ-ACK or CSI and SR in a PUCCH

In the following, a UE is configured to transmit \( K \) PUCCHs for respective \( K \) SRs in a slot, as determined by a set of schedulingRequestResourceld, a schedulingRequestResourceld associated with schedulingRequestID-BFR-SCell, and a schedulingRequestResourceld associated with schedulingRequestID-LBT-SCell, with SR transmission occasions that would overlap with a transmission of a PUCCH with HARQ-ACK information from the UE in the slot or with a transmission of a PUCCH with CSI report(s) from the UE in the slot.

If a UE would transmit a PUCCH with positive SR and at most two HARQ-ACK information bits in a resource using PUCCH format 0 , the UE transmits the PUCCH in the resource using PUCCH format 0 in PRB(s) for HARQ-ACK information as described in clause 9.2.3. The UE determines a value of \( m_{0} \) and \( m_{\mathrm{CS}} \) for computing a value of cyclic

ETSI


--- Page 117  ---


3GPP TS 38.213 version 17.1.0 Release 17
116
ETSI TS 138213 V17.1.0 (2022-05)

shift \( \alpha \) [4, TS 38.211] where \( m_{0} \) is provided by initialCyclicShift of PUCCH-format0, and \( m_{\mathrm{CS}} \) is determined from the value of one HARQ-ACK information bit or from the values of two HARQ-ACK information bits as in Table 9.2.5-1 and Table 9.2.5-2, respectively.

If the UE would transmit negative SR and a PUCCH with at most two HARQ-ACK information bits in a resource using PUCCH format 0 , the UE transmits the PUCCH in the resource using PUCCH format 0 for HARQ-ACK information as described in clause 9.2.3.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.2.5-1: Mapping of values for one HARQ-ACK information bit and positive SR to sequences for PUCCH format 0}
\begin{tabular}{|c|c|c|}
\hline HARQ-ACK Value & \( \mathbf{0} \) & \( \mathbf{1} \) \\
\hline Sequence cyclic shift & \( m_{C S}=3 \) & \( m_{C S}=9 \) \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.2.5-2: Mapping of values for two HARQ-ACK information bits and positive SR to sequences for PUCCH format 0}
\begin{tabular}{|c|c|c|c|c|}
\hline HARQ-ACK Value & \( \{\mathbf{0}, \mathbf{0}\} \) & \( \{\mathbf{0}, \mathbf{1}\} \) & \( \{\mathbf{1}, \mathbf{1}\} \) & \( \{\mathbf{1}, \mathbf{0}\} \) \\
\hline Sequence cyclic shift & \( m_{C S}=1 \) & \( m_{C S}=4 \) & \( m_{C S}=7 \) & \( m_{C S}=10 \) \\
\hline
\end{tabular}
\end{table}

If a UE would transmit SR in a resource using PUCCH format 0 and HARQ-ACK information bits in a resource using PUCCH format 1 in a slot, the UE transmits only a PUCCH with the HARQ-ACK information bits in the resource using PUCCH format 1.

If the UE would transmit positive SR in a first resource using PUCCH format 1 and at most two HARQ-ACK information bits in a second resource using PUCCH format 1 in a slot, the UE transmits a PUCCH with HARQ-ACK information bits in the first resource using PUCCH format 1 as described in clause 9.2.3. If a UE would not transmit a positive SR in a resource using PUCCH format 1 and would transmit at most two HARQ-ACK information bits in a resource using PUCCH format 1 in a slot, the UE transmits a PUCCH in the resource using PUCCH format 1 for HARQ-ACK information as described in clause 9.2.3.

If a UE would transmit a PUCCH with \( O_{\text {ACK }} \) HARQ-ACK information bits in a resource using PUCCH format 2 or PUCCH format 3 or PUCCH format 4 in a slot, as described in clauses 9.2.1 and 9.2.3, \( \left[\log _{2}(K+1)\right] \) bits representing a negative or positive SR, in ascending order of the values of schedulingRequestResourceld, a schedulingRequestResourceld associated with schedulingRequestID-BFR-SCell, and a schedulingRequestResourceld associated with schedulingRequestID-LBT-SCell, are appended to the HARQ-ACK information bits and the UE transmits the combined \( O_{\mathrm{UCl}}=O_{\mathrm{ACK}}+\left[\log _{2}(K+1)\right] \mathrm{UCI} \) bits in a PUCCH using a resource with PUCCH format 2 or PUCCH format 3 or PUCCH format 4 that the UE determines as described in clauses 9.2.1 and 9.2.3. If one of the SRs is a positive LRR , the value of the \( \left[\log _{2}(K+1)\right] \) bits indicates the positive LRR . An all-zero value for the \( \left\lceil\log _{2}(K+1)\right\rceil \) bits represents a negative SR value across all \( K \) SRs.

If a UE would transmit a PUCCH with \( O_{\mathrm{CSI}} \mathrm{CSI} \) report bits in a resource using PUCCH format 2 or PUCCH format 3 or PUCCH format 4 in a slot, \( \left\lceil\log _{2}(K+1)\right\rceil \) bits representing corresponding negative or positive SR, in ascending order of the values of scheduling RequestResourceld, a schedulingRequestResourceld associated with schedulingRequestID-BFR-SCell, and a schedulingRequestResourceld associated with schedulingRequestID-LBT-SCell, are prepended to the CSI information bits as described in clause 9.2.5.2 and the UE transmits a PUCCH with the combined \( O_{\text {UCI }}= \left[\log _{2}(K+1)\right]+O_{\mathrm{CSI}} \mathrm{UCI} \) bits in a resource using the PUCCH format 2 or PUCCH format 3 or PUCCH format 4 for CSI reporting. If one of the SRs is a positive LRR, the value of the \( \left[\log _{2}(K+1)\right] \) bits indicates the positive LRR. An all-zero value for the \( \left[\log _{2}(K+1)\right] \) bits represents a negative SR value across all \( K \mathrm{SRs} \).

If a UE transmits a PUCCH with \( O_{\mathrm{ACK}} \) HARQ-ACK information bits, \( O_{\mathrm{SR}}=\left\lceil\log _{2}(K+1)\right\rceil \) SR bits, and \( O_{\mathrm{CRC}} \) CRC bits using PUCCH format 2 or PUCCH format 3 in a PUCCH resource that includes \( M_{\mathrm{RB}}^{\mathrm{PUCCH}} \) PRBs, the UE determines a number of PRBs \( M_{\mathrm{RB}, \mathrm{min}}^{\mathrm{PUCCH}} \) for the PUCCH transmission to be the minimum number of PRBs, that is smaller than or equal to a number of PRBs provided by nrofPRBs in PUCCH-format 2 or nrofPRBs in PUCCH-format 3 and starts from the first PRB from the number of PRBs, that results to \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CRC}}\right) \leq M_{\mathrm{RB}, \mathrm{min}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sc}, \mathrm{ctrl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCH}} \cdot Q_{m} \cdot r \) and, if \( M_{\mathrm{RB}}^{\mathrm{PUCCH}}>1,\left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CRC}}\right)>\left(M_{\mathrm{RB}, \mathrm{min}}^{\mathrm{PUCCH}}-1\right) \cdot N_{\mathrm{sc}, \mathrm{crl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \), where \( N_{\mathrm{sc}, \mathrm{ctrl}}^{\mathrm{RB}}, N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCH}}, Q_{m} \), and \( r \) are defined in clause 9.2.5.2. For PUCCH format 3, if \( M_{\mathrm{RB} \text { min }}^{\mathrm{PUCCH}} \) is not equal \( 2^{\alpha_{2}} \cdot 3^{\alpha_{3}} \cdot 5^{\alpha_{5}} \) according to [4, TS 38.211], \( M_{\mathrm{RB}, \mathrm{m} \text { in }}^{\mathrm{PUCCH}} \) is increased to the nearest allowed value of nrofPRBs \( [12, \mathrm{TS} 38.331] \). If \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CRC}}\right)> \left(M_{\mathrm{RB}}^{\mathrm{PUCCH}}-1\right) \cdot N_{\mathrm{sc}, \mathrm{ctrl}}^{\mathrm{RB}} \cdot N_{\text {symb-UCl }}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \), the UE transmits the PUCCH over the \( M_{\mathrm{RB}}^{\mathrm{PUCCH}} \) PRBs.

ETSI


--- Page 118  ---


3GPP TS 38.213 version 17.1.0 Release 17
117
ETSI TS 138213 V17.1.0 (2022-05)

If a UE is provided a first interlace of \( M_{\text {Interlace }, 0}^{\text {PUCCH }} \) PRBs by interlace0 in InterlaceAllocation and transmits a PUCCH with \( O_{\mathrm{ACK}} \) HARQ-ACK information bits, \( O_{\mathrm{SR}}=\left[\log _{2}(K+1)\right] \) SR bits, and \( O_{\mathrm{CRC}} \) CRC bits using PUCCH format 2 or PUCCH format 3, the UE transmits the PUCCH over the first interlace if \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CRC}}\right) \leq M_{\mathrm{Interlace}, 0}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sc}, \mathrm{crrl}}^{\mathrm{RB}} \). \( N_{\text {symb-UCI }}^{\text {PUCCH }} \cdot Q_{m} \cdot r \); otherwise, if the UE is provided a second interlace by interlacel in PUCCH-format2 or PUCCHformat3, the UE transmits the PUCCH over the first and second interlaces.
9.2.5.2 UE procedure for multiplexing HARQ-ACK/SR/CSI in a PUCCH

For a transmission occasion of a single CSI report, a PUCCH resource is provided by pucch-CSI-ResourceList. For a transmission occasion of multiple CSI reports, corresponding PUCCH resources can be provided by multi-CSI-PUCCHResourceList. If a UE is provided first and second PUCCH-Config, multi-CSI-PUCCH-ResourceList is provided by the first PUCCH-Config, and PUCCH-Resourceld in pucch-CSI-ResourceList or multi-CSI-PUCCH-ResourceList indicates a corresponding PUCCH resource in PUCCH-Resource provided by the first PUCCH-Config-

If a UE is provided only one PUCCH resource set for transmission of HARQ-ACK information in response to PDSCH reception scheduled by a DCI format or in response to a DCI format having associated HARQ-ACK information without scheduling PDSCH reception, the UE does not expect to be provided simultaneousHARQ-ACK-CSI.

A UE is configured by maxCodeRate a code rate for multiplexing HARQ-ACK, SR, and CSI report(s) in a PUCCH transmission using PUCCH format 2, PUCCH format 3, or PUCCH format 4.

If a UE transmits CSI reports using PUCCH format 2, the UE transmits only wideband CSI for each CSI report [6, TS 38.214]. In the following, a Part 1 CSI report refers either to a CSI report with only wideband CSI or to a Part 1 CSI report with wideband CSI and sub-band CSI.

Denote as
- \( O_{\text {ACK }} \) a total number of HARQ-ACK information bits, if any
- \( O_{\mathrm{SR}} \) a total number of SR bits. \( O_{\mathrm{SR}}=0 \) if there is no scheduling request bit; otherwise, \( O_{\mathrm{SR}}=\left\lceil\log _{2}(K+1)\right\rceil \) as described in clause 9.2.5.1
- \( O_{\mathrm{CSI}}=\sum_{n=1}^{\text {Natad }}\left(O_{\mathrm{CSI}-\text { partl, } n}+O_{\mathrm{CSI}-\text { parl2, } n}\right) \), where \( O_{\text {CSI-partl, } n \text { is a number of Part } 1 \mathrm{CSI} \text { report bits for CSI report with }} \) priority value \( n, O_{\text {CSI-part } 2, n} \) is a number of Part 2 CSI report bits, if any, for CSI report with priority value \( n \) [6, TS 38.214], and \( N_{\text {CS] }}^{\text {total }} \) is a number of CSI reports that include overlapping CSI reports
- \( O_{\text {CRC }}=O_{\text {CRCCSI-part1 }}+O_{\text {CRCCSI-part2 }} \), where \( O_{\text {CRC,CSI-part1 }} \) is a number of CRC bits, if any, for encoding HARQ\( \mathrm{ACK}, \mathrm{SR} \) and Part 1 CSI report bits and \( O_{\mathrm{CRC}, \mathrm{CSI} \text {-part2 }} \) is a number of CRC bits, if any, for encoding Part 2 CSI report bits

In the following
- \( r \) is a code rate given by maxCodeRate as in Table 9.2.5.2-1.
- \( M_{\mathrm{RB}}^{\mathrm{PUCCH}} \) is a number of PRBs provided by nrof \( P R B s \); otherwise, if nrof \( P R B s \) is not provided, \( M_{\mathrm{RB}}^{\mathrm{PUCCH}}=1 \)
- \( \quad N_{\mathrm{sc}, \mathrm{ctr}}^{\mathrm{RB}}=N_{\mathrm{sc}}^{\mathrm{RB}}-4 \) for PUCCH format 2 or, if the PUCCH resource with PUCCH format 2 includes an orthogonal cover code with length \( N_{\mathrm{SF}}^{\mathrm{PUCCH}, 2} \) provided by occ-Length, \( N_{\mathrm{sc}, \mathrm{crl}}^{\mathrm{RB}}=\left(N_{\mathrm{sc}}^{\mathrm{RB}}-4\right) / N_{\mathrm{SF}}^{\mathrm{PUCC}, 2}, N_{\mathrm{sc}, \mathrm{crl}}^{\mathrm{RB}}=N_{\mathrm{sc}}^{\mathrm{RB}} \) for PUCCH format 3 or, if the PUCCH resource with PUCCH format 3 includes an orthogonal cover code with length \( N_{\mathrm{SF}}^{\mathrm{PUCCH}, 3} \) provided by occ-Length, \( N_{\mathrm{sc}, \text { ctr }}^{\mathrm{RB}}=N_{\mathrm{sc}}^{\mathrm{RB}} / N_{\mathrm{SF}}^{\mathrm{PUCCH}, 3} \), and \( N_{\mathrm{sc}, \text { ctl }}^{\mathrm{RB}}=N_{\mathrm{sc}}^{\mathrm{RB}} / N_{\mathrm{SF}}^{\mathrm{PUCCH}, 4} \) for PUCCH format 4, where \( N_{s c}^{\mathrm{RB}} \) is a number of subcarriers per resource block [4, TS 38.211]
- \( \quad N_{\text {symb }- \text { UCT }}^{\text {PUCC }} \) is equal to a number of PUCCH symbols \( N_{\text {symb }}^{\text {PUCCH, } 2} \) for PUCCH format 2 provided by nrofsymbols in PUCCH-format2. For PUCCH format 3 or for PUCCH format 4, \( N_{\text {symb-UCT }}^{\text {PUCCH }} \) is equal to a number of PUCCH symbols \( N_{\text {symb }}^{\text {PUCC, } 3} \) for PUCCH format 3 or equal to a number of PUCCH symbols \( N_{\text {symb }}^{\text {PUCCH }, 4} \) for PUCCH format

ETSI


--- Page 119  ---


3GPP TS 38.213 version 17.1.0 Release 17
118
ETSI TS 138213 V17.1.0 (2022-05)

4 provided by nrofSymbols in PUCCH-format3 or nrofSymbols in PUCCH-format4, respectively, after excluding a number of symbols used for DM-RS transmission for PUCCH format 3 or for PUCCH format 4, respectively [4, TS 38.211]
- \( Q_{m}=1 \) if pi/2-BPSK is the modulation scheme and \( Q_{m}=2 \) if QPSK is the modulation scheme as indicated by pi2BPSK for PUCCH format 3 or PUCCH format 4. For PUCCH format 2, \( Q_{m}=2 \)

If a UE has one or more CSI reports and zero or more HARQ-ACK/SR information bits to transmit in a PUCCH where the HARQ-ACK, if any, is in response to a PDSCH reception without a corresponding PDCCH
- if any of the CSI reports are overlapping and the UE is provided by multi-CSI-PUCCH-ResourceList with \( J \leq 2 \) PUCCH resources in a slot, for PUCCH format 2 and/or PUCCH format 3 and/or PUCCH format 4, as described in clause 9.2.1, where the resources are indexed according to an ascending order for the product of a number of corresponding REs, modulation order \( Q_{m} \), and configured code rate \( r \);
- if \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}}+O_{\mathrm{CRC}}\right) \leq\left(M_{\mathrm{RB}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{SC}, \mathrm{Ctrl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r\right)_{0} \), the UE uses PUCCH format 2 resource 0 , or the PUCCH format 3 resource 0 , or the PUCCH format 4 resource 0
- else if \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CS} 1}+O_{\mathrm{CRC}}\right)>\left(M_{\mathrm{RB}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sc}, \mathrm{ctr} \mid}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{uCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r\right)_{j} \) and \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CS} 1}+O_{\mathrm{CRC}}\right) \leq\left(M_{\mathrm{RB}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sc}, \mathrm{ctrl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r\right)_{j+1}, 0 \leq j<J-1 \), the UE transmits a
PUCCH conveying HARQ-ACK information, SR and CSI report(s) in a respective PUCCH where the UE uses the PUCCH format 2 resource \( j+1 \), or the PUCCH format 3 resource \( j+1 \), or the PUCCH format 4 resource \( j+1 \)
- else the UE uses the PUCCH format 2 resource \( J-1 \), or the PUCCH format 3 resource \( J-1 \), or the PUCCH format 4 resource \( J-1 \) and the UE selects \( N_{\mathrm{CS} 1}^{\text {rported }} \) CSI report(s) for transmission together with HARQACK information and SR, when any, in ascending priority value as described in [6, TS 38.214]
- else, the UE transmits the \( O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}}+O_{\mathrm{CRC}} \) bits in a PUCCH resource provided by pucch-CSIResourceList and determined as described in clause 9.2.5

If a UE has HARQ-ACK, SR and wideband or sub-band CSI reports to transmit and the UE determines a PUCCH resource with PUCCH format 2, or the UE has HARQ-ACK, SR and wideband CSI reports [6, TS 38.214] to transmit and the UE determines a PUCCH resource with PUCCH format 3 or PUCCH format 4, where
- the UE determines the PUCCH resource using the PUCCH resource indicator field [5, TS 38.212] in a last of a number of DCI formats with a value of a PDSCH-to-HARQ_feedback timing indicator field, if present, or a value of dl-DataToUL-ACK, or dl-DataToUL-ACK-r16, or dl-DataToUL-ACK-DCI-1-2, indicating a same slot for the PUCCH transmission, from a PUCCH resource set provided to the UE for HARQ-ACK transmission, and
- the UE determines the PUCCH resource set as described in clause 9.2.1 and clause 9.2.3 for \( Q_{\text {UCI }} \mathrm{UCI} \) bits
and
- if \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CST} \text {-part 1 }}+O_{\mathrm{CRC}, \mathrm{CST} \text {-part 1 }}\right) \leq M_{\mathrm{RB}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{SS}, \mathrm{crtl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCT}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \), the UE transmits the HARQ-ACK, SR , and CSI reports bits by selecting the minimum number \( M_{\mathrm{RB}, \mathrm{min}}^{\mathrm{PUCCH}} \) of the \( M_{\mathrm{RB}}^{\mathrm{PUCCH}} \) PRBs satisfying \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CST}-\text { part } 1}+O_{\mathrm{CRC}, \mathrm{CSI}-\text { part } 1}\right) \leq M_{\mathrm{RB}, \text { min }}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sC}, \mathrm{ctr} 1}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCT}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \) as described in clauses 9.2.3 and 9.2.5.1;
- else, the UE selects \( N_{\mathrm{CS} 1}^{\text {reported }} \mathrm{CSI} \) report(s), from the \( N_{\mathrm{CS} 1}^{\text {btal }} \mathrm{CSI} \) reports, for transmission together with HARQACK and SR in ascending priority value [6, TS 38.214], where the value of \( N_{\text {CS] }}^{\text {eported }} \) satisfies
\[
\left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+\sum_{n=1}^{N_{\mathrm{CSB}}^{\text {moded }}} O_{\mathrm{CSI}-\mathrm{partl}, n}+O_{\mathrm{CRC}, \mathrm{CSl}-\mathrm{partl}, N}\right) \leq M_{\mathrm{RB}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sC}, \mathrm{ctrl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \text { and }
\]

ETSI


--- Page 120  ---


3GPP TS 38.213 version 17.1.0 Release 17
119
ETSI TS 138213 V17.1.0 (2022-05)
\[
\left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+\sum_{n=1}^{N_{\mathrm{cSI}}^{\text {spowed }}+1} O_{\mathrm{CSJ}-\mathrm{partl}, n}+O_{\mathrm{CRC}, \mathrm{CSJ}-\mathrm{partl}, N+1}\right)>M_{\mathrm{RB}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sC}, \mathrm{ctl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \text {, where } O_{\mathrm{CRC}, \mathrm{CSI}-\mathrm{partl}, N} \text { is a }
\]
number of CRC bits corresponding to \( O_{\mathrm{ACK}}+O_{\mathrm{SR}}+\sum_{n=1}^{\text {Nencted }} O_{\mathrm{CSJ}-\mathrm{part} 1, n} \mathrm{UCl} \) bits, and \( O_{\mathrm{CRC}, \mathrm{CSI}-\mathrm{partl}, N+1} \) is a number of CRC bits corresponding to \( O_{\mathrm{ACK}}+O_{\mathrm{SR}}+\sum_{n=1}^{N_{\text {ess }}} O_{\text {CSI-part } 1, n} \mathrm{UCl} \) bits.

If a UE is provided a first interlace of \( M_{\text {Interlace }, 0}^{\text {PUCCH }} \) PRBs by interlace0 in InterlaceAllocation, the UE has HARQ-ACK, SR and wideband or sub-band CSI reports to transmit, and the UE determines a PUCCH resource with PUCCH format 2, or the UE has HARQ-ACK, SR and wideband CSI reports to transmit and the UE determines a PUCCH resource with PUCCH format 3, where
- the UE determines the PUCCH resource using the PUCCH resource indicator field in a last of a number of DCI formats with a value of a PDSCH-to-HARQ_feedback timing indicator field, or a value provided by \( d l \) -DataToUL-ACK or dl-DataToUL-ACK-r16 or dl-DataToUL-ACK-ForDCI-Formatl-2 if the PDSCH-toHARQ_feedback timing indicator field is not present in a DCI format, indicating a same slot for the PUCCH transmission, from a PUCCH resource set provided to the UE for HARQ-ACK transmission, and
- the UE determines the PUCCH resource set as described in clauses 9.2 .1 and 9.2 .3 for \( O_{\mathrm{UCl}} \mathrm{UCI} \) bits
and
- if \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSJ}-\text { partl }}+O_{\mathrm{CRC,CSI}-\text { partl }}\right) \leq M_{\text {Irterlace, } 0}^{\text {PUCCH }} \cdot N_{\mathrm{sC,ctrl}}^{\mathrm{RB}} \cdot N_{\text {symb-UCJ }}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \), the UE transmits the HARQ-ACK, SR, and CSI reports bits in a PUCCH over the first interlace
- else, if the UE is provided a second interlace of \( M_{\text {Interlace, } \mathrm{I}}^{\text {PUCCH }} \) PRBs by interlacel and if \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}-\text { part } \mathrm{I}}+\right. \left.O_{\text {CRC,CSI-partl }}\right) \leq\left(M_{\text {Interlace, } 0}^{\text {PUCCH }}+M_{\text {Interlace, },}^{\text {PUCCH }}\right) \cdot N_{\text {sc, ctrl }}^{\mathrm{RB}} \cdot N_{\text {symb-UCI }}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \), the UE transmits the HARQ-ACK, SR, and CSI reports bits in a PUCCH over both the first and second interlaces
- else, the procedure is same as the corresponding one when the UE is provided PUCCH-ResourceSet by replacing \( M_{\mathrm{RB}}^{\mathrm{PUCCH}} \) with \( M_{\mathrm{Interlace,0}, 0}^{\mathrm{PUCCH}} \), or, if the UE is provided interlacel, by \( M_{\mathrm{Interlace,0}}^{\mathrm{PUCCH}}+M_{\mathrm{Interlace,1}}^{\mathrm{PUCCH}} \) -

If a UE has HARQ-ACK, SR and sub-band CSI reports to transmit and the UE determines a PUCCH resource with PUCCH format 3 or PUCCH format 4, where
- the UE determines the PUCCH resource using the PUCCH resource indicator field [5, TS 38.212] in a last of a number of DCI formats with a value of a PDSCH-to-HARQ_feedback timing indicator field indicating a same slot for the PUCCH transmission, or by a value provided by dl-DataToUL-ACK or dl-DataToUL-ACK-r16 or dl-DataToUL-ACK-ForDCI-Formatl-2 if the PDSCH-to-HARQ_feedback timing indicator field is not present in the last DCI format, from a PUCCH resource set provided to the UE for HARQ-ACK transmission, and
- the UE determines the PUCCH resource set as described in clause 9.2.1 and clause 9.2.3 for \( O_{\text {UCI }} \) UCI bits
and
- if \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}}+O_{\mathrm{CRC}}\right) \leq M_{\mathrm{RE}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{SC}, \mathrm{ctrl}}^{\mathrm{RE}} \cdot N_{\text {symb-UCl }}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \), the UE transmits the HARQ-ACK, SR and the \( N_{\text {CS] }}^{\text {total }} \) CSI report bits by selecting the minimum number \( M_{\text {RB } \text { min }}^{\text {PUCCH }} \) of PRBs from the \( M_{\text {RB }}^{\text {PUCCH }} \) PRBs satisfying \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}}+O_{\mathrm{CRC}}\right) \leq M_{\mathrm{RB}, \mathrm{min}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{SC}, \mathrm{CTl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCI}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \) as described in clauses 9.2.3 and 9.2.5.1
- else,
- if for \( N_{\text {CSI-part2 }}^{\text {reported }}>0 \) Part 2 CSI report priority value(s), it is
and

ETSI


--- Page 121  ---


3GPP TS 38.213 version 17.1.0 Release 17
120
ETSI TS 138213 V17.1.0 (2022-05)
\[
\begin{array}{l}
\text {, }
\end{array}
\]
the UE selects the first \( N_{\text {CSJ-part2 }}^{\text {reported }} \) Part 2 CSI reports, according to respective priority value(s) \( [6, \operatorname{TS} 38.214] \), for transmission together with the HARQ-ACK, SR and \( N_{\text {CS] }}^{\text {total }} \) Part 1 CSI reports, where \( O_{\text {CSI-part } 1, \pi} \) is the number of Part 1 CSI report bits for the \( n_{\text {th }} \) CSI report and \( O_{\text {CSI-part } 2, n} \) is the number of Part 2 CSI report bits and \( O_{\text {CRC,CSI-part2, } N+1} \) is a number of CRC bits corresponding to \( \sum_{n=1}^{\substack{N_{\text {CIM-urn }}^{\text {prome }}+1 \\ \sum_{\text {CSI-par12, } n}}} \)
- else, the UE drops all Part 2 CSI reports and selects \( N_{\text {CSI-part1 }}^{\text {reported }} \) Part 1 CSI report(s), from the \( N_{\text {CSI }}^{\text {total }} \) CSI reports in ascending priority value [6, TS 38.214], for transmission together with the HARQ-ACK and SR information bits where the value of \( N_{\text {CSI-part 1 }}^{\text {reported }} \) satisfies

If a UE is provided a first interlace of \( M_{\text {Interlace, } 0}^{\text {PUCCH }} \) PRBs by interlace0 in InterlaceAllocation, the UE has HARQ-ACK, SR and sub-band CSI reports to transmit, and the UE determines a PUCCH resource with PUCCH format 3, where
- the UE determines the PUCCH resource using the PUCCH resource indicator field in a last of a number of DCI formats that have a value of a PDSCH-to-HARQ_feedback timing indicator field indicating a same slot for the PUCCH transmission, or a value provided by dl-DataToUL-ACK or dl-DataToUL-ACK-r16 or dl-DataToUL-ACK-ForDCI-Formatl-2 if the PDSCH-to-HARQ_feedback timing indicator field is not present in the last DCI format, from a PUCCH resource set provided to the UE for HARQ-ACK transmission, and
- the UE determines the PUCCH resource set as described in clauses 9.2 .1 and 9.2 .3 for \( O_{\mathrm{UCl}} \mathrm{UCI} \) bits
and
- if \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}}+O_{\mathrm{CRC}}\right) \leq M_{\mathrm{Interlace}, 0}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sc}, \mathrm{ctr}]}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCI}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \), the UE transmits the HARQ-ACK, SR and the \( N_{\text {CSI }}^{\text {total }} \) CSI report bits in a PUCCH over the first interlace
- else if the UE is provided a second interlace of \( M_{\text {Interlace, } \mathrm{I}}^{\text {PUCCH }} \) PRBs by interlacel and if \( \left(O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSJ}}+\right. \left.O_{\mathrm{CRC}}\right) \leq\left(M_{\text {Interlace }, 0}^{\mathrm{PUCCH}}+M_{\text {Interlace, },}^{\mathrm{PUCCH}}\right) \cdot N_{\mathrm{sc}, \mathrm{ctr}]}^{\mathrm{RB}} \cdot N_{\text {symb-UCI }}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r \), the UE transmits the HARQ-ACK, SR, and CSI reports bits in a PUCCH over both the first and second interlaces
- else, the procedure is same as the corresponding one when the UE is provided PUCCH-ResourceSet by replacing \( M_{\mathrm{RB}}^{\mathrm{PUCCH}} \) with \( M_{\mathrm{Interlace,0}, 0}^{\mathrm{PUCCH}} \), or, if the UE is provided interlacel, with \( M_{\mathrm{Interlace,0}}^{\mathrm{PUCCH}}+M_{\mathrm{Interlace,1}}^{\mathrm{PUCCH}} \) -

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.2.5.2-1: Code rate \( r \) corresponding to value of maxCodeRate}
\begin{tabular}{|l|l|}
\hline maxCodeRate & Code rate \( r \) \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 122  ---


3GPP TS 38.213 version 17.1.0 Release 17
121
ETSI TS 138213 V17.1.0 (2022-05)

\begin{tabular}{|c|c|}
\hline 0 & 0.08 \\
\hline 1 & 0.15 \\
\hline 2 & 0.25 \\
\hline 3 & 0.35 \\
\hline 4 & 0.45 \\
\hline 5 & 0.60 \\
\hline 6 & 0.80 \\
\hline 7 & Reserved \\
\hline
\end{tabular}
9.2.5.3 UE procedure for reporting UCI of different priorities

If a UE
- is provided PUCCH-ConfigurationList for PUCCH transmissions with priority 0 and 1 ,
- is provided UCI-MuxWithDifferentPriority, and
- would transmit overlapping PUCCHs that include a first PUCCH with \( O_{\text {ACK }, 0} \) HARQ-ACK information bits of priority 0 and a second PUCCH with \( O_{\mathrm{ACK} 1} \) HARQ-ACK information bits of priority 1
- if the PUCCH resource for the second PUCCH includes PUCCH format 2, 3, or 4 and additionally includes \( O_{\mathrm{SR}_{1} 1} \mathrm{SR} \) bits of priority \( 1, O_{\mathrm{ACK}_{1} 1} \) is replaced by \( O_{\mathrm{ACK}_{1} 1}+O_{\mathrm{SR}_{1} 1} \) where \( O_{\mathrm{SR}_{1} 1} \) is determined according to clause 9.2.5.1
the UE
- determines
- a PUCCH resource set from the second PUCCH-Config using \( O_{\mathrm{UCI}}=O_{\mathrm{ACK}, 0}+O_{\mathrm{ACK}, 1} \) as described in clause 9.2.1, and a PUCCH resource from the PUCCH resource set as described in clause 9.2.3 where a DCI format, if any, triggers PUCCH transmission of priority 1 , or
- a PUCCH resource from the second sps-PUCCH-AN-List using \( O_{\mathrm{UCI}}=O_{\mathrm{ACK} 0}+O_{\mathrm{ACK} 1} \) as described in clause 9.2.1, and
- multiplexes the \( O_{\mathrm{ACK}_{1} 0} \) and \( O_{\mathrm{ACK}_{1} 1} \) HARQ-ACK information bits in a same PUCCH using the PUCCH resource.

If the PUCCH resource includes PUCCH format 2 or PUCCH format 3 and \( M_{\mathrm{RB}}^{\mathrm{PUCCH}} \) PRBs, the UE determines a number of \( M_{\mathrm{RB}, \mathrm{m} \text { in }}^{\mathrm{PUCCH}} \leq M_{\mathrm{RB}}^{\mathrm{PUCCH}} \) PRBs for the PUCCH transmission to be the minimum number of PRBs that starts from the first PRB from the \( M_{\mathrm{RB}}^{\mathrm{PUCCH}} \) PRBs and results to
\[
\left(O_{\mathrm{ACK}_{1} 0}+O_{\mathrm{CRC}_{1} 0}\right) \cdot r_{1}+\left(O_{\mathrm{ACK}_{1} 1}+O_{\mathrm{CRC}_{1} 1}\right) \cdot r_{0} \leq M_{\mathrm{RB}, \mathrm{~min}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sc}, \mathrm{crl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCCH}} \cdot Q_{m} \cdot r_{0} \cdot r_{1}
\]
where \( O_{\mathrm{CRC}, 0} \) or \( O_{\mathrm{CRC}, 1} \) is a number of CRC bits, if any, for encoding the \( O_{\mathrm{ACK}, 0} \) or the \( O_{\mathrm{ACK}, 1} \) HARQ-ACK information bits, respectively, \( r_{0} \) is provided by maxCodeRateLP, and the remaining parameters are as defined in clause 9.2.5.2 with \( r_{1}=r \). For PUCCH format 3, if \( M_{\mathrm{RB}, \mathrm{m} \text { in }}^{\mathrm{PUCH}} \) is not equal to \( 2^{\alpha_{2}} \cdot 3^{\alpha_{3}} \cdot 5^{\alpha_{5}}[4, \mathrm{TS} 38.211], M_{\mathrm{RB}, \min }^{\mathrm{PUCH}} \) is increased to a nearest value that is equal to \( 2^{\alpha_{2}} \cdot 3^{\alpha_{3}} \cdot 5^{\alpha_{5}} \) and does not exceed nrofPRBs.

If \( \left(O_{\mathrm{ACK}, 0}+O_{\mathrm{CRC}, 0}\right) \cdot r_{1}+\left(O_{\mathrm{ACK}, 1}+O_{\mathrm{CRC}, 1}\right) \cdot r_{0}>M_{\mathrm{RB}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sc}, \mathrm{ctrl}}^{\mathrm{RB}} \cdot N_{\mathrm{symb}-\mathrm{UCl}}^{\mathrm{PUCC}} \cdot Q_{m} \cdot r_{0} \cdot r_{1} \), the UE transmits the PUCCH over the \( M_{\mathrm{RB}}^{\text {PUCCH }} \) PRBs. If a UE transmits a PUCCH that includes HARQ-ACK information bits of priority 0 and 1 using PUCCH format 1, the UE determines a power for the PUCCH transmission, as described in clause 7.2.1, assuming that all HARQ-ACK information bits have priority 1 .

If a UE transmits a PUCCH that includes one HARQ-ACK information bit of priority 0 and one HARQ-ACK information bit of priority 1
- if the PUCCH transmission uses a resource that includes PUCCH format 0 , the HARQ-ACK information bits of priority 1 and priority 0 are set as the first and second bits in Table 9.2.3-4, respectively, to derive the \( m_{\mathrm{CS}} \) of the PUCCH transmission
- if the PUCCH transmission uses a resource that includes PUCCH format 1 , the HARQ-ACK information bits of priority 1 and priority 0 are the first and second bits, respectively, of the QPSK modulated symbol for the PUCCH transmission

ETSI


--- Page 123  ---


3GPP TS 38.213 version 17.1.0 Release 17
122
ETSI TS 138213 V17.1.0 (2022-05)

If a UE transmits a PUCCH that includes HARQ-ACK information bits of priority 0 and 1 using a PUCCH resource that includes PUCCH format 2, 3 or 4, the UE determines a power for the PUCCH transmission, as described in clause 7.2.1, assuming that the PUCCH includes only UCI bits of priority 1 , where \( N_{\mathrm{RE}}(i)=\min \left(M_{\mathrm{RB}}^{\mathrm{PUCCH}} \cdot N_{\mathrm{sc}, \mathrm{crt} \mid}^{\mathrm{RB}}\right. \). \( \left.N_{\text {symb-UCl },}^{\text {PUCCH }},\left[\left(O_{\mathrm{UCl}_{1}, 1}+O_{\mathrm{CRC}_{1} 1}\right) /\left(Q_{m} \cdot r_{1}\right)\right]\right) \).
9.2.5.4 UE procedure for deferring HARQ-ACK for SPS PDSCH

If a UE is provided spsHARQdeferral and, after performing the procedures in clauses 9 and 9.2 .5 to resolve overlapping among PUCCHs and PUSCHs in a first slot, if any, the UE determines a PUCCH resource for a PUCCH transmission with first HARQ-ACK information bits for SPS PDSCH receptions that the UE would report for a first time, and the PUCCH resource
- is provided by SPS-PUCCH-AN-List as described in clause 9.2.1, or by nIPUCCH-AN if SPS-PUCCH-AN-List is not provided
- is not cancelled by an overlapping PUCCH or PUSCH transmission of larger priority index
- overlaps with a symbol indicated as downlink by tdd-UL-DL-ConfigurationCommon or tdd-UL-DLConfigDedicated, or indicated for a SS/PBCH block by ssb-PositionsInBurst, or belonging to a CORESET associated with a Type0-PDCCH CSS set
the UE
- determines an earliest second slot and, after performing the procedures in clauses 9 and 9.2.5 to resolve overlapping among PUCCHs and PUSCHs, if any, a PUSCH or a PUCCH in the earliest second slot to multiplex HARQ-ACK information bits that include second HARQ-ACK information bits from the first HARQ-ACK information bits
- if the UE detects a DCI format in a PDCCH reception that triggers a PUCCH transmission with a Type-3 HARQ-ACK codebook in a slot as described in clause 9.1 .4 , the UE stops the procedure to determine the earliest second slot in the slot
- if the UE is provided a periodic cell switching pattern for PUCCH transmissions by pucch-sSCellPattern, the UE determines the earliest second slot and a corresponding cell based on the periodic cell switching pattern as described in clause 9.A
- if the UE multiplexes the second HARQ-ACK information in a PUSCH, or in a PUCCH using a resource that is not from SPS-PUCCH-AN-List, or from nIPUCCH-AN if SPS-PUCCH-AN-List is not provided, the UE stops the procedure to determine the earliest second slot in the slot
- if the UE multiplexes the second HARQ-ACK information in a first PUCCH using a resource provided by SPS-PUCCH-AN-List, or by nIPUCCH-AN if SPS-PUCCH-AN-List is not provided, of smaller priority index and the UE drops the first PUCCH transmission due to an overlapping with a second PUSCH or PUCCH transmission of larger priority index, the UE stops the procedure to determine the earliest second slot in the slot
- the second HARQ-ACK information bits correspond to SPS PDSCH configurations with spsHARQdeferral values that are larger than or equal to a time difference, with reference to slots for PUCCH transmissions on the primary cell, between the second slot and the slot of the SPS PDSCH reception, if any
- if the UE multiplexes the second HARQ-ACK information in a first PUCCH using a resource provided by SPS-PUCCH-AN-List, or by nIPUCCH-AN if SPS-PUCCH-AN-List is not provided, and the PUCCH transmission is not dropped due to an overlapping with a PUSCH or PUCCH transmission of larger priority and does not have any symbol that overlaps with a symbol indicated as downlink by tdd-UL-DLConfigurationCommon or tdd-UL-DL-ConfigDedicated, or indicated for a SS/PBCH block by ssbPositionsInBurst, or belonging to a CORESET associated with a Type0-PDCCH CSS set, the UE stops the procedure to determine the earliest second slot in the slot
- the second HARQ-ACK information bits, generated as described in clause 9.1 2, are appended in a HARQ-ACK codebook the UE generates as described in clauses 9.1.2, 9.1.2.1,9.1.3.1, or 9.1.5
- if the UE would receive a PDSCH providing a TB for a same HARQ process as a HARQ-ACK information bit from the second HARQ-ACK information bits prior to transmitting the PUCCH or the PUSCH, the UE does not include the HARQ-ACK information bit in the HARQ-ACK information bits.

ETSI


--- Page 124  ---


3GPP TS 38.213 version 17.1.0 Release 17
123
ETSI TS 138213 V17.1.0 (2022-05)

The UE does not expect to be provided both spsHARQdeferral and nrofSlots or PUCCH-nrofSlots for any PUCCH resource of same priority.
9.2.6 PUCCH repetition procedure

A UE can be indicated to transmit a PUCCH over \( N_{\text {PUCCH }}^{\text {repeat }} \) slots using a PUCCH resource, where
- if the PUCCH resource is indicated by a DCI format and includes PUCCH-nrofSlots, \( N_{\text {PUCCH }}^{\text {repeat }} \) is provided by PUCCH-nrofSlots
- otherwise, \( N_{\text {PUCCH }}^{\text {repeat }} \) is provided by nrofSlots

If the UE is provided subslotLengthForPUCCH, a slot for a PUCCH transmission with repetitions over \( N_{\text {PUCCH }}^{\text {repeat }}>1 \) slots includes a number of symbols indicated by subslotLengthForPUCCH.

For \( N_{\text {PUCCH }}^{\text {repeat }}>1 \),
- the UE repeats the PUCCH transmission with the UCI over \( N_{\text {PUCCH }}^{\text {repeat }} \) slots
- a repetition of the PUCCH transmission in each of the \( N_{\text {PUCCH }}^{\text {repeat }} \) slots has a same number of consecutive symbols, as provided by nrofSymbols
- a repetition of the PUCCH transmission in each of the \( N_{\text {PUCCH }}^{\text {repeat }} \) slots has a same first symbol, as provided by startingSymbollndex if subslotLengthForPUCCH is not provided; otherwise mod(startingSymbollndex, subslotLengthForPUCCH)
- the UE is configured by interslotFrequencyHopping whether or not to perform frequency hopping for repetitions of the PUCCH transmission in different slots
- if the UE is configured to perform frequency hopping for repetitions of a PUCCH transmission across slots and the UE is not provided PUCCH-DMRS-Bundling = 'enabled'
- the UE performs frequency hopping per slot
- the UE transmits the PUCCH starting from a first PRB, provided by starting PRB, in slots with even number and starting from a second PRB , provided by secondHopPRB, in slots with odd number. The slot indicated to the UE for the first repetition of the PUCCH transmission has number 0 and each subsequent slot until the UE transmits the PUCCH in \( N_{\text {PUCCH }}^{\text {repeat }} \) slots is counted regardless of whether or not the UE transmits the PUCCH in the slot
- the UE does not expect to be configured to perform frequency hopping for a repetition of the PUCCH transmission within a slot
- if the UE is configured to perform frequency hopping for repetitions of a PUCCH transmission across slots and the UE is provided PUCCH-DMRS-Bundling = 'enabled'
- the UE performs frequency hopping per interval of \( N_{\text {PUCCH }}^{\text {interval }} \) consecutive slots, that start from a slot indicated to the UE and where the UE would transmit a first repetition of the PUCCH, where \( N_{\text {PUCCH }}^{\text {interval }} \) is the value of PUCCH-Frequencyhopping-Interval, if provided; otherwise, \( N_{\text {PUCCH }}^{\text {interval }} \) is the value of PUCCHTimeDomainWindowLength
- the UE transmits the PUCCH over intervals until the UE transmits the PUCCH in \( N_{\text {PUCCH }}^{\text {repeat }} \) slots, where the first interval has number 0 and each subsequent interval is counted regardless of whether or not the UE transmits the PUCCH in a slot
- the UE transmits the PUCCH starting from a first PRB, provided by starting \( P R B \), in intervals with even number and starting from a second PRB, provided by secondHopPRB, in intervals of frequency hopping intervals with odd number
- the UE does not expect to be configured to perform frequency hopping for a repetition of the PUCCH transmission within a slot

ETSI


--- Page 125  ---


3GPP TS 38.213 version 17.1.0 Release 17
124
ETSI TS 138213 V17.1.0 (2022-05)
- if the UE is not configured to perform frequency hopping for repetitions of a PUCCH transmission across slots and the UE is configured to perform frequency hopping for a repetition of the PUCCH transmission within a slot, the frequency hopping pattern between the first PRB and the second PRB is same within each slot

If the UE determines that, for a repetition of a PUCCH transmission in a slot, the number of symbols available for the PUCCH transmission is smaller than the value provided by nrofSymbols for the corresponding PUCCH format, the UE does not transmit the PUCCH repetition in the slot.

A SS/PBCH block symbol is a symbol of an SS/PBCH block with candidate SS/PBCH block index corresponding to the SS/PBCH block index indicated to a UE by ssb-PositionsInBurst in SIBl or ssb-PositionsInBurst in ServingCellConfigCommon or, if the UE is not provided DLorJoint-TCIState or followUnifiedTCIstate, by ssbPositionsInBurst in SSB-MTCAdditionalPCI associated to physical cell ID with active TCI states.

For unpaired spectrum, the UE determines the \( N_{\text {PUCCH }}^{\text {repeat }} \) slots for a PUCCH transmission starting from a slot indicated to the UE as described in clause 9.2.3 for HARQ-ACK reporting, or a slot determined as described in clause 9.2.4 for SR reporting or in clause 5.2.1.4 of [6, TS 38.214] for CSI reporting and having
- an UL symbol, as described in clause 11.1, or flexible symbol that is not SS/PBCH block symbol provided by startingSymbollndex as a first symbol, and
- consecutive UL symbols, as described in clause 11.1, or flexible symbols that are not SS/PBCH block symbols, starting from the first symbol, equal to or larger than a number of symbols provided by nrofsymbols

For paired spectrum or supplementary uplink band, the UE determines the \( N_{\mathrm{PUCCH}}^{\text {repeat }} \) slots for a PUCCH transmission as the \( N_{\text {PUCCH }}^{\text {repeat }} \) consecutive slots starting from a slot indicated to the UE as described in clause 9.2.3 for HARQ-ACK reporting, or a slot determined as described in clause 9.2.4 for SR reporting or in clause 5.2.1.4 of [6, TS 38.214] for CSI reporting.

If a UE would transmit a PUCCH over a first number \( N_{\text {PUCCH }}^{\text {repeat }}>1 \) of slots and the UE would transmit a PUSCH with repetition Type A or with TB processing over multiple slots over a second number of slots, and the PUCCH transmission would overlap with the PUSCH transmission in one or more slots, and the conditions in clause 9.2.5 for multiplexing the UCI in the PUSCH are satisfied in the overlapping slots, the UE transmits the PUCCH and does not transmit the PUSCH in the overlapping slots.

If a UE would transmit a PUCCH over a first number \( N_{\text {PUCCH }}^{\text {repeat }}>1 \) of slots and the UE would transmit a PUSCH with repetition Type B over a second number of slots, and the PUCCH transmission would overlap with actual PUSCH repetitions in one or more slots, and the conditions in clause 9.25 for multiplexing the UCI in the PUSCH are satisfied for the overlapping actual PUSCH repetitions, the UE transmits the PUCCH and does not transmit the overlapping actual PUSCH repetitions.

A UE does not multiplex different UCI types in a PUCCH transmission with repetitions over \( N_{\text {PUCCH }}^{\text {repeat }}>1 \) slots. If a UE would transmit a first PUCCH over more than one slot and at least a second PUCCH over one or more slots, and the transmissions of the first PUCCH and the second PUCCH would overlap in a number of slots then, for each slot of the number of slots and with UCI type priority of HARQ-ACK \( > \) SR \( > \) CSI with higher priority \( > \) CSI with lower priority
- the UE does not expect the first PUCCH and any of the second PUCCHs to start at a same slot and include a UCI type with same priority
- if the first PUCCH and any of the second PUCCH s include a UCI type with same priority, the UE transmits the PUCCH starting at an earlier slot and does not transmit the PUCCH starting at a later slot
- if the first PUCCH and any of the second PUCCHs do not include a UCI type with same priority, the UE transmits the PUCCH that includes the UCI type with higher priority and does not transmit the PUCCH that include the UCI type with lower priority

When a PUCCH resource used for repetitions of a PUCCH transmission by a UE includes first and second spatial settings, or first and second sets of power control parameters, as described in [11, TS 38.321] and in clause 7.2.1, the UE
- uses the first and second spatial settings, or the first and second sets of power control parameters, for first and second repetitions of the PUCCH transmission, respectively, when \( N_{\text {PUCCH }}^{\text {repeat }}=2 \),

ETSI


--- Page 126  ---


3GPP TS 38.213 version 17.1.0 Release 17
125
ETSI TS 138213 V17.1.0 (2022-05)
- alternates between the first and second spatial settings, or between the first and second sets of power control parameters, respectively, per \( N_{\mathrm{PUCCH}} \) switchetitions of the PUCCH transmission, where \( N_{\mathrm{PUCCH}}^{\text {switch }}=1 \) if mappingPattern \( = \) 'cyclicMapping'; else, \( N_{\text {PUCCH }}^{\text {switch }}=2 \).

A UE does not expect a PUCCH that is in response to a DCI format detection to overlap with any other PUCCH that does not satisfy the corresponding timing conditions in clause 9.2.5.

If a UE would transmit a PUCCH over \( N_{\text {PUCCH }}^{\text {repeat }} \) slots and the UE does not transmit the PUCCH in a slot from the \( N_{\text {PUCCH }}^{\text {repeat }} \) slots due to overlapping with another PUCCH transmission in the slot, the UE counts the slot in the number of \( N_{\text {PUCCH }}^{\text {repeat }} \) slots.

For DAPS operation, if a UE would transmit a PUCCH over \( N_{\text {PUCCH }}^{\text {repeat }} \) slots on the source MCG and the UE does not transmit the PUCCH in a slot from the \( N_{\text {PUCCH }}^{\text {rep eat }} \) slots due to overlapping in time with UE transmission on the target MCG in the slot, the UE counts the slot in the number of \( N_{\text {PUCCH }}^{\text {repeat }} \) slots.
9.3 UCI reporting in physical uplink shared channel

Offset values are defined for a UE to determine a number of resources for multiplexing HARQ-ACK information and for multiplexing CSI reports in a PUSCH. Offset values are also defined for multiplexing CG-UCI [5, TS 38.212] in a CG-PUSCH. The offset values are signalled to a UE either by a DCI format scheduling the PUSCH transmission or by higher layers.

If a DCI format that does not include a beta_offset indicator field schedules the PUSCH transmission from the UE and the UE is provided betaOffsets = 'semiStatic', the UE applies the \( \beta_{\text {offset }}^{\text {HARQ-ACK }}, \beta_{\text {offset }}^{\text {CSI-1 }} \), and \( \beta_{\text {offset }}^{\text {CSI-2 }} \) values that are provided by betaOffsets = 'semiStatic' for the corresponding HARQ-ACK information, Part 1 CSI reports and Part 2 CSI reports. If the PUSCH transmission has priority 0 or priority 1 and the UE is configured by UCIMuxWithDifferentPriority to multiplex HARQ-ACK information of priority 1 or priority 0 , respectively, and if the UE multiplexes HARQ-ACK information of priority 1 or priority 0 , the UE applies corresponding \( \beta_{\text {offset }}^{\text {HARQ-ACK } 1} \) or \( \beta_{\text {offset }}^{\text {HARQ-ACK }, 0} \) provided by betaOffset-CrossPril = 'semiStatic' for DCI formats \( 0 \_0 / 0 \_1 \) and by betaOffsetsCrossPriIDCI-0-2 = 'semiStatic' for DCI format 0_2, or by betaOffset-CrossPri0 = 'semiStatic' for DCI format \( 0-1 \) and by betaOffsetsCrossPri0DCI-0-2 = 'semiStatic' for DCI format \( 0 \_2 \), respectively.

If the PUSCH transmission is with a configured grant and the UE is provided CG-UCI-OnPUSCH='semiStatic', the UE applies the \( \beta_{\text {offset }}^{\text {HARR-ACK }}, \beta_{\text {offset }}^{\text {CSI-1 }} \), and \( \beta_{\text {offset }}^{\text {CSI-2 }} \) values that are provided by CG-UCI-OnPUSCH = 'semiStatic' for the corresponding HARQ-ACK information, Part 1 CSI reports and Part 2 CSI reports. If the PUSCH transmission has priority 0 or priority 1 and the UE is configured by UCI-Mux WithDifferentPriority to multiplex HARQ-ACK information of priority 1 or priority 0 , respectively, and if the UE multiplexes HARQ-ACK information of priority 1 or priority 0 , the UE applies corresponding \( \beta_{\text {offset }}^{\text {HARQ-ACK }, 1} \) or \( \beta_{\text {offset }}^{\text {HARQ-ACK }, 0} \) provided by CG-betaOffsetsCrossPril \( = \) 'semiStatic' or CG-betaOffsetsCrossPri0 = 'semiStatic', respectively.

If the PUSCH transmission is scheduled by DCI format \( 0 \_0 \) and the UE is provided betaOffsets = 'dynamic', the UE applies the \( \beta_{\text {offset }}^{\text {HARQ-ACK }}, \beta_{\text {offset }}^{\text {CSI-1 }} \), and \( \beta_{\text {offset }}^{\text {CSI-2 }} \) values that are determined from the first value of betaOffsets \( = \) 'dynamic'. If the UE is configured by UCI-MuxWithDifferentPriority to multiplex HARQ-ACK information of priority 1 , the UE applies corresponding \( \beta_{\text {offset }}^{\text {HARQ-ACK } 1} \) provided by the first value of betaOffset-CrossPril = 'dynamic'.

If the PUSCH transmission is a configured grant Type 2 PUSCH and the UE is provided CG-UCI-OnPUSCH \( = \) 'dynamic', the UE applies the \( \beta_{\text {offset }}^{\mathrm{HARQ}-\mathrm{ACK}}, \beta_{\mathrm{offset}}^{\mathrm{CSI}-1} \), and \( \beta_{\text {offset }}^{\mathrm{CSI}-2} \) values that are determined from the first value of \( C G \) -UCI-OnPUSCH = 'dynamic'. If the PUSCH transmission has priority 0 or priority 1 and the UE is configured by UCIMuxWithDifferentPriority to multiplex HARQ-ACK information of priority 1 or priority 0, respectively, and if the UE multiplexes HARQ-ACK information of priority 1 or priority 0 , the UE applies corresponding \( \beta_{\text {offset }}^{\text {HARQ-ACK } 1} \) or \( \beta_{\text {offset }}^{\text {HARQ-ACK, } 0} \) provided by the first value of CG-betaOffsetsCrossPril = 'dynamic' or CG-betaOffsetsCrossPrio = 'dynamic', respectively.

HARQ-ACK information offsets \( \beta_{\text {offset }}^{\text {HARQ-ACK }} \) are configured to values according to Table 9.3-1. The betaOffsetACKIndex 1, betaOffsetACK-Index2, and betaOffsetACK-Index3 respectively provide indexes \( I_{\text {offset }, 0}^{\text {HARQ-ACK }} \), \( I_{\text {offset }, 1}^{\text {HARQ-ACK }} \), and \( I_{\text {offset } 2}^{\text {HARQ-ACK }} \) for the UE to use if the UE multiplexes up to 2 HARQ-ACK information bits, more than 2 and up to 11 HARQ-ACK information bits, and more than 11 bits in the PUSCH, respectively.

ETSI


--- Page 127  ---


3GPP TS 38.213 version 17.1.0 Release 17
126
ETSI TS 138213 V17.1.0 (2022-05)

Offsets \( \beta_{\text {offset }}^{\text {HARQ-ACK }, 0} \) for multiplexing HARQ-ACK information with priority 0 in a PUSCH transmission with priority 1 are configured to values according to Table 9.3-1. The betaOffsetACKPri0-Index1, betaOffsetACKPri0-Index2, and betaOffsetACKPri0-Index3 respectively provide indexes \( I_{\text {offset }, 0}^{\text {HARQ-ACK }, 0}, I_{\text {offset }, 1}^{\text {HARQ }}{ }^{\text {HACK }, 0} \), and \( I_{\text {offset }, 2}^{\text {HARQ-ACK }, 0} \) for the UE to use if the UE multiplexes up to 2 bits, more than 2 and up to 11 bits, and more than 11 bits of HARQ-ACK information with priority 0 in the PUSCH transmission with priority 1, respectively.

Offsets \( \beta_{\text {offset }}^{\text {HARQ-ACK }, 1} \) for multiplexing HARQ-ACK information with priority 1 in a PUSCH transmission with priority 0 are configured to values according to Table 9.3-1. The betaOffsetACKPri1-Index1, betaOffsetACKPri1-Index2, and betaOffsetACKPril-Index3 respectively provide indexes \( I_{\text {offset }, 0}^{\text {HARQ-ACK }, 1}, I_{\text {offset }, 1}^{\text {HARQ-ACK }, 1} \), and \( I_{\text {offset }, 2}^{\text {HARQ-ACK }, 1} \) for the UE to use if the UE multiplexes up to 2 bits, more than 2 and up to 11 bits, and more than 11 bits of HARQ-ACK information with priority 1 in the PUSCH transmission with priority 0 , respectively.

Part 1 CSI report and Part 2 CSI report offsets \( \beta_{\text {offset }}^{\text {CSI-1 }} \) and \( \beta_{\text {offset }}^{\text {CSI-2 }} \), respectively, are configured to values according to Table 9.3-2. The betaOffsetCSI-Part1-Indexl and betaOffsetCSI-Part2-Indexl respectively provide indexes \( I_{\text {offset }, 0}^{\text {CSI }} \) and \( I_{\text {offset }, 0}^{\text {CSI }} \) for the UE to use if the UE multiplexes up to 11 bits for Part 1 CSI reports or Part 2 CSI reports in the PUSCH. The betaOffsetCSI-Part1-Index2 and betaOffsetCSI-Part2-Index2 respectively provide indexes \( I_{\text {offset }, 1}^{\text {CSI }} \) or \( I_{\text {offset }, 1}^{\text {CSI }} \) for the UE to use if the UE multiplexes more than 11 bits for Part 1 CSI reports or Part 2 CSI reports in the PUSCH.

If a DCI format that includes a beta_offset indicator field with one bit or two bits, as configured by uci-OnPUSCH or UCI-OnPUSCH-DCI-0-2, schedules the PUSCH transmission from the UE, the UE is provided by each of \{betaOffsetACK-Index 1, betaOffsetACK-Index2, betaOffsetACK-Index3\}, \{betaOffsetACKPri0-Index1, betaOffsetACKPri0-Index2, betaOffsetACKPri0-Index3\}, and \{betaOffsetACKPri 1-Index 1, betaOffsetACKPri 1-Index2, betaOffsetACKPril-Index3\} a set of two or four \( I_{\text {offset }}^{\text {HARQ-ACK }}, I_{\text {offset }}^{\text {HARQ-ACK }, 0} \), and \( I_{\text {offset }}^{\text {HARQ-ACK }, 1} \) indexes from Table 9.3-1 for multiplexing HARQ-ACK information in the PUSCH transmission and by each of \{betaOffsetCSI-Partl-Indexl, betaOffsetCSI-Part1-Index2\} a set of two or four \( I_{\text {offset }}^{\text {CSI }} \) indexes, and by each of \{betaOffsetCSI-Part2-Index1, betaOffsetCSI-Part2-Index2\} a set of two or four \( I_{\text {offset }}^{\mathrm{CSI}-2} \) indexes from Table 9.3-2, respectively, for multiplexing Part 1 CSI reports and Part 2 CSI reports, respectively, in the PUSCH transmission. The beta_offset indicator field indicates a \( I_{\text {offset }}^{\text {HARQ-ACK }} \) value and/or a \( I_{\text {offset }}^{\text {HARQ-ACK }, 0} \) value, and/or a \( I_{\text {offset }}^{\text {HARQ-ACK }, 1} \) value, a \( I_{\text {offset }}^{\text {CSI-1 }} \) value and a \( I_{\text {offset }}^{\text {CSI-2 }} \) value from the respective sets of values, with the mapping defined in Table 9.3-3 and in Table 9.3-3A. If the PUSCH transmission has priority 0 or priority 1, and the UE is provided UCI-MuxWithDifferentPriority, and the UE multiplexes HARQ-ACK information of priority 1 or priority 0 in the PUSCH, the UE applies \{betaOffsetACKPri l-Index l, betaOffsetACKPrilIndex2, betaOffsetACKPri1-Index3\}, or \{betaOffsetACKPri0-Index1, betaOffsetACKPri0-Index2, betaOffsetACKPri0Index3 ) provided by betaOffset-CrossPril = 'dynamic' for DCI format 0_1, betaOffsetsCrossPrilDCI-0-2= 'dynamic' for DCI format 0_2, or betaOffset-CrossPri0 = 'dynamic' for DCI format 0_1, betaOffsetsCrossPri0DCI-0-2= 'dynamic' for DCI format 0_2, respectively.

For a PUSCH transmission that is configured by a ConfiguredGrantConfig and includes CG-UCI, the UE multiplexes CG-UCI in the PUSCH transmission if the UE is provided by betaOffsetCG-UCI a \( I_{\text {offset }}^{\mathrm{CG}-\mathrm{UCl}} \) value, from a set of values, with the mapping defined in Table 9.3-1. If the UE is provided cg-UCI-Multiplexing and multiplexes HARQ-ACK information in the PUSCH transmission, as described in clauses 9 and 9.2.5, the UE jointly encodes the HARQ-ACK information and the CG-UCI [5, TS 38.212] and determines a number of resources for multiplexing the combined information in a PUSCH using \( \beta_{\text {offset }}^{\text {HARQ-ACK }} \) which provides indexes \( I_{\text {offset }, 1}^{\text {HARQ-ACK }} \) and \( I_{\text {offset }, 2}^{\text {HARQ-ACK }} \) for the UE to use if the UE multiplexes up to 11, and more than 11 combined information bits, respectively.

ETSI


--- Page 128  ---


3GPP TS 38.213 version 17.1.0 Release 17
127
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.3-1: Mapping of beta_offset values for HARQ-ACK information and/or for CG-UCI and the index signalled by higher layers}
\begin{tabular}{|l|l|}
\hline \( I_{\text {offset }, 0}^{\text {HARQ-ACK }} \) or \( I_{\text {offset,1 }}^{\text {HARQ-ACK }} \) or \( I_{\text {offset,2 }}^{\text {HARQ-ACK }} \) or \( I_{\text {offset }}^{\text {CG-UCI }} \) or \( I_{\text {offset, } 0}^{\text {HARQ-ACK, } 0} \) or \( I_{\text {offset, } 1}^{\text {HARQ-ACK, } 0} \) or \( I_{\text {offset, } 2}^{\text {HARQ-ACK, } 0} \) or \( I^{\text {HARQ-ACK,1 }} \) or \( I^{\text {HARQ-ACK,1 }} \) or \( I^{\text {HARQ-ACK,1 }} I_{\text {offset }, 0} \) Or \( I_{\text {offset }, 1} \) Or \( I_{\text {off } s e t, 2} \) & \( \boldsymbol{\beta}_{\text {offset }}^{\text {HARQ-ACK }} \) or \( \boldsymbol{\beta}_{\text {offset }}^{\text {CG-UCI }} \) or \( \boldsymbol{\beta}_{\text {offset }}^{\text {HARQ-ACK,0 }} \) or \( \boldsymbol{\beta}_{\text {offset }}^{\text {HARQ-ACK,1 }} \) \\
\hline 0 & 1.000 \\
\hline 1 & 2.000 \\
\hline 2 & 2.500 \\
\hline 3 & 3.125 \\
\hline 4 & 4.000 \\
\hline 5 & 5.000 \\
\hline 6 & 6.250 \\
\hline 7 & 8.000 \\
\hline 8 & 10.000 \\
\hline 9 & 12.625 \\
\hline 10 & 15.875 \\
\hline 11 & 20.000 \\
\hline 12 & 31.000 \\
\hline 13 & 50.000 \\
\hline 14 & 80.000 \\
\hline 15 & 126.000 \\
\hline 16 & 0.6 \\
\hline 17 & 0.4 \\
\hline 18 & 0.2 \\
\hline 19 & 0.1 \\
\hline 20 & 0.05 \\
\hline 21 & Reserved \\
\hline 22 & Reserved \\
\hline 23 & Reserved \\
\hline 24 & Reserved \\
\hline 25 & Reserved \\
\hline 26 & Reserved \\
\hline 27 & Reserved \\
\hline 28 & Reserved \\
\hline 29 & Reserved \\
\hline 30 & Reserved \\
\hline 31 & Reserved \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 129  ---


3GPP TS 38.213 version 17.1.0 Release 17
128
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.3-2: Mapping of beta_offset values for CSI and the index signalled by higher layers}
\begin{tabular}{|l|l|}
\hline \( I_{\text {Sff }}^{\text {CSI }-1} \) or \( I_{\text {Sff }-1}^{\text {CSI }} I_{\text {offset, } 0} \) Or \( I_{\text {offset, } 1} I^{\text {CSI-2 }} \) or \( I^{\text {CSI-2 }} I_{\text {offset, } 0} \) OT \( I_{\text {offset, } 1} \) & \( \boldsymbol{\beta}_{\text {offset }}^{\text {CSI }-1} \beta_{\text {offset }} \boldsymbol{\beta}_{\text {offset }}^{\text {CSI-2 }} \) \\
\hline 0 & 1.125 \\
\hline 1 & 1.250 \\
\hline 2 & 1.375 \\
\hline 3 & 1.625 \\
\hline 4 & 1.750 \\
\hline 5 & 2.000 \\
\hline 6 & 2.250 \\
\hline 7 & 2.500 \\
\hline 8 & 2.875 \\
\hline 9 & 3.125 \\
\hline 10 & 3.500 \\
\hline 11 & 4.000 \\
\hline 12 & 5.000 \\
\hline 13 & 6.250 \\
\hline 14 & 8.000 \\
\hline 15 & 10.000 \\
\hline 16 & 12.625 \\
\hline 17 & 15.875 \\
\hline 18 & 20.000 \\
\hline 19 & Reserved \\
\hline 20 & Reserved \\
\hline 21 & Reserved \\
\hline 22 & Reserved \\
\hline 23 & Reserved \\
\hline 24 & Reserved \\
\hline 25 & Reserved \\
\hline 26 & Reserved \\
\hline 27 & Reserved \\
\hline 28 & Reserved \\
\hline 29 & Reserved \\
\hline 30 & Reserved \\
\hline 31 & Reserved \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 130  ---


3GPP TS 38.213 version 17.1.0 Release 17
129
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.3-3: Mapping of four beta_offset indicator values to offset indexes}
\begin{tabular}{|l|l|}
\hline beta_offset indicator & \\
\hline \( 00^{\prime} \) & \( 1^{\text {st }} \) offset index provided by higher layers \\
\hline 01' & \( 2^{\text {nd }} \) offset index provided by higher layers \\
\hline '10' & \( 3^{\text {rd }} \) offset index provided by higher layers \\
\hline '11' & \( 4^{\text {th }} \) offset index provided by higher layers \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 9.3-3A: Mapping of two beta_offset indicator values to offset indexes}
\begin{tabular}{|l|l|}
\hline beta_offset indicator & \\
\hline '0' & \( 1^{\text {st }} \) offset index provided by higher layers \\
\hline '1' & \( 2^{\text {nd }} \) offset index provided by higher layers \\
\hline
\end{tabular}
\end{table}

10 UE procedure for receiving control information
If the UE is configured with a SCG, the UE shall apply the procedures described in this clause for both MCG and SCG except for PDCCH monitoring in Type0/0A/2/2A -PDCCH CSS sets where the UE is not required to apply the procedures in this clause for the SCG
- When the procedures are applied for MCG, the terms 'secondary cell', 'secondary cells' , 'serving cell', 'serving cells' in this clause refer to secondary cell, secondary cells, serving cell, serving cells belonging to the MCG respectively.
- When the procedures are applied for SCG, the terms 'secondary cell', 'secondary cells', 'serving cell', 'serving cells' in this clause refer to secondary cell, secondary cells (not including PSCell), serving cell, serving cells belonging to the SCG respectively. The term 'primary cell' in this clause refers to the PSCell of the SCG.

A UE monitors a set of PDCCH candidates in one or more CORESETs on the active DL BWP on each activated serving cell configured with PDCCH monitoring according to corresponding search space sets where monitoring implies receiving each PDCCH candidate and decoding according to the monitored DCI formats.

In the remaining of this clause, when a PDCCH reception by a UE includes two PDCCH candidates from corresponding search space sets, as described in clause 10.1
- a PDCCH monitoring occasion is the union of the PDCCH monitoring occasions for the two PDCCH candidates
- the start of the PDCCH reception is the start of the earlier PDCCH candidate
- the end of the PDCCH reception is the end of the PDCCH candidate that ends later

The PDCCH reception includes the two PDCCH candidates also when the UE is not required to monitor one of the two PDCCH candidates as described in clauses 10,11.1, and 11.1.1.

A UE obtains an indication to monitor PDCCH on the active DL BWP of the serving cell for a maximum number of PDCCH candidates and non-overlapping CCEs
- per slot, as in Tables 10.1-2 and 10.1-3, if monitoringCapabilityConfig \( = \) r15monitoringcapability, or
- per span, as in Tables 10.1-2A and 10.1-3A, if monitoringCapabilityConfig \( = \) rl6monitoringcapability, or
- per group of \( X_{s} \) slots according to combination \( \left(X_{s}, Y_{s}\right) \), as in Tables 10.1-2B and 10.1-3B, if monitoringCapabilityConfig = r17monitoringcapability or if monitoringCapabilityConfig is not provided

ETSI


--- Page 131  ---


3GPP TS 38.213 version 17.1.0 Release 17
130
ETSI TS 138213 V17.1.0 (2022-05)

The remaining of this clause, including clause 10.1, considers that a UE is provided monitoringCapabilityConfig for a serving cell. If the UE is not provided monitoringCapabilityConfig for the serving cell, corresponding statements that the UE is provided monitoringCapabilityConfig for the serving cell are substituted as follows
- for SCS configuration \( \mu \in\{0,1,2,3\} \), the UE monitors PDCCH on the active DL BWP of the serving cell for maximum numbers of PDCCH candidates and non-overlapping CCEs per slot as in Tables 10.1-2 and 10.1-3.
- for SCS configuration \( \mu \in\{5,6\} \), the UE monitors PDCCH on the active DL BWP of the serving cell for maximum numbers of PDCCH candidates and non-overlapping CCEs per group of \( X_{s} \) slots according to combination \( \left(X_{s}, Y_{s}\right)=(4,1) \) for \( \mu=5 \) and \( \left(X_{s}, Y_{s}\right)=(8,1) \) for \( \mu=6 \) as in Tables 10.1-2B and 10.1-3B.

The UE does not expect to monitor PDCCH with SCS configuration \( \mu=6 \) before the UE is provided dedicated higher layer parameters.

A UE can indicate a capability to monitor PDCCH according to one or more of the combinations \( (\mathrm{X}, \mathrm{Y})=(2,2),(4,3) \), and \( (7,3) \) per SCS configuration of \( \mu=0 \) and \( \mu=1 \). A span is a number of consecutive symbols in a slot where the UE is configured to monitor PDCCH. Each PDCCH monitoring occasion is within one span. If a UE monitors PDCCH on a cell according to combination ( \( \mathrm{X}, \mathrm{Y} \) ), the UE supports PDCCH monitoring occasions in any symbol of a slot with minimum time separation of \( X \) symbols between the first symbol of two consecutive spans, including across slots. A span starts at a first symbol where a PDCCH monitoring occasion starts and ends at a last symbol where a PDCCH monitoring occasion ends, where the number of symbols of the span is up to \( Y \).

If a UE indicates a capability to monitor PDCCH according to multiple ( \( \mathrm{X}, \mathrm{Y} \) ) combinations and a configuration of search space sets to the UE for PDCCH monitoring on a cell results to a separation of every two consecutive PDCCH monitoring spans that is equal to or larger than the value of \( X \) for more than one of the multiple combinations ( \( X, Y \) ), the UE monitors PDCCH on the cell according to the combination ( \( X, Y \) ), from the more than one combinations ( \( X, Y \) ), that is associated with the largest maximum number of \( M_{\text {PDCCH }}^{\max ,(X, Y), \mu} \) and \( C_{\text {PDCCH }}^{\max ,(X, Y), \mu} \) defined in Table 10.1-2A and Table 10.1-3A. The UE expects to monitor PDCCH according to the same combination (X, Y) in every slot on the active DL BWP of a cell.

For SCS configuration \( \mu=5 \) or \( \mu=6 \), a UE can indicate a capability to monitor PDCCH according to one or more combinations ( \( X_{s}, Y_{s} \) ), where \( X_{s} \) and \( Y_{s} \) are numbers of consecutive slots. Groups of \( X_{s} \) slots are consecutive and nonoverlapping and the \( Y_{s} \) slots are within the \( X_{s} \) slots. The first group of \( X_{s} \) slots starts from the beginning of a subframe. The start of two consecutive groups of \( Y_{s} \) slots is separated by \( X_{s} \) slots.

If a UE monitors PDCCH on a cell according to combination ( \( X_{s}, Y_{s} \) ), the UE can monitor PDCCH for Type1-PDCCH CSS set provided by dedicated higher layer signalling, Type3-PDCCH CSS sets, and USS sets in any slot of the \( Y_{s} \) slots, and the UE can monitor PDCCH for Type0/0A/2-PDCCH CSS set and Typel-PDCCH CSS set provided in SIB1 in any slot of the \( X_{s} \) slots. The UE determines the number of monitored PDCCH candidates and the number of non-overlapped CCEs for combination ( \( X_{s}, Y_{s} \) ) based on all search space sets within the \( X_{s} \) slots, as applicable according to the search space set configurations, and maximum corresponding values are provided in Table 10.1-2B and Table 10.1-3B, respectively.

For \( \mu=6 \), if the UE indicates a capability to monitor PDCCH according to multiple combinations ( \( X_{s}, Y_{s} \) ) and a configuration of search space sets to the UE for PDCCH monitoring on a serving cell results to a separation of every two consecutive groups of \( Y_{s} \) slots that is not smaller than \( X_{s} \) for more than one combinations ( \( X_{s}, Y_{s} \) ), of the multiple combinations ( \( X_{s}, Y_{s} \) ), the UE monitors PDCCH on the cell according to the combination ( \( X_{s}, Y_{s} \) ), from the more than one combinations ( \( X_{s}, Y_{s} \) ), that is associated with the largest maximum number of \( M_{\text {PDCCH }}^{\max , X_{S}, \mu} \) and \( C_{\text {PDCCH }}^{\max , X_{S}, \mu} \) defined in Table 10.1-2B and Table 10.1-3B.

A UE capability for PDCCH monitoring per slot, or per group of \( X_{s} \) slots according to combination \( \left(X_{s}, Y_{s}\right) \), or per span on an active DL BWP of a serving cell is defined by a maximum number of PDCCH candidates and non-overlapped CCEs the UE can monitor per slot, or per group of \( X_{s} \) slots according to combination ( \( X_{s}, Y_{s} \) ), or per span, respectively, on the active DL BWP of the serving cell.

For monitoring of a PDCCH candidate by a UE, if the UE
- has received ssb-PositionsInBurst in SIBI and has not received ssb-PositionsInBurst in ServingCellConfigCommon for a serving cell, and
- does not monitor PDCCH candidates in a Type0-PDCCH CSS set, and

ETSI


--- Page 132  ---


3GPP TS 38.213 version 17.1.0 Release 17
131
ETSI TS 138213 V17.1.0 (2022-05)
- at least one RE for a PDCCH candidate overlaps with at least one RE of a candidate SS/PBCH block corresponding to a SS/PBCH block index provided by ssb-PositionsInBurst in SIBI, the UE is not required to monitor the PDCCH candidate.

For monitoring of a PDCCH candidate by a UE, if the UE
- has received ssb-PositionsInBurst in ServingCellConfigCommon for a serving cell, and
- does not monitor PDCCH candidates in a Type0-PDCCH CSS set, and
- at least one RE for a PDCCH candidate overlaps with at least one RE of a candidate SS/PBCH block corresponding to a SS/PBCH block index provided by ssb-PositionsInBurst in ServingCellConfigCommon,
the UE is not required to monitor the PDCCH candidate.
For monitoring of a PDCCH candidate by a UE, if the UE
- has received ssb-PositionsInBurst in SSB-MTCAdditionalPCI for a serving cell, and
- at least one RE for a PDCCH candidate overlaps with at least one RE of a candidate SS/PBCH block corresponding to a SS/PBCH block index provided by ssb-PositionsInBurst in SSB-MTCAdditionalPCI with same physical cell identity as the one associated with a RS having same quasi-collocation properties as a CORESET for the PDCCH candidate,
the UE is not required to monitor the PDCCH candidate.
A UE is not required to monitor PDCCH candidates for a Type0/0A/1/2-PDCCH CSS set when the active TCI state for a corresponding CORESET is not associated with physCellld in ServingCellConfigCommon.

If a UE monitors the PDCCH candidate for a Type0-PDCCH CSS set on the serving cell according to the procedure described in clause 13, the UE may assume that no SS/PBCH block is transmitted in REs used for monitoring the PDCCH candidate on the serving cell.

If at least one RE of a PDCCH candidate for a UE on the serving cell overlaps with at least one RE of lte-CRSToMatchAround, or of LTE-CRS-PatternList, the UE is not required to monitor the PDCCH candidate.

If a UE is provided availableRB-SetsPerCell, the UE is not required to monitor PDCCH candidates that overlap with any RB from RB sets that are indicated as unavailable for receptions by an available RB set indicator field in DCI format 2_0 as described in clause 11.1.1. If the UE does not obtain the available RB set indicator for a symbol, the UE monitors PDCCH candidates on all RB sets in the symbol.

If a UE can support
- a first set of \( N_{\text {cell }, 0}^{\mathrm{DL}} \) serving cells where the UE is either not provided coresetPoollndex or is provided coresetPoollndex with a single value for all CORESETs on all DL BWPs of each scheduling cell from the first set of serving cells, and
- a second set of \( N_{\text {cell }, 1}^{\mathrm{DL}} \) serving cells where the UE is not provided coresetPoollndex or is provided coresetPoollndex with a value 0 for a first CORESET, and with a value 1 for a second CORESET on any DL BWP of each scheduling cell from the second set of serving cells
the UE determines, for the purpose of reporting pdcch-BlindDetectionCA, a number of serving cells as \( N_{\text {cell }, 0}^{\mathrm{DL}}+R \). \( N_{\text {cells }, 1}^{\mathrm{DL}} \) where \( R \) is a value reported by the UE.

If a UE indicates in UE-NR-Capability a carrier aggregation capability larger than 4 serving cells and the UE is not provided monitoringCapabilityConfig for any downlink cell or if the UE is provided monitoringCapabilityConfig = r15monitoringcapability for all downlink cells where the UE monitors PDCCH, the UE includes in UE-NR-Capability an indication for a maximum number of PDCCH candidates and for a maximum number of non-overlapped CCEs the UE can monitor per slot when the UE is configured for carrier aggregation operation over more than 4 cells. When a UE is not configured for NR-DC operation, the UE determines a capability to monitor a maximum number of PDCCH candidates and a maximum number of non-overlapped CCEs per slot that corresponds to \( N_{\text {cells }}^{\text {cap }} \) downlink cells, where
- \( \quad N_{\text {cells }}^{\text {cap }} \) is \( N_{\text {cells }, 0}^{\mathrm{DL}}+R \cdot N_{\text {cells }, 1}^{\mathrm{DL}} \) if the UE does not provide pdcch-BlindDetectionCA where \( N_{\text {cells }, 0}^{\mathrm{DL}}+N_{\text {cells }, 1}^{\mathrm{DL}} \) is the number of configured downlink serving cells

ETSI


--- Page 133  ---


3GPP TS 38.213 version 17.1.0 Release 17
132
ETSI TS 138213 V17.1.0 (2022-05)
- otherwise, \( N_{\text {cells }}^{\text {cap }} \) is the value of pdcch-BlindDetectionCA

When a UE is configured for NR-DC operation, the UE determines a capability to monitor a maximum number of PDCCH candidates and a maximum number of non-overlapped CCEs per slot that corresponds to \( N_{\text {cells }}^{\text {cap }}=N_{\text {cells }}^{\text {MCG }} \) downlink cells for the MCG where \( N_{\text {cells }}^{\mathrm{MCG}} \) is provided by pdcch-BlindDetection for the MCG and determines a capability to monitor a maximum number of PDCCH candidates and a maximum number of non-overlapped CCEs per slot that corresponds to \( N_{\text {cells }}^{\text {cap }}=N_{\text {cells }}^{\text {SCG }} \) downlink cells for the SCG where \( N_{\text {cells }}^{\text {SCG }} \) is provided by pdcch-BlindDetection for the SCG. When the UE is configured for carrier aggregation operation over more than 4 cells, or for a cell group when the UE is configured for NR-DC operation, the UE does not expect to monitor per slot a number of PDCCH candidates or a number of non-overlapped CCEs that is larger than the maximum number as derived from the corresponding value of \( N_{\text {cells }}^{\text {cap }} \).

When a UE is configured for NR-DC operation with a total of \( N_{\mathrm{NR}-\mathrm{DC}}^{\mathrm{DL}} \), cells downlink cells on both the MCG and the SCG, the UE expects to be provided pdcch-BlindDetection for the MCG and pdcch-BlindDetection for the SCG with values that satisfy
- pdcch-BlindDetection for the MCG + pdcch-BlindDetection for the SCG <= pdcch-BlindDetectionCA, if the UE reports pdcch-BlindDetectionCA, or
- pdcch-BlindDetection for the \( \mathrm{MCG}+ \) pdcch-BlindDetection for the \( \mathrm{SCG}<=N_{\mathrm{NR}-\mathrm{DC}}^{\mathrm{DL}} \), clls , if the UE does not report pdcch-BlindDetectionCA.

For NR-DC operation, the UE may indicate, through pdcch-BlindDetectionMCG-UE and pdcch-BlindDetectionSCG\( U E \), respective maximum values for pdcch-BlindDetection for the MCG and pdcch-BlindDetection for the SCG.

If the UE reports pdcch-BlindDetectionCA,
- the value range of pdcch-BlindDetectionMCG-UE or of pdcch-BlindDetectionSCG-UE is \( [1, \ldots, p d c c h \) -BlindDetectionCA-1], and
- pdcch-BlindDetectionMCG-UE + pdcch-BlindDetectionSCG-UE >= pdcch-BlindDetectionCA.

Otherwise, if \( N_{\mathrm{NR}-\mathrm{DC}, \max }^{\mathrm{DL}, \text { cells }} \) is a maximum total number of downlink cells that the UE can be configured on both the MCG and the SCG for NR-DC as indicated in UE-NR-Capability,
- the value range of pdcch-BlindDetectionMCG-UE or of pdcch-BlindDetectionSCG-UE is [1,2,3], and
- pdcch-BlindDetectionMCG-UE + pdcch-BlindDetectionSCG-UE \( >=N_{\mathrm{NR}-\mathrm{DC}, \max }^{\mathrm{DL}, \text { cells }} \) -

If a UE indicates in UE-NR-Capability a carrier aggregation capability larger than two downlink cells, the UE includes in UE-NR-Capability an indication for a maximum number of PDCCH candidates and a maximum number of nonoverlapped CCEs that the UE can monitor per span when the UE is configured for carrier aggregation operation over more than two downlink cells with monitoringCapabilityConfig \( = \) rl6monitoringcapability. When a UE is not configured for NR-DC operation and the UE is provided monitoringCapabilityConfig \( = \) rl6monitoringcapability for all downlink cells where the UE monitors PDCCH, the UE determines a capability to monitor a maximum number of PDCCH candidates and a maximum number of non-overlapped CCEs per span that corresponds to \( N_{\text {cells }}^{\text {cap-r16 }} \) downlink cells, where
- \( \quad N_{\text {cells }}^{\text {cap-r16 }} \) is the number of configured downlink cells if the UE does not provide pdcch-MonitoringCA
- otherwise, \( N_{\text {cells }}^{\text {cap-r16 }} \) is the value of pdcch-MonitoringCA

When a UE is configured for NR-DC operation and the UE is provided monitoringCapabilityConfig \( = \) rl6monitoringcapability for all downlink cells where the UE monitors PDCCH, the UE determines a capability to monitor a maximum number of PDCCH candidates and a maximum number of non-overlapped CCEs per span that corresponds to
- \( \quad N_{\text {cells }}^{\text {cap-r16 }}=N_{\text {cells }, \mathrm{r16}}^{\text {MCG }} \) downlink cells for the MCG where \( N_{\text {cells }, \mathrm{r16}}^{\text {MCG }} \) is provided by pdcch-BlindDetection2 for the MCG, and
- \( N_{\text {cells }}^{\text {cap-r16 }}=N_{\text {cell } \mathrm{r} 16}^{\text {SCG }} \) downlink cells for the SCG where \( N_{\text {cells } \mathrm{r} 16}^{\text {SCG }} \) is provided by pdcch-BlindDetection2 for the SCG

ETSI


--- Page 134  ---


3GPP TS 38.213 version 17.1.0 Release 17
133
ETSI TS 138213 V17.1.0 (2022-05)

When the UE is configured for carrier aggregation operation over more than 2 cells, or for a cell group when the UE is configured for NR-DC operation, the UE does not expect to monitor per span a number of PDCCH candidates or a number of non-overlapped CCEs that is larger than the maximum number as derived from the corresponding value of \( N_{\text {cells }}^{\text {cap-r16 }} \).

When a UE is configured for NR-DC operation with a total of \( N_{\mathrm{NR}-\mathrm{DC}}^{\mathrm{DL}, \text { cells }} \) downlink cells on both the MCG and the SCG and the UE is provided monitoringCapabilityConfig = rl 6monitoringcapability for all downlink cells where the UE monitors PDCCH, the UE expects to be provided pdcch-BlindDetection2 for the MCG and pdcch-BlindDetection2 for the SCG with values that satisfy
- pdcch-BlindDetection2 for the MCG + pdcch-BlindDetection2 for the SCG <= pdcch-MonitoringCA, if the UE reports pdcch-MonitoringCA, or
- pdcch-BlindDetection2 for the MCG + pdcch-BlindDetection2 for the SCG \( <=N_{\mathrm{NR}-\mathrm{DC}}^{\mathrm{DL}, \text { cells }} \), if the UE does not report pdcch-MonitoringCA

When a UE is configured for NR-DC operation and the UE is provided monitoringCapabilityConfig \( = \) rl6monitoringcapability for all downlink cells where the UE monitors PDCCH, the UE may indicate, through pdcch-BlindDetectionMCG-UE-r16 and pdcch-BlindDetectionSCG-UE-r16, respective maximum values for pdcchBlindDetection for the MCG and pdcch-BlindDetection for the SCG.

If the UE reports pdcch-MonitoringCA,
- the value range of pdcch-BlindDetectionMCG-UE-r16 or of pdcch-BlindDetectionSCG-UE-r16 is [1, ...,pdcchMonitoring CA-1], and
- pdcch-BlindDetectionMCG-UE-r16+pdcch-BlindDetectionSCG-UE-r16>=pdcch-MonitoringCA.

Otherwise, if \( N_{\mathrm{NR}-\mathrm{DC}, \text { max, r16 }}^{\mathrm{DL}, \text { clls }} \) is a maximum total number of downlink cells for which the UE is provided monitoringCapabilityConfig = r16monitoringcapability and the UE is configured on both the MCG and the SCG for NR-DC as indicated in UE-NR-Capability
- the value of pdcch-BlindDetectionMCG-UE-r16 or of pdcch-BlindDetectionSCG-UE-r16 is 1,
- pdcch-BlindDetectionMCG-UE-r16+pdcch-BlindDetectionSCG-UE-r16>= \( N_{\mathrm{NR}-\mathrm{DC}, \max , \mathrm{r} 16}^{\mathrm{DL} 601 \mathrm{c}} \)

If a UE indicates in UE-NR-Capability a carrier aggregation capability larger than four downlink cells, the UE includes in UE-NR-Capability an indication for a maximum number of PDCCH candidates and a maximum number of nonoverlapped CCEs that the UE can monitor per group of \( X_{s} \) slots when the UE is configured for carrier aggregation operation over more than four downlink cells with SCS configuration \( \mu \in\{5,6\} \). When a UE is not configured for NRDC operation for all downlink cells where the UE monitors PDCCH, the UE determines a capability to monitor a maximum number of PDCCH candidates and a maximum number of non-overlapped CCEs per group of \( X_{s} \) slots that corresponds to \( N_{\text {cells }}^{\text {cap-r17 }} \) downlink cells, where
- \( \quad N_{\text {cells }}^{\text {cap-r17 }} \) is the number of configured downlink cells if the UE does not provide pdcch-MonitoringCA-r17
- otherwise, \( N_{\text {cells }}^{\text {cap-r17 }} \) is the value of pdcch-MonitoringCA-r17

When the UE is configured for carrier aggregation operation over more than 4 cells, the UE does not expect to monitor per group of \( X_{s} \) slots a number of PDCCH candidates or a number of non-overlapped CCEs that is larger than the maximum number as derived from the corresponding value of \( N_{\text {cells }}^{\text {cap-r17 }} \).

If a UE indicates in UE-NR-Capability a carrier aggregation capability larger than one downlink cell with monitoringCapabilityConfig = r15monitoringcapability or larger than one downlink cell with monitoringCapabilityConfig = rl6monitoringcapability, the UE includes in UE-NR-Capability an indication for a maximum number of PDCCH candidates and a maximum number of non-overlapped CCEs the UE can monitor for downlink cells with monitoringCapabilityConfig \( = \) r15monitoringcapability or for downlink cells with monitoringCapabilityConfig = r16monitoringcapability when the UE is configured for carrier aggregation operation over more than two downlink cells with at least one downlink cell with monitoringCapabilityConfig = r15monitoringcapability and at least one downlink cell with monitoringCapabilityConfig \( = \) rl6monitoringcapability. When a UE is not configured for NR-DC operation, the UE determines a capability to monitor a maximum number of

ETSI


--- Page 135  ---


3GPP TS 38.213 version 17.1.0 Release 17
134
ETSI TS 138213 V17.1.0 (2022-05)

PDCCH candidates and a maximum number of non-overlapped CCEs per slot or per span that corresponds to \( N_{\text {cells }, r 15}^{\text {cap }-r 16} \) downlink cells or to \( N_{\text {cells }, r 16}^{\text {cap }-r 16} \) downlink cells, respectively, where
- \( \quad N_{\text {cells } r 15}^{\text {cap }-r 16} \) is the number of configured downlink cells if the UE does not provide pdcch-BlindDetectionCAI
- otherwise,
- if the UE reports only one combination of (pdcch-BlindDetectionCA1,pdcch-BlindDetectionCA2), \( N_{\text {cells }, r 15}^{\text {cap }-r 16} \) is the value of pdcch-BlindDetectionCAI
- else, \( N_{\text {cells, } r 15}^{\text {cap-r16 }} \) is the value of pdcch-BlindDetectionCAl from a combination of (pdcch-BlindDetectionCAl, pdcch-BlindDetectionCA2) that is provided by pdcch-BlindDetectionCA-Comblndicator
and
- \( \quad N_{\text {cells } r 16}^{\text {cap-r } 16} \) is the number of configured downlink cells if the UE does not provide pdcch-BlindDetectionCA2
- otherwise,
- if the UE reports only one combination of (pdcch-BlindDetectionCA1, pdcch-BlindDetectionCA2), \( N_{\text {cells }, r 16}^{\text {cap }-r 16} \) is the value of \( p d c c h \)-BlindDetectionCA2
- else, \( N_{\text {cells, r16 }}^{\text {cap-r16 }} \) is the value of pdcch-BlindDetectionCA2 from a combination of (pdcch-BlindDetectionCAl, pdcch-BlindDetectionCA2) that is provided by pdcch-BlindDetectionCA-Comblndicator

If a UE indicates in UE-NR-Capability a carrier aggregation capability larger than one downlink cell with monitoringCapabilityConfig \( = \) r15monitoringcapability or larger than one downlink cell with monitoringCapabilityConfig \( = \) r17monitoringcapability, the UE includes in UE-NR-Capability an indication for a maximum number of PDCCH candidates and a maximum number of non-overlapped CCEs the UE can monitor for downlink cells with monitoringCapabilityConfig \( = \) r15monitoringcapability or for downlink cells with monitoringCapabilityConfig \( = \) r 17 monitoringcapability when the UE is configured for carrier aggregation operation over more than two downlink cells with at least one downlink cell with monitoringCapabilityConfig \( = \) r15monitoringcapability and at least one downlink cell has SCS configuration \( \mu \in\{5,6\} \). When a UE is not configured for NR-DC operation, the UE determines a capability to monitor a maximum number of PDCCH candidates and a maximum number of non-overlapped CCEs per slot or per group of \( X_{s} \) slots that corresponds to \( N_{\text {cells }, r 15 / r 17}^{\text {cap }-r 17} \) downlink cells or to \( N_{\text {cells }, r 17 / r 15}^{\text {cap }-r 17} \) downlink cells, respectively, where
- \( \quad N_{\text {cells }, r 15 / r 17}^{\text {cap }-r 17} \) is the number of configured downlink cells if the UE does not provide pdcch-BlindDetectionCAr15
- otherwise,
- if the UE reports only one combination of (pdcch-BlindDetectionCAr15, pdcch-BlindDetectionCAr17), \( N_{\text {cells } r 15 / r 17}^{\text {cap } r 17} \) is the value of pdcch-BlindDetectionCAr15
- else, \( N_{\text {cells }, r 15 / r 17}^{\text {cap }-r 17} \) is the value of pdcch-BlindDetectionCAr15 from a combination of (pdcchBlindDetectionCAr15, pdcch-BlindDetectionCAr17) that is provided by pdcch-BlindDetectionCA-CombIndicator-r17
and
- \( \quad N_{\text {cells }, r 17 / r 15}^{\text {cap }-r 17} \) is the number of configured downlink cells if the UE does not provide pdcch-BlindDetectionCAr17
- otherwise,
- if the UE reports only one combination of (pdcch-BlindDetectionCAr15, pdcch-BlindDetectionCAr17), \( N_{\text {cells }, r 17 / r 15}^{\text {cap }-r 17} \) is the value of pdcch-BlindDetectionCAr17
- else, \( N_{\text {cells }, r 17 / r 15}^{\text {cap }-r 17} \) is the value of pdcch-BlindDetectionCAr17 from a combination of (pdcchBlindDetectionCAr15, pdcch-BlindDetectionCAr17) that is provided by pdcch-BlindDetectionCA-CombIndicator-r17

ETSI


--- Page 136  ---


3GPP TS 38.213 version 17.1.0 Release 17
135
ETSI TS 138213 V17.1.0 (2022-05)

If a UE indicates in UE-NR-Capability a carrier aggregation capability larger than one downlink cell with monitoringCapabilityConfig = r16monitoringcapability or larger than one downlink cell with monitoringCapabilityConfig = r17monitoringcapability, the UE includes in UE-NR-Capability an indication for a maximum number of PDCCH candidates and a maximum number of non-overlapped CCEs the UE can monitor for downlink cells with monitoringCapabilityConfig \( = \) rl6monitoringcapability or for downlink cells with monitoringCapabilityConfig = r17monitoringcapability when the UE is configured for carrier aggregation operation over more than two downlink cells with at least one downlink cell with monitoringCapabilityConfig = rl6monitoring capability and with at least one downlink cell with monitoringCapabilityConfig = r17monitoringcapability. When a UE is not configured for NR-DC operation, the UE determines a capability to monitor a maximum number of PDCCH candidates and a maximum number of non-overlapped CCEs per span or per group of \( X_{s} \) slots that corresponds to \( N_{\text {cells }, r 16 / r 17}^{\text {cap }-r 17} \) downlink cells or to \( N_{\text {cells }, r 17 / r 16}^{\text {cap }-r 17} \) downlink cells, respectively, where
- \( \quad N_{\text {cells }, r 16 / r 17}^{\text {cap }-r 17} \) is the number of configured downlink cells if the UE does not provide pdcch-BlindDetectionCAr16
- otherwise,
- if the UE reports only one combination of (pdcch-BlindDetectionCAr16, pdcch-BlindDetectionCAr17), \( N_{\text {cells }, r 16 / r 17}^{\text {cap-r17 }} \) is the value of pdcch-BlindDetectionCAr16
- else, \( N_{\text {cells }, r 16 / r 17}^{\text {cap }-r 17} \) is the value of pdcch-BlindDetectionCAr16 from a combination of (pdcchBlindDetectionCAr16, pdcch-BlindDetectionCAr17) that is provided by pdcch-BlindDetectionCA-Comblndicator-r17
and
- \( \quad N_{\text {cells }, r 17 / r 16}^{\text {cap }-r 17} \) is the number of configured downlink cells if the UE does not provide pdcch-BlindDetectionCAr 17
- otherwise,
- if the UE reports only one combination of (pdcch-BlindDetectionCAr16, pdcch-BlindDetectionCAr17), \( N_{\text {cells }, r 17 / r 16}^{\text {cap-r17 }} \) is the value of pdcch-BlindDetectionCAr17
- else, \( N_{\text {cells }, r 17 / r 16}^{\text {cap }-r 17} \) is the value of pdcch-BlindDetectionCAr17 from a combination of (pdcchBlindDetectionCAr16, pdcch-BlindDetectionCAr17) that is provided by pdcch-BlindDetectionCA-Comblndicator-r17

If a UE indicates in UE-NR-Capability a carrier aggregation capability larger than one downlink cell with monitoringCapabilityConfig = r15monitoringcapability, or larger than one downlink cell with monitoringCapabilityConfig = r16monitoringcapability, or larger than one downlink cell with monitoringCapabilityConfig = r17monitoringcapability, the UE includes in UE-NR-Capability an indication for a maximum number of PDCCH candidates and a maximum number of non-overlapped CCEs the UE can monitor for downlink cells with monitoringCapabilityConfig = r15monitoringcapability, or for downlink cells with monitoringCapabilityConfig = r16monitoringcapability, or for downlink cells with monitoringCapabilityConfig = r17monitoringcapability when the UE is configured for carrier aggregation operation over more than three downlink cells with at least one downlink cell with monitoringCapabilityConfig = r15monitoringcapability, at least one downlink cell with monitoringCapabilityConfig \( = \) rl 6monitoringcapability and at least one downlink cell with monitoringCapabilityConfig \( = \) r17monitoringcapability. When a UE is not configured for NR-DC operation, the UE determines a capability to monitor a maximum number of PDCCH candidates and a maximum number of nonoverlapped CCEs per slot or per span or per group of \( X_{s} \) slots that corresponds to \( N_{\text {cells }, r 15 /\{r 16, r 17\}}^{\text {cap }-r 17} \) downlink cells or to \( N_{\text {cells }, r 16 /\{r 15, r 17\}}^{\text {cap }-r 17} \) downlink cells or to \( N_{\text {cells }, r 17 /\{r 15, r 16\}}^{\text {capp }-r 17} \) downlink cells, respectively, where
- \( \quad N_{\text {cells }, r 15 /\{r 16, r 17\}}^{\text {cap }-r 17} \) is the number of configured downlink cells if the UE does not provide pdcchBlindDetectionCAr15
- otherwise,
- if the UE reports only one combination of (pdcch-BlindDetectionCAr15, pdcch-BlindDetectionCAr 16, pdcchBlindDetectionCAr17), \( N_{\text {cells }, r 15 /\{r 16, r 17\}}^{\text {cap-r17 }} \) is the value of pdcch-BlindDetectionCAr15

ETSI


--- Page 137  ---


3GPP TS 38.213 version 17.1.0 Release 17
136
ETSI TS 138213 V17.1.0 (2022-05)
- else, \( N_{\text {cells }, r 15 /\{r 16, r 17\}}^{\text {cap }-r 17} \) is the value of pdcch-BlindDetectionCAr15 from a combination of (pdcchBlindDetectionCAr15, pdcch-BlindDetectionCAr16, pdcch-BlindDetectionCAr17) that is provided by pdcch-BlindDetectionCA-CombIndicator-r17
- \( \quad N_{\text {cells }, r 16 /\{r 15, r 17\}}^{\text {cap }-r 17} \) is the number of configured downlink cells if the UE does not provide pdcchBlindDetectionCAr16
- otherwise,
- if the UE reports only one combination of (pdcch-BlindDetectionCAr15, pdcch-BlindDetectionCAr16, pdcchBlindDetectionCAr17), \( N_{\text {cells }, r 16 /\{r 15, r 17\}}^{\text {cap }-r 17} \) is the value of pdcch-BlindDetectionCAr16
- else, \( N_{\text {cells }, r 16 /\{r 15, r 17\}}^{\text {cap }-r 17} \) is the value of pdcch-BlindDetectionCAr16 from a combination of (pdcchBlindDetectionCAr15, pdcch-BlindDetectionCAr16, pdcch-BlindDetectionCAr17) that is provided by pdcch-BlindDetectionCA-CombIndicator-r17
and
- \( \quad N_{\text {cells }, r 17 /\{r 15, r 16\}}^{\text {cap }-r 17} \) is the number of configured downlink cells if the UE does not provide pdcchBlindDetectionCAr17
- otherwise,
- if the UE reports only one combination of (pdcch-BlindDetectionCAr15, pdcch-BlindDetectionCAr16, pdcchBlindDetectionCAr17), \( N_{\text {cells }, r 17 /\{r 15, r 16\}}^{\text {cap }-r 17} \) is the value of pdcch-BlindDetectionCAr17
- else, \( N_{\text {cells }, r 17 /\{r 15, r 16\}}^{\text {cap }-r 17} \) is the value of pdcch-BlindDetectionCAr17from a combination of (pdcchBlindDetectionCAr15, pdcch-BlindDetectionCAr16, pdcch-BlindDetectionCAr17) that is provided by pdcch-BlindDetectionCA-CombIndicator-r17

When a UE is configured for NR-DC operation and is provided monitoringCapabilityConfig \( = \) r15monitoringcapability for at least one downlink cell and monitoringCapabilityConfig \( = \) rl6monitoringcapability for at least one downlink cell where the UE monitors PDCCH, the UE determines a capability to monitor a maximum number of PDCCH candidates and a maximum number of non-overlapped CCEs that corresponds to
- \( \quad N_{\text {cell } \mathrm{s}_{\mathrm{r} 15}}^{\text {cap-r16 }}=N_{\text {cells } \mathrm{r} 15}^{\text {MCG }} \) downlink cells for the MCG where \( N_{\text {cells } \mathrm{r} 15}^{\text {MCG }} \) is provided by pdcch-BlindDetection3 for the MCG ,
- \( \quad N_{\text {cells }, \mathrm{r} 15}^{\text {cap-r16 }}=N_{\text {cells }, \mathrm{r} 15}^{\text {SCG }} \) downlink cells for the SCG where \( N_{\text {cells }, \mathrm{r} 15}^{\text {SCG }} \) is provided by pdcch-BlindDetection3 for the SCG, and
- \( \quad N_{\text {cell } \mathrm{s}, \mathrm{r} 16}^{\text {cap-r16 }}=N_{\text {cell } \mathrm{s} 16}^{\text {MCG }} \) downlink cells for the MCG where \( N_{\text {cells }, \mathrm{r} 16}^{\text {MCG }} \) is provided by pdcch-BlindDetection2 for the MCG,
- \( \quad N_{\text {cells } \mathrm{r} 16}^{\text {cap-r16 }}=N_{\text {cell } \mathrm{s}, \mathrm{r} 16}^{\text {SCG }} \) downlink cells for the SCG where \( N_{\text {cells }, \mathrm{r} 16}^{\text {SCG }} \) is provided by pdcch-BlindDetection2 for the SCG

When a UE is configured for carrier aggregation operation over more than two downlink cells with at least one downlink cell with monitoringCapabilityConfig \( = \) r15monitoringcapability, at least one downlink cell with monitoringCapabilityConfig \( = \) rl6monitoringcapability, and no downlink cell has SCS configuration \( \mu \in\{5,6\} \), or for a cell group when the UE is configured for NR-DC operation, the UE does not expect to
- monitor per slot a number of PDCCH candidates or a number of non-overlapped CCEs that is larger than the maximum number as derived from the corresponding value of \( N_{\text {cell } \mathrm{s}, \mathrm{r} 15}^{\text {cap-r16 }} \), and
- monitor per span a number of PDCCH candidates or a number of non-overlapped CCEs that is larger than the maximum number as derived from the corresponding value of \( N_{\text {cells,r16 }}^{\text {cap-r16 }} \)

When the UE is configured for carrier aggregation operation over more than two downlink cells with at least one downlink cell with monitoringCapabilityConfig \( = \) r15monitoringcapability, at least one downlink cell with

ETSI


--- Page 138  ---


3GPP TS 38.213 version 17.1.0 Release 17
137
ETSI TS 138213 V17.1.0 (2022-05)

monitoringCapabilityConfig \( =r 17 \) monitoringcapability, and no downlink cell with monitoringCapabilityConfig \( = \) rl6monitoringcapability, the UE does not expect to
- monitor per slot a number of PDCCH candidates or a number of non-overlapped CCEs that is larger than the maximum number as derived from the corresponding value of \( N_{\text {cells } r 15 / r 17}^{\text {cap }-r 17} \), and
- monitor per group of \( X_{s} \) slots a number of PDCCH candidates or a number of non-overlapped CCEs that is larger than the maximum number as derived from the corresponding value of \( N_{\text {cells } r 17 / r 15}^{\text {cap }-r 17} \)

When the UE is configured for carrier aggregation operation over more than two downlink cells with at least one downlink cell with monitoringCapabilityConfig \( = \) rl6monitoringcapability, at least one downlink cell with monitoringCapabilityConfig = r17monitoringcapability, and no downlink cell with monitoringCapabilityConfig = rl5monitoringcapability, the UE does not expect to
- monitor per span a number of PDCCH candidates or a number of non-overlapped CCEs that is larger than the maximum number as derived from the corresponding value of \( N_{\text {cells } r 16 / r 17}^{\text {cap }-r 17} \), and
- monitor per group of \( X_{s} \) slots a number of PDCCH candidates or a number of non-overlapped CCEs that is larger than the maximum number as derived from the corresponding value of \( N_{\text {cells } r 17 / r 16}^{\text {cap }-r 17} \)

When the UE is configured for carrier aggregation operation over more than three downlink cells with at least one downlink cell with monitoringCapabilityConfig \( = \) r15monitoringcapability, at least one downlink cell with monitoringCapabilityConfig = r16monitoringcapability, and at least one downlink cell with monitoringCapabilityConfig \( = \) r17monitoringcapability, the UE does not expect to
- monitor per slot a number of PDCCH candidates or a number of non-overlapped CCEs that is larger than the maximum number as derived from the corresponding value of \( N_{\text {cells }, r 15 /\{r 16, r 17\}}^{\text {cap }-r 17} \), and
- monitor per span a number of PDCCH candidates or a number of non-overlapped CCEs that is larger than the maximum number as derived from the corresponding value of \( N_{\text {cells }, r 16 /\{r 15, r 17\}}^{\text {cap }-r 17} \), and
- monitor per group of \( X_{s} \) slots a number of PDCCH candidates or a number of non-overlapped CCEs that is larger than the maximum number as derived from the corresponding value of \( N_{\text {cells, } r 17 /\{r 15, r 16\}}^{\text {cap }-r 17} \)

When a UE is configured for NR-DC operation with a total of \( N_{\mathrm{NR}-\mathrm{DC}}^{\mathrm{DL}} \) downlink cells on both the MCG and the SCG and the UE is provided monitoringCapabilityConfig \( = \) r15monitoringcapability for \( N_{\mathrm{NR}-\mathrm{DC}, \mathrm{r} 15}^{\mathrm{DL}} \) downlink cells and monitoringCapabilityConfig \( = \) rl6monitoringcapability for \( N_{\mathrm{NR}-\mathrm{DC}, \mathrm{r} 16}^{\mathrm{DL}} \), downlink cells where the UE monitors PDCCH, the UE expects to be provided pdcch-BlindDetection 3 and pdcch-BlindDetection 2 for the MCG, and pdcchBlindDetection3 and pdcch-BlindDetection2 for the SCG with values that satisfy
- pdcch-BlindDetection3 for the MCG + pdcch-BlindDetection3 for the SCG <= pdcch-BlindDetectionCA1, if the UE reports pdcch-BlindDetectionCA1, or
- pdcch-BlindDetection3 for the MCG + pdcch-BlindDetection3 for the SCG \( <=N_{\mathrm{NR}-\mathrm{DC}, \mathrm{r} 15}^{\mathrm{DL}} \), if the UE does not report pdcch-BlindDetectionCAI
and
- pdcch-BlindDetection2 for the MCG + pdcch-BlindDetection2 for the SCG <= pdcch-BlindDetectionCA2, if the UE reports pdcch-BlindDetectionCA2, or
- pdcch-BlindDetection2 for the \( \mathrm{MCG}+ \) pdcch-BlindDetection2 for the \( \mathrm{SCG}<=\mathrm{N}_{\mathrm{NR}-\mathrm{DC}, \mathrm{r} 16}^{\mathrm{DL}} \), if the UE does not report pdcch-BlindDetectionCA2

When a UE is configured for NR-DC operation and is provided monitoringCapabilityConfig \( = \) r15monitoringcapability for at least one downlink cell and monitoringCapabilityConfig \( = \) rl6monitoringcapability for at least one downlink cell where the UE monitors PDCCH, the UE may indicate, through pdcch-BlindDetectionMCG-UEI and pdcch-BlindDetectionSCG-UE1, respective maximum values for pdcch-BlindDetection 3 for the MCG and pdcchBlindDetection3 for the SCG, and through pdcch-BlindDetectionMCG-UE2 and pdcch-BlindDetectionSCG-UE2 respective maximum values for pdcch-BlindDetection2 for the MCG and pdcch-BlindDetection2 for the SCG.

ETSI


--- Page 139  ---


3GPP TS 38.213 version 17.1.0 Release 17
138
ETSI TS 138213 V17.1.0 (2022-05)

If the UE reports pdcch-BlindDetectionCA1,
- the value range of pdcch-BlindDetectionMCG-UEl or of pdcch-BlindDetectionSCG-UEl is \( [0,1, \ldots, p d c c h \) BlindDetectionCAl], and
- pdcch-BlindDetectionMCG-UEl + pdcch-BlindDetectionSCG-UEl>=pdcch-BlindDetectionCAl.

Otherwise, if \( N_{\mathrm{NR}-\mathrm{DC} \text { max, } \mathrm{r} 15}^{\mathrm{DL}, \text { is a maximum total number of downlink cells for which the UE is provided }} \) monitoringCapabilityConfig = r15monitoringcapability and the UE is configured on both the MCG and the SCG for NR-DC as indicated in UE-NR-Capability
- the value range of pdcch-BlindDetectionMCG-UEl or of pdcch-BlindDetectionSCG-UEl is \( [0,1,2] \),
- pdcch-BlindDetectionMCG-UEl + pdcch-BlindDetectionSCG-UEl>= \( N_{\mathrm{NR}-\mathrm{DC}_{\mathrm{m}} \mathrm{max}_{\mathrm{i}} \mathrm{r} 15}^{\mathrm{DL}, \mathrm{cells}} \)

If the UE reports pdcch-BlindDetectionCA2
- the value range of pdcch-BlindDetectionMCG-UE2 or of pdcch-BlindDetectionSCG-UE2 is \( [0,1, \ldots, p d c c h \) BlindDetectionCA2], and
- pdcch-BlindDetectionMCG-UE2 + pdcch-BlindDetectionSCG-UE2>= pdcch-BlindDetectionCA2.

Otherwise, if \( N_{\mathrm{NR}-\mathrm{DC} \text { max, } \mathrm{r} 16}^{\mathrm{DL}, \text { is a maximum total number of downlink cells for which the } \mathrm{UE} \text { is provided }} \) monitoringCapabilityConfig = r16monitoringcapability and the UE is configured on both the MCG and the SCG for NR-DC as indicated in UE-NR-Capability
- the value range of pdcch-BlindDetectionMCG-UE2 or of pdcch-BlindDetectionSCG-UE2 is \( [0,1] \),
- pdcch-BlindDetectionMCG-UE2 + pdcch-BlindDetectionSCG-UE2>= \( N_{\mathrm{NR}-\mathrm{DC}, \max , \mathrm{r} 16}^{\mathrm{DL}, \text { ells }} \)
10.1 UE procedure for determining physical downlink control channel assignment

A set of PDCCH candidates for a UE to monitor is defined in terms of PDCCH search space sets. A search space set can be a CSS set or a USS set. A UE monitors PDCCH candidates in one or more of the following search spaces sets
- a Type0-PDCCH CSS set on the primary cell of the MCG configured by
- pdcch-ConfigSIB1 in MIB or by searchSpaceSIB1 in PDCCH-ConfigCommon or by searchSpaceZero in PDCCH-ConfigCommon for a DCI format \( 1 \_0 \) with CRC scrambled by a SI-RNTI, or
- searchSpaceZero in PDCCH-ConfigCommon when pdcch-Config-MCCH and pdcch-Config-MTCH are not provided, for a DCI format \( 4 \_0 \) with CRC scrambled by a MCCH-RNTI or a G-RNTI
- a Type0A-PDCCH CSS set configured by searchSpaceOtherSystemInformation in PDCCH-ConfigCommon for a DCI format 1 _ 0 with CRC scrambled by a SI-RNTI on the primary cell of the MCG
- a Type0B-PDCCH CSS set configured by searchSpaceBroadcast in pdcch-Config-MCCH and pdcch-Config\( M T C H \) for a DCI format with CRC scrambled by a MCCH-RNTI or a G-RNTI, on the primary cell of the MCG
- a Type1-PDCCH CSS set configured by ra-SearchSpace in PDCCH-ConfigCommon for a DCI format 10 with CRC scrambled by a RA-RNTI, a MsgB-RNTI, or a TC-RNTI on the primary cell
- a Type1A-PDCCH CSS set configured by sdt-SearchSpace in PDCCH-ConfigCommon for a DCI format with CRC scrambled by a C-RNTI or a CS-RNTI on the primary cell as described in clause 19.1
- a Type2-PDCCH CSS set configured by pagingSearchSpace in PDCCH-ConfigCommon for a DCI format \( 1 \_0 \) with CRC scrambled by a P-RNTI on the primary cell of the MCG
- a Type2A-PDCCH CSS set configured by peiSearchSpace in DownlinkConfigCommonSIB for a DCI format 2_7 with CRC scrambled by a PEI-RNTI on the primary cell of the MCG
- a Type3-PDCCH CSS set configured by

ETSI


--- Page 140  ---


3GPP TS 38.213 version 17.1.0 Release 17
139
ETSI TS 138213 V17.1.0 (2022-05)
- SearchSpace in PDCCH-Config with searchSpaceType \( = \) common for DCI formats with CRC scrambled by INT-RNTI, SFI-RNTI, TPC-PUSCH-RNTI, TPC-PUCCH-RNTI, TPC-SRS-RNTI, or CI-RNTI and, only for the primary cell, C-RNTI, MCS-C-RNTI, CS-RNTI(s), or PS-RNTI, or
- SearchSpace-Multicast in PDCCH-Config-Multicast for DCI formats with CRC scrambled by G-RNTI, or G-CS-RNTI, or
- searchSpaceBroadcast in pdcch-Config-MCCH and pdcch-Config-MTCH on secondary cell for a DCI format \( 4 \_0 \) with CRC scrambled by a MCCH-RNTI or a G-RNTI, and
- a USS set configured by
- SearchSpace in PDCCH-Config with searchSpaceType \( = \) ue-Specific for DCI formats with CRC scrambled by C-RNTI, MCS-C-RNTI, SP-CSI-RNTI, CS-RNTI(s), SL-RNTI, SL-CS-RNTI, or SL Semi-Persistent Scheduling V-RNTI, or
- sdt-CG-SearchSpace for DCI formats with CRC scrambled by C-RNTI or CS-RNTI as described in clause 19.1.

In the following, DCI formats with CRC scrambled by C-RNTI or CS-RNTI or MCS-C-RNTI are also referred to as unicast DCI formats, DCI formats with CRC scrambled by G-RNTI or G-CS-RNTI are also referred to as multicast DCI formats, and DCI formats with CRC scrambled by MCCH-RNTI or G-RNTI for MTCH scheduling PDSCH receptions are also referred to as broadcast DCI formats.

For a DL BWP, if a UE is not provided searchSpaceSIB1 for Type0-PDCCH CSS set by PDCCH-ConfigCommon, the UE does not monitor PDCCH candidates for a Type0-PDCCH CSS set on the DL BWP. The Type0-PDCCH CSS set is defined by the CCE aggregation levels and the number of PDCCH candidates per CCE aggregation level given in Table 10.1-1.

If the active DL BWP and the initial DL BWP for a UE have same SCS and same CP length and the active DL BWP includes all RBs of the CORESET with index 0 , or the active DL BWP is the initial DL BWP, or the active DL BWP includes all RBs of an MBS frequency resource provided by cfr-Config-MCCH-MTCH as described in clause 18, the CORESET configured for Type0-PDCCH CSS set has CORESET index 0 and the Type0-PDCCH CSS set has search space set index 0 .

If the active DL BWP and an MBS frequency resource provided by cfr-Config-MCCH-MTCH for a UE have same SCS and same CP length and the active DL BWP includes all RBs of the MBS frequency resource, and if the UE is provided searchSpaceBroadcast for Type0B-PDCCH CSS set on the primary cell or for Type3-PDCCH CSS set on a secondary cell, the UE monitors PDCCH for detection of broadcast DCI formats, as described in clause 18, on the active DL BWP.

For a DL BWP, if a UE is not provided searchSpaceOtherSystemInformation for Type0A-PDCCH CSS set, the UE does not monitor PDCCH for Type0A-PDCCH CSS set on the DL BWP. The CCE aggregation levels and the number of PDCCH candidates per CCE aggregation level for Type0A-PDCCH CSS set are given in Table 10.1-1.

For a DL BWP, if a UE is not provided ra-SearchSpace for Type1-PDCCH CSS set, the UE does not monitor PDCCH for Type1-PDCCH CSS set on the DL BWP. If the UE has not been provided a Type3-PDCCH CSS set, or a Type1APDCCH CSS set, or a USS set and the UE has received a C-RNTI and has been provided a Typel-PDCCH CSS set, the UE monitors PDCCH candidates for DCI format \( 0 \_0 \) and DCI format \( 1 \_0 \) with CRC scrambled by the C-RNTI in the Type1-PDCCH CSS set.

If a UE is not provided pagingSearchSpace for Type2-PDCCH CSS set, the UE does not monitor PDCCH for Type2PDCCH CSS set on the DL BWP. The CCE aggregation levels and the number of PDCCH candidates per CCE aggregation level for Type2-PDCCH CSS set are given in Table 10.1-1.

If a UE is not provided peiSearchSpace for Type2A-PDCCH CSS set, the UE does not monitor PDCCH for Type2APDCCH CSS set on the DL BWP. The CCE aggregation levels and the maximum number of PDCCH candidates per CCE aggregation level for Type2A-PDCCH CSS set are given in Table 10.1-1. If the UE is provided peiSearchSpace with zero value for the Type2A-PDCCH CSS set index, and for the SS/PBCH block and CORESET multiplexing patterns 2 and 3, the UE determines PDCCH monitoring occasions as described in clause 13.

If a UE is provided a zero value for searchSpaceID in PDCCH-ConfigCommon for a Type0/0A/2-PDCCH CSS set, or is not provided searchSpaceBroadcast, the UE determines monitoring occasions for PDCCH candidates of the Type0/0A/2-PDCCH CSS set as described in clause 13, and the UE is provided a C-RNTI, the UE monitors PDCCH

ETSI


--- Page 141  ---


3GPP TS 38.213 version 17.1.0 Release 17
140
ETSI TS 138213 V17.1.0 (2022-05)

candidates only at monitoring occasions associated with a SS/PBCH block, where the SS/PBCH block is determined by the most recent of
- a MAC CE activation command indicating a TCI state of the active BWP that includes a CORESET with index 0 , as described in [6, TS 38.214], where the TCI-state includes a CSI-RS which is quasi-co-located with the SS/PBCH block, or
- a random access procedure that is not initiated by a PDCCH order that triggers a contention-free random access procedure

If a UE monitors PDCCH candidates for DCI formats with CRC scrambled by a C-RNTI and the UE is provided a nonzero value for searchSpacelD in PDCCH-ConfigCommon for a Type0/0A/2-PDCCH CSS set, or monitors PDCCH candidates for DCI formats with CRC scrambled by a MCCH-RNTI or a G-RNTI and the UE is provided a non-zero value for searchSpaceBroadcast in pdcch-Config-MCCH and pdcch-Config-MTCH for a Type0/0B-PDCCH CSS set, the UE determines monitoring occasions for PDCCH candidates of the Type0/0A/2-PDCCH CSS set, or of the Type0/0B-PDCCH set, respectively, based on the search space set associated with the value of searchSpaceID.

The UE may assume that the DM-RS antenna port associated with PDCCH receptions in the CORESET configured by pdcch-ConfigSIBI in MIB, the DM-RS antenna port associated with corresponding PDSCH receptions, and the corresponding SS/PBCH block are quasi co-located with respect to average gain, quasi co-location 'type A' and 'typeD' properties, when applicable [6, TS 38.214], if the UE is not provided a TCI state indicating quasi co-location information of the DM-RS antenna port for PDCCH reception in the CORESET. The value for the DM-RS scrambling sequence initialization is the cell ID. For operation without shared spectrum channel access in FR1 and FR2-1, a SCS is provided by subCarrierSpacingCommon in MIB. For operation with shared spectrum channel access in FR1 and for operation in FR2-2, a SCS is same as the SCS of a corresponding SS/PBCH block.

For single cell operation or for operation with carrier aggregation in a same frequency band, a UE does not expect to monitor a PDCCH in a Type0/0A/0B/2/3-PDCCH CSS set or in a USS set if a DM-RS for monitoring a PDCCH in a Typel-PDCCH CSS set is not configured with same qcl-Type set to 'typeD' properties [6, TS 38.214] with a DM-RS for monitoring the PDCCH in the Type0/0A/0B/2/3-PDCCH CSS set or in the USS set, and if the PDCCH or an associated PDSCH overlaps in at least one symbol with a PDCCH the UE monitors in a Type1-PDCCH CSS set or with an associated PDSCH.

If a UE is provided
- one or more search space sets by corresponding one or more of searchSpaceZero, searchSpaceSIB1, searchSpaceOtherSystemInformation, pagingSearchSpace, ra-SearchSpace, and
- a C-RNTI, an MCS-C-RNTI, or a CS-RNTI
the UE monitors PDCCH candidates for DCI format \( 0 \_0 \) and DCI format \( 1 \_0 \) with CRC scrambled by the C-RNTI, the MCS-C-RNTI, or the CS-RNTI in the one or more search space sets in a slot where the UE monitors PDCCH candidates for at least a DCI format \( 0 \_0 \) or a DCI format \( 1 \_0 \) with CRC scrambled by SI-RNTI, RA-RNTI, MsgBRNTI, or P-RNTI.

If a UE is provided
- one or more search space sets by corresponding one or more of searchSpaceZero, searchSpaceSIB1, searchSpaceOtherSystemInformation, pagingSearchSpace, peiSearchSpace, ra-SearchSpace, or a CSS set by PDCCH-Config, and
- a SI-RNTI, a P-RNTI, a PEI-RNTI, a RA-RNTI, a MsgB-RNTI, a SFI-RNTI, an INT-RNTI, a TPC-PUSCHRNTI, a TPC-PUCCH-RNTI, or a TPC-SRS-RNTI
then, for a RNTI from any of these RNTIs, the UE does not expect to process information from more than one DCI format with CRC scrambled with the RNTI per slot.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.1-1: CCE aggregation levels and maximum number of PDCCH candidates per CCE aggregation level for CSS sets configured by searchSpaceSIB1}
\begin{tabular}{|c|c|}
\hline CCE Aggregation Level & Number of Candidates \\
\hline 4 & 4 \\
\hline 8 & 2 \\
\hline 16 & 1 \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 142  ---


3GPP TS 38.213 version 17.1.0 Release 17
141
ETSI TS 138213 V17.1.0 (2022-05)

For each DL BWP configured to a UE in a serving cell, the UE can be provided by higher layer signalling with
- \( P \leq 3 \) CORESETs if coresetPoollndex is not provided, or if a value of coresetPoolIndex is same for all CORESETs if coresetPoollndex is provided
- \( P \leq 5 \) CORESETs if coresetPoollndex is not provided for a first CORESET, or is provided and has a value 0 for a first CORESET, and is provided and has a value 1 for a second CORESET

For each CORESET, the UE is provided the following by ControlResourceSet:
- a CORESET index \( p \), by controlResourceSetld or by controlResourceSetId-v1610, where
- \( 0<p<12 \) if coresetPoollndex is not provided, or if a value of coresetPoollndex is same for all CORESETs if coresetPoollndex is provided;
- \( 0<p<16 \) if coresetPoollndex is not provided for a first CORESET, or is provided and has a value 0 for a first CORESET, and is provided and has a value 1 for a second CORESET;
- a DM-RS scrambling sequence initialization value by pdcch-DMRS-ScramblingID;
- a precoder granularity for a number of REGs in the frequency domain where the UE can assume use of a same DM-RS precoder by precoderGranularity;
- a number of consecutive symbols provided by duration;
- a set of resource blocks provided by frequencyDomainResources;
- CCE-to-REG mapping parameters provided by cce-REG-MappingType;
- an antenna port quasi co-location, from a set of antenna port quasi co-locations provided by TCI-State, indicating quasi co-location information of the DM-RS antenna port for PDCCH reception;
- an indication for a presence or absence of a transmission configuration indication (TCI) field for a DCI format, other than DCI format \( 1 \_0 \), that schedules PDSCH receptions or has associated HARQ-ACK information without scheduling PDSCH and is provided by a PDCCH in CORESET \( p \), by tci-PresentInDCI or tci-PresentDC1-1-2.

When precoderGranularity \( = \) allContiguousRBs, a UE does not expect
- to be configured a set of resource blocks of a CORESET that includes more than four sub-sets of resource blocks that are not contiguous in frequency
- any RE of a CORESET to overlap with any RE determined from lte-CRS-ToMatchAround, or from LTE-CRSPatternList, or with any RE of a SS/PBCH block.

If a UE is provided two TCI states indicating quasi co-location information of the DM-RS antenna port for PDCCH reception in a CORESET associated with a Type3-PDCCH CSS set, the UE may assume the quasi co-location information indicated in both of the two TCI states for the PDCCH reception in the CORESET.

For each CORESET in a DL BWP of a serving cell, a respective frequencyDomainResources provides a bitmap
- if a CORESET is not associated with any search space set configured with freqMonitorLocations, the bits of the bitmap have a one-to-one mapping with non-overlapping groups of 6 consecutive PRBs, in ascending order of the PRB index in the DL BWP bandwidth of \( N_{\mathrm{RB}}^{\mathrm{BWP}} \) PRBs with starting common RB position \( N_{\mathrm{BWP}}^{\text {start }} \), where the first common RB of the first group of 6 PRBs has common RB index \( 6 \cdot\left[N_{\mathrm{BWP}}^{\text {start }} / 6\right] \) if \( r b \)-Offset is not provided, or the first common RB of the first group of 6 PRBs has common RB index \( N_{\mathrm{BWP}}^{\text {start }}+N_{\mathrm{RB}}^{\text {offset }} \) where \( N_{\mathrm{RB}}^{\text {offset }} \) is provided by rb-Offset.
- if a CORESET is associated with at least one search space set configured with freqMonitorLocations, the first \( N_{\text {RBG }, \text { set0 }}^{\text {size }} \) bits of the bitmap have a one-to-one mapping with non-overlapping groups of 6 consecutive PRBs, in ascending order of the PRB index in each RB set \( k \) in the DL BWP bandwidth of \( N_{\mathrm{RB}}^{\mathrm{BWP}} \) PRBs with starting common RB position \( R B_{s 0+k, \mathrm{DL}}^{\text {start }, \mu} \) [6, TS 38.214], where the first common RB of the first group of 6 PRBs has common RB index \( R B_{s 0+k, \mathrm{DL}}^{\text {start }, \mu}+N_{\mathrm{RB}}^{\text {offset }} \) and \( k \) is indicated by freqMonitorLocations if provided for a search space set; otherwise, \( k=0 . N_{\mathrm{RBG}, \text { set } 0}^{\text {size }}=\left\lfloor\left(N_{\mathrm{RB}, \text { set } 0}^{\text {size }}-N_{\mathrm{RB}}^{\text {offset }}\right) / 6\right\rfloor, N_{\mathrm{RB}, \text { set } 0}^{\text {size }} \) is a number of available PRBs in the RB set 0 for the DL BWP, and \( N_{\mathrm{RB}}^{\text {offset }} \) is provided by \( r b \)-Offset or \( N_{\mathrm{RB}}^{\text {off }}=0 \) if \( r b \)-Offset is not provided. If a UE is

ETSI


--- Page 143  ---


3GPP TS 38.213 version 17.1.0 Release 17
142
ETSI TS 138213 V17.1.0 (2022-05)

provided RB sets in the DL BWP, the UE expects that the RBs of the CORESET are within the union of the PRBs in the RB sets of the DL BWP.

For a CORESET other than a CORESET with index 0 ,
- if a UE has not been provided a configuration of TCI state(s) by tci-StatesPDCCH-ToAddList and tci-StatesPDCCH-ToReleaseList for the CORESET, or has been provided initial configuration of more than one TCI states for the CORESET by tci-StatesPDCCH-ToAddList and tci-StatesPDCCH-ToReleaseList but has not received a MAC CE activation command for one of the TCI states as described in [11, TS 38.321], the UE assumes that the DM-RS antenna port associated with PDCCH receptions is quasi co-located with the SS/PBCH block the UE identified during the initial access procedure, or for a most recent configured grant PUSCH transmission as described in clause 19 for a same HARQ process;
- if a UE has been provided a configuration of more than one TCI states by tci-StatesPDCCH-ToAddList and tci-StatesPDCCH-ToReleaseList for the CORESET as part of Reconfiguration with sync procedure as described in [12, TS 38.331] but has not received a MAC CE activation command for one of the TCI states as described in [11, TS 38.321], the UE assumes that the DM-RS antenna port associated with PDCCH receptions is quasi colocated with the SS/PBCH block or the CSI-RS resource the UE identified during the random access procedure initiated by the Reconfiguration with sync procedure as described in [12, TS 38.331].

For a CORESET with index 0 ,
- if the UE is provided DLorJoint-TCIState and if followUnifiedTCIstate \( = \) 'enabled' for the CORESET, the UE assumes that a DM-RS antenna port for PDCCH receptions in the CORESET and a DM-RS antenna port for PDSCH receptions scheduled by DCI formats provided by PDCCH receptions in the CORESET are quasi colocated with the reference signals provided by the indicated DLorJoint-TCIState[6, TS 38.214]
- else, the UE assumes that a DM-RS antenna port for PDCCH receptions in the CORESET is quasi co-located with
- the one or more DL RS configured by a TCI state, where the TCI state is indicated by a MAC CE activation command for the CORESET, if any, or
- a SS/PBCH block the UE identified during a most recent random access procedure not initiated by a PDCCH order that triggers a contention-free random access procedure, if no MAC CE activation command indicating a TCI state for the CORESET is received after the most recent random access procedure, or a SS/PBCH block the UE identified during a most recent configured grant PUSCH transmission as described in clause 19.

For a CORESET other than a CORESET with index 0 , if a UE is provided a single TCI state for a CORESET, or if the UE receives a MAC CE activation command for one or two of the provided TCI states for a CORESET, the UE assumes that the DM-RS antenna port associated with PDCCH receptions in the CORESET is quasi co-located with the one or more DL RS configured by the TCI states. For a CORESET with index 0 , the UE expects that a CSI-RS configured with qcl-Type set to 'typeD' in a TCI state indicated by a MAC CE activation command for the CORESET is provided by a SS/PBCH block
- if the UE receives a MAC CE activation command for one of the TCI states, the UE applies the activation command in the first slot that is after slot \( k+3 N_{\text {slot }}^{\text {sub frame }, \mu}+2^{\mu} \cdot k_{\text {mac }} \) where \( k \) is the slot where the UE would transmit a PUCCH with HARQ-ACK information for the PDSCH providing the activation command, \( \mu \) is the SCS configuration for the PUCCH in the slot when the activation command is applied, and \( k_{\text {mac }} \) is a number of slots for SCS configuration \( \mu=0 \) provided by \( K-M a c \) or \( k_{\mathrm{mac}}=0 \) if \( K-M a c \) is not provided.

If a UE is provided DLorJoint-TCIState, a DM-RS antenna port for PDCCH receptions in a CORESET, other than a CORESET with index 0 , associated only with USS sets and/or Type3-PDCCH CSS sets, and a DM-RS antenna port for PDSCH receptions scheduled by DCI formats provided by PDCCH receptions in the CORESET are quasi co-located with reference signals provided by the indicated DLorJoint-TCIState [6, TS 38.214].

If a UE is provided follow UnifiedTCIstate for a CORESET, other than a CORESET with index 0 , associated at least with CSS sets other than Type3-PDCCH CSS sets, and if followUnifiedTCIstate is set as enabled, a DM-RS antenna port for PDCCH receptions in the CORESET and a DM-RS antenna port for PDSCH receptions scheduled by DCI formats provided by PDCCH receptions in the CORESET are quasi co-located with reference signals provided by the indicated DLorJoint-TCIState.

If the UE is provided by simultaneousTCI-UpdateListl or simultaneousTCI-UpdateList2 up to two lists of cells for simultaneous TCI state activation, the UE applies the antenna port quasi co-location provided by one or two TCI-State

ETSI


--- Page 144  ---


3GPP TS 38.213 version 17.1.0 Release 17
143
ETSI TS 138213 V17.1.0 (2022-05)

each with same activated tci-StatelD value, to CORESETs with a same index in all configured DL BWPs of all configured cells in a list determined from a serving cell index, where one or two tci-StateID, the CORESET index, and the serving cell index are provided by a MAC CE command.

For each DL BWP configured to a UE in a serving cell, the UE is provided by higher layers with \( S \leq 10 \) search space sets where, for each search space set from the \( S \) search space sets, the UE is provided the following by SearchSpace:
- a search space set index \( s, 0<s<40 \), by searchSpaceld
- an association between the search space set \( s \) and a CORESET \( p \) by controlResourceSetld or by controlResourceSetld-v1610
- a PDCCH monitoring periodicity of \( k_{s} \) slots and a PDCCH monitoring offset of \( o_{s} \) slots, by monitoringSlotPeriodicityAndOffset or by monitoringSlotPeriodicityAndOffset-r17
- a PDCCH monitoring pattern within a slot, indicating first symbol(s) of the CORESET for PDCCH monitoring within each slot where the UE monitors PDCCH, by monitoringSymbols WithinSlot
- a duration of \( T_{s}<k_{s} \) indicating a number of slots that the search space set \( s \) exists by duration, or a number of slots in consecutive groups of slots where the search space set \( s \) can exist by duration-r 17
- a bitmap, by monitoringSlots WithinSlotGroup, that applies per group of slots and provides a PDCCH monitoring pattern indicating slots in a group of slots for PDCCH monitoring
- a size of the group of slots is same as a size of monitoringSlotsWithinSlotGroup
- for a Type1-PDCCH CSS set provided by ra-SearchSpace in dedicated RRC signaling, or for a Type3PDCCH CSS set, or for a USS set, the PDCCH monitoring pattern indicates only consecutive slots in the group of slots for PDCCH monitoring and, at least for one combination ( \( X_{s}, Y_{s} \) ) indicated by the UE as a capability, a number of the consecutive slots is not larger than \( Y_{s} \)
- a number of PDCCH candidates \( M_{s}^{(L)} \) per CCE aggregation level \( L \) by aggregationLevell, aggregationLevel2, aggregationLevel4, aggregationLevel8, and aggregationLevell6, for CCE aggregation level 1, CCE aggregation level 2, CCE aggregation level 4, CCE aggregation level 8, and CCE aggregation level 16, respectively
- an indication that search space set \( S \) is either a CSS set or a USS set by searchSpaceType
- if search space set \( s \) is a CSS set
- an indication by dci-Format0-0-AndFormat1-0 to monitor PDCCH candidates for DCI format \( 0 \_0 \) and DCI format 1_0
- an indication by dci-Format2-0 to monitor one or two PDCCH candidates, or to monitor one PDCCH candidate per RB set if the UE is provided freqMonitorLocations for the search space set, for DCI format \( 2 \_0 \) and a corresponding CCE aggregation level
- an indication by dci-Format2-1 to monitor PDCCH candidates for DCI format 2_1
- an indication by dci-Format2-2 to monitor PDCCH candidates for DCI format 2_2
- an indication by dci-Format2-3 to monitor PDCCH candidates for DCI format 2_3
- an indication by dci-Format2-4 to monitor PDCCH candidates for DCI format 2_4
- an indication by dci-Format2-6 to monitor PDCCH candidates for DCI format 2 _6
- an indication by dci-Format4-0 to monitor PDCCH candidates for DCI format \( 4 \_0 \)
- an indication by dci-Format4-1, or dci-Format4-2, or dci-Format4-1-AndFormat4-2 to monitor PDCCH candidates for DCI format \( 4 \_1 \), or DCI format \( 4 \_2 \), or for both DCI format \( 4 \_1 \) and DCI format \( 4 \_2 \), respectively
- a search space set index by searchSpaceLinking for another search space set that is linked to search space set \( s \)
- if search space set \( s \) is a USS set, an indication by dci-Formats to monitor PDCCH candidates either for DCI format \( 0 \_0 \) and DCI format \( 1 \_0 \), or for DCI format \( 0 \_1 \) and DCI format \( 1 \_1 \), or an indication by dci-FormatsExt

ETSI


--- Page 145  ---


3GPP TS 38.213 version 17.1.0 Release 17
144
ETSI TS 138213 V17.1.0 (2022-05)

to monitor PDCCH candidates for DCI format \( 0 \_2 \) and DCI format \( 1 \_2 \), or for DCI format \( 0 \_1 \), DCI format \( 1 \_1 \), DCI format 0_2, and DCI format 1_2, or an indication by dci-FormatsSL to monitor PDCCH candidates for DCI format \( 0 \_0 \) and DCI format \( 1 \_0 \), or for DCI format \( 0 \_1 \) and DCI format \( 1 \_1 \), or for DCI format \( 3 \_0 \), or for DCI format \( 3 \_1 \), or for DCI format \( 3 \_0 \) and DCI format \( 3 \_1 \)
- a bitmap by freqMonitorLocations, if provided, to indicate an index of one or more RB sets for the search space set \( s \), where the MSB \( k \) in the bitmap corresponds to RB set \( k-1 \) in the DL BWP. For RB set \( k \) indicated in the bitmap, the first \( \operatorname{PRB} \) of the frequency domain monitoring location confined within the RB set is given by \( R B_{s 0+k, \mathrm{DL}}^{\text {start }, \mu}+N_{\mathrm{RB}}^{\text {offset }} \), where \( R B_{s 0+k, \mathrm{DL}}^{\text {start }, \mu} \) is the index of first common RB of the RB set \( k \) [6, TS 38.214], and \( N_{\mathrm{RB}}^{\text {offset }} \) is provided by \( r b \)-Offset or \( N_{\mathrm{RB}}^{\text {offset }}=0 \) if \( r b \)-Offset is not provided. For each RB set with a corresponding value of 1 in the bitmap, the frequency domain resource allocation pattern for the monitoring location is determined based on the first \( N_{\text {RBG }}^{\text {size }} 0 \) bits infrequencyDomainResources provided by the associated CORESET configuration.

If the monitoringSymbolsWithinSlot indicates to a UE to monitor PDCCH in a subset of up to three consecutive symbols that are same in every slot where the UE monitors PDCCH for all search space sets, the UE does not expect to be configured with a PDCCH SCS other than 15 kHz if the subset includes at least one symbol after the third symbol.

A UE does not expect to be provided a first symbol and a number of consecutive symbols for a CORESET that results to a PDCCH candidate mapping to symbols of different slots.

A UE does not expect any two PDCCH monitoring occasions on an active DL BWP, for a same search space set or for different search space sets, in a same CORESET to be separated by a non-zero number of symbols that is smaller than the CORESET duration.

A UE determines a PDCCH monitoring occasion on an active DL BWP from the PDCCH monitoring periodicity, the PDCCH monitoring offset, and the PDCCH monitoring pattern within a slot. For search space set \( s \), the UE determines that PDCCH monitoring occasions exist in a slot with number \( n_{s, f}^{\mu}\left[4\right. \), TS 38.211] in a frame with number \( n_{f} \) if ( \( n_{f} \left.N_{\text {slot }}^{\text {frame }, \mu}+n_{s_{, f}}^{\mu}-o_{s}\right) \bmod k_{s}=0 \). If monitoringSlotsWithinSlotGroup is provided, the slot is the first slot in a group of slots and PDCCH monitoring occasions exist in the group of slots. The UE monitors PDCCH candidates for search space set \( s \) for \( T_{s} \) consecutive slots, starting from slot \( n_{s_{1} f}^{\mu} \), and does not monitor PDCCH candidates for search space set \( s \) for the next \( k_{s}-T_{s} \) consecutive slots.

A USS at CCE aggregation level \( L \in\{1,2,4,8,16\} \) is defined by a set of PDCCH candidates for CCE aggregation level L.

If a UE is configured with CrossCarrierSchedulingConfig for a serving cell the carrier indicator field value corresponds to the value indicated by CrossCarrierSchedulingConfig.

For an active DL BWP of a serving cell on which a UE monitors PDCCH candidates in a USS, if the UE is not configured with a carrier indicator field, the UE monitors the PDCCH candidates without carrier indicator field. For an active DL BWP of a serving cell on which a UE monitors PDCCH candidates in a USS, if a UE is configured with a carrier indicator field, the UE monitors the PDCCH candidates with carrier indicator field.

A UE does not expect to monitor PDCCH candidates on an active DL BWP of a secondary cell if the UE is configured to monitor PDCCH candidates with carrier indicator field corresponding to that secondary cell in another serving cell. For the active DL BWP of a serving cell on which the UE monitors PDCCH candidates, the UE monitors PDCCH candidates at least for the same serving cell.

For a search space set \( s \) associated with CORESET \( p \), the CCE indexes for aggregation level \( L \) corresponding to PDCCH candidate \( m_{s, n_{C I}}^{(L)} \) of the search space set in slot \( n_{s_{1} f}^{\mu} \) for an active DL BWP of a serving cell corresponding to carrier indicator field value \( n_{C I} \) are given by
\[
L \cdot\left\{\left(Y_{p, n_{s, f}^{\mu}}+\left\lfloor\frac{m_{s, n_{C I}}^{(L)} \cdot N_{\mathrm{CCE}, p}}{L \cdot M_{s, \max }^{(L)}}\right\rfloor+n_{C I}\right) \bmod \left\lfloor N_{\mathrm{CCE}, p} / L\right\rfloor\right\}+i
\]
where
for any CSS, \( Y_{p, n_{s, f}^{\mu}}=0 \);

ETSI


--- Page 146  ---


3GPP TS 38.213 version 17.1.0 Release 17
145
ETSI TS 138213 V17.1.0 (2022-05)

for a USS, \( Y_{p, n_{s, f}^{\mu}}^{\mu}=\left(A_{p} \cdot Y_{p, n_{s, f}^{\mu}-1}^{\mu}\right) \bmod D, Y_{p,-1}=n_{\mathrm{RNTI}} \neq 0, A_{p}=39827 \) for \( p \bmod 3=0, A_{p}=39829 \) for \( \operatorname{pmod} 3=1, A_{p}=39839 \) for \( p \bmod 3=2 \), and \( D=65537 \);
\( i=0, \cdots, L-1 ; \)
\( N_{\text {CCE } p} \) is the number of CCEs, numbered from 0 to \( N_{\text {CCE } p}-1 \), in CORESET \( p \) and, if any, per RB set;
\( n_{C I} \) is the carrier indicator field value if the UE is configured with a carrier indicator field by
CrossCarrierSchedulingConfig for the serving cell on which PDCCH is monitored; otherwise, including for any CSS, \( n_{C I}=0 \);
\( m_{s, n_{C I}}^{(L)}=0, \cdots, M_{s, n_{C I}}^{(L)}-1 \), where \( M_{s, n_{C I}}^{(L)} \) is the number of PDCCH candidates the UE is configured to monitor for aggregation level \( L \) of a search space set \( s \) for a serving cell corresponding to \( n_{C I} \);
for any CSS, \( M_{s, \max }^{(L)}=M_{s, 0}^{(L)} \);
for a USS, \( M_{s_{1} \max }^{(L)} \) is the maximum of \( M_{s_{1} n_{C I}}^{(L)} \) over all configured \( n_{C I} \) values for a CCE aggregation level \( L \) of search space set \( s \);
the RNTI value used for \( n_{\text {RNTI }} \) is the C-RNTI.
For search space sets \( s_{i} \) and \( s_{j} \) that include searchSpaceLinking with value \( s_{j} \) and \( s_{i} \), respectively, a UE monitors, in monitoring occasions with same index according to each of search space sets \( s_{i} \) and \( s_{j} \) in a slot, PDCCH candidates \( m_{s_{i}, n_{C I}}^{(L)} \) and \( m_{s_{j}, n_{C I}}^{(L)} \), with \( m_{s_{i}, n_{C I}}^{(L)}=m_{s_{j}, n_{C I}}^{(L)} \), for detection of a DCI format with same information. The UE expects \( k_{s_{i}}= k_{s_{j}}, o_{s_{i}}=o_{s_{j}}, T_{s_{i}}=T_{s_{j}}, M_{s_{i}}^{(L)}=M_{s_{j}}^{(L)} \), and a same number of non-overlapping PDCCH monitoring occasions per slot based on corresponding monitoringSymbolsWithinSlot, for search space sets \( s_{i} \) and \( s_{j} \). For CORESET \( p_{i} \) associated with the search space set \( s_{i} \) and for CORESET \( p_{j} \) associated with the search space set \( s_{j} \), the UE is provided tci-
PresentInDCI or tci-PresentDCI-1-2 for either none or both of CORESETs \( p_{i} \) and \( p_{j} \). For CORESET \( p_{i} \) associated with the search space set \( s_{i} \) and for CORESET \( p_{j} \) associated with the search space set \( s_{j} \), the UE is either not provided coresetPoollndex value of 1 for any of the two CORESETs, or is provided coresetPoollndex value of 1 for both CORESETs.

A UE can indicate by countLinkedCandidates a capability for counting PDCCH candidates \( m_{s_{i}, n_{C I}}^{(L)} \) and \( m_{s_{j}, n_{C I}}^{(L)} \) either as 2 PDCCH candidates or as 3 PDCCH candidates.

For search space sets \( s_{i}, s_{j}, s_{k} \), and \( s_{l} \), that include searchSpaceLinking with values \( s_{j}, s_{i}, s_{l} \), and \( s_{k} \), respectively, a UE expects to simultaneously monitor PDCCH candidates \( m_{s_{i}, n_{C I, 1}}^{(8)}=m_{s_{j}, n_{C I, 1}}^{(8)} \), and \( m_{s_{k}, n_{C I, 2}}^{(16)}=m_{s_{l}, n_{C I, 2}}^{(16)} \) only if a first CCE of \( m_{s_{i} n_{C I, 1}}^{(8)} \) or \( m_{s_{j}, n_{C I, 1}}^{(8)} \) has different index than a first CCE of \( m_{s_{k} n}^{(16)}{ }_{C I, 2} \) or \( m_{s_{l} n n_{C I, 2}}^{(16)} \) in a CORESET configured with \( c c e \) -REG-MappingType \( = \) 'nonInterleaved' and with duration of one symbol.

If a UE
- is provided monitoringCapabilityConfig = rl6monitoringcapability for a downlink cell,
- is provided, by searchSpaceLinking, for search space sets \( s_{i} \) and \( s_{j} \) on the downlink cell respective values \( s_{j} \) and \( s_{i} \), and
- indicates three-BDforSSsetLinking
the UE counts each PDCCH candidate for the one of the search space sets \( s_{i} \) and \( s_{j} \) that the UE monitors PDCCH in the later span, as two PDCCH candidates. The UE does not expect a first PDCCH candidate from search space set \( s_{i} \) or \( s_{j} \) and a second PDCCH candidate from a search space set \( s_{k} \) that does not include searchSpaceLinking to use a same set of CCEs and same scrambling in a same CORESET, and provide respective first and second DCI formats with same size, in any span other than the first span in a slot.

A UE does not expect to be provided freqMonitorLocations for a search space set \( s \) in a serving cell if intraCellGuardBandsDL-List indicates that no intra-cell guard-bands are configured for the serving cell.

A UE that

ETSI


--- Page 147  ---


3GPP TS 38.213 version 17.1.0 Release 17
146
ETSI TS 138213 V17.1.0 (2022-05)
- is configured for operation with carrier aggregation, and
- indicates support of search space sharing through searchSpaceSharingCA-UL or through searchSpaceSharingCA-DL, and
- has a PDCCH candidate with CCE aggregation level \( L \) in CORESET \( p \) associated with search space set \( s_{i} \) for detection of a first DCI format, other than DCI format \( 0 \_0 \) or DCI format \( 1 \_0 \), having a first size and scheduling
- PUSCH transmission or configured grant Type 2 PUSCH release on serving cell \( n_{C I, 2} \), or
- PDSCH reception or having associated HARQ-ACK information without scheduling PDSCH reception on serving cell \( n_{C I, 2} \)
can receive a corresponding PDCCH through a PDCCH candidate with CCE aggregation level \( L \) in CORESET \( p \) associated with search space set \( s_{j} \) for detection of a second DCI format having a second size and associated with scheduling on serving cell \( n_{C I, 1} \) if the first size and the second size are same and if neither of search space sets \( s_{i} \) and \( s_{j} \) includes searchSpaceLinking.

A UE expects to monitor PDCCH candidates for up to 4 sizes of DCI formats that include up to 3 sizes of DCI formats with CRC scrambled by C-RNTI per serving cell. The UE counts a number of sizes for DCI formats per serving cell based on a number of configured PDCCH candidates in respective search space sets for the corresponding active DL BWP.

A UE does not expect to detect, in a same PDCCH monitoring occasion, a DCI format with CRC scrambled by a SIRNTI, RA-RNTI, MsgB-RNTI, TC-RNTI, P-RNTI, C-RNTI, CS-RNTI, MCS-RNTI, MCCH-RNTI, G-RNTI, or G-CS-RNTI and a DCI format with CRC scrambled by a SL-RNTI or a SL-CS-RNTI for scheduling respective PDSCH reception and PSSCH transmission on a same serving cell.

A PDCCH candidate with index \( m_{s_{j}, n_{C I}}^{(L)} \) for a search space set \( s_{j} \) using a set of \( L \) CCEs in a CORESET \( p \) on the active DL BWP for serving cell \( n_{C I} \) is not counted for monitoring if there is a PDCCH candidate with index \( m_{s_{i,} n_{C I}}^{(L)} \) for a search space set \( s_{i}<s_{j} \), or if there is a PDCCH candidate with index \( n_{s_{j}, n_{C I}}^{(L)} \) and \( n_{s_{j}, n_{C I}}^{(L)}<m_{s_{j}, n_{C I}}^{(L)} \), in the CORESET \( p \) on the active DL BWP for serving cell \( n_{C I} \) using a same set of \( L \) CCEs, the PDCCH candidates have identical scrambling, and the corresponding DCI formats for the PDCCH candidates have a same size; otherwise, the PDCCH candidate with index \( m_{s_{j}, n_{C I}}^{(L)} \) is counted for monitoring.

For search space sets \( s_{i} \) and \( s_{j} \) that include searchSpaceLinking with values \( s_{j} \) and \( s_{i} \), and for search space set \( s_{k} \) that does not include searchSpaceLinking, when a UE
- monitors PDCCH candidates \( m_{s_{i}, n_{C I, 1}}^{(L)}=m_{s_{j}, n_{C I, 1}}^{(L)} \) for detection of a first DCI format,
- monitors PDCCH candidate \( m_{s_{k} n C_{I, 2}}^{(L)} \) for detection of a second DCI format having a same size as the first DCI format,
- the PDCCH candidate \( m_{s_{i} n_{C I, 1}}^{(L)} \), or the PDCCH candidate \( m_{s_{j}, n_{C I, 1}}^{(L)} \), and the PDCCH candidate \( m_{s_{k}, n_{C I, 2}}^{(L)} \) have identical scrambling and use a same set of CCEs over same symbols in a slot in a CORESET \( p \),
the PDCCH candidate \( m_{s_{k}, n_{C I, 2}}^{(L)} \) is not counted for monitoring and the UE assumes that a detected DCI format is the first DCI format. A UE may monitor PDCCH candidate \( m_{s_{k}, n_{C I, 2}}^{(L)} \) depending on a corresponding capability [16, TS 38.306].

For search space sets \( s_{i} \) and \( s_{j} \) that include searchSpaceLinking with values \( s_{j} \) and \( s_{i} \), and for search space set \( s_{k} \) that does not include searchSpaceLinking, when a UE
- monitors PDCCH candidates \( m_{s_{i}, n_{C I, 1}}^{(8)}=m_{s_{j}, n_{C I, 1}}^{(8)} \) for detection of a first DCI format and monitors PDCCH candidate \( m_{s_{k} n_{C I, 2}}^{(16)} \) for detection of a second DCI format, or monitors PDCCH candidates \( m_{s_{i} n_{C I, 1}}^{(16)}=m_{s_{j}, n_{C I, 1}}^{(16)} \) for detection of the first DCI format and monitors PDCCH candidate \( m_{s_{k}, n_{C I, 2}}^{(8)} \) for detection of the second DCI format, and

ETSI


--- Page 148  ---


3GPP TS 38.213 version 17.1.0 Release 17
147
ETSI TS 138213 V17.1.0 (2022-05)
- one of the PDCCH candidates \( m_{s_{i}, n_{C I, 1}}^{(8)} \) and \( m_{s_{j}, n_{C I, 1}}^{(8)} \), and the PDCCH candidate \( m_{s_{k}, n_{C I, 2}}^{(16)} \), or one of the PDCCH candidates \( m_{s_{i}, n_{C I, 1}}^{(16)} \) and \( m_{s_{j}, n_{C I, 1}}^{(16)} \), and the PDCCH candidate \( m_{s_{k}, n_{C I, 2}}^{(8)} \), have a first CCE with same index and are simultaneously monitored in a CORESET \( p \) with cce-REG-MappingType \( = \) 'nonInterleaved' and duration of one symbol,
the UE assumes that a detected DCI format is the first DCI format.
For search space sets \( s_{i}, s_{j}, s_{k} \), and \( s_{l} \) that include searchSpaceLinking with values \( s_{j}, s_{i}, s_{l} \), and \( s_{k} \), respectively, and for detection of DCI formats with same size, a UE expects different CCEs or different scrambling in a CORESET \( p \) for any of first PDCCH candidates \( m_{s_{i} n}^{(L)} n_{C I, 1} \) and \( m_{s_{j}, n_{C I, 1}}^{(L)} \), with \( m_{s_{i}, n_{C I, 1}}^{(L)}=m_{s_{j}, n}^{(L)} \), and any of second PDCCH candidates \( m_{s_{k} n_{C I, 2}}^{(L)} \) and \( m_{s_{l} n_{C I, 2}}^{(L)} \), with \( m_{s_{k} n_{C I, 2}}^{(L)}=m_{s_{l} n_{C I, 2}}^{(L)} \) that the UE would simultaneously monitor.

Table 10.1-2 provides the maximum number of monitored PDCCH candidates, \( M_{\text {PDCCH }}^{\text {max, } \mu \text {, } \mu} \), per slot for a UE in a DL BWP with SCS configuration \( \mu \) for operation with a single serving cell.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.1-2: Maximum number \( M_{\text {PDCCH }}^{\text {max }, \text { slot }, \mu} \) of monitored PDCCH candidates per slot for a DL BWP with SCS configuration \( \mu \in\{0,1,2,3\} \) for a single serving cell}
\begin{tabular}{|c|c|}
\hline \( \boldsymbol{\mu} \) & Maximum number of monitored PDCCH candidates per slot and per serving cell \( \boldsymbol{M}_{\text {PDCCH }}^{\text {max, } \boldsymbol{\text { slot }} \boldsymbol{,} \boldsymbol{H}} \) \\
\hline 0 & 44 \\
\hline 1 & 36 \\
\hline 2 & 22 \\
\hline 3 & 20 \\
\hline
\end{tabular}
\end{table}

Table 10.1-2A provides the maximum number of monitored PDCCH candidates, \( M_{\mathrm{PDCCH}}^{\max (X, Y), \mu} \), per span for a UE in a DL BWP with SCS configuration \( \mu \) for operation with a single serving cell.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.1-2A: Maximum number \( M_{\text {PDCCH }}^{\text {max }(X, Y), \mu} \) of monitored PDCCH candidates in a span for combination \( (X, Y) \) for a DL BWP with SCS configuration \( \mu \in\{0,1\} \) for a single serving cell}
\begin{tabular}{|c|c|c|c|}
\hline & \multicolumn{3}{|c|}{\begin{tabular}{c} 
Maximum number \( M_{\text {proc.H }}^{\max ,(X), \boldsymbol{\mu}} \) of monitored PDCCH \\
candidates per span for combination \( (X, Y) \) and per \\
serving cell
\end{tabular}} \\
\hline\( \mu \) & \( (2,2) \) & \( (4,3) \) & \( (7,3) \) \\
\hline 0 & 14 & 28 & 44 \\
\hline 1 & 12 & 24 & 36 \\
\hline
\end{tabular}
\end{table}

Table 10.1-2B provides the maximum number of monitored PDCCH candidates, \( M_{\text {PDCCH }}^{m a x, X_{s}, \mu} \), per group of \( X_{s} \) slots for combination \( \left(X_{s}, Y_{s}\right) \) for a UE in a DL BWP with SCS configuration \( \mu \) for operation with a single serving cell.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.1-2B: Maximum number \( M_{\text {PDCCH }}^{\max , X_{s}, \mu} \) of monitored PDCCH candidates per group of \( X_{s} \) slots for combination \( \left(X_{s}, Y_{s}\right) \) for a DL BWP with SCS configuration \( \mu \in\{5,6\} \) for a single serving cell}
\begin{tabular}{|c|c|c|c|c|}
\hline & \multicolumn{4}{|c|}{\begin{tabular}{c} 
Maximum number \( M_{\text {PDCH }}^{\text {max }, X_{s}, \mu} \) of monitored PDCCH candidates in a \\
group of \( X_{s} \) slots per combination \( \left(X_{s}, Y_{s}\right) \) and per serving cell
\end{tabular}} \\
\hline\( \mu \) & \( (4,1) \) & \( (4,2) \) & \( (8,1) \) & \( (8,4) \) \\
\hline 5 & 20 & 20 & - & - \\
\hline 6 & 10 & 10 & 20 & 20 \\
\hline
\end{tabular}
\end{table}

Table 10.1-3 provides the maximum number of non-overlapped CCEs, \( C_{\text {PDCCH }}^{m a x, \mu s, \mu} \), for a DL BWP with SCS configuration \( \mu \) that a UE is expected to monitor corresponding PDCCH candidates per slot for operation with a single serving cell.

CCEs for PDCCH candidates are non-overlapped if they correspond to
- different CORESET indexes, or

ETSI


--- Page 149  ---


3GPP TS 38.213 version 17.1.0 Release 17
148
ETSI TS 138213 V17.1.0 (2022-05)
- different first symbols for the reception of the respective PDCCH candidates.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.1-3: Maximum number \( C_{\text {PDCCH }}^{\text {max, } \text { slot } \mu} \) of non-overlapped CCEs per slot for a DL BWP with SCS configuration \( \mu \in\{0,1,2,3\} \) for a single serving cell}
\begin{tabular}{|l|l|}
\hline \( \mu \) & Maximum number of non-overlapped CCEs per slot and per serving cell \( \boldsymbol{C}_{\text {pDCCH }}^{\text {max } \boldsymbol{\text { slot }} \boldsymbol{,} \boldsymbol{\mu}} \) \\
\hline 0 & 56 \\
\hline 1 & 56 \\
\hline 2 & 48 \\
\hline 3 & 32 \\
\hline
\end{tabular}
\end{table}

Table 10.1-3A provides the maximum number of non-overlapped CCEs, \( C_{\text {PDCCH }}^{\max (X, Y), \mu} \), for a DL BWP with SCS configuration \( \mu \) that a UE is expected to monitor corresponding PDCCH candidates per span for operation with a single serving cell.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.1-3A: Maximum number \( C_{\text {PDCSH }}^{\max (X, Y), \mu} \) of non-overlapped CCEs in a span for combination ( \( X, Y \) ) for a DL BWP with SCS configuration \( \mu \in\{0,1\} \) for a single serving cell}
\begin{tabular}{|c|c|c|c|}
\hline & \multicolumn{3}{|c|}{\begin{tabular}{c} 
Maximum number \( C_{\text {PDCCH }}^{\text {max, }(X, Y), \mu} \) of non-overlapped \\
CCEs per span for combination \( (X, Y) \) and per \\
serving cell
\end{tabular}} \\
\hline\( \mu \) & \( (2,2) \) & \( (4,3) \) & \( (7,3) \) \\
\hline 0 & 18 & 36 & 56 \\
\hline 1 & 18 & 36 & 56 \\
\hline
\end{tabular}
\end{table}

Table 10.1-3B provides the maximum number of non-overlapped CCEs, \( C_{\text {PDCCH }}^{m a x,} X_{S} \), for a DL BWP with SCS configuration \( \mu \) that a UE is expected to monitor corresponding PDCCH candidates per group of \( X_{s} \) slots for combination \( \left(X_{S}, Y_{S}\right) \) for operation with a single serving cell.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.1-3B: Maximum number \( C_{\text {PDCCH }}^{\max , X_{s}, \mu} \) of non-overlapped CCEs in a group of \( X_{s} \) slots for any combination \( \left(X_{s}, Y_{s}\right) \) for a DL BWP with SCS configuration \( \mu \in\{5,6\} \) for a single serving cell}
\begin{tabular}{|c|c|c|c|c|}
\hline & \multicolumn{4}{|c|}{\begin{tabular}{c} 
Maximum number of non-overlapped CCEs in a group of \( X_{\boldsymbol{s}} \) slots \\
per combination \( \left(X_{\boldsymbol{s}}, Y_{\boldsymbol{s}}\right) \) and per serving cell \( C_{\text {PDCCH }}^{\text {max }, \boldsymbol{\mu}} \)
\end{tabular}} \\
\hline\( \mu \) & \( (4,1) \) & \( (4,2) \) & \( (8,1) \) & \( (8,4) \) \\
\hline 5 & 32 & 32 & - & - \\
\hline 6 & 16 & 16 & 32 & 32 \\
\hline
\end{tabular}
\end{table}

If a UE
- does not report pdcch-BlindDetectionCA or is not provided BDFactorR, \( \gamma=R \)
- reports pdcch-BlindDetectionCA, the UE can be indicated by BDFactorR either \( \gamma=1 \) or \( \gamma=R \)

If a UE is configured with \( N_{\text {cells }, 0}^{\mathrm{DL}, \mu}+N_{\text {cells }, 1}^{\mathrm{DL}, \mu} \) downlink cells for which the UE is not provided monitoringCapabilityConfig, or is provided monitoringCapabilityConfig \( = \) r15monitoringcapability and is not provided CORESETPoollndex, with associated PDCCH candidates monitored in the active DL BWPs of the scheduling cells using SCS configuration \( \mu \) where \( \sum_{\mu=0}^{3}\left(N_{\text {cells }, 0}^{\mathrm{DL} \mu}+\gamma \cdot N_{\text {cells }, 1}^{\mathrm{DL} \mu}\right) \leq N_{\text {cells }}^{\text {cap }} \), the UE is not required to monitor, on the active DL BWPs of the scheduling cells,
- more than \( M_{\text {PDCCH }}^{\text {total, slot, } \mu}=M_{\text {PDCCH }}^{\text {max, slot, } \mu} \) PDCCH candidates or more than \( C_{\text {PDCCH }}^{\text {total, slot }, \mu}=C_{\text {PDCCH }}^{\text {max, slot, } \mu} \) non-overlapped CCEs per slot for each scheduled cell when the scheduling cell is from the \( N_{\text {cell }, 0}^{\mathrm{DL}, \mu} \) downlink cells, or
- more than \( M_{\text {PDCCH }}^{\text {total, slot }, \mu}=\gamma \cdot M_{\text {PDCCH }}^{\text {max, slot, } \mu} \) PDCCH candidates or more than \( C_{\text {PDCCH }}^{\text {total, slot }, \mu}=\gamma \cdot C_{\text {PDCCH }}^{\text {max, slot, } \mu} \) nonoverlapped CCEs per slot for each scheduled cell when the scheduling cell is from the \( N_{\text {cells }, 1}^{\mathrm{DL}, \mu} \) downlink cells
- more than \( M_{\text {PDCCH }}^{\text {max, slot, } \mu} \) PDCCH candidates or more than \( C_{\text {PDCCH }}^{\text {max, } \text { slot, } \mu} \) non-overlapped CCEs per slot for CORESETs with same coresetPoollndex value for each scheduled cell when the scheduling cell is from the \( N_{\text {cells }, 1}^{\mathrm{DL}, \mu} \) downlink cells

ETSI


--- Page 150  ---


3GPP TS 38.213 version 17.1.0 Release 17
149
ETSI TS 138213 V17.1.0 (2022-05)

\( N_{\text {cells }}^{\text {cap }} \) is replaced by \( N_{\text {cells, } 15}^{\text {cap-r16 }} \), if a UE is configured with downlink cells for which the UE is provided both monitoringCapabilityConfig \( = \) r15monitoringcapability and monitoringCapabilityConfig \( = \) rl 6monitoringcapability.

If a UE
- is configured with \( N_{\text {cells }, 0}^{\mathrm{DL}, \mu}+N_{\text {cells }, 1}^{\mathrm{DL}, \mu} \) downlink cells for which the UE is not provided monitoringCapabilityConfig, or is provided monitoringCapabilityConfig = r15monitoringcapability and is not provided coresetPoollndex,
- with associated PDCCH candidates monitored in the active DL BWPs of the scheduling cell(s) using SCS configuration \( \mu \), where \( \sum_{\mu=0}^{3}\left(N_{\text {cells }, 0}^{\mathrm{DL}, \mu}+\gamma \cdot N_{\text {cells }, 1}^{\mathrm{DL}, \mu}\right)>N_{\text {cells }}^{\text {cap }} \), and
- a DL BWP of an activated cell is the active DL BWP of the activated cell, and a DL BWP of a deactivated cell is the DL BWP with index provided by firstActiveDownlinkBWP-Id for the deactivated cell,
the UE is not required to monitor more than \( M_{\mathrm{PDCCH}}^{\mathrm{total}, \mathrm{slot}, \mu}=\left\lfloor N_{\mathrm{cell} \mathrm{s}}^{\mathrm{cap}} \cdot M_{\mathrm{PDCCH}}^{\mathrm{max}, \mathrm{slot}, \mu}\right. \).
\( \left.\left(N_{\text {cells }, 0}^{\mathrm{DL}, \mu}+\gamma \cdot N_{\text {cells }, \mathrm{l}}^{\mathrm{DL}, \mu}\right) / \sum_{j=0}^{3}\left(N_{\text {cells }, 0}^{\mathrm{DL}, j}+\gamma \cdot N_{\text {cells }, \mathrm{l}}^{\mathrm{DL}, j}\right)\right] \mathrm{PDCCH} \) candidates or more than \( C_{\mathrm{PDCCH}}^{\text {total, } \mathrm{slot}, \mu}= \left\lfloor N_{\text {cells }}^{\text {cap }} \cdot C_{\text {PDCCH }}^{\text {max, } s \text { lot, } \mu} \cdot\left(N_{\text {cells, } 0}^{\mathrm{DL}, \mu}+\gamma \cdot N_{\text {cells, }, \mathrm{l}}^{\mathrm{DL}, \mu}\right) / \sum_{j=0}^{3}\left(N_{\text {cells }, 0}^{\mathrm{DL}, j}+\gamma \cdot N_{\text {cells, }, \mathrm{l}}^{\mathrm{DL}, j}\right)\right\rfloor \) non-overlapped CCEs per slot on the active DL BWP(s) of scheduling cell(s) from the \( N_{\text {cells }, 0}^{\mathrm{DL}, \mu}+N_{\text {cells }, 1}^{\mathrm{DL}, \mu} \) downlink cells. \( N_{\text {cells }}^{\text {cap }} \) is replaced by \( N_{\text {cells }, \mathrm{r} 15}^{\text {cap-rl } 6} \) if a UE is configured with downlink cells for which the UE is provided both monitoringCapabilityConfig \( = \) r15monitoring capability and monitoringCapabilityConfig \( = \) rl6monitoring capability.

For each scheduled cell from the \( N_{\text {cell }, 0}^{\mathrm{DL} \mu} \) downlink cells, the UE is not required to monitor on the active DL BWP with SCS configuration \( \mu \) of the scheduling cell more than \( \min \left(M_{\text {PDCCH }}^{\text {max }, \text { slot }, \mu}, M_{\text {PDCCH }}^{\text {total, }, \mu l+\mu}\right) \) PDCCH candidates or more than \( \min \left(C_{\text {PDCCH }}^{\text {tmax, slot, } \mu}, C_{\text {PDCCH }}^{\text {total, slot, } \mu}\right) \) non-overlapped CCEs per slot.

For each scheduled cell from the \( N_{\text {cells }, 1}^{\mathrm{DL} \mu} \) downlink cells, the UE is not required to monitor on the active DL BWP with SCS configuration \( \mu \) of the scheduling cell
- more than \( \min \left(\gamma \cdot M_{\text {PDCCH }}^{\text {max, slot, } \mu}, M_{\text {PDCCH }}^{\text {total, slot, } \mu}\right) \) PDCCH candidates or more than \( \min \left(\gamma \cdot C_{\text {PDCCH }}^{\text {max, } \text { slot, } \mu}, C_{\text {PDCCH }}^{\text {total, slot, } \mu}\right) \) nonoverlapped CCEs per slot
- more than \( \min \left(M_{\text {PDCCH }}^{\text {max, slot, } \mu}, M_{\text {PDCCH }}^{\text {total, slot, } \mu}\right) \) PDCCH candidates or more than \( \min \left(C_{\text {PDCCH }}^{\text {max, slot, } \mu}, C_{\text {PDCCH }}^{\text {total, slot, } \mu}\right) \) nonoverlapped CCEs per slot for CORESETs with same coresetPoollndex value

If a UE is configured with \( N_{\text {cells }, \mathrm{r} 16}^{\mathrm{DL} \mu} \) downlink cells for which the UE is provided monitoringCapabilityConfig \( = \) rl6monitoringcapability and with associated PDCCH candidates monitored in the active DL BWPs of the scheduling cells using SCS configuration \( \mu \), and with \( N_{\text {cells, } r 16}^{\mathrm{DL},(\mathrm{X}, \mathrm{Y}), \mu} \) of the \( N_{\text {cells, } r 16}^{\mathrm{DL} \mu} \) downlink cells using combination (X, Y) for PDCCH monitoring, where \( \sum_{\mu=0}^{1} N_{\text {cells, r16 }}^{\mathrm{DL} \mu} \leq N_{\text {cells }}^{\text {cap-r16 }} \), the UE is not required to monitor, on the active DL BWP of the scheduling cell, more than \( M_{\text {PDCCH }}^{\text {total, }(X, Y), \mu}=M_{\text {PDCCH }}^{\text {max, }(X, Y), \mu} \) PDCCH candidates or more than \( C_{\text {PDCCH }}^{\text {total, }(X, Y), \mu}=C_{\text {PDCCH }}^{\text {max, }(X, Y), \mu} \) non-overlapped CCEs per span for each scheduled cell when the scheduling cell is from the \( N_{\text {cells,r16 }}^{\mathrm{DL},(\mathrm{X}, \mathrm{Y}), \mu} \) downlink cells. If a UE is configured with downlink cells for which the UE is provided both monitoringCapabilityConfig \( = \) r15monitoringcapability and monitoringCapabilityConfig \( = \) r16monitoringcapability, \( N_{\text {cells }}^{\text {cap-r16 }} \) is replaced by \( N_{\text {cells, } \mathrm{r} 16}^{\text {cap-r16 }} \).

If a UE is configured only with \( N_{\text {cells }, 16}^{\mathrm{DL}, \mu} \) downlink cells for which the UE is provided monitoringCapabilityConfig \( = \) rl6monitoringcapability and with associated PDCCH candidates monitored in the active DL BWPs of the scheduling cells using SCS configuration \( \mu \), and with \( N_{\text {cells, } r 16}^{\mathrm{DL},(\mathrm{X}, \mathrm{Y}), \mu} \) of the \( N_{\text {cells, } r 16}^{\mathrm{DL} \mu} \) downlink cells using combination (X, Y) for PDCCH monitoring, where \( \sum_{\mu=0}^{1} N_{\text {cells, } r 16}^{\mathrm{DL} \mu}>N_{\text {cells }}^{\text {cap-r16 }} \), a DL BWP of an activated cell is the active DL BWP of the activated cell, and a DL BWP of a deactivated cell is the DL BWP with index provided by firstActiveDownlinkBWP-Id for the deactivated cell, the UE is not required to monitor more than \( M_{\text {PDCCH }}^{\text {total, }(X, Y), \mu}=\mid N_{\text {cells }}^{\text {cap-r16 }} \cdot M_{\text {PDCCH }}^{\text {max, }(X, Y), \mu} \).
\( \left.N_{\text {cell } \mathrm{s}, \mathrm{r} 16}^{\mathrm{DL}(\mathrm{X}, \mathrm{Y}), \mu} / \sum_{j=0}^{1} N_{\text {cells, } \mathrm{r} 16}^{\mathrm{DL}, \mathrm{j}}\right\rfloor \) PDCCH candidates or more than \( C_{\text {PDCCH }}^{\text {total, }(\mathrm{X}, \mathrm{Y}), \mu}=\left\lfloor N_{\text {cells }}^{\text {cap-r16 }} \cdot C_{\text {PDCCH }}^{\text {max, }(\mathrm{X}, \mathrm{Y}), \mu}\right. \).
\( N_{\text {cells, } \mathrm{r} 16}^{\mathrm{DL}(\mathrm{X}, \mathrm{Y}), \mu} / \sum_{j=0}^{1} N_{\text {cells, } \mathrm{r} 16}^{\mathrm{DL}, \mathrm{j}} \) non-overlapped CCEs

ETSI


--- Page 151  ---


3GPP TS 38.213 version 17.1.0 Release 17
150
ETSI TS 138213 V17.1.0 (2022-05)
- per set of spans on the active DL BWP(s) of all scheduling cell(s) from the \( N_{\text {cells }, r 16}^{\mathrm{DL}(\mathrm{X}, \mu} \) downlink cells within every X symbols, if the union of PDCCH monitoring occasions on all scheduling cells from the \( N_{\text {cells }, \mathrm{r} 16}^{\mathrm{DL}(\mathrm{X}, \mathrm{Y}) \mu} \) downlink cells results to PDCCH monitoring according to the combination (X, Y) and any pair of spans in the set is within \( Y \) symbols, where first X symbols start at a first symbol with a PDCCH monitoring occasion and next X symbols start at a first symbol with a PDCCH monitoring occasion that is not included in the first \( X \) symbols
- per set of spans across the active DL BWP(s) of all scheduling cells from the \( N_{\text {cells, } r 16}^{\mathrm{DL}(\mathrm{X}, \mathrm{Y}), \mu} \) downlink cells, with at most one span per scheduling cell for each set of spans, otherwise
where \( N_{\mathrm{cells}, \mathrm{r} 16}^{\mathrm{DL}, \mathrm{j}} \) is a number of configured cells with associated PDCCH candidates monitored in the active DL BWPs of the scheduling cells using SCS configuration \( j \). If a UE is configured with downlink cells for which the UE is provided both monitoringCapabilityConfig \( = \) r 15 monitoringcapability and monitoringCapabilityConfig \( = \) r16monitoringcapability, \( N_{\text {cells }}^{\text {cap-r16 }} \) is replaced by \( N_{\text {cells, r16 }}^{\text {cap-r16 }} \).

For each scheduled cell from the \( N_{\text {cells }, r 16}^{\mathrm{DL}(\mathrm{X}, \mathrm{Y}), \mu} \) downlink cells using combination \( (\mathrm{X}, \mathrm{Y}) \), the UE is not required to monitor on the active DL BWP with SCS configuration \( \mu \) of the scheduling cell, more than \( \min \left(M_{\text {PDCCH }}^{\max \left(X_{Y}, \mu\right.}, M_{\text {PDCCH }}^{\operatorname{total}\left(X_{Y}, \mu\right), \mu}\right) \) PDCCH candidates or more than \( \min \left(C_{\text {PDCCH }}^{\max (X, Y), \mu}, C_{\text {PDCCH }}^{\text {total }(X, Y), \mu}\right) \) non-overlapped CCEs per span.

A UE does not expect to be configured CSS sets, except for CSS sets provided by searchSpaceBroadcast or by searchSpace-Multicast, that result to corresponding total, or per scheduled cell, numbers of monitored PDCCH candidates and non-overlapped CCEs per slot, per group of \( X_{s} \) slots for a corresponding combination \( \left(X_{s}, Y_{s}\right) \), or per span that exceed the corresponding maximum numbers per slot, or per group of \( X_{s} \) slots for a corresponding combination \( \left(X_{s}, Y_{s}\right) \), or per span, respectively.

For same cell scheduling or for cross-carrier scheduling, a UE does not expect a number of PDCCH candidates, and a number of corresponding non-overlapped CCEs per slot, or per group of \( X_{s} \) slots for a corresponding combination ( \( X_{s}, Y_{s} \) ), or per span, on a secondary cell to be larger than the corresponding numbers that the UE is capable of monitoring on the secondary cell per slot, or per group of \( X_{s} \) slots for a corresponding combination \( \left(X_{s}, Y_{s}\right) \), or per span, respectively. If a UE is provided monitoringCapabilityConfig \( = \) rl6monitoringcapability for the primary cell, except the first span of each slot, the UE does not expect a number of PDCCH candidates and a number of corresponding nonoverlapped CCEs per span on the primary cell to be larger than the corresponding numbers that the UE is capable of monitoring on the primary cell per span.

If a UE is configured with \( N_{\text {cells, } 17}^{\mathrm{DL} \mu} \) downlink cells with SCS configuration \( \mu \in\{5,6\} \) in the active DL BWPS of the scheduling cells, and with \( N_{\text {cells, } r 17}^{\mathrm{DL}, X_{S}, \mu} \) of the \( N_{\text {cells, } r 17}^{\mathrm{DL}, \mu} \) downlink cells using any combination \( \left(X_{s}, Y_{s}\right) \) for a group of \( X_{s} \) slots for PDCCH monitoring, where \( \sum_{\mu=5}^{6} N_{\text {cells, } \mathrm{r} 17}^{\mathrm{DL}, \mu} \leq N_{\text {cells }}^{\text {cap-r17 }} \), the UE is not required to monitor, on the active DL BWP of the scheduling cell, more than \( M_{\text {PDCCH }}^{\text {total }, X_{S}, \mu}=M_{\text {PDCCH }}^{\max , X_{S}, \mu} \mathrm{PDCCH} \) candidates or more than \( C_{\text {PDCCH }}^{\text {total }, X_{S}, \mu}=C_{\text {PDCCH }}^{\max , X_{S}, \mu} \) non-overlapped CCEs per group of \( X_{s} \) slots for each scheduled cell when the scheduling cell is from the \( N_{\text {cells, } 17}^{\mathrm{DL}, X_{s}} \) downlink cells. If the UE is configured with downlink cells for which the UE is provided monitoringCapabilityConfig \( = \) r15monitoringcapability and downlink cells for which the UE is provided monitoringCapabilityConfig = r17monitoringcapability for the active DL BWPs, \( N_{\text {cells }}^{\text {cap-r17 }} \) is replaced by \( N_{\text {cells,r17/r15. }}^{\text {cap-r17 }} \). If the UE is configured with downlink cells for which the UE is provided monitoringCapabilityConfig = rl6monitoringcapability and downlink cells for which the UE is provided monitoringCapabilityConfig \( =r 17 \) monitoringcapability for the active DL BWPs, \( N_{\text {cells }}^{\text {cap }-17} \) is replaced by \( N_{\text {cells,r17/r16 }}^{\text {cap-r17 }} \). If the UE is configured with downlink cells for which the UE is provided monitoringCapabilityConfig \( = \) r15monitoringcapability and monitoringCapabilityConfig \( = \) r16monitoringcapability and downlink cells with SCS configuration \( \mu \in\{5,6\} \) for the active DL BWPs, \( N_{\text {cells }}^{\text {cap-r17 }} \) is replaced by \( N_{\text {cells, } \mathrm{r} 17 /\{\mathrm{r} 15, \mathrm{r} 16\}}^{\text {cap-r17 }} \).

If a UE is configured \( N_{\text {cell } \mathrm{r} 17}^{\mathrm{DL}, \mu} \) downlink cells with monitoringCapabilityConfig \( =r 17 \) monitoringcapability for the active DL BWPs of the scheduling cells, and with \( N_{\text {cells, } \mathrm{r} 17}^{\mathrm{DL} X_{\mathrm{S}}, \mu} \) of the \( N_{\text {cells, } 17}^{\mathrm{DL}, \mu} \) downlink cells using any combination \( \left(X_{s}, Y_{s}\right) \) for a group of \( X_{s} \) slots for PDCCH monitoring, where \( \sum_{\mu=5}^{6} N_{\text {cell } \mathrm{s}, \mathrm{r} 17}^{\mathrm{DL}, \mu}>N_{\text {cells }}^{\text {cap-r17 }} \), a DL BWP of an activated cell is the active DL BWP of the activated cell, and a DL BWP of a deactivated cell is the DL BWP with index provided by firstActiveDownlinkBWP-Id for the deactivated cell, the UE is not required to monitor more than \( M_{\text {PDCCH }}^{\text {total }, X_{S}, \mu}= \left\lfloor N_{\text {cells }}^{\text {cap-r17 }} \cdot M_{\text {PDCCH }}^{\text {max, } X_{S}, \mu} \cdot N_{\text {cells, } r 17}^{\mathrm{DL}_{1} X_{S}, \mu} / \sum_{j=5}^{6} N_{\text {cells, } r 17}^{\mathrm{DL}_{1} j}\right\rfloor \) PDCCH candidates, or more than \( C_{\text {PDCCH }}^{\text {total, } X_{S}, \mu}=\left\lfloor N_{\text {cells }}^{\text {cap-r17 }} \cdot C_{\text {PDCCH }}^{\text {max, } X_{S}, \mu}\right. \). \( N_{\text {cells }, \text { 17 }}^{\mathrm{DL}_{,} X_{s}, \mu} / \sum_{j=5}^{6} N_{\text {cells }, \text { 17 } 7}^{\mathrm{DL}_{, j}} \) ] non-overlapped CCEs, per group of \( X_{s} \) slots on the active DL BWP(s) of scheduling cell(s)

ETSI


--- Page 152  ---


3GPP TS 38.213 version 17.1.0 Release 17
151
ETSI TS 138213 V17.1.0 (2022-05)

from the \( N_{\text {cells, } r 17}^{\mathrm{DL}, X_{S}, \mu} \) downlink cells where \( N_{\text {cells, } r 17}^{\mathrm{DL}, j} \) is a number of configured cells with associated PDCCH candidates monitored in the active DL BWPs of the scheduling cells using SCS configuration \( j \). If the UE is configured \( N_{\text {cells, } r 17}^{\mathrm{DL}} \) downlink cells for which the UE is provided both monitoringCapabilityConfig \( = \) r15monitoringcapability or monitoringCapabilityConfig = r16monitoringcapability, and monitoringCapabilityConfig = r17monitoringcapability for the active DL BWP, \( N_{\text {cells }}^{\text {cap-r17 }} \) is replaced by \( N_{\text {cells, } \mathrm{r} 17 / \mathrm{r} 15}^{\text {cap-r17 }} \), or by \( N_{\text {cells, } \mathrm{r} 17 / \mathrm{r} 16}^{\text {cap-r17 }} \), or by \( N_{\text {cells, } \mathrm{r} 17 /\{\mathrm{r} 15, \mathrm{r} 16\}}^{\text {cap-r17 }} \), respectively, and \( \left.N_{\text {cell } \mathrm{s}, \mathrm{r} 17}^{\mathrm{DL}, X_{s}, \mu} / \sum_{j=0}^{6} N_{\text {cell } \mathrm{s}, \mathrm{r} 17}^{\mathrm{DL}, j}\right\rfloor \), and \( N_{\text {cells, } \mathrm{ref}}^{\text {cap-r17 }} \) is one of \( N_{\text {cells, } \mathrm{r} 17 / \mathrm{r} 15}^{\text {cap-r17 }}, N_{\text {cells }, \mathrm{r} 17 / \mathrm{r} 16}^{\text {cap-r17 }} \), or \( N_{\text {cells }, \mathrm{r} 17 /\{\mathrm{r} 15, \mathrm{r} 16\}}^{\text {cap-r17 }} \), respectively.

For each scheduled cell from the \( N_{\text {cells, } r 17}^{\mathrm{DL} X_{s}, \mu} \) downlink cells using any combination \( \left(X_{s}, Y_{s}\right) \) for a group of \( X_{s} \) slots, the UE is not required to monitor on the active DL BWP with SCS configuration \( \mu \) of the scheduling cell, more than \( \min \left(M_{\text {PDCCH }}^{\max , X_{S}, \mu}, M_{\text {PDCCH }}^{\text {total }, X_{S}, \mu}\right) \) PDCCH candidates or more than \( \min \left(C_{\text {PDCCH }}^{\max , X_{S}, \mu}, C_{\text {PDCCH }}^{\text {total }, X_{S}, \mu}\right) \) non-overlapped CCEs per group of \( X_{s} \) slots.

For cross-carrier scheduling, the number of PDCCH candidates for monitoring and the number of non-overlapped CCEs per span or per slot or per group of \( X_{s} \) slots are separately counted for each scheduled cell.

The UE allocates PDCCH candidates for monitoring to USS sets for the primary cell having an active DL BWP with SCS configuration \( \mu \) in a slot if the UE is not provided monitoringCapabilityConfig for the primary cell or if the UE is provided monitoringCapabilityConfig \( = \) r15monitoringcapability for the primary cell, or in the first span of each slot if the UE is provided monitoringCapabilityConfig \( = \) rl6monitoringcapability for the primary cell, or in a group of \( X_{s} \) slots for a corresponding combination \( \left(X_{s}, Y_{s}\right) \) if the UE is provided monitoringCapabilityConfig \( = \) rl 7 monitoringcapability for the primary cell, according to the following pseudocode.

If for the USS sets for scheduling on the primary cell the UE is not provided coresetPoollndex for first CORESETs, or is provided coresetPoollndex with value 0 for first CORESETs, and is provided coresetPoollndex with value 1 for second CORESETs, and if \( \min \left(\gamma \cdot M_{\text {PDCCH }}^{\text {max, slot, } \mu}, M_{\text {PDCCH }}^{\text {total, slot }, \mu}\right)>\min \left(M_{\text {PDCCH }}^{\text {max, slot, } \mu}, M_{\text {PDCCH }}^{\text {total, slot, } \mu}\right) \) or \( \min (\gamma \cdot \left.C_{\text {PDCCH }}^{\text {max, slot, } \mu}, C_{\text {PDCCH }}^{\text {total, slot }, \mu}\right)>\min \left(C_{\text {PDCCH }}^{\text {max, } s \text { lot, } \mu}, C_{\text {PDCCH }}^{\text {total, slot, } \mu}\right) \), the following pseudocode applies only to USS sets associated with the first CORESETs. A UE does not expect to monitor PDCCH in a USS set without allocated PDCCH candidates for monitoring.

In the following pseudocode, if the UE is provided monitoringCapabilityConfig \( = \) rl6monitoringcapability for the primary cell, \( M_{\text {PDCCH }}^{\text {max, } s \text { lot, } \mu} \) and \( C_{\text {PDCCH }}^{\text {max, } s \text { lot, } \mu} \) are replaced by \( M_{\text {PDCCH }}^{\max _{1}(X, Y) \mu} \) and \( C_{\text {PDCCH }}^{\max (X, Y), \mu} \) respectively, and \( M_{\text {PDCCH }}^{\text {total, slot }, \mu} \) and \( C_{\text {PDCCH }}^{\text {total, slot. } \mu} \) are replaced by \( M_{\text {PDCCH }}^{\text {total, }(X, Y) \mu} \) and \( C_{\text {PDCCH }}^{\text {total, }(X, Y) \mu} \) respectively.

In the following pseudocode, if the UE is provided monitoringCapabilityConfig \( = \) r17monitoringcapability for the primary cell, \( M_{\text {PDCCH }}^{\max , \text { slot }, \mu} \) and \( C_{\text {PDCCH }}^{\max , \text { slot }, \mu} \) are replaced by \( M_{\text {PDCCH }}^{\max , X_{\mathrm{S}, \mu} \mu} \) and \( C_{\text {PDCCH }}^{\max , X_{\mathrm{S}, \mu} \mu} \) respectively, and \( M_{\text {PDCCH }}^{\text {total, } \text { slot }, \mu} \) and \( C_{\text {PDCCH }}^{\text {total, slot } \mu} \) are replaced by \( M_{\text {PDCCH }}^{\text {total, } X_{s}, \mu} \) and \( C_{\text {PDCCH }}^{\text {total, } X_{s}, \mu} \) respectively.

For all search space sets that a UE monitors PDCCH on the primary cell within a slot \( n \), or within a group of \( X_{s} \) slots for a corresponding combination \( \left(X_{s}, Y_{s}\right) \), or within a span in slot \( n \), denote by \( S_{\text {css }} \) a set of CSS sets, except for CSS sets provided by searchSpaceBroadcast or by searchSpace-Multicast, with cardinality of \( I_{\mathrm{css}} \) and by \( S_{\mathrm{uss}} \) a set of USS sets and CSS sets provided by searchSpaceBroadcast or by searchSpace-Multicast with cardinality of \( J_{\text {uss }} \) for scheduling on the primary cell. The location of search space sets \( s_{j}, 0 \leq j<J_{u s s} \), in \( S_{\text {uss }} \) is according to an ascending order of the search space set index.

Denote by \( M_{S_{\mathrm{css}}(i)}^{(L)}, 0 \leq i<I_{c S S} \), the number of counted PDCCH candidates for monitoring for CSS set \( S_{\mathrm{css}}(i) \) and by \( M_{S_{\mathrm{uss}}(j)}^{(L)}, 0 \leq j<J_{u s s} \), the number of counted PDCCH candidates for monitoring for search space set \( S_{\mathrm{uss}}(j) \). If a UE indicates three-BDforSSsetLinking and is provided for search space set \( s_{j} \), by searchSpaceLinking, a search space set \( s_{i} \) with \( s_{i}<s_{j} \), set \( M_{S_{\mathrm{css}}(j)}^{(L)}=2 \cdot M_{S_{\mathrm{css}}(j)}^{(L)} \) if \( s_{i} \) and \( s_{j} \) are CSS sets or set \( M_{S_{\mathrm{uss}}(j)}^{(L)}=2 \cdot M_{S_{\mathrm{uss}}(j)}^{(L)} \) if \( s_{i} \) and \( s_{j} \) are USS sets.

For the CSS sets in \( S_{\mathrm{css}} \), a UE monitors \( M_{\text {PDCCH }}^{\mathrm{css}}=\sum_{i=0}^{I_{\mathrm{css}}-1} \sum_{L} M_{S_{\mathrm{css}}(i)}^{(L)} \) PDCCH candidates requiring a total of \( C_{\text {PDCCH }}^{\mathrm{css}} \) non-overlapping CCEs in a slot, of in group of \( X_{s} \) slots for a corresponding combination ( \( X_{s}, Y_{s} \) ), or in a span.

Denote by \( V_{\text {CCE }}\left(S_{\text {uss }}(j)\right) \) the set of non-overlapping CCEs for search space set \( S_{\text {uss }}(j) \) and by \( C\left(V_{\text {CCE }}\left(S_{\text {uss }}(j)\right)\right) \); the cardinality of \( V_{\text {CCE }}\left(S_{\text {uss }}(j)\right) \) where a UE determines the non-overlapping CCEs for search space set \( S_{\text {uss }}(j) \) considering the allocated PDCCH candidates for monitoring for the CSS sets in \( S_{\mathrm{css}} \) and the allocated PDCCH candidates for monitoring for all search space sets \( S_{\text {uss }}(k), 0 \leq k \leq j \).

ETSI


--- Page 153  ---


3GPP TS 38.213 version 17.1.0 Release 17
152
ETSI TS 138213 V17.1.0 (2022-05)

Set \( M_{\text {PDCCH }}^{\text {uss }}=\min \left(M_{\text {PDCCH }}^{\text {tax, slot, } \mu}, M_{\text {PDCCH }}^{\text {total, slot, } \mu}\right)-M_{\text {PDCCH }}^{\text {css }} \)
Set \( C_{\text {PDCCH }}^{\mathrm{uss}}=\min \left(C_{\text {PDCCH }}^{\mathrm{max}, \text { slot }, \mu}, C_{\text {PDCCH }}^{\text {total,slot }, \mu}\right)-C_{\text {PDCCH }}^{\mathrm{css}} \)
Set \( j=0 \)
while \( \sum_{L} M_{S_{\mathrm{uss}}(j)}^{(L)} \leq M_{\text {PDCCH }}^{\mathrm{uss}} \) AND \( \mathcal{C}\left(V_{\text {CCE }}\left(S_{\mathrm{uss}}(j)\right)\right) \leq C_{\text {PDCCH }}^{\mathrm{uss}} \)
allocate \( \sum_{L} M_{S_{\text {uss }}(j)}^{(L)} \) PDCCH candidates for monitoring to search space set \( S_{\text {uss }}(j) \)
\[
\begin{array}{l}
M_{\mathrm{PDCCH}}^{\mathrm{uss}}=M_{\mathrm{PDCCH}}^{\mathrm{uss}}-\sum_{L} M_{S_{\mathrm{uss}}(j)}^{(L)} \\
C_{\mathrm{PDCCH}}^{\mathrm{uss}}=C_{\mathrm{PDCCH}}^{\mathrm{uss}}-c\left(V_{\mathrm{CCE}}\left(S_{\mathrm{uss}}(j)\right)\right) \\
j=j+1
\end{array}
\]
end while
If a UE
- is configured for single cell operation or for operation with carrier aggregation in a same frequency band, and
- monitors PDCCH candidates in overlapping PDCCH monitoring occasions in multiple CORESETs that have been configured with same or different qcl-Type set to 'typeD' properties on active DL BWP(s) of one or more cells
the UE monitors PDCCHs only in a CORESET, and in any other CORESET from the multiple CORESETs that have been configured with qci-Type set to same 'typeD' properties as the CORESET, on the active DL BWP of a cell from the one or more cells
- the CORESET corresponds to the CSS set with the lowest index in the cell with the lowest index containing CSS, if any; otherwise, to the USS set with the lowest index in the cell with lowest index
- the lowest USS set index is determined over all USS sets with at least one PDCCH candidate in overlapping PDCCH monitoring occasions

If a UE
- is configured for single cell operation or for operation with carrier aggregation in a same frequency band,
- monitors PDCCH candidates in overlapping PDCCH monitoring occasions in multiple CORESETs that have been configured with same or different qcl-Type set to 'typeD' properties on active DL BWP(s) of one or more cells, and
- is provided two-QCLTypeDforPDCCHRepetition
the UE monitors PDCCHs only in a first CORESET with qcl-Type set to first 'typeD' properties and, if any, in a second CORESET with qcl-Type set to second 'typeD' properties that are different than the first 'typeD' properties, and in any other CORESET from the multiple CORESETs with corresponding qcl-Type set to the first 'typeD' properties and/or to the second 'typeD' properties
- the first CORESET corresponds to the CSS set with the lowest index in the cell with the lowest index containing CSS sets, if any; otherwise, to the USS set with the lowest index in the cell with lowest index
- excluding CSS sets and USS sets associated with CORESETs with qcl-Type set to first 'typeD' properties, the second CORESET corresponds to the CSS set with the lowest index in the cell with the lowest index containing CSS sets; if any; otherwise, to the USS set with the lowest index in the cell with lowest index, where the CSS set or the USS set includes searchSpaceLinking with a value indicating, respectively, any CSS set or any USS set associated with CORESETs with qcl-Type set to first 'typeD' properties
- the lowest USS set index is determined over all USS sets with at least one PDCCH candidate in overlapping PDCCH monitoring occasions

If a UE

ETSI


--- Page 154  ---


3GPP TS 38.213 version 17.1.0 Release 17
153
ETSI TS 138213 V17.1.0 (2022-05)
- is configured for single cell operation or for operation with carrier aggregation in a same frequency band,
- monitors PDCCH candidates in overlapping PDCCH monitoring occasions in multiple CORESETs that have been configured with same or different qcl-Type set to 'typeD' properties on active DL BWP(s) of one or more cells,
- one or more CORESETs have two activated TCI states, and
- reports twoTypeDcapabilityname
the UE monitors PDCCHs only in a CORESET with a first qcl-Type set to first 'typeD' properties and, if any, a second qcl-Type set to second 'typeD' properties that are different than the first 'typeD' properties, and in any other CORESET from the multiple CORESETs with corresponding qcl-Type set to the first 'typeD' properties or to the second 'typeD' properties
- the CORESET corresponds to the CSS set with the lowest index in the cell with the lowest index containing CSS, if any; otherwise, to the USS set with the lowest index in the cell with lowest index
- the lowest USS set index is determined over all USS sets with at least one PDCCH candidate in overlapping PDCCH monitoring occasions

For the purpose of determining the CORESET, a SS/PBCH block is considered to have different QCL 'typeD' properties than a CSI-RS.

For the purpose of determining the CORESET, a first CSI-RS associated with a SS/PBCH block in a first cell and a second CSI-RS in a second cell that is also associated with the SS/PBCH block are assumed to have same QCL 'typeD' properties.

The allocation of non-overlapping CCEs and of PDCCH candidates for PDCCH monitoring is according to all search space sets associated with the multiple CORESETs on the active DL BWP(s) of the one or more cells.

The number of active TCI states is determined from the multiple CORESETs.
If a UE
- is configured for single cell operation or for operation with carrier aggregation in a same frequency band, and
- monitors PDCCH candidates in overlapping PDCCH monitoring occasions in multiple CORESETs where none of the CORESETs has TCI-states configured with qcl-Type set to 'typeD',
the UE is required to monitor PDCCH candidates in overlapping PDCCH monitoring occasions for search space sets associated with different CORESETs.

For a scheduled cell and at any time, if a UE is provided a C-RNTI, the UE expects to have received at most 16 PDCCHs for DCI formats with CRC scrambled by C-RNTI, CS-RNTI, MCS-C-RNTI, G-RNTI for multicast, or G-CSRNTI scheduling 16 PDSCH receptions for which the UE has not received any corresponding PDSCH symbol and at most 16 PDCCHs for DCI formats with CRC scrambled by C-RNTI, CS-RNTI, or MCS-C-RNTI scheduling 16 PUSCH transmissions for which the UE has not transmitted any corresponding PUSCH symbol.

If a UE is not provided monitoringCapabilityConfig \( = \) r16monitoringcapability for any serving cell, and
- is not configured for NR-DC operation and indicates through pdcch-BlindDetectionCA a capability to monitor PDCCH candidates for \( N_{\text {cells }}^{\text {cap }} \geq 4 \) downlink cells and the UE is configured with \( N_{\text {cells }}^{\mathrm{DL}}>4 \) downlink cells or \( N_{\text {cells }}^{\mathrm{UL}}>4 \) uplink cells, or
- is configured with NR-DC operation and for a cell group with \( N_{\text {cells }}^{\text {DL }} \) downlink cells or \( N_{\text {cells }}^{\text {UL }} \) uplink cells the UE expects to have respectively received at most \( 16 \cdot N_{\text {cells }}^{\text {cap }} \) PDCCHs for
- DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }}^{\text {cap }} \) PDSCH receptions for which the UE has not received any corresponding PDSCH symbol over all \( N_{\text {cells }}^{\mathrm{DL}} \) downlink cells

ETSI


--- Page 155  ---


3GPP TS 38.213 version 17.1.0 Release 17
154
ETSI TS 138213 V17.1.0 (2022-05)
- DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }}^{\text {cap }} \) PUSCH transmissions for which the UE has not transmitted any corresponding PUSCH symbol over all \( N_{\text {cells }}^{\text {UL }} \) uplink cells

If a UE is provided monitoringCapabilityConfig \( = \) r16monitoringcapability for all serving cells, and
- is not configured for NR-DC operation and indicates through pdcch-MonitoringCA a capability to monitor PDCCH candidates for \( N_{\text {cells }}^{\text {cap }-r 16} \geq 2 \) downlink cells and the UE is configured with \( N_{\text {cells }}^{\mathrm{DL}}>2 \) downlink cells or \( N_{\text {cells }}^{\text {UL }}>2 \) uplink cells, or
- is configured with NR-DC operation and for a cell group with \( N_{\text {cells }}^{\text {DL }} \) downlink cells or \( N_{\text {cells }}^{\text {UL }} \) uplink cells the UE expects to have respectively received at most \( 16 \cdot N_{\text {cells }}^{\text {cap }-r 16} \) PDCCHs for
- DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }}^{\text {cap }}{ }^{r 16} \) PDSCH receptions for which the UE has not received any corresponding PDSCH symbol over all \( N_{\text {cells }}^{\text {DL }} \) downlink cells
- DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }}^{\text {cap }}{ }^{r 16} \) PUSCH transmissions for which the UE has not transmitted any corresponding PUSCH symbol over all \( N_{\text {cells }}^{\text {UL }} \) uplink cells.

If a UE is provided monitoringCapabilityConfig \( = \) rl6monitoringcapability for at least one serving cell and is not provided monitoringCapabilityConfig \( = \) rl6monitoringcapability for at least one serving cell, and
- is not configured for NR-DC operation, and indicates a capability to monitor PDCCH candidates for \( N_{\text {cells } r 15}^{\text {cap }-r 16} \geq \) 1 downlink cells and \( N_{\text {cells } r 16}^{\text {cap }-r 16} \geq 1 \) downlink cells, and the UE is configured with \( N_{\text {cells }}^{\text {DL }}>1 \) downlink cells or \( N_{\text {cells }}^{\text {UL }}>1 \) uplink cells, or
- is configured with NR-DC operation and for a cell group with \( N_{\text {cells }}^{\text {DL }} \) downlink cells or \( N_{\text {cells }}^{\text {UL }} \) uplink cells
the UE expects to have respectively received
- at most \( 16 \cdot N_{\text {cells }, r 15}^{\text {cap }-r 16} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }, r 15}^{\text {cap-r } 16} \) PDSCH receptions for which the UE has not received any corresponding PDSCH symbol over all serving cells that are not provided monitoringCapabilityConfig = rl6monitoringcapability
- at most \( 16 \cdot N_{\text {cells }, r 15}^{\text {cap }-r 16} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells } r 15}^{\text {cap }-r 16} \) PUSCH transmissions for which the UE has not transmitted any corresponding PUSCH symbol over all serving cells that are not provided monitoringCapabilityConfig \( = \) rl6monitoringcapability
- at most \( 16 \cdot N_{\text {cells }, r 16}^{\text {cap }-r 16} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }, r 16}^{\text {cap }-r 16} \) PDSCH receptions for which the UE has not received any corresponding PDSCH symbol over all serving cells that are provided monitoringCapabilityConfig \( = \) rl6monitoringcapability
- at most \( 16 \cdot N_{\text {cells }, r 16}^{\text {cap }-r 16} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells } r 16}^{\text {cap-r16 }} \) PUSCH transmissions for which the UE has not transmitted any corresponding PUSCH symbol over all serving cells that are provided monitoringCapabilityConfig \( = \) rl6monitoringcapability

If a UE is provided serving cells with SCS configuration \( \mu \in\{5,6\} \) for the active DL BWP, is not configured for NRDC operation and indicates through pdcch-MonitoringCA a capability to monitor PDCCH candidates for \( N_{\text {cells }}^{\text {cap- } r 17} \geq 4 \) downlink cells and the UE is configured with \( N_{\text {cells }}^{\mathrm{DL}}>4 \) downlink cells or \( N_{\text {cells }}^{\mathrm{UL}}>4 \) uplink cells, the UE expects to have respectively received at most \( 16 \cdot N_{\text {cells }}^{\text {cap-r17 }} \) PDCCHs for
- DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }}^{\text {cap-r17 }} \) PDSCH receptions for which the UE has not received any corresponding PDSCH symbol over all \( N_{\text {cells }}^{\text {DL }} \) downlink cells

ETSI


--- Page 156  ---


3GPP TS 38.213 version 17.1.0 Release 17
155
ETSI TS 138213 V17.1.0 (2022-05)
- DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }}^{\text {cap-r } 17} \) PUSCH transmissions for which the UE has not transmitted any corresponding PUSCH symbol over all \( N_{\text {cells }}^{\text {UL }} \) uplink cells.

If a UE is provided monitoringCapabilityConfig \( = \) r17monitoringcapability for at least one serving cell, is provided monitoringCapabilityConfig = r15monitoringcapability for at least one serving cell, is not provided monitoringCapabilityConfig = r16monitoringcapability for any serving cell, is not configured for NR-DC operation, indicates a capability to monitor PDCCH candidates for \( N_{\text {cells }, r 15 / r 17}^{\text {cap- } r 17} \geq 1 \) downlink cells and \( N_{\text {cells }, r 17 / r 15}^{\text {cap- } r 17} \geq 1 \) downlink cells, and UE is configured with \( N_{\text {cells }}^{\mathrm{DL}}>1 \) downlink cell or \( N_{\text {cells }}^{\mathrm{UL}}>1 \) uplink cells, the UE expects to have respectively received
- at most \( 16 \cdot N_{\text {cells } r 15 / r 17}^{\text {cap }-r 17} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells } r 15 / r 17}^{\text {cap-r17 }} \) PDSCH receptions for which the UE has not received any corresponding PDSCH symbol over all serving cells that are provided monitoring CapabilityConfig \( = \) r15monitoringcapability
- at most \( 16 \cdot N_{\text {cells }, r 15 / r 17}^{\text {cap }-r 17} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }, r 15 / r 17}^{\text {cap-r17 }} \) PUSCH transmissions for which the UE has not transmitted any corresponding PUSCH symbol over all serving cells that are provided monitoring CapabilityConfig \( = \) r15monitoringcapability
- at most \( 16 \cdot N_{\text {cells }, r 17 / r 15}^{\text {cap-r17 }} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }, r 17 / r 15}^{\text {cap-r17 }} \) PDSCH receptions for which the UE has not received any corresponding PDSCH symbol over all serving cells with monitoringCapabilityConfig \( = \) rl7monitoringcapability
- at most \( 16 \cdot N_{\text {cells }, r 17 / r 15}^{\text {cap-r17 }} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }, r 17 / r 15}^{\text {cap-r17 }} \) PUSCH transmissions for which the UE has not transmitted any corresponding PUSCH symbol over all serving cells with monitoringCapabilityConfig \( = \) rl7monitoringcapability

If a UE is provided monitoringCapabilityConfig \( = \) r17monitoringcapability for at least one serving cell, is provided monitoringCapabilityConfig = rl6monitoringcapability for at least one serving cell, is not provided monitoringCapabilityConfig = r15monitoringcapability for any serving cell, is not configured for NR-DC operation, indicates a capability to monitor PDCCH candidates for \( N_{\text {cell } s, r 16 / r 17}^{\text {cap- } r 17} \geq 1 \) downlink cells and \( N_{\text {cells }, r 17 / r 16}^{\text {cap- } r 17} \geq 1 \) downlink cells, and the UE is configured with \( N_{\text {cells }}^{\mathrm{DL}}>1 \) downlink cells or \( N_{\text {cells }}^{\mathrm{UL}}>1 \) uplink cells
the UE expects to have respectively received
- at most \( 16 \cdot N_{\text {cells }, r 16 / r 17}^{\text {cap }-r 17} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }, r 16 / r 17}^{\text {cap-r17 }} \) PDSCH receptions for which the UE has not received any corresponding PDSCH symbol over all serving cells that are provided monitoring CapabilityConfig \( = \) rl6monitoringcapability
- at most \( 16 \cdot N_{\text {cells } r 16 / r 17}^{\text {cap }-r 17} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells } r 16 / r 17}^{\text {cap-r17 }} \) PUSCH transmissions for which the UE has not transmitted any corresponding PUSCH symbol over all serving cells that are provided monitoring CapabilityConfig \( = \) rl6monitoringcapability
- at most \( 16 \cdot N_{\text {cells }, r 17 / r 16}^{\text {cap }-r 17} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }, r 17 / r 16}^{\text {cap-r17 }} \) PDSCH receptions for which the UE has not received any corresponding PDSCH symbol over all serving cells with monitoringCapabilityConfig \( = \) rl 7monitoringcapability
- at most \( 16 \cdot N_{\text {cells }, r 17 / r 16}^{\text {cap }-r 17} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells } r 17 / r 16}^{\text {cap-r17 }} \) PUSCH transmissions for which the UE has not transmitted any

ETSI


--- Page 157  ---


3GPP TS 38.213 version 17.1.0 Release 17
156
ETSI TS 138213 V17.1.0 (2022-05)

corresponding PUSCH symbol over all serving cells with monitoringCapabilityConfig \( = \) rl 7monitoringcapability

If a UE is provided monitoringCapabilityConfig \( =r 17 \) monitoringcapability for at least one serving cell, is provided monitoringCapabilityConfig = rl6monitoringcapability for at least one serving cell, and monitoringCapabilityConfig = r15monitoringcapability for at least one serving cell, is not configured for NR-DC operation, indicates a capability to monitor PDCCH candidates for \( N_{\text {cells }, r 15 /\{r 16, r 17\}}^{\text {cap }-r 17} \geq 1 \) downlink cells, \( N_{\text {cells }, r 16 /\{r 15, r 17\}}^{\text {cap- } r 17} \geq 1 \), and \( N_{\text {cell }, r 17 /\{r 15, r 16\}}^{\text {cap- } r 17} \geq 1 \) downlink cells, and is configured with \( N_{\text {cells }}^{\mathrm{DL}}>1 \) downlink cells or \( N_{\text {cells }}^{\mathrm{UL}}>1 \) uplink cells
the UE expects to have respectively received
- at most \( 16 \cdot N_{\text {cells }, r 15 /\{r 16, r 17\}}^{\text {cap }-r 17} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells, } r 15 /\{r 16, r 17\}}^{\text {cap }-r 17} \) PDSCH receptions for which the UE has not received any corresponding PDSCH symbol over all serving cells that are provided monitoringCapabilityConfig \( = \) r15monitoringcapability
- at most \( 16 \cdot N_{\text {cells, } r 15 /\{r 16, r 17\}}^{\text {cap }-r 17} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells, } r 15 /\{r 16, r 17\}}^{\text {cap-r17 }} \) PUSCH transmissions for which the UE has not transmitted any corresponding PUSCH symbol over all serving cells that are provided monitoring CapabilityConfig \( = \) r15monitoringcapability
- at most \( 16 \cdot N_{\text {cells }, r 16 /\{r 15, r 17\}}^{\text {cap }-r 17} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells, } r 16 /\{r 15, r 17\}}^{\text {cap }-r 17} \) PDSCH receptions for which the UE has not received any corresponding PDSCH symbol over all serving cells that are provided monitoringCapabilityConfig \( = \) rl6monitoringcapability
- at most \( 16 \cdot N_{\text {cells }, r 16 /\{r 15, r 17\}}^{\text {cap }-r 17} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }, r 16 /\{r 15, r 17\}}^{\text {cap-r17 }} \) PUSCH transmissions for which the UE has not transmitted any corresponding PUSCH symbol over all serving cells that are provided monitoring CapabilityConfig \( = \) rl6monitoringcapability
- at most \( 16 \cdot N_{\text {cells }, r 17 /\{r 16, r 17\}}^{\text {cap }-r 17} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells, } r 17 /\{r 16, r 17\}}^{\text {cap }-r 17} \) PDSCH receptions for which the UE has not received any corresponding PDSCH symbol over all serving cells with monitoringCapabilityConfig \( = \) rl 7monitoringcapability
- at most \( 16 \cdot N_{\text {cells }, r 17 /\{r 16, r 17\}}^{\text {cap }-r 17} \) PDCCHs for DCI formats with CRC scrambled by a C-RNTI, or a CS-RNTI, or a MCS-C-RNTI scheduling \( 16 \cdot N_{\text {cells }, r 17 /\{r 16, r 17\}}^{\text {cap-r17 }} \) PUSCH transmissions for which the UE has not transmitted any corresponding PUSCH symbol over all serving cells with monitoringCapabilityConfig \( = \) rl 7monitoringcapability

If a UE
- is configured to monitor a first PDCCH candidate for a DCI format \( 0 \_0 \) and a DCI format \( 1 \_0 \) from a CSS set and a second PDCCH candidate for a DCI format \( 0 \_0 \) and a DCI format \( 1 \_0 \) from a USS set, where the CSS set and the USS set do not include searchSpaceLinking, in a CORESET with index zero on an active DL BWP, and
- the DCI formats \( 0 \_0 / 1 \_0 \) associated with the first PDCCH candidate and the DCI formats \( 0 \_0 / 1 \_0 \) associated with the second PDCCH candidate have same size, and
- the UE receives the first PDCCH candidate and the second PDCCH candidate over a same set of CCEs, and
- the first PDCCH candidate and the second PDCCH candidate have identical scrambling, and
- the DCI formats \( 0 \_0 / 1 \_0 \) for the first PDCCH candidate and the DCI formats \( 0 \_0 / 1 \_0 \) for the second PDCCH candidate have CRC scrambled by either C-RNTI, or MCS-C-RNTI, or CS-RNTI
the UE decodes only the DCI formats \( 0 \_0 / 1 \_0 \) associated with the first PDCCH candidate.
If a UE detects a DCI format with inconsistent information, the UE discards all the information in the DCI format.

ETSI


--- Page 158  ---


3GPP TS 38.213 version 17.1.0 Release 17
157
ETSI TS 138213 V17.1.0 (2022-05)

A UE configured with a bandwidth part indicator in a DCI format determines, in case of an active DL BWP or of an active UL BWP change, that the information in the DCI format is applicable to the new active DL BWP or UL BWP, respectively, as described in clause 12 .

For unpaired spectrum operation, if a UE is not configured for PUSCH/PUCCH transmission on serving cell \( c_{2} \), the UE does not expect to monitor PDCCH on serving cell \( c_{1} \) if the PDCCH overlaps in time with SRS transmission (including any interruption due to uplink or downlink RF retuning time [ 10 , TS 38.133]) on serving cell \( c_{2} \) and if the UE is not capable of simultaneous reception and transmission on serving cell \( c_{1} \) and serving cell \( c_{2} \).

If a UE is provided resourceBlocks and symbolsInResourceBlock in RateMatchPattern of PDSCH-Config, or if the UE is additionally provided periodicityAndPattern in RateMatchPattern of PDSCH-Config, the UE can determine a set of RBs in symbols of a slot that are not available for PDSCH reception scheduled by a unicast DCI format as described in [6, TS 38.214]. If a PDCCH candidate that provides a unicast DCI format is mapped to one or more REs that overlap with REs of any RB in the set of RBs in symbols of the slot, the UE does not expect to monitor the PDCCH candidate.

If a UE is provided resourceBlocks and symbolsInResourceBlock in RateMatchPattern of PDSCH-Config-Multicast, or if the UE is additionally provided periodicityAndPattern in RateMatchPattern of PDSCH-Config-Multicast, the UE can determine a set of RBs in symbols of a slot that are not available for PDSCH reception scheduled by a multicast DCI format. If a PDCCH candidate that provides a multicast DCI format is mapped to one or more REs that overlap with REs of any RB in the set of RBs in symbols of the slot, the UE does not expect to monitor the PDCCH candidate.

A UE does not expect to be configured with dci-FormatsSL and dci-FormatsExt in a same USS.
10.1.1 Self-carrier and cross-carrier scheduling on the primary cell

A UE can be configured for scheduling on the primary cell from the primary cell and from a secondary cell [ 12 , TS 38.331]. The UE is either not provided monitoringCapabilityConfig or the UE is provided only monitoringCapabilityConfig = r15monitoringcapability for the primary cell and for the secondary cell. The UE is not provided coresetPoollndex on the primary cell or on the secondary cell.

The SCS configuration \( \mu_{P} \) for the active DL BWP on the primary cell is smaller than or equal to the SCS configuration \( \mu_{S} \) for the active DL BWP on the secondary cell.

For the remaining of this clause, either the secondary cell is activated and the active DL BWP is not a dormant DL BWP for a UE, or the UE does not indicate a capability [16, TS 36.306] for disabling \( \alpha \) that is provided by ccsBlindDetectionSplit; otherwise, procedures described in the remaining of this clause are not applicable for the UE and the procedures are as described in clause 10.1.

If \( \mu_{P}<\mu_{S} \), the UE determines \( M_{\text {PDCCH }}^{\text {total, slot }, \mu_{P}} \) and \( C_{\text {PDCCH }}^{\text {total, slot }, \mu_{P}} \), and determines \( M_{\text {PDCCH }}^{\text {total, slot }, \mu_{S}} \) and \( C_{\text {PDCCH }}^{\text {total, slot }, \mu_{S}} \), by including the primary cell only in the \( N_{\text {cells }, 0}^{\mathrm{DL}, \mu_{P}} \) downlink cells in \( \sum_{j=0}^{3}\left(N_{\text {cells }, 0}^{\mathrm{DL}, j}+\gamma \cdot N_{\text {cells }, \mathrm{I}}^{\mathrm{DL}, j}\right) \), as described in clause 10.1. If \( \mu_{P}=\mu_{S}= \mu \), the UE determines \( M_{\text {PDCCH }}^{\text {total, slot }, \mu} \) and \( C_{\text {PDCCH }}^{\text {total, slot }, \mu} \) by including the primary cell once in the \( N_{\text {cells }, 0}^{\mathrm{DL}, \mu} \) downlink cells in \( \sum_{j=0}^{3}\left(N_{\text {cells }, 0}^{\mathrm{DL}, j}+\gamma \cdot N_{\text {cells }, \mathrm{I}}^{\mathrm{DL}, j}\right) \), as described in clause 10.1.

For scheduling on the primary cell from the primary cell, the UE is not required to monitor more than \( \left\lfloor\alpha \cdot \min \left(M_{\text {PDCCH }}^{\max , \text { slot }, \mu_{P}}, M_{\text {PDCCH }}^{\text {total }, \text { slot }, \mu_{P}}\right)\right\rfloor \) PDCCH candidates per slot or more than \( \left\lfloor\alpha \cdot \min \left(C_{\text {PDCCH }}^{\text {max, slot, } \mu_{P}}, C_{\text {PDCCH }}^{\text {total, slot, } \mu_{P}}\right)\right\rfloor \) nonoverlapping CCEs per slot on the active DL BWP of the primary cell, where \( \alpha \) is provided by ccs-BlindDetectionSplit.

For scheduling on the primary cell from the secondary cell, the UE is not required to monitor on the active DL BWP of the secondary cell more than
- \( M_{\text {PDCCH }}^{\text {max, } s l o t, \mu S} \) PDCCH candidates per slot or more than \( C_{\text {PDCCH }}^{\text {max, } s l o t, \mu_{S}} \) non-overlapping CCEs per slot of the active DL BWP of the secondary cell
- \( \min \left(M_{\text {PDCCH }}^{\text {max }, \text { slot }, \mu_{P}}, M_{\text {PDCCH }}^{\text {total, slot }, \mu_{P}}\right)-\left\lfloor\alpha \cdot \min \left(M_{\text {PDCCH }}^{\text {max, } \text { slot, } \mu_{P}}, M_{\text {PDCCH }}^{\text {total, slot, } \mu_{P}}\right)\right\rfloor \) PDCCH candidates per slot or more than \( \min \left(C_{\text {PDCCH }}^{\text {max, slot, } \mu_{P}}, C_{\text {PDCCH }}^{\text {total, slot }}, \mu_{P}\right)-\left\lfloor\alpha \cdot \min \left(C_{\text {PDCCH }}^{\text {max, slot, } \mu_{P}}, C_{\text {PDCCH }}^{\text {total, slot, } \mu_{P}}\right)\right\rfloor \) non-overlapping CCEs per slot of the active DL BWP of the primary cell

If \( \mu_{P}<\mu_{S} \), the UE does not count PDCCH candidates and non-overlapping CCEs that the UE monitors for scheduling on the primary cell from the secondary cell towards \( M_{\text {PDCCH }}^{\text {total, } \text { slot }, \mu_{S}} \) and \( C_{\text {PDCCH }}^{\text {total, slot }, \mu_{S}} \), respectively.

ETSI


--- Page 159  ---


3GPP TS 38.213 version 17.1.0 Release 17
158
ETSI TS 138213 V17.1.0 (2022-05)

If \( \mu_{P}<\mu_{S} \), the UE counts PDCCH candidates and non-overlapping CCEs that the UE monitors for scheduling on the primary cell from the secondary cell towards \( M_{\text {PDCCH }}^{\text {total, slot } \mu_{P}} \) and \( C_{\text {PDCCH }}^{\text {total, slot } \mu_{P}} \), respectively.

For allocation of PDCCH candidates and non-overlapping CCEs to search space sets for scheduling on the primary cell from the primary cell, the UE applies the procedure in clause 10.1 using \( \left\lfloor\alpha \cdot \min \left(M_{\text {PDCCH }}^{\text {max, slot, } \mu}, M_{\text {PDCCH }}^{\text {total, slot, } \mu}\right)\right\rfloor \) instead of \( \min \left(M_{\text {PDCCH }}^{\text {max, slot }, \mu}, M_{\text {PDCCH }}^{\text {total, slot }, \mu}\right) \), and using \( \left\lfloor\alpha \cdot \min \left(C_{\text {PDCCH }}^{\text {max, slot, } \mu}, C_{\text {PDCCH }}^{\text {total, slot }, \mu}\right)\right\rfloor \) instead of \( \min \left(C_{\text {PDCCH }}^{\text {max, slot, } \mu}, C_{\text {PDCCH }}^{\text {total, slot, } \mu}\right) \) for the primary cell.
10.2 PDCCH validation for DL SPS and UL grant Type 2

A UE validates, for scheduling activation or scheduling release, a DL SPS assignment PDCCH or a configured UL grant Type 2 PDCCH if
- the CRC of a corresponding DCI format is scrambled with a CS-RNTI provided by \( c s \)-RNTI or a G-CS-RNTI provided by g-cs-RNTI, and
- the new data indicator field in the DCI format for the enabled transport block is set to ' 0 ', and
- the DFI flag field, if present, in the DCI format is set to ' 0 ', and
- the time domain resource assignment field in the DCI format indicates a row with single SLIV, and
- if validation is for scheduling activation and if the PDSCH-to-HARQ_feedback timing indicator field in the DCI format is present, the PDSCH-to-HARQ_feedback timing indicator field does not provide an inapplicable value from dl-DataToUL-ACK-r16.

If a UE is provided a single configuration for UL grant Type 2 PUSCH or for SPS PDSCH, validation of the DCI format is achieved if all fields for the DCI format are set according to Table 10.2-1 or Table 10.2-2.

If a UE is provided more than one configuration for UL grant Type 2 PUSCH or for SPS PDSCH, a value of the HARQ process number field in a DCI format indicates an activation for a corresponding UL grant Type 2 PUSCH or for a SPS PDSCH configuration with a same value as provided by ConfiguredGrantConfigIndex or by sps-ConfigIndex, respectively. Validation of the DCI format is achieved if the RV field for the DCI format is set as in Table 10.2-3.

If a UE is provided more than one configuration for UL grant Type 2 PUSCH or for SPS PDSCH
- if the UE is provided ConfiguredGrantConfigType2DeactivationStateList or sps-ConfigDeactivationStateList, a value of the HARQ process number field in a DCI format indicates a corresponding entry for scheduling release of one or more UL grant Type 2 PUSCH or SPS PDSCH configurations
- if the UE is not provided ConfiguredGrantConfigType2DeactivationStateList or spsConfigDeactivationStateList, a value of the HARQ process number field in a DCI format indicates a release for a corresponding UL grant Type 2 PUSCH or for a SPS PDSCH configuration with a same value as provided by ConfiguredGrantConfigIndex or by sps-ConfigIndex, respectively

Validation of the DCI format is achieved if all fields for the DCI format are set according to Table 10.2-4.
If validation is achieved, the UE considers the information in the DCI format as a valid activation or valid release of DL SPS or configured UL grant Type 2. If validation is not achieved, the UE discards all the information in the DCI format.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.2-1: Special fields for single DL SPS or single UL grant Type 2 scheduling activation PDCCH validation when a UE is provided a single SPS PDSCH or UL grant Type 2 configuration in the active DL/UL BWP of the scheduled cell}
\begin{tabular}{|c|c|c|c|}
\hline & \( \mathbf{D C I} \) format 0_0/0_1/0_2 & \( \mathbf{D C I} \) format 1_0/1_2/4_1 & \( \mathbf{D C I} \) format 1_1/4_2 \\
\hline HARQ process number & set to all '0's & set to all '0's & set to all '0's \\
\hline Redundancy version & set to all '0's & set to all '0's & \begin{tabular}{c} 
For the enabled transport block: \\
set to all '0's
\end{tabular} \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 160  ---


3GPP TS 38.213 version 17.1.0 Release 17
159
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.2-2: Special fields for single DL SPS or single UL grant Type 2 scheduling release PDCCH validation when a UE is provided a single SPS PDSCH or UL grant Type 2 configuration in the active DL/UL BWP of the scheduled cell}
\begin{tabular}{|l|l|l|}
\hline & DCI format 0_0/0_1/0_2 & DCI format 1_0/1_1/1_2/4_1/4_2 \\
\hline HARQ process number & set to all '0's & set to all '0's \\
\hline Redundancy version & set to all '0's & set to all '0's \\
\hline Modulation and coding scheme & set to all '1's & set to all '1's \\
\hline Frequency domain resource assignment & \begin{tabular}{l}
set to all '0's for FDRA Type 2 with \( \mu=1 \) \\
set to all '1's, otherwise
\end{tabular} & set to all '0's for FDRA Type 0 or for dynamicSwitch set to all '1's for FDRA Type 1 \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.2-3: Special fields for a single DL SPS or single UL grant Type 2 scheduling activation PDCCH validation when a UE is provided multiple DL SPS or UL grant Type 2 configurations in the active DL/UL BWP of the scheduled cell}
\begin{tabular}{|c|c|c|c|}
\hline & \( \mathbf{D C I} \) format 0_0/0_1/0_2 & \( \mathbf{D C I} \) format 1_0/1_2/4_1 & \( \mathbf{D C I} \) format 1_1/4_2 \\
\hline Redundancy version & set to all '0's & set to all '0's & \begin{tabular}{c} 
For the enabled transport block: \\
set to all '0's
\end{tabular} \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.2-4: Special fields for a single or multiple DL SPS and UL grant Type 2 scheduling release PDCCH validation when a UE is provided multiple DL SPS or UL grant Type 2 configurations in the active DL/UL BWP of the scheduled cell}
\begin{tabular}{|l|l|l|}
\hline & DCI format 0_0/0_1/0_2 & DCI format 1_0/1_1/1_2/4_1/4_2 \\
\hline Redundancy version & set to all '0's & set to all '0's \\
\hline Modulation and coding scheme & set to all '1's & set to all '1's \\
\hline Frequency domain resource assignment & \begin{tabular}{l}
set to all '0's for FDRA Type 2 with \( \mu=1 \) \\
set to all '1's, otherwise
\end{tabular} & \begin{tabular}{l}
set to all '0's for FDRA Type 0 or for dynamicSwitch \\
set to all '1's for FDRA Type 1
\end{tabular} \\
\hline
\end{tabular}
\end{table}

A UE is expected to provide HARQ-ACK information in response to a SPS PDSCH release after \( N \) symbols from the last symbol of a PDCCH providing the SPS PDSCH release. If processingType2Enabled of PDSCH-ServingCellConfig is set to enable for the serving cell with the PDCCH providing the SPS PDSCH release, \( N=5 \) for \( \mu=0, N=5.5 \) for \( \mu=1 \), and \( N=11 \) for \( \mu=2 \), otherwise, \( N=10 \) for \( \mu=0, N=12 \) for \( \mu=1, N=22 \) for \( \mu=2, N=25 \) for \( \mu=3 \), \( N=100 \) for \( \mu=5 \), and \( N=200 \) for \( \mu=6 \), wherein \( \mu \) corresponds to the smallest SCS configuration between the SCS configuration of the PDCCH providing the SPS PDSCH release and the SCS configuration of a PUCCH carrying the HARQ-ACK information in response to a SPS PDSCH release.
10.2A PDCCH validation for SL configured grant Type 2

A UE validates, for scheduling activation or scheduling release, a SL configured grant Type 2 PDCCH if
- the CRC of a corresponding DCI format \( 3 \_0 \) is scrambled with a SL-CS-RNTI provided by sl-CS-RNTI, and
- the new data indicator field in the DCI format \( 3 \_0 \) for the enabled transport block is set to ' 0 '

Validation of the DCI format \( 3 \_0 \) is achieved if all fields for the DCI format \( 3 \_0 \) are set according to Table 10.2A-1 or Table 10.2A-2.

If validation is achieved, the UE considers the information in the DCI format \( 3 \_0 \) as a valid activation or valid release of SL configured grant Type 2. If validation is not achieved, the UE discards all the information in the DCI format 3_0.

ETSI


--- Page 161  ---


3GPP TS 38.213 version 17.1.0 Release 17
160
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.2A-1: Special fields for SL configured grant Type 2 scheduling activation PDCCH validation}
\begin{tabular}{|c|c|}
\hline & DCI format 3 0 \\
\hline HARQ process number & set to all '0's \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.2A-2: Special fields for SL configured grant Type 2 scheduling release PDCCH validation}
\begin{tabular}{|c|c|}
\hline & DCI format 3 0 \\
\hline HARQ process number & set to all '1's \\
\hline \begin{tabular}{c} 
Frequency resource assignment \\
(if present)
\end{tabular} & set to all '1's \\
\hline
\end{tabular}
\end{table}
10.3 PDCCH monitoring indication and dormancy/non-dormancy behaviour for SCells

A UE configured with DRX mode operation [11, TS 38.321] can be provided the following for detection of a DCI format 2_6 in a PDCCH reception on the PCell or on the SpCell [12, TS 38.331]
- a PS-RNTI for DCI format 2_6 by ps-RNTI
- a number of search space sets, by dci-Format2-6, to monitor PDCCH for detection of DCI format 2 _6 on the active DL BWP of the PCell or of the SpCell according to a common search space as described in clause 10.1
- a payload size for DCI format 2_6 by sizeDCI-2-6
- a location in DCI format 2_6 of a Wake-up indication bit by ps-PositionDCI-2-6
- a ' 0 ' value for the Wake-up indication bit, when reported to higher layers, indicates to not start the \( d r x \) onDurationTimer for the next long DRX cycle [11, TS 38.321]
- a ' 1 ' value for the Wake-up indication bit, when reported to higher layers, indicates to start the \( d r x \) onDurationTimer for the next long DRX cycle [11, TS 38.321]
- a bitmap, when the UE is provided a number of groups of configured SCells by dormancyGroupOutsideActiveTime, where
- the bitmap location is immediately after the Wake-up indication bit location
- the bitmap size is equal to the number of groups of configured SCells where each bit of the bitmap corresponds to a group of configured SCells from the number of groups of configured SCells
- a ' 0 ' value for a bit of the bitmap indicates an active DL BWP, provided by dormantBWP-Id, for the UE [11, TS38.321] for each activated SCell in the corresponding group of configured SCells
- a '1' value for a bit of the bitmap indicates
- an active DL BWP, provided by firstOutsideActiveTimeBWP-Id, for the UE for each activated SCell in the corresponding group of configured SCells, if a current active DL BWP is the dormant DL BWP
- a current active DL BWP, for the UE for each activated SCell in the corresponding group of configured SCells, if the current active DL BWP is not the dormant DL BWP
- the UE sets the active DL BWP to the indicated active DL BWP
- an offset by \( p s \)-Offset indicating a time, where the UE starts monitoring PDCCH for detection of DCI format 26 according to the number of search space sets, prior to a slot where the drx-onDurationTimer would start on the PCell or on the SpCell [11, TS 38.321]
- for each search space set, the PDCCH monitoring occasions are the ones in the first \( T_{\mathrm{s}} \) slots indicated by duration, or \( T_{\mathrm{s}}=1 \) slot if duration is not provided, starting from the first slot of the first \( T_{\mathrm{s}} \) slots and ending prior to the start of drx-onDurationTimer.

ETSI


--- Page 162  ---


3GPP TS 38.213 version 17.1.0 Release 17
161
ETSI TS 138213 V17.1.0 (2022-05)

On PDCCH monitoring occasions associated with a same long DRX Cycle, a UE does not expect to detect more than one DCI format 2_6 with different values of the Wake-up indication bit for the UE or with different values of the bitmap for the UE.

The UE does not monitor PDCCH for detecting DCI format 2_6 during Active Time [11, TS 38.321].
If a UE reports for an active DL BWP a MinTimeGap value that is X slots prior to the beginning of a slot where the UE would start the drx-onDurationTimer, the UE is not required to monitor PDCCH for detection of DCI format 2 _ 6 during the X slots, where X corresponds to the MinTimeGap value of the SCS of the active DL BWP in Table 10.3-1.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.3-1 Minimum time gap value X}
\begin{tabular}{|c|c|c|}
\hline \multirow{2}{*}{ SCS (kHz) } & \multicolumn{2}{|c|}{ Minimum Time Gap X (slots) } \\
\cline { 2 - 3 } & Value 1 & Value 2 \\
\hline 15 & 1 & 3 \\
\hline 30 & 1 & 6 \\
\hline 60 & 1 & 12 \\
\hline 120 & 2 & 24 \\
\hline 480 & 8 & 96 \\
\hline 960 & 16 & 192 \\
\hline
\end{tabular}
\end{table}

If a UE is provided search space sets to monitor PDCCH for detection of DCI format 2_6 in the active DL BWP of the PCell or of the SpCell and the UE detects DCI format 2_6, the physical layer of a UE reports the value of the Wake-up indication bit for the UE to higher layers [11, TS 38.321] for the next long DRX cycle.

If a UE is provided search space sets to monitor PDCCH for detection of DCI format 2_6 in the active DL BWP of the PCell or of the SpCell and the UE does not detect DCI format 2_6, the physical layer of the UE does not report a value of the Wake-up indication bit to higher layers for the next long DRX cycle.

If a UE is provided search space sets to monitor PDCCH for detection of DCI format 2_6 in the active DL BWP of the PCell or of the SpCell and the UE
- is not required to monitor PDCCH for detection of DCI format 2_6, as described in clauses 10, 11.1, 12, and in clause 5.7 of [11, TS 38.321] for all corresponding PDCCH monitoring occasions outside Active Time prior to a next long DRX cycle, or
- does not have any PDCCH monitoring occasions for detection of DCI format 2_6 outside Active Time of a next long DRX cycle
the physical layer of the UE reports a value of 1 for the Wake-up indication bit to higher layers for the next long DRX cycle.

If a UE is provided search space sets to monitor PDCCH for detection of DCI format \( 0 \_1 \) and DCI format \( 1 \_1 \) and if one or both of DCI format 0_1 and DCI format 1_1 include a SCell dormancy indication field,
- the SCell dormancy indication field is a bitmap with size equal to a number of groups of configured SCells, provided by dormancyGroupWithinActiveTime,
- each bit of the bitmap corresponds to a group of configured SCells from the number of groups of configured Scells
- if the UE detects a DCI format \( 0 \_1 \) or a DCI format \( 1 \_1 \) that does not include a carrier indicator field, or detects a DCI format \( 0 \_1 \) or DCI format \( 1 \_1 \) that includes a carrier indicator field with value equal to 0 , and if the DCI format \( 0 \_1 \) does not indicate UL grant Type 2 release nor deactivate semi-persistent CSI report(s) on PUSCH, or if the DCI format \( 1 \_1 \) does not indicate SPS PDSCH release
- a ' 0 ' value for a bit of the bitmap indicates an active DL BWP, provided by dormantBWP-Id, for the UE for each activated SCell in the corresponding group of configured SCells
- a '1' value for a bit of the bitmap indicates
- an active DL BWP, provided by firstWithinActiveTimeBWP-Id, for the UE for each activated SCell in the corresponding group of configured SCells, if a current active DL BWP is the dormant DL BWP

ETSI


--- Page 163  ---


3GPP TS 38.213 version 17.1.0 Release 17
162
ETSI TS 138213 V17.1.0 (2022-05)
- a current active DL BWP, for the UE for each activated SCell in the corresponding group of configured SCells, if the current active DL BWP is not the dormant DL BWP
- the UE sets the active DL BWP to the indicated active DL BWP

If a UE is provided search space sets to monitor PDCCH for detection of DCI format 1_1, and if
- the CRC of DCI format 1_1 is scrambled by a C-RNTI or a MCS-C-RNTI, and if
- a one-shot HARQ-ACK request field is not present or has a ' 0 ' value, and if
- the UE detects a DCI format 1 _ 1 on the primary cell that does not include a carrier indicator field, or detects a DCI format 1_1 on the primary cell that includes a carrier indicator field with value equal to 0 , and if
- resourceAllocation \( = \) resourceAllocationType0 and all bits of the frequency domain resource assignment field in DCI format 1_1 are equal to 0 , or
- resourceAllocation \( = \) resourceAllocationTypel and all bits of the frequency domain resource assignment field in DCI format 1_1 are equal to 1 , or
- resourceAllocation = dynamicSwitch and all bits of the frequency domain resource assignment field in DCI format 1_1 are equal to 0 or 1
the UE considers the DCI format 1_1 as indicating SCell dormancy, not scheduling a PDSCH reception, and for transport block 1 interprets the sequence of fields of
- modulation and coding scheme
- new data indicator
- redundancy version
and of
- HARQ process number
- antenna port(s)
- DMRS sequence initialization
as providing a bitmap to each configured SCell, in an ascending order of the SCell index, where
- a ' 0 ' value for a bit of the bitmap indicates an active DL BWP, provided by dormantBWP-Id, for the UE for a corresponding activated SCell
- a '1' value for a bit of the bitmap indicates
- an active DL BWP, provided by firstWithinActiveTimeBWP-Id, for the UE for a corresponding activated SCell, if a current active DL BWP is the dormant DL BWP
- a current active DL BWP, for the UE for a corresponding activated SCell, if the current active DL BWP is not the dormant DL BWP
- the UE sets the active DL BWP to the indicated active DL BWP

If an active DL BWP provided by dormantBWP-Id for a UE on an activated SCell is not a default DL BWP for the UE on the activated SCell, as described in clause 12, the BWP inactivity timer is not used for transitioning from the active DL BWP provided by dormantBWP-Id to the default DL BWP on the activated SCell.

A UE is expected to provide HARQ-ACK information in response to a detection of a DCI format \( 1 \_1 \) indicating SCell dormancy after \( N \) symbols from the last symbol of a PDCCH providing the DCI format 1_1. If processingType2Enabled of PDSCH-ServingCellConfig is set to enable for the serving cell with the PDCCH providing the DCI format 1_1, \( N=7 \) for \( \mu=0, N=7.5 \) for \( \mu=1 \), and \( N=15 \) for \( \mu=2 \); otherwise, \( N=14 \) for \( \mu=0, N= \) 16 for \( \mu=1, N=27 \) for \( \mu=2, N=31 \) for \( \mu=3, N=124 \) for \( \mu=5 \), and \( =248 \) for \( \mu=6 \), where \( \mu \) is the smallest SCS configuration between the SCS configuration of the PDCCH providing the DCI format 1 _ 1 and the SCS configuration of a PUCCH with the HARQ-ACK information in response to the detection of the DCI format 1 _

ETSI


--- Page 164  ---


3GPP TS 38.213 version 17.1.0 Release 17
163
ETSI TS 138213 V17.1.0 (2022-05)
10.4 Search space set group switching and skipping of PDCCH monitoring

A UE can be provided a group index for a respective Type3-PDCCH CSS set or USS set by searchSpaceGroupIdList for PDCCH monitoring on a serving cell. If the UE is not provided searchSpaceGroupIdList for a search space set, the following procedures are not applicable for PDOCH monitoring according to the search space set.

If a UE is provided cellGroupsForSwitchList, indicating one or more groups of serving cells, the following procedures apply to all serving cells within each group; otherwise, the following procedures apply only to a serving cell for which the UE is provided searchSpaceGroupIdList.

When a UE is provided searchSpaceGroupIdList, the UE resets PDCCH monitoring according to search space sets with group index 0 , if provided by searchSpaceGroupIdList.

A UE can be provided by searchSpaceSwitchDelay a number of symbols \( P_{\text {switch }} \) where a minimum value of \( P_{\text {switch }} \) is provided in Table 10.4-1 for UE processing capability 1 and UE processing capability 2 and SCS configuration \( \mu \). UE processing capability 1 for SCS configuration \( \mu \) applies unless the UE indicates support for UE processing capability 2 .

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 10.4-1: Minimum value of \( \boldsymbol{P}_{\text {switch }} \) [symbols]}
\begin{tabular}{|c|c|c|}
\hline \( \boldsymbol{\mu} \) & \begin{tabular}{c} 
Minimum \( \mathbf{P}_{\text {switch }} \) value for \\
UE processing capability 1 [symbols]
\end{tabular} & \begin{tabular}{c} 
Minimum \( \mathbf{P}_{\text {switch }} \) value for \\
UE processing capability 2 [symbols]
\end{tabular} \\
\hline 0 & 25 & 10 \\
\hline 1 & 25 & 12 \\
\hline 2 & 25 & 22 \\
\hline 3 & 40 & - \\
\hline 5 & 160 & - \\
\hline 6 & 320 & - \\
\hline
\end{tabular}
\end{table}

A UE can be provided, by searchSpaceSwitchTimer, a timer value for a serving cell that the UE is provided searchSpaceGroupIdList or, if provided, for a set of serving cells provided by cellGroupsForSwitchList. The UE decrements the timer value by one after each slot based on a reference SCS configuration that is the smallest SCS configuration \( \mu \) among all configured DL BWPs in the serving cell, or in the set of serving cells. The UE maintains the reference SCS configuration during the timer decrement procedure.

If a UE is provided by SearchSpaceSwitchTrigger a location of a search space set group switching flag field in a DCI format \( 2 \_0 \), as described in clause 11.1.1, for a serving cell where the UE has active DL BWP with SCS configuration \( \mu \)
- if the UE detects a DCI format 2_0 and a value of the search space set group switching flag field in the DCI format \( 2 \_0 \) is 0 , the UE starts monitoring PDCCH according to search space sets with group index 0 , and stops monitoring PDCCH according to search space sets with group index 1 , for the serving cell
- at the beginning of the first slot that is at least \( P_{\text {switch }} \) symbols after the last symbol of the PDCCH with the DCI format \( 2 \_0 \) when \( \mu \in\{0,1,2,3\} \)
- at the beginning of the first slot, of a group of \( X_{s} \) slots, that is at least \( P_{\text {switch }} \) symbols after the last symbol of the PDCCH with the DCI format \( 2 \_0 \) when \( \mu \in\{5,6\} \)
- if the UE detects a DCI format 2_0 and a value of the search space set group switching flag field in the DCI format \( 2 \_0 \) is 1 , the UE starts monitoring PDCCH according to search space sets with group index 1 , and stops monitoring PDCCH according to search space sets with group index 0 , for the serving cell
- at the beginning of the first slot that is at least \( P_{\text {switch }} \) symbols after the last symbol of the PDCCH with the DCI format \( 2 \_0 \), when \( \mu \in\{0,1,2,3\} \)
- at the beginning of the first slot, of a group of \( X_{s} \) slots, that is at least \( P_{\text {switch }} \) symbols after the last symbol of the PDCCH with the DCI format \( 2 \_0 \) when \( \mu \in\{5,6\} \)
and the UE sets the timer value to the value provided by searchSpaceSwitchTimer
- if the UE monitors PDCCH for a serving cell according to search space sets with group index 1 , the UE starts monitoring PDCCH for the serving cell according to search space sets with group index 0 , and stops monitoring PDCCH according to search space sets with group index 1 , for the serving cell

ETSI


--- Page 165  ---


3GPP TS 38.213 version 17.1.0 Release 17
164
ETSI TS 138213 V17.1.0 (2022-05)
- at the beginning of the first slot that is at least \( P_{\text {switch }} \) symbols after a slot where the timer expires or after a last symbol of a remaining channel occupancy duration for the serving cell if indicated by DCI format \( 2 \_0 \) when \( \mu \in\{0,1,2,3\} \)
- at the beginning of the first slot, of a group of \( X_{s} \) slots, that is at least \( P_{\text {switch }} \) symbols after a slot where the timer expires or after a last symbol of a remaining channel occupancy duration for the serving cell if indicated by DCI format \( 2 \_0 \) when \( \mu \in\{5,6\} \)

If a UE is not provided SearchSpaceSwitchTrigger for a serving cell,
- if the UE detects a DCI format by monitoring PDCCH according to a search space set with group index 0 , the UE starts monitoring PDCCH according to search space sets with group index 1 , and stops monitoring PDCCH according to search space sets with group index 0 , for the serving cell
- at the beginning of the first slot that is at least \( P_{\text {switch }} \) symbols after the last symbol of the PDCCH with the DCI format when \( \mu \in\{0,1,2,3\} \),
- at the beginning of the first slot, of a group of \( X_{s} \) slots, that is at least \( P_{\text {switch }} \) symbols after the last symbol of the PDCCH with the DCI format when \( \mu \in\{5,6\} \)
the UE sets the timer value to the value provided by searchSpaceSwitchTimer if the UE detects a DCI format by monitoring PDCCH in any search space set
- if the UE monitors PDCCH for a serving cell according to search space sets with group index 1 , the UE starts monitoring PDCCH for the serving cell according to search space sets with group index 0 , and stops monitoring PDCCH according to search space sets with group index 1 , for the serving cell
- at the beginning of the first slot that is at least \( P_{\text {switch }} \) symbols after a slot where the timer expires or, if the UE is provided a search space set to monitor PDCCH for detecting a DCI format \( 2 \_0 \), after a last symbol of a remaining channel occupancy duration for the serving cell if indicated by DCI format \( 2 \_0 \) when \( \mu \in \{0,1,2,3\} \)
- at the beginning of the first slot, of a group of \( X_{s} \) slots, that is at least \( P_{\text {switch }} \) symbols after a slot where the timer expires or, if the UE is provided a search space set to monitor PDCCH for detecting a DCI format \( 2 \_0 \), after a last symbol of a remaining channel occupancy duration for the serving cell if indicated by DCI format \( 2 \_0 \) when \( \mu \in\{5,6\} \)

A UE determines a slot and a symbol in the slot to start or stop PDCCH monitoring according to search space sets for a serving cell that the UE is provided searchSpaceGroupldList or, if cellGroupsForSwitchList is provided, for a set of serving cells, based on the smallest SCS configuration \( \mu \) among all configured DL BWPs in the serving cell or in the set of serving cells and, if any, in the serving cell where the UE receives a PDCCH and detects a corresponding DCI format \( 2 \_0 \) triggering the start or stop of PDCCH monitoring according to search space sets.

A UE can be provided a set of durations by PDCCHSkippingDurationList for PDCCH monitoring on an active DL BWP of a serving cell and, if the UE is not provided searchSpaceGroupIdList-r 17 on the active DL BWP of the serving cell, a DCI format \( 0 \_1 \) and a DCI format \( 0 \_2 \) that schedule PUSCH transmission, and a DCI format \( 1 \_1 \) and a DCI format 1 _ 2 that schedule PDSCH receptions can include a PDCCH monitoring adaptation field of 1 bit or of 2 bits.

If the field has 1 bit and for PDCCH monitoring by the UE according to Type3-PDCCH CSS sets or USS sets on the active DL BWP of the serving cell
- a ' 0 ' value for the bit indicates no skipping in PDCCH monitoring
- a '1' value for the bit indicates skipping PDCCH monitoring for a duration provided by the first value in the set of durations

If the field has 2 bits and for PDCCH monitoring by the UE according to Type3-PDCCH CSS sets or USS sets on the active DL BWP of the serving cell
- a ' 00 ' value for the bits indicates no skipping in PDCCH monitoring
- a '01' value for the bits indicates skipping PDCCH monitoring for a duration provided by the first value in the set of durations

ETSI


--- Page 166  ---


3GPP TS 38.213 version 17.1.0 Release 17
165
ETSI TS 138213 V17.1.0 (2022-05)
- a ' 10 ' value for the bits indicates skipping PDCCH monitoring for a duration provided by the second value in the set of durations
- a '11' value for the bits indicates skipping PDCCH monitoring for a duration provided by the third value in the set of durations, if any; otherwise, if the set of durations includes two values, a use of the ' 11 ' value is reserved

A UE can be provided group indexes for a Type3-PDCCH CSS set or USS set by searchSpaceGroupldList-r 17 for PDCCH monitoring on an active DL BWP of a serving cell and, if the UE is not provided PDCCHSkipping DurationList for the active DL BWP of the serving cell, a DCI format \( 0 \_1 \) and a DCI format \( 0 \_2 \) that schedule PUSCH transmissions and a DCI format 1_1 and a DCI format 1_2 that schedule PDSCH receptions can include a PDCCH monitoring adaptation field of 1 bit or of 2 bits for the serving cell.

If the field has 1 bit and for PDCCH monitoring by the UE according to Type3-PDCCH CSS sets or USS sets on the active DL BWP of the serving cell
- a ' 0 ' value for the bit indicates start of PDCCH monitoring according to search space sets with group index 0 and stop of PDCCH monitoring according to search space sets with other group indexes, if any
- a ' 1 ' value for the bit indicates start of PDCCH monitoring according to search space sets with group index 1 and stop of PDCCH monitoring according to search space sets with other group indexes, if any, and the UE sets the timer value to the one provided by searchSpaceSwitchTimer-r 17

If the field has 2 bits and for PDCCH monitoring by the UE according to Type3-PDCCH CSS sets or USS sets on the active DL BWP of the serving cell
- a ' \( 00^{\prime} \) value for the bit indicates start of PDCCH monitoring according to search space sets with group index 0 and stop of PDCCH monitoring according to search space sets with other group indexes, if any
- a ' 01 ' value for the bit indicates start of PDCCH monitoring according to search space sets with group index 1 and stop of PDCCH monitoring according to search space sets with other group indexes, if any, and the UE sets the timer value to the one provided by searchSpaceSwitchTimer-r 17
- a ' \( 10^{\prime} \) value for the bit indicates start of PDCCH monitoring according to search space sets with group index 2 and stop of PDCCH monitoring according to search space sets with other group indexes, if any, and the UE sets the timer value to the one provided by searchSpaceSwitchTimer-r 17
- a '11' value is reserved

A UE can be provided a set of durations by PDCCHSkippingDurationList and group indexes for a Type3-PDCCH CSS set or USS set by searchSpaceGroupldList-r 17 for PDCCH monitoring on an active DL BWP of a serving cell and, a DCI format \( 0 \_1 \) and a DCI format \( 0 \_2 \) that schedule PUSCH transmissions, and a DCI format \( 1 \_1 \) and a DCI format \( 1 \_2 \) that schedule PDSCH receptions can include a PDCCH monitoring adaptation field of 2 bits.

If the set of durations includes one value and for PDCCH monitoring by the UE according to Type3-PDCCH CSS sets or USS sets on the active DL BWP of the serving cell
- a ' \( 00^{\prime} \) value for the bits indicates start of PDCCH monitoring according to search space sets with group index 0 and stop of PDCCH monitoring according to search space sets with group index 1 , if any
- a '01' value for the bits indicates start of PDCCH monitoring according to search space sets with group index 1 and stop of PDCCH monitoring according to search space sets with group index 0 , if any, and the UE sets the timer value to the one provided by searchSpaceSwitchTimer-r 17
- a ' \( 10^{\prime} \) value for the bits indicates skipping PDCCH monitoring for a duration provided by the value in the set of durations
- a '11' value is reserved

If the set of durations includes two values and for PDCCH monitoring by the UE according to Type3-PDCCH CSS sets or USS sets on active DL BWP of the the serving cell
- a ' \( 00^{\prime} \) value for the bits indicates start of PDCCH monitoring according to search space sets with group index 0 and stop of PDCCH monitoring according to search space sets with group index 1, if any

ETSI


--- Page 167  ---


3GPP TS 38.213 version 17.1.0 Release 17
166
ETSI TS 138213 V17.1.0 (2022-05)
- a '01' value for the bits indicates start of PDCCH monitoring according to search space sets with group index 1 and stop of PDCCH monitoring according to search space sets with group index 0 , if any, and the UE sets the timer value to the one provided by searchSpaceSwitchTimer-r17
- a '10' value for the bits indicates skipping PDCCH monitoring for a duration provided by the first value in the set of durations
- a '11' value for the bits indicates skipping PDCCH monitoring for a duration provided by the second value in the set of durations

When the PDCCH monitoring adaptation field indicates to a UE to start PDCCH monitoring according to search space sets with a first group index and stop PDCCH monitoring according to search space sets with a second group index, the UE applies the indication
- at the beginning of a first slot that is at least \( P_{\text {switch }} \) symbols after the last symbol of the PDCCH reception providing the DCI format with the PDCCH monitoring adaptation field when \( \mu \in\{0,1,2,3\} \),
- at the beginning of a first slot, of a slot group of \( X_{s} \) slots, that is at least \( P_{\text {switch }} \) symbols after the last symbol of the PDCCH reception providing the DCI format with the PDCCH monitoring adaptation field when \( \mu \in\{5,6\} \)

When the PDCCH monitoring adaptation field indicates to a UE to skip PDCCH monitoring for a duration on the active DL BWP of a serving cell, the UE starts skipping of PDCCH monitoring at the beginning of a first slot that is after the last symbol of the PDCCH reception providing the DCI format with the PDCCH monitoring adaptation field.

If a UE is provided group indexes for a Type3-PDCCH CSS set or a USS set by searchSpaceGroupldList-r17 and a timer value by searchSpaceSwitchTimer-r 17 for PDCCH monitoring an active DL BWP of on a serving cell and the timer is running, the UE
- resets the timer after a slot of the active DL BWP of the serving cell if the UE detects a DCI format in a PDCCH reception in the slot for with CRC scrambled by C-RNTI/CS-RNTI/MCS-C-RNTI
- otherwise, decrements the timer value by one after a slot of the active DL BWP of the serving cell

When the timer expires in a first slot, the UE monitors PDCCH on the serving cell according to search space sets with group index 0 starting in a second slot that
- is not earlier than \( P_{\text {switch }} \) symbols after the first slot when \( \mu \in\{0,1,2,3\} \),
- is a first slot in a slot group of \( X_{s} \) slots that is not earlier than \( P_{\text {switch }} \) symbols after the first slot when \( \mu \in\{5,6\} \),
- is not earlier than a slot where a PDCCH skipping duration expires, if applicable

When a UE receives
- a first PDCCH in a first slot that provides a DCI format with a PDCCH monitoring adaptation field having a first value indicating skipping PDCCH monitoring, or indicating start of PDCCH monitoring according to a search space sets with a first group index and stop of PDCCH monitoring according to search space sets with a second group index, for an active DL BWP and
- a second PDCCH that provides a DCI format with a PDCCH monitoring adaptation field having a second value indicating skipping PDCCH monitoring, or indicating start of PDCCH monitoring according to search space sets with a first group index and stop of PDCCH monitoring according to search space sets with a second group index different than the first group index, for the active DL BWP where the second PDCCH is received
- in the first slot if the first value indicates skipping PDCCH monitoring
- before a slot that is at least \( P_{\text {switch }} \) symbols after the first slot if the first value indicates start of PDCCH monitoring according to search space sets with a first group index
the UE does not expect the second value to be different than the first value.
A UE does not expect to receive in a second slot a PDCCH on an active DL BWP that provides a DCI format indicating skipping PDCCH monitoring, or start of PDCCH monitoring according to search space sets with group index 1 or 2 for the active DL BWP, if the second slot is not at least \( P_{\text {switch }} \) symbols after a first slot where the timer expires.

ETSI


--- Page 168  ---


3GPP TS 38.213 version 17.1.0 Release 17
167
ETSI TS 138213 V17.1.0 (2022-05)
10.4A PDCCH monitoring for early indication of paging

A UE can be provided the following for detection of a DCI format 2_7 in RRC_IDLE state or in RRC_INACTIVE state [12, TS 38.331]
- a search space set, by peiSearchSpace, to monitor PDCCH for detection of DCI format 2_7 according to a Type2A-PDCCH CSS set as described in clause 10.1
- a number of frames, by \( P E I-F \) offset, from the start of a first paging frame of paging frames associated with a number of PDCCH monitoring occasions for DCI format 2 _ 7 [17, TS 38.304] to the start of a frame
- a number of symbols, by firstPDCCH-MonitoringOccasionOfPEI-O, from the start of the frame to the start of the first PDCCH monitoring occasion for DCI format 2_7
- a size, by payloadSizeDCI_format2_7
- a number of subgroups per paging occasion, \( N_{\mathrm{SG}}^{\mathrm{PO}} \), by subgroupsNumPerPO
- a number of paging occasions associated with the number of PDCCH monitoring occasions for DCI format 2_7, \( N_{\mathrm{PO}}^{\mathrm{PEI}} \), by PONumPerPEI

A paging indication field of DCl format 2_7 includes \( N_{\mathrm{PO}}^{\mathrm{PEI}} \) segments of \( K \) bits, where \( K=N_{\mathrm{SG}}^{\mathrm{PO}} \) if \( N_{\mathrm{SG}}^{\mathrm{PO}}>0 \) and \( K=1 \) if \( N_{\mathrm{SG}}^{\mathrm{PO}} \) is not provided. For a subgroup index \( i_{S G}, 0 \leq i_{S G}<K \), a UE determines a value for the \( \left(i_{P O} \cdot K+i_{S G}\right) \) bit in the paging indication field, where \( i_{P O}=\left(\left(\mathrm{UE} \_\mathrm{ID} \bmod N\right) \cdot N_{S}+i_{S}\right) \bmod N_{\mathrm{PO}}^{\mathrm{PEI}} \) is a paging occasion index, and UE_ID, \( N, N_{S} \), \( i_{S G} \), and \( i_{S} \) are defined in [17, TS 38.304]. When the value is ' 1 ', the UE monitors a paging occasion determined according to [17, TS 38.304]; otherwise, the UE is not required to monitor the paging occasion.

If \( N_{\mathrm{PO}}^{\mathrm{PEI}}<N_{S} \), the number of symbols from the start of the frame to the start of the first PDCCH monitoring occasion for DCI format \( 2-7 \) that is associated with paging occasion index \( i_{P O} \) is the \( \left(\left\lfloor i_{S} / N_{\mathrm{PO}}^{\mathrm{PEI}}\right\rfloor+1\right) \)-th value from the \( N_{S} / N_{\mathrm{PO}}^{\mathrm{PEI}} \) values provided by firstPDCCH-MonitoringOccasionOfPEI-O.
10.4B Indication of TRS resources

A UE in RRC_IDLE state or RRC_INACTIVE state can be provided by TRS-ResourceSetConfig a set of TRS occasions [6, TS 38.214]. If TRS-ResourceSetConfig is provided, a DCI format 2 _ 7 , if peiSearchSpace is provided, and a DCI format \( 1 \_0 \) with CRC scrambled by P-RNTI includes a TRS availability indication field [4, TS 38.212] that provides a bitmap to groups of TRS resource sets where the configuration of each TRS resource set includes an association to a bit of the bitmap. The UE can be additionally provided a multiple, by validityDuration, for a number of frames provided by defaultPagingCycle for TRS resource sets with indicated presence; if validityDuration is not provided, the multiple is equal to 2 .

A value of ' 1 ' for a bit of the bitmap indicates presence of associated TRS resource sets for the multiple of the number of frames, starting from a SFN determined from (SFN + PF_offset) \( \bmod T=0[17, \mathrm{TS} 38.304] \) that corresponds to the frame that includes a PDCCH providing the DCI format 2_7, or the DCI format \( 1 \_0 \) with CRC scrambled by P-RNTI, with the TRS availability indication field indicating the TRS resource sets, where \( T \) is provided by defaultPagingCycleA value of ' 0 ' for a bit of the bitmap indicates no change to a current assumption for the availability or unavailability of associated TRS resource sets.

A UE can receive first and second PDCCHs that provide DCI format 2_7 or DCI format \( 1 \_0 \) with CRC scrambled by PRNTI that indicate presence of TRS resource sets for the multiple of the number of frames, where the second PDCCH reception after the first PDCCH reception by a time that is smaller than the multiple of the number of frames.
10.5 HARQ-ACK information for PUSCH transmissions

A UE can be configured a number of search space sets to monitor PDCCH for detecting a DCI format \( 0 \_1 \) with a DFI flag field and CRC scrambled with a CS-RNTI provided by \( c s-R N T I \). The UE determines that the DCI format provides HARQ-ACK information for PUSCH transmissions based on when a DFI flag field value is set to '1', if a PUSCH transmission is configured by ConfiguredGrantConfig.

ETSI


--- Page 169  ---


3GPP TS 38.213 version 17.1.0 Release 17
168
ETSI TS 138213 V17.1.0 (2022-05)

The HARQ-ACK information corresponds to transport blocks in PUSCH transmissions for all HARQ processes for a serving cell of a PDCCH reception that provides DCI format \( 0 \_1 \) or, if DCI format \( 0 \_1 \) includes a carrier indicator field, for a serving cell indicated by a value of the carrier indicator field.

For a PUSCH transmission configured by ConfiguredGrantConfig, HARQ-ACK information for a transport block of a corresponding HARQ process number is valid if a first symbol of the PDCCH reception is after a last symbol of the PUSCH transmission, or of any repetition of the PUSCH transmission, by a number of symbols provided by \( c g \) -minDFI-Delay.

For an initial transmission by a UE of a transport block in a PUSCH configured by ConfiguredGrantConfig, if the UE receives a CG-DFI that provides HARQ-ACK information for the transport block, the UE assumes that the transport block was correctly decoded if the HARQ-ACK information value is ACK; otherwise, the UE assumes that the transport block was not correctly decoded.

For a PUSCH transmission scheduled by a DCI format, if the UE receives a CG-DFI that provides HARQ-ACK information for the transport block, the UE assumes that the transport block was correctly decoded if the HARQ-ACK information value is ACK; otherwise, the UE assumes that the transport block was not correctly decoded.

For a PUSCH transmission scheduled by a DCI format, HARQ-ACK information for a transport block of a corresponding HARQ process number is valid if a first symbol of the PDCCH reception is after a last symbol of the PUSCH transmission by a number of symbols provided by cg-minDFI-Delay or, if the PUSCH transmission is over multiple slots,
- after a last symbol of the PUSCH transmission in a first slot from the multiple slots by a number of symbols provided by cg-minDFI-Delay, if a value of the HARQ-ACK information is ACK.
- after a last symbol of the PUSCH transmission in a last slot from the multiple slots by a number of symbols provided by cg-minDFI-Delay, if a value of the HARQ-ACK information is NACK.

UE does not expect to be configured with different cg-minDFI-Delay-r 16 among multiple ConfiguredGrantConfig in one BWP.

11 UE-group common signalling
If the UE is configured with a SCG, the UE shall apply the procedures described in this clause for both MCG and SCG
- When the procedures are applied for MCG, the terms 'secondary cell', 'secondary cells', 'serving cell', 'serving cells' in this clause refer to secondary cell, secondary cells, serving cell, serving cells belonging to the MCG respectively.
- When the procedures are applied for SCG, the terms 'secondary cell', 'secondary cells', 'serving cell', 'serving cells' in this clause refer to secondary cell, secondary cells (not including PSCell), serving cell, serving cells belonging to the SCG respectively. The term 'primary cell' in this clause refers to the PSCell of the SCG.

In the remaining of this clause, unless stated otherwise, when a PDCCH reception by a UE includes two PDCCH candidates from corresponding search space sets, as described in clause 10.1
- a PDCCH monitoring occasion is the union of the PDCCH monitoring occasions for the two PDCCH candidates
- the start of the PDCCH reception is the start of the earlier PDCCH candidate
- the end of the PDCCH reception in the end of the PDCCH candidate that ends later

The PDCCH reception includes the two PDCCH candidates also when the UE is not required to monitor one of the two PDCCH candidates as described in clauses 10,11.1, and 11.1.1.
11.1 Slot configuration

A slot format includes downlink symbols, uplink symbols, and flexible symbols.
The following are applicable for each serving cell.

ETSI


--- Page 170  ---


3GPP TS 38.213 version 17.1.0 Release 17
169
ETSI TS 138213 V17.1.0 (2022-05)

If a UE is provided \( t d d \)-UL-DL-Configuration Common, the UE sets the slot format per slot over a number of slots as indicated by tdd-UL-DL-Configuration Common.

The tdd-UL-DL-ConfigurationCommon provides
- a reference SCS configuration \( \mu_{\mathrm{re}} \) by referenceSubcarrierSpacing
- a patternl.

The patternl provides
- a slot configuration period of \( P \) msec by dl-UL-TransmissionPeriodicity
- a number of slots \( d_{\text {slots }} \) with only downlink symbols by nrofDownlinkSlots
- a number of downlink symbols \( d_{\text {sym }} \) by nrofDownlinkSymbols
- a number of slots \( u_{\text {slots }} \) with only uplink symbols by nrofUplinkSlots
- a number of uplink symbols \( u_{\text {sym }} \) by nrofUplinkSymbols

A value \( P=0.625 \mathrm{msec} \) is valid only for \( \mu_{\text {res }}=3 \). A value \( P=1.25 \mathrm{msec} \) is valid only for \( \mu_{\text {res }}=2 \) or \( \mu_{\text {res }}=3 \). A value \( P=2.5 \mathrm{msec} \) is valid only for \( \mu_{\mathrm{re} 5}=1 \), or \( \mu_{\mathrm{re} 5}=2 \), or \( \mu_{\mathrm{re} 5}=3 \).

A slot configuration period of \( P \) msec includes \( S=P \cdot 2^{\mu_{\text {er }}} \) slots with SCS configuration \( \mu_{\text {ref }} \). From the \( S \) slots, a first \( d_{\text {slots }} \) slots include only downlink symbols and a last \( u_{\text {slots }} \) slots include only uplink symbols. The \( d_{\text {sym }} \) symbols after the first \( d_{\text {slots }} \) slots are downlink symbols. The \( u_{\text {sym }} \) symbols before the last \( u_{\text {slos }} \) slots are uplink symbols. The remaining \( \left(S-d_{\text {slots }}-u_{\text {slots }}\right) \cdot N_{\text {symb }}^{\text {slot }}-d_{\text {sym }}-u_{\text {sym }} \) are flexible symbols.

The first symbol every \( 20 / P \) periods is a first symbol in an even frame.
If tdd-UL-DL-ConfigurationCommon provides both pattern I and pattern 2, the UE sets the slot format per slot over a first number of slots as indicated by patternl and the UE sets the slot format per slot over a second number of slots as indicated by pattern 2 .

The pattern 2 provides
- a slot configuration period of \( P_{2} \) msec by dl-UL-TransmissionPeriodicity
- a number of slots \( d_{\text {slots, } 2} \) with only downlink symbols by nrofDownlinkSlots
- a number of downlink symbols \( d_{\text {sym,2 }} \) by nrofDownlinkSymbols
- a number of slots \( u_{\text {slots }, 2} \) with only uplink symbols by nrofUplinkSlots
- a number of uplink symbols \( u_{\text {sym, } 2} \) by nrofUplinkSymbols

The applicable values of \( P_{2} \) are same as the applicable values for \( P \).

A slot configuration period of \( P+P_{2} \) msec includes first \( S=P \cdot 2^{\mu_{\mathrm{er}}} \) slots and second \( S_{2}=P_{2} \cdot 2^{\mu_{\mathrm{er}}} \) slots.

From the \( s_{2} \) slots, a first \( d_{\text {slos, } 2} \) slots include only downlink symbols and a last \( u_{\text {slots }, 2} \) include only uplink symbols. The \( d_{\text {sym, } 2} \) symbols after the first \( d_{\text {slots, } 2} \) slots are downlink symbols. The \( u_{\text {sym, } 2} \) symbols before the last \( u_{\text {slots, } 2} \) slots are uplink symbols. The remaining \( \left(S_{2}-d_{\text {slots }, 2}-u_{\text {slots }, 2}\right) \cdot N_{\text {symb }}^{\text {slot }}-d_{\text {sym }, 2}-u_{\text {sym }, 2} \) are flexible symbols.

ETSI


--- Page 171  ---


3GPP TS 38.213 version 17.1.0 Release 17
170
ETSI TS 138213 V17.1.0 (2022-05)

A UE expects that \( P+P_{2} \) divides 20 msec.
The first symbol every \( 20 /\left(P+P_{2}\right) \) periods is a first symbol in an even frame.

A UE expects that the reference SCS configuration \( \mu_{\mathrm{re} \Gamma} \) is smaller than or equal to a SCS configuration \( \mu \) for any configured DL BWP or UL BWP. Each slot provided by pattern \( l \) or pattern 2 is applicable to \( 2^{\left(\mu-\mu_{\mathrm{er}}\right)} \) consecutive slots in the active DL BWP or the active UL BWP where the first slot starts at a same time as a first slot for the reference SCS configuration \( \mu_{\mathrm{re} \Gamma} \) and each downlink or flexible or uplink symbol for the reference SCS configuration \( \mu_{\mathrm{re} \Gamma} \) corresponds to \( 2^{\left(\mu-\mu_{\mathrm{rer}}\right)} \) consecutive downlink or flexible or uplink symbols for the SCS configuration \( \mu \).

If the UE is additionally provided tdd-UL-DL-ConfigurationDedicated, the parameter tdd-UL-DLConfigurationDedicated overrides only flexible symbols per slot over the number of slots as provided by \( t d d-U L-D L- \) ConfigurationCommon.

The tdd-UL-DL-ConfigurationDedicated provides
- a set of slot configurations by slotSpecificConfigurationsToAddModList
- for each slot configuration from the set of slot configurations
- a slot index for a slot provided by slotIndex
- a set of symbols for a slot by symbols where
- if symbols = allDownink, all symbols in the slot are downlink
- if symbols = allUplink, all symbols in the slot are uplink
- if symbols = explicit, nrofDownlinkSymbols provides a number of downlink first symbols in the slot and nrofUplinkSymbols provides a number of uplink last symbols in the slot. If nrofDownlinkSymbols is not provided, there are no downlink first symbols in the slot and if noofUplinkSymbols is not provided, there are no uplink last symbols in the slot. The remaining symbols in the slot are flexible

For each slot having a corresponding index provided by slotIndex, the UE applies a format provided by a corresponding symbols. The UE does not expect tdd-UL-DL-ConfigurationDedicated to indicate as uplink or as downlink a symbol that tdd-UL-DL-ConfigurationCommon indicates as a downlink or as an uplink symbol, respectively.

For each slot configuration provided by tdd-UL-DL-ConfigurationDedicated, a reference SCS configuration is the reference SCS configuration \( \mu_{\text {re } 5} \) provided by tdd-UL-DL-ConfigurationCommon.

A slot configuration period and a number of downlink symbols, uplink symbols, and flexible symbols in each slot of the slot configuration period are determined from \( t d d-U L-D L \)-ConfigurationCommon and \( t d d-U L-D L- \) ConfigurationDedicated and are common to each configured BWP.

A UE considers symbols in a slot indicated as downlink by tdd-UL-DL-ConfigurationCommon, or tdd-UL-DLConfigurationDedicated to be available for receptions and considers symbols in a slot indicated as uplink by tdd-UL-DL-Configuration Common, or by tdd-UL-DL-ConfigurationDedicated to be available for transmissions.

If a UE is not configured to monitor PDCCH for DCI format \( 2-0 \), for a set of symbols of a slot that are indicated as flexible by tdd-UL-DL-ConfigurationCommon and tdd-UL-DL-ConfigurationDedicated if provided, or when tdd-UL-DL-Configuration Common and tdd-UL-DL-ConfigurationDedicated are not provided to the UE
- the UE receives PDSCH or CSI-RS in the set of symbols of the slot if the UE receives a corresponding indication by a DCI format
- the UE transmits PUSCH, PUCCH, PRACH, or SRS in the set of symbols of the slot if the UE receives a corresponding indication by a DCI format, a RAR UL grant, fallbackRAR UL grant, or successRAR

For operation on a single carrier in unpaired spectrum, if a UE is configured by higher layers to receive a PDCCH, or a PDSCH, or a CSI-RS, or a DL PRS in a set of symbols of a slot, the UE receives the PDCCH, the PDSCH, the CSI-RS, or the DL PRS if the UE does not detect a DCI format that indicates to the UE to transmit a PUSCH, a PUCCH, a PRACH, or a SRS in at least one symbol of the set of symbols of the slot; otherwise, the UE does not receive the PDCCH, or the PDSCH, or the CSI-RS, or the DL PRS in the set of symbols of the slot.

ETSI


--- Page 172  ---


3GPP TS 38.213 version 17.1.0 Release 17
171
ETSI TS 138213 V17.1.0 (2022-05)

For a UE operation with shared spectrum channel access in FR1, or in FR2-2 when the UE is provided ChannelAccessMode2-r17 = 'enabled', if the UE is provided csi-RS-ValidationWith-DCI, is not provided CODurationsPerCell, and is not provided SlotFormatCombinationsPerCell, and if the UE is configured by higher layers to receive a CSI-RS in a set of symbols of a slot, the UE cancels the CSI-RS reception in the set of symbols of the slot if the UE does not detect a DCI format indicating an aperiodic CSI-RS reception or scheduling a PDSCH reception in the set of symbols of the slot.

If a UE is provided channelAccessMode = 'dynamic' and is provided availableRB-SetsToAddModList and availableRBSetsToReleaseList, the UE expects to be provided co-DurationsPerCellToAddModList and coDurationsPerCellToReleaseList and/or slotFormatCombToAddModList and slotFormatCombToReleaseList.

For operation on a single carrier in unpaired spectrum, if a UE is configured by higher layers to transmit SRS, or PUCCH, or PUSCH, or PRACH in a set of symbols of a slot and the UE detects a DCI format indicating to the UE to receive CSI-RS or PDSCH in a subset of symbols from the set of symbols, then
- If the UE does not indicate the capability of [partialCancellation], the UE does not expect to cancel the transmission of the PUCCH or PUSCH or PRACH in the set of symbols if the first symbol in the set occurs within \( T_{\text {proc }, 2} \) relative to a last symbol of a CORESET where the UE detects the DCI format; otherwise, the UE cancels the PUCCH, or the PUSCH, or an actual repetition of the PUSCH [6, TS38.214], determined from clauses 9 and 9.2.5 or clause 6.1 of [6, TS38.214], or the PRACH transmission in the set of symbols.
- If the UE indicates the capability of [partialCancellation], the UE does not expect to cancel the transmission of the PUCCH or PUSCH or PRACH in symbols from the set of symbols that occur within \( T_{p r o c, 2} \) relative to a last symbol of a CORESET where the UE detects the DCI format. The UE cancels the PUCCH, or the PUSCH, or an actual repetition of the PUSCH [6, TS 38.214], determined from clauses 9 and 9.2 .5 or clause 6.1 of [6, TS 38.214], or the PRACH transmission in remaining symbols from the set of symbols.
- The UE does not expect to cancel the transmission of SRS in symbols from the subset of symbols that occur within \( T_{\text {proc }, 2} \) relative to a last symbol of a CORESET where the UE detects the DCI format. The UE cancels the SRS transmission in remaining symbols from the subset of symbols.
\( T_{\text {proc }, 2} \) is the PUSCH preparation time for the corresponding UE processing capability [6, TS 38.214] assuming \( d_{2,1}=1 \) and \( \mu \) corresponds to the smallest SCS configuration between the SCS configuration of the PDCCH carrying the DCI format and the SCS configuration of the SRS, PUCCH, PUSCH or \( \mu_{r} \), where \( \mu_{r} \) corresponds to the SCS configuration of the PRACH if it is 15 kHz or higher; otherwise \( \mu_{r}=0 \).

For a set of symbols of a slot that are indicated to a UE as uplink by tdd-UL-DL-ConfigurationCommon, or tdd-UL-DLConfigurationDedicated, the UE does not receive PDCCH, PDSCH, or CSI-RS when the PDCCH, PDSCH, or CSI-RS overlaps, even partially, with the set of symbols of the slot.

For a set of symbols of a slot that are indicated to a UE as uplink by tdd-UL-DL-ConfigurationCommon, or tdd-UL-DLConfigurationDedicated, the UE does not receive DL PRS in the set of symbols of the slot, if the UE is not provided with a measurement gap.

For a set of symbols of a slot that are indicated to a UE as downlink by tdd-UL-DL-ConfigurationCommon, or tdd-UL-DL-ConfigurationDedicated, the UE does not transmit PUSCH, PUCCH, PRACH, or SRS when the PUSCH, PUCCH, PRACH, or SRS overlaps, even partially, with the set of symbols of the slot.

For a set of symbols of a slot that are indicated to a UE as flexible by tdd-UL-DL-ConfigurationCommon, and tdd-UL-DL-ConfigurationDedicated if provided, the UE does not expect to receive both dedicated higher layer parameters configuring transmission from the UE in the set of symbols of the slot and dedicated higher layer parameters configuring reception by the UE in the set of symbols of the slot.

For operation on a single carrier in unpaired spectrum, for a set of symbols of a slot indicated to a UE for reception of SS/PBCH blocks by ssb-PositionsInBurst in SIBl or by ssb-PositionsInBurst in ServingCellConfigCommon or, if the UE is not provided DLorJoint-TCIState or followUnifiedTCIstate, by ssb-PositionsInBurst in SSB-MTCAdditionalPCI associated to physical cell ID with active TCI states, the UE does not transmit PUSCH, PUCCH, PRACH in the slot if a transmission would overlap with any symbol from the set of symbols and the UE does not transmit SRS in the set of symbols of the slot. The UE does not expect the set of symbols of the slot to be indicated as uplink by tdd-UL-DLConfigurationCommon, or tdd-UL-DL-ConfigurationDedicated, when provided to the UE.

If a UE

ETSI


--- Page 173  ---


3GPP TS 38.213 version 17.1.0 Release 17
172
ETSI TS 138213 V17.1.0 (2022-05)
- is configured with multiple serving cells and is provided with directiona/CollisionHandling-r16 = 'enabled' for a set of serving cell(s) among the multiple serving cells, and
- indicates support of half-DuplexTDD-CA-SameSCS-r 16 capability, and
- is not configured to monitor PDCCH for detection of DCI format \( 2-0 \) on any of the multiple serving cells,
for a set of symbols of a slot that are indicated to the UE for reception of SS/PBCH blocks in a first cell of the multiple serving cells by ssb-PositionsInBurst in SystemInformationBlockTypel or by ssb-PositionsInBurst in ServingCellConfigCommon or, if the UE is not provided DLorJoint-TCIState or followUnifiedTCIstate, by ssbPositionsInBurst in SSB-MTCAdditionalPCI associated to physical cell ID with active TCI states, the UE does not transmit PUSCH, PUCCH, or PRACH in the slot if a transmission would overlap with any symbol from the set of symbols, and the UE does not transmit SRS in the set of symbols of the slot in
- any of the multiple serving cells if the UE is not capable of simultaneous transmission and reception as indicated by simultaneousRxTxInterBandCA among the multiple serving cells, and
- any one of the cells corresponding to the same band as the first cell, irrespective of any capability indicated by simultaneousRxTxInterBandCA.

For a set of symbols of a slot corresponding to a valid PRACH occasion and \( N_{\text {gap }} \) symbols before the valid PRACH occasion, as described in clause 8.1 , the UE does not receive \( \mathrm{PDCCH}, \mathrm{PDSCH} \), or CSI-RS in the slot if a reception would overlap with any symbol from the set of symbols. The UE does not expect the set of symbols of the slot to be indicated as downlink by tdd-UL-DL-ConfigurationCommon or tdd-UL-DL-ConfigurationDedicated.

For a set of symbols of a slot indicated to a UE by pdcch-ConfigSIBI in MIB for a CORESET for Type0-PDCCH CSS set, the UE does not expect the set of symbols to be indicated as uplink by tdd-UL-DL-ConfigurationCommon, or tdd-UL-DL-ConfigurationDedicated.

If a UE is scheduled by a DCI format to receive PDSCH over multiple slots, and if \( t d d \)-UL-DL-ConfigurationCommon, or tdd-UL-DL-ConfigurationDedicated, indicate that, for a slot from the multiple slots, at least one symbol from a set of symbols where the UE is scheduled PDSCH reception in the slot is an uplink symbol, the UE does not receive the PDSCH in the slot.

If a UE is scheduled by a DCI format to transmit PUSCH over multiple slots, and if \( t d d-U L-D L \)-ConfigurationCommon, or tdd-UL-DL-ConfigurationDedicated, indicates that, for a slot from the multiple slots, at least one symbol from a set of symbols where the UE is scheduled PUSCH transmission in the slot is a downlink symbol, the UE does not transmit the PUSCH in the slot.

If a UE
- is configured with multiple serving cells and is provided with directionalCollisionHandling-r16='enabled' for a set of serving cell(s) among the configured multiple serving cells, and
- indicates support of half-DuplexTDD-CA-SameSCS-r16 capability, and
- is not configured to monitor PDCCH for detection of DCI format \( 2-0 \) on any of the multiple serving cells,
the UE determines a reference cell for a symbol as an active cell with the smallest cell index among
- the configured multiple serving cells if the UE is not capable of simultaneous transmission and reception as indicated by simultaneousRxTxInterBandCA among the multiple serving cells, and
- the cells of each band respectively if the UE is capable of simultaneous transmission and reception by simultaneousRxTxInterBandCA for the configured multiple serving cells,
where the symbol is configured as
- downlink, or uplink, as indicated by tdd-UL-DL-ConfigurationCommon or tdd-UL-DL-ConfigurationDedicated
- uplink, if the symbol is flexible and the UE is configured to transmit SRS, PUCCH, PUSCH, or PRACH on the symbol
- downlink, if the symbol is flexible and the UE is configured to receive PDCCH, PDSCH or CSI-RS on the symbol.

ETSI


--- Page 174  ---


3GPP TS 38.213 version 17.1.0 Release 17
173
ETSI TS 138213 V17.1.0 (2022-05)

And if another cell among the cells configured with directionalCollisionHandling-r 16 operates in the same frequency band as the reference cell, the UE does not expect
- a symbol to be indicated as downlink or uplink on the reference cell and as uplink or downlink on another cell, respectively, by tdd-UL-DL-ConfigurationCommon or by tdd-UL-DL-ConfigurationDedicated,
- tdd-UL-DL-ConfigurationCommon or tdd-UL-DL-ConfigurationDedicated to indicate a symbol as downlink on the reference cell and to detect a DCI format scheduling a transmission on the symbol on another cell, and
- to be configured by higher layers to receive \( \mathrm{PDCCH}, \mathrm{PDSCH} \), or CSI-RS on a flexible symbol on the reference cell and to detect a DCI format scheduling a transmission on the symbol on another cell,
if the reference cell and another cell among the cells configured with directionalCollisionHanding-r 16 operate in different frequency bands,
the UE
- assumes symbol as flexible, is not required to receive higher layer configured PDCCH, PDSCH, or CSI-RS and not expected to transmit higher layer configured SRS, PUCCH, PUSCH, or PRACH, when tdd-UL-DLConfiguration Common or tdd-UL-DL-ConfigurationDedicated indicates symbol as downlink or uplink on another cell and as uplink or downlink for the reference cell, respectively,
- transmits a signal/channel scheduled by a DCI format on a symbol of another cell when the symbol is indicated as downlink by tdd-UL-DL-ConfigurationCommon or tdd-UL-DL-ConfigurationDedicated for the reference cell,
- is not required to receive a higher layer configured \( \mathrm{PDCCH}, \mathrm{PDSCH} \), or CSI-RS on flexible symbols on the reference cell in a set of symbols, if the UE detects a DCI format scheduling a transmission on one or more symbols in the set of symbols on another cell,
and regardless of whether the reference cell and another cell operate in same or different frequency bands,
the UE
- does not expect tdd-UL-DL-ConfigurationCommon or tdd-UL-DL-ConfigurationDedicated for the reference cell to indicate a symbol as uplink and to detect a DCI format scheduling a reception on the symbol on another cell
- does not expect to be configured by higher layers to transmit SRS, PUCCH, PUSCH, or PRACH on a flexible symbol on the reference cell and to detect a DCI format scheduling a reception on the symbol on another cell
- does not transmit a PUCCH, PUSCH or PRACH that is configured by higher layers on a set of symbols on another cell if at least one symbol from the set of symbols is indicated as downlink by \( t d d-U L-D L- \) Configuration Common or tdd-UL-DL-ConfigurationDedicated or is a symbol corresponding to a PDCCH, PDSCH, or CSI-RS reception that is configured by higher layers on the reference cell
- does not transmit a SRS that is configured by higher layers on a set of symbols on another cell if the set of symbols is indicated as downlink by tdd-UL-DL-ConfigurationCommon or tdd-UL-DL-ConfigurationDedicated or corresponds to a PDCCH, PDSCH or CSI-RS reception that is configured by higher layers on the reference cell
- does not receive a PDCCH, PDSCH or CSI-RS that is configured by higher layers on a set of symbols on another cell if at least one symbol from the set of symbols is indicated as uplink by tdd-UL-DL-ConfigurationCommon or tdd-UL-DL-ConfigurationDedicated or is a symbol corresponding to a SRS, PUCCH, PUSCH, or PRACH transmission that is configured by higher layers on the reference cell
- assumes a symbol indicated as downlink or uplink by tdd-UL-DL-ConfigurationCommon or tdd-UL-DLConfigurationDedicated on another cell to be flexible, if the UE is respectively configured by higher layers to transmit SRS, PUCCH, PUSCH, or PRACH or to receive PDCCH, PDSCH, or CSI-RS on the reference cell
- does not expect to detect a first DCI format scheduling a transmission or reception on a symbol on a first cell and a second DCI format scheduling a reception or transmission on the symbol on a second cell, respectively.

After the UE applies the procedures described above for directional collision handling within the set of cells that have been configured with directionalCollisionHanding-r16, the UE does not expect any directional collision among the serving cells that the UE is not capable of simultaneous transmission and reception.

ETSI


--- Page 175  ---


3GPP TS 38.213 version 17.1.0 Release 17
174
ETSI TS 138213 V17.1.0 (2022-05)
11.1.1 UE procedure for determining slot format

This clause applies for a serving cell that is included in a set of serving cells configured to a UE by slotFormatCombToAddModList and slotFormatCombToReleaseList, availableRB-SetsToAddModList and availableRBSetsToReleaseList, switchTriggerToAddModList and switchTriggerToReleaseList, or coDurationsPerCellToAddModList and co-DurationsPerCellToReleaseList.

If a UE is configured by higher layers with parameter SlotFormatIndicator, the UE is provided an SF[-RNTI by sfiRNTI and with a payload size of DCI format \( 2-0 \) by dci-PayloadSize.

The UE is also provided in one or more serving cells with a configuration for a search space set \( s \) and a corresponding CORESET \( p \) for monitoring \( M_{p, s}^{\left(L_{\mathrm{SFI}}\right)} \) PDCCH candidates for DCI format \( 2 \_0 \) with a CCE aggregation level of \( L_{\mathrm{SFI}} \) CCEs as described in clause 10.1. The \( M_{p, s}^{\left(L_{\mathrm{SFI}}\right)} \) PDCCH candidates are the first \( M_{p, s}^{\left(L_{\mathrm{SFI}}\right)} \) PDCCH candidates for CCE aggregation level \( L_{\text {SFI }} \) for search space set \( s \) in CORESET \( p \).

For each serving cell in the set of serving cells, the UE can be provided:
- an identity of the serving cell by servingCellld
- a location of a SFI-index field in DCI format 2 _ 0 by positionInDCI
- a set of slot format combinations by slotFormatCombinations, where each slot format combination in the set of slot format combinations includes
- one or more slot formats indicated by a respective slotFormats for the slot format combination, and
- a mapping for the slot format combination provided by slotFormats to a corresponding SF[-index field value in DCI format 2 _ 0 provided by slotFormatCombinationId
- for unpaired spectrum operation, a reference SCS configuration \( \mu_{\mathrm{SFI}} \) by subcarrierSpacing and, when a supplementary UL carrier is configured for the serving cell, a reference SCS configuration \( \mu_{\text {SFI,SUL }} \) by subcarrierSpacing2 for the supplementary UL carrier
- for paired spectrum operation, a reference SCS configuration \( \mu_{\text {SFIDL }} \) for a DL BWP by subcarrierSpacing and a reference SCS configuration \( \mu_{\mathrm{SFI}, \mathrm{UL}} \) for an UL BWP by subcarrierSpacing 2
- a location of an available RB set indicator field in DCI format \( 2 \_0 \) that is
- one bit, if intraCellGuardBandsDL-List for the serving cell indicates no intra-cell guard-bands are configured, where a value of ' 1 ' indicates that the serving cell is available for receptions, a value of ' 0 ' indicates that the serving cell is not available for receptions, by availableRB-SetsPerCell, and the serving cell remains available or unavailable for reception until the end of the remaining channel occupancy duration
- a bitmap having a one-to-one mapping with the \( \operatorname{RB} \) sets \( [6, T S 38.214] \) of the serving cell, if intraCellGuardBandsDL-List for the serving cell indicates intra-cell guard-bands are configured, where the bitmap includes \( N_{\mathrm{RB}, \text { set, DL }} \) bits and \( N_{\mathrm{RB}, \text { set, DL }} \) is the number of RB sets in the serving cell, a value of ' 1 ' indicates that an RB set is available for receptions, a value of ' 0 ' indicates that an RB set is not available for receptions, by availableRB-SetsPerCell and a RB set remains available or unavailable for receptions until the end of the remaining channel occupancy duration
- a location of a channel occupancy duration field in DCI format 2 _0, by CO-DurationsPerCell, that indicates a remaining channel occupancy duration for the serving cell starting from a first symbol of a slot where the UE detects the DCI format \( 2-0 \) by providing a value from co-DurationList. The channel occupancy duration field includes \( \max \left\{\left[\log _{2}(\operatorname{COdurationListSize})\right], 1\right\} \) bits, where COdurationListSize is the number of values provided by co-DurationList. If CO-DurationsPerCell is not provided, the remaining channel occupancy duration for the serving cell is a number of slots, starting from the slot where the UE detects the DCI format 2 , 0 , that the SFIindex field value provides corresponding slot formats
- a reference SCS configuration for co-DurationList, by subcarrierSpacing-r16
- a location of a search space set group switching flag field in DCI format 2 _ 0 , by SearchSpaceSwitchTrigger, that indicates a group from two groups of search space sets for PDCCH monitoring for scheduling for the serving cell or the set of serving cells, provided by CellGroupsForSwitching, as described in clause 10.4.

ETSI


--- Page 176  ---


3GPP TS 38.213 version 17.1.0 Release 17
175
ETSI TS 138213 V17.1.0 (2022-05)

If neither CO-DurationPerCell-r16 nor SlotFormatCombinationsPerCell are provided and if ChannelAccessModerl6 \( = \) "semiStatic" is provided, the procedures in this clause apply with assuming a channel occupancy time defined in clause 4.3 of [15, TS 37.213] is the remaining channel occupancy duration if a DL transmission burst(s) is detected within the channel occupancy time.

A SFI-index field value in a DCI format 20 indicates to a UE a slot format for each slot in a number of slots for each DL BWP or each UL BWP starting from a slot where the UE detects the DCI format \( 2 \_0 \). The number of slots is equal to or larger than a PDCCH monitoring periodicity for DCI format 2_0. The SFI-index field includes \( \max \left\{\left[\log _{2}(\operatorname{maxSFI}\right.\right. \) inde \( \left.\left.x+1)\right], 1\right\} \) bits where maxSFlindex is the maximum value of the values provided by corresponding slotFormatCombinationId. A slot format is identified by a corresponding format index as provided in Table 11.1.1-1 where ' \( D \) ' denotes a downlink symbol, 'U' denotes an uplink symbol, and ' \( F \) ' denotes a flexible symbol.

If a PDCCH monitoring periodicity for DCI format \( 2 \_0 \), provided to a UE for the search space set \( S \) by monitoringSlotPeriodicityAndOffset, is smaller than a duration of a slot format combination the UE obtains at a PDCCH monitoring occasion for DCI format \( 2 \_0 \) by a corresponding SFI-index field value, and the UE detects more than one DCI formats 2_0 indicating a slot format for a slot, the UE expects each of the more than one DCI formats 2_0 to indicate a same format for the slot.

A UE does not expect to be configured to monitor PDCCH for DCI format \( 2 \_0 \) on a second serving cell that uses larger SCS than the serving cell.

ETSI


--- Page 177  ---


3GPP TS 38.213 version 17.1.0 Release 17
176
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 11.1.1-1: Slot formats for normal cyclic prefix}
\begin{tabular}{|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|}
\hline Format & \multicolumn{14}{|c|}{Symbol number in a slot} \\
\hline & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 \\
\hline 0 & D & D & D & D & D & D & D & D & D & D & D & D & D & D \\
\hline 1 & U & U & U & U & U & U & U & U & U & U & U & U & U & U \\
\hline 2 & F & F & F & F & F & F & F & F & F & F & F & F & F & F \\
\hline 3 & D & D & D & D & D & D & D & D & D & D & D & D & D & F \\
\hline 4 & D & D & D & D & D & D & D & D & D & D & D & D & F & F \\
\hline 5 & D & D & D & D & D & D & D & D & D & D & D & F & F & F \\
\hline 6 & D & D & D & D & D & D & D & D & D & D & F & F & F & F \\
\hline 7 & D & D & D & D & D & D & D & D & D & F & F & F & F & F \\
\hline 8 & F & F & F & F & F & F & F & F & F & F & F & F & F & U \\
\hline 9 & F & F & F & F & F & F & F & F & F & F & F & F & U & U \\
\hline 10 & F & U & U & U & U & U & U & U & U & U & U & U & U & U \\
\hline 11 & F & F & U & U & U & U & U & U & U & U & U & U & U & U \\
\hline 12 & F & F & F & U & U & U & U & U & U & U & U & U & U & U \\
\hline 13 & F & F & F & F & U & U & U & U & U & U & U & U & U & U \\
\hline 14 & F & F & F & F & F & U & U & U & U & U & U & U & U & U \\
\hline 15 & F & F & F & F & F & F & U & U & U & U & U & U & U & U \\
\hline 16 & D & F & F & F & F & F & F & F & F & F & F & F & F & F \\
\hline 17 & D & D & F & F & F & F & F & F & F & F & F & F & F & F \\
\hline 18 & D & D & D & F & F & F & F & F & F & F & F & F & F & F \\
\hline 19 & D & F & F & F & F & F & F & F & F & F & F & F & F & U \\
\hline 20 & D & D & F & F & F & F & F & F & F & F & F & F & F & U \\
\hline 21 & D & D & D & F & F & F & F & F & F & F & F & F & F & U \\
\hline 22 & D & F & F & F & F & F & F & F & F & F & F & F & U & U \\
\hline 23 & D & D & F & F & F & F & F & F & F & F & F & F & U & U \\
\hline 24 & D & D & D & F & F & F & F & F & F & F & F & F & U & U \\
\hline 25 & D & F & F & F & F & F & F & F & F & F & F & U & U & U \\
\hline 26 & D & D & F & F & F & F & F & F & F & F & F & U & U & U \\
\hline 27 & D & D & D & F & F & F & F & F & F & F & F & U & U & U \\
\hline 28 & D & D & D & D & D & D & D & D & D & D & D & D & F & U \\
\hline 29 & D & D & D & D & D & D & D & D & D & D & D & F & F & U \\
\hline 30 & D & D & D & D & D & D & D & D & D & D & F & F & F & U \\
\hline 31 & D & D & D & D & D & D & D & D & D & D & D & F & U & U \\
\hline 32 & D & D & D & D & D & D & D & D & D & D & F & F & U & U \\
\hline 33 & D & D & D & D & D & D & D & D & D & F & F & F & U & U \\
\hline 34 & D & F & U & U & U & U & U & U & U & U & U & U & U & U \\
\hline 35 & D & D & F & U & U & U & U & U & U & U & U & U & U & U \\
\hline 36 & D & D & D & F & U & U & U & U & U & U & U & U & U & U \\
\hline 37 & D & F & F & U & U & U & U & U & U & U & U & U & U & U \\
\hline 38 & D & D & F & F & U & U & U & U & U & U & U & U & U & U \\
\hline 39 & D & D & D & F & F & U & U & U & U & U & U & U & U & U \\
\hline 40 & D & F & F & F & U & U & U & U & U & U & U & U & U & U \\
\hline 41 & D & D & F & F & F & U & U & U & U & U & U & U & U & U \\
\hline 42 & D & D & D & F & F & F & U & U & U & U & U & U & U & U \\
\hline 43 & D & D & D & D & D & D & D & D & D & F & F & F & F & U \\
\hline 44 & D & D & D & D & D & D & F & F & F & F & F & F & U & U \\
\hline 45 & D & D & D & D & D & D & F & F & U & U & U & U & U & U \\
\hline 46 & D & D & D & D & D & F & U & D & D & D & D & D & F & U \\
\hline 47 & D & D & F & U & U & U & U & D & D & F & U & U & U & U \\
\hline 48 & D & F & U & U & U & U & U & D & F & U & U & U & U & U \\
\hline 49 & D & D & D & D & F & F & U & D & D & D & D & F & F & U \\
\hline 50 & D & D & F & F & U & U & U & D & D & F & F & U & U & U \\
\hline 51 & D & F & F & U & U & U & U & D & F & F & U & U & U & U \\
\hline 52 & D & F & F & F & F & F & U & D & F & F & F & F & F & U \\
\hline 53 & D & D & F & F & F & F & U & D & D & F & F & F & F & U \\
\hline 54 & F & F & F & F & F & F & F & D & D & D & D & D & D & D \\
\hline 55 & D & D & F & F & F & U & U & U & D & D & D & D & D & D \\
\hline 56-254 & \multicolumn{14}{|c|}{Reserved} \\
\hline 255 & \multicolumn{14}{|c|}{\begin{tabular}{l}
UE determines the slot format for the slot based on tdd-UL-DL-ConfigurationCommon, or tdd-UL- \\
DL-ConfigurationDedicated and, if any, on detected DCI formats
\end{tabular}} \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 178  ---


3GPP TS 38.213 version 17.1.0 Release 17
177
ETSI TS 138213 V17.1.0 (2022-05)

For unpaired spectrum operation for a UE on a serving cell, the UE is provided by subcarrierSpacing a reference SCS configuration \( \mu_{\text {SFI }} \) for each slot format in a combination of slot formats indicated by an SFI-index field value in DCI format \( 2-0 \). The UE expects that for a reference SCS configuration \( \mu_{\mathrm{SFI}} \) and for an active DL BWP or an active UL BWP with SCS configuration \( \mu \), it is \( \mu \geq \mu_{\text {SFI }} \). Each slot format in the combination of slot formats indicated by the SFIindex field value in DCI format \( 2 \_0 \) is applicable to \( 2^{\left(\mu-\mu_{\mathrm{SFI}}\right)} \) consecutive slots in the active DL BWP or the active UL BWP where the first slot starts at a same time as a first slot for the reference SCS configuration \( \mu_{\text {SFI }} \) and each downlink or flexible or uplink symbol for the reference SCS configuration \( \mu_{\text {SFI }} \) corresponds to \( 2^{\left(\mu-\mu_{\text {SFI }}\right)} \) consecutive downlink or flexible or uplink symbols for the SCS configuration \( \mu \).

For paired spectrum operation for a UE on a serving cell, the SFI-index field in DCI format \( 2 \_0 \) indicates a combination of slot formats that includes a combination of slot formats for a reference DL BWP and a combination of slot formats for a reference UL BWP of the serving cell. The UE is provided by subcarrierSpacing a reference SCS configuration \( \mu_{\text {SFI,DL }} \) for the combination of slot formats indicated by the SFI-index field value in DCI format \( 2 \_0 \) for the reference DL BWP of the serving cell. The UE is provided by subcarrierSpacing2 a reference SCS configuration \( \mu_{\mathrm{SFI}, \mathrm{UL}} \) for the combination of slot formats indicated by the SFI-index field value in DCI format \( 2 \_0 \) for the reference UL BWP of the serving cell. If \( \mu_{\mathrm{SFI}, \mathrm{DL}} \geq \mu_{\mathrm{SFI}, \mathrm{UL}} \) and for each \( 2^{\left(\mu_{\mathrm{SFI}, \mathrm{DL}}-\mu_{\mathrm{SFI}, \mathrm{UL}}\right)}+1 \) values provided by a value of slotFormats, where the value of slotFormats is determined by a value of slotFormatCombinationId in slotFormatCombination and the value of slotFormatCombinationId is set by the value of the SFI-index field value in DCI format \( 2-0 \), the first \( 2{ }^{\left(\mu_{\mathrm{SFI}, \mathrm{DL}}-\mu_{\mathrm{SFI}, \mathrm{UL}}\right)} \) values for the combination of slot formats are applicable to the reference DL BWP and the next value is applicable to the reference UL BWP. If \( \mu_{\text {SFI,DL }}<\mu_{\text {SFI,UL }} \) and for each \( 2^{\left(\mu_{\text {SFI,UL }}-\mu_{\text {SFI,DL }}\right)}+1 \) values provided by slotFormats, the first value for the combination of slot formats is applicable to the reference DL BWP and the next \( 2^{\left(\mu_{\text {SFI,UL }}-\mu_{\text {SFI,DL }}\right)} \) values are applicable to the reference UL BWP.

The UE is provided a reference SCS configuration \( \mu_{\text {SFI,DL }} \) so that for an active DL BWP with SCS configuration \( \mu_{\text {DL }} \), it is \( \mu_{\mathrm{DL}} \geq \mu_{\mathrm{SFI}, \mathrm{DL}} \). The UE is provided a reference SCS configuration \( \mu_{\mathrm{SFI}, \mathrm{UL}} \) so that for an active UL BWP with SCS configuration \( \mu_{\mathrm{UL}} \), it is \( \mu_{\mathrm{UL}} \geq \mu_{\mathrm{SFI}, \mathrm{UL}} \). Each slot format for a combination of slot formats indicated by the SFI-index field value in DCI format \( 2-0 \) for the reference DL BWP, by indicating a value for slotFormatCombinationId that is mapped to a value of slotFormats in slotFormatCombination, is applicable to \( 2^{\left(\mu_{\mathrm{DL}}-\mu_{\mathrm{SFI}, \mathrm{DL}}\right)} \) consecutive slots for the active DL BWP where the first slot starts at a same time as a first slot in the reference DL BWP and each downlink or flexible symbol for the reference SCS configuration \( \mu_{\text {SFI DL }} \) corresponds to \( 2{ }^{\left(\mu_{\text {DL }}-\mu_{\text {SFI DL }}\right)} \) consecutive downlink or flexible symbols for the SCS configuration \( \mu_{\mathrm{DL}} \). Each slot format for the combination of slot formats for the reference UL BWP is applicable to \( 2^{\left(\mu_{\mathrm{UL}}-\mu_{\mathrm{SFI}, \mathrm{UL}}\right)} \) consecutive slots for the active UL BWP where the first slot starts at a same time as a first slot in the reference UL BWP and each uplink or flexible symbol for the reference SCS configuration \( \mu_{\text {SFI, UL }} \) corresponds to \( 2^{\left(\mu_{\text {UL }}-\mu_{\text {SFI,UL }}\right)} \) consecutive uplink or flexible symbols for the SCS configuration \( \mu_{\text {UL }} \).

For unpaired spectrum operation with a second UL carrier for a UE on a serving cell, the SFI-index field value in DCI format 20 indicates a combination of slot formats that includes a combination of slot formats for a reference first UL carrier of the serving cell and a combination of slot formats for a reference second UL carrier of the serving cell. The UE is provided by subcarrierSpacing a reference SCS configuration \( \mu_{\text {SFI }} \) for the combination of slot formats indicated by the SFI-index field in DCI format \( 2-0 \) for the reference first UL carrier of the serving cell. The UE is provided by subcarrierSpacing2 a reference SCS configuration \( \mu_{\text {SFISUL }} \) for the combination of slot formats indicated by the SFIindex field value in DCI format \( 2-0 \) for the reference second UL carrier of the serving cell. For each \( 2^{\left(\mu_{\mathrm{SFI}}-\mu_{\mathrm{SFI}, \mathrm{SUL}}\right)}+1 \) values of slotFormats, the first \( 2^{\left(\mu_{\text {SFI }}-\mu_{\text {SFI,SUL }}\right)} \) values for the combination of slot formats are applicable to the reference first UL carrier and the next value is applicable to the reference second UL carrier.

The UE expects to be provided a reference SCS configuration \( \mu_{\text {SFI,SUL }} \) so that for an active UL BWP in the second UL carrier with SCS configuration \( \mu_{\text {SUL }} \), it is \( \mu_{\text {SUL }} \geq \mu_{\text {SFISUL }} \). Each slot format for a combination of slot formats indicated by the SFI-index field in DCI format 2_0 for the reference first UL carrier is applicable to \( 2^{\left(\mu-\mu_{\mathrm{SFI}}\right)} \) consecutive slots for the active DL BWP and the active UL BWP in the first UL carrier where the first slot starts at a same time as a first slot in the reference first UL carrier. Each slot format for the combination of slot formats for the reference second UL carrier is applicable to \( 2{ }^{\left(\mu_{\text {SUL }}-\mu_{\text {SFI SUL }}\right)} \) consecutive slots for the active UL BWP in the second UL carrier where the first slot starts at a same time as a first slot in the reference second UL carrier.

If a BWP in the serving cell is configured with \( \mu=2 \) and with extended CP , the UE expects \( \mu_{\mathrm{SFI}}=0, \mu_{\mathrm{SFI}}=1 \), or \( \mu_{\mathrm{SFI}}=2 \). A format for a slot with extended CP is determined from a format for a slot with normal CP. A UE determines an extended CP symbol to be a downlink/uplink/flexible symbol if the overlapping normal CP symbols that are downlink/uplink/flexible symbols, respectively. A UE determines an extended CP symbol to be a flexible symbol if one of the overlapping normal CP symbols is flexible. A UE determines an extended CP symbol to be a flexible symbol if the pair of the overlapping normal CP symbols includes a downlink and an uplink symbol.

ETSI


--- Page 179  ---


3GPP TS 38.213 version 17.1.0 Release 17
178
ETSI TS 138213 V17.1.0 (2022-05)

A reference SCS configuration \( \mu_{\mathrm{SFI}} \), or \( \mu_{\mathrm{SFI}, \mathrm{DL}} \), or \( \mu_{\mathrm{SFI}, \mathrm{UL}} \), or \( \mu_{\mathrm{SFI}, \mathrm{SUL}} \) is either 0 , or 1 , or 2 for FR1 and is either 2 or 3 for FR2.

For a set of symbols of a slot, a UE does not expect to detect a DCI format 2.0 with an SFI-index field value indicating the set of symbols of the slot as uplink and to detect a DCI format indicating to the UE to receive PDSCH or CSI-RS in the set of symbols of the slot.

For a set of symbols of a slot, a UE does not expect to detect a DCI format 2.0 with an SFI-index field value indicating the set of symbols in the slot as downlink and to detect a DCI format, a RAR UL grant, fallbackRAR UL grant, or successRAR indicating to the UE to transmit PUSCH, PUCCH, PRACH, or SRS in the set of symbols of the slot.

For a set of symbols of a slot that are indicated by a DCI format \( 2 \_0 \) as being within a remaining channel occupancy duration either by a channel occupancy duration field or by an SFI-index field, a UE does not expect to detect at a later time a DCI format 2_0 indicating, either by a channel occupancy duration field or by an SFI-index field, that any symbol from the set of symbols is not within a remaining channel occupancy duration.

For a set of symbols of a slot that are indicated as downlink/uplink by tdd-UL-DL-ConfigurationCommon, or tdd-UL-DL-ConfigurationDedicated, the UE does not expect to detect a DCI format \( 2-0 \) with an SFI-index field value indicating the set of symbols of the slot as uplink/downlink, respectively, or as flexible.

For a set of symbols of a slot corresponding to SS/PBCH blocks with candidate SS/PBCH block indices corresponding to the SS/PBCH block indexes indicated to a UE by ssb-PositionsInBurst in SIB1, or by ssb-PositionsInBurst in ServingCellConfigCommon, as described in clause 4.1 or, if the UE is not provided DLorJoint-TCIState or followUnifiedTCIstate, by ssb-PositionsInBurst in SSB-MTCAdditionalPCI associated to physical cell ID with active TCI states, the UE does not expect to detect a DCI format \( 2-0 \) with an SFI-index field value indicating the set of symbols of the slot as uplink.

For a set of symbols of a slot corresponding to a valid PRACH occasion and \( N_{\text {gap }} \) symbols before the valid PRACH occasion, as described in clause 8.1, the UE does not expect to detect a DCI format 2.0 with an SFI-index field value indicating the set of symbols of the slot as downlink.

For a set of symbols of a slot indicated to a UE by pdcch-ConfigSIBI in MIB for a CORESET for Type0-PDCCH CSS set, the UE does not expect to detect a DCI format \( 2-0 \) with an SFI-index field value indicating the set of symbols of the slot as uplink.

For a set of symbols of a slot indicated to a UE as flexible by tdd-UL-DL-ConfigurationCommon and tdd-UL-DLConfigurationDedicated if provided, or when tdd-UL-DL-ConfigurationCommon and tdd-UL-DLConfigurationDedicated are not provided to the UE, and if the UE detects a DCI format \( 2 \_0 \) providing a format for the slot using a slot format value other than 255
- if one or more symbols from the set of symbols are symbols in a CORESET configured to the UE for PDCCH monitoring, the UE receives PDCCH in the CORESET only if an SFI-index field value in DCI format \( 2 \_0 \) indicates that the one or more symbols are downlink symbols
- if an SFI-index field value in DCI format 2_0 indicates the set of symbols of the slot as flexible and the UE detects a DCI format indicating to the UE to receive PDSCH or CSI-RS in the set of symbols of the slot, the UE receives PDSCH or CSI-RS in the set of symbols of the slot
- if an SFI-index field value in DCI format 2_0 indicates the set of symbols of the slot as flexible and the UE detects a DCI format, a RAR UL grant, fallbackRAR UL grant, or successRAR indicating to the UE to transmit PUSCH, PUCCH, PRACH, or SRS in the set of symbols of the slot the UE transmits the PUSCH, PUCCH, PRACH, or SRS in the set of symbols of the slot
- if an SFI-index field value in DCI format 2_0 indicates the set of symbols of the slot as flexible, and the UE does not detect a DCI format indicating to the UE to receive PDSCH or CSI-RS, or the UE does not detect a DCI format, a RAR UL grant, fallbackRAR UL grant, or successRAR indicating to the UE to transmit PUSCH, PUCCH, PRACH, or SRS in the set of symbols of the slot, the UE does not transmit or receive in the set of symbols of the slot
- if the UE is configured by higher layers to receive PDSCH or CSI-RS in the set of symbols of the slot, the UE receives the PDSCH or the CSI-RS in the set of symbols of the slot only if an SFI-index field value in DCI format 2_0 indicates the set of symbols of the slot as downlink and, if applicable, the set of symbols is within remaining channel occupancy duration

ETSI


--- Page 180  ---


3GPP TS 38.213 version 17.1.0 Release 17
179
ETSI TS 138213 V17.1.0 (2022-05)
- if the UE is configured by higher layers to receive DL PRS in the set of symbols of the slot, the UE receives the DL PRS in the set of symbols of the slot only if an SFI-index field value in DCI format 2_0 indicates the set of symbols of the slot as downlink or flexible.
- if the UE is configured by higher layers to transmit PUCCH, or PUSCH, or PRACH in the set of symbols of the slot, the UE transmits the PUCCH, or the PUSCH, or the PRACH in the slot only if an SFI-index field value in DCI format 2_0 indicates the set of symbols of the slot as uplink
- if the UE is configured by higher layers to transmit SRS in the set of symbols of the slot, the UE transmits the SRS only in a subset of symbols from the set of symbols of the slot indicated as uplink symbols by an SFI-index field value in DCI format 2_0
- a UE does not expect to detect an SFI-index field value in DCI format 2_0 indicating the set of symbols of the slot as downlink and also detect a DCI format, a RAR UL grant, fallbackRAR UL grant, or successRAR indicating to the UE to transmit SRS, PUSCH, PUCCH, or PRACH, in one or more symbols from the set of symbols of the slot
- a UE does not expect to detect an SFI-index field value in DCI format 2_0 indicating the set of symbols of the slot as downlink or flexible if the set of symbols of the slot includes symbols corresponding to any repetition of a PUSCH transmission activated by an UL Type 2 grant PDCCH as described in clause 10.2
- a UE does not expect to detect an SFI-index field value in DCI format 2_0 indicating the set of symbols of the slot as uplink and also detect a DCI format indicating to the UE to receive PDSCH or CSI-RS in one or more symbols from the set of symbols of the slot

If a UE is configured by higher layers to receive a CSI-RS or a PDSCH in a set of symbols of a slot and the UE detects a DCI format \( 2-0 \) with a slot format value other than 255 that indicates a slot format with a subset of symbols from the set of symbols as uplink or flexible, or the UE detects a DCI format indicating to the UE to transmit PUSCH, PUCCH, SRS, or PRACH in at least one symbol in the set of the symbols, the UE cancels the CSI-RS reception in the set of symbols of the slot or cancels the PDSCH reception in the slot.

For a UE operation with shared spectrum channel access in FR1, or in FR2-2 when the UE is provided ChannelAccessMode2-r17 = 'enabled', if a UE is configured by higher layers to receive a CSI-RS and the UE is provided CO-DurationsPerCell, for a set of symbols of a slot that are indicated as downlink or flexible by tdd-UL-DLConfigurationCommon or tdd-UL-DL-ConfigurationDedicated, or when tdd-UL-DL-ConfigurationCommon and tdd-UL-DL-ConfigurationDedicated are not provided, the UE cancels the CSI-RS reception in the set of symbols of the slot that are not within the remaining channel occupancy duration.

If a UE is configured by higher layers to receive a DL PRS in a set of symbols of a slot and the UE detects a DCI format \( 2 \_0 \) with a slot format value other than 255 that indicates a slot format with a subset of symbols from the set of symbols as uplink, or the UE detects a DCI format indicating to the UE to transmit PUSCH, PUCCH, SRS, or PRACH in at least one symbol in the set of the symbols, the UE cancels the DL PRS reception in the set of symbols of the slot.

If a UE is configured by higher layers to transmit SRS, or PUCCH, or PUSCH, or PRACH in a set of symbols of a slot and the UE detects a DCI format \( 2-0 \) with a slot format value other than 255 that indicates a slot format with a subset of symbols from the set of symbols as downlink or flexible, or the UE detects a DCI format indicating to the UE to receive CSI-RS or PDSCH in a subset of symbols from the set of symbols, then
- If the UE does not indicate the capability of [partialCancellation], the UE does not expect to cancel the transmission of the PUCCH or PUSCH or PRACH in the set of symbols if the first symbol in the set occurs within \( T_{\text {proc }, 2} \) relative to a last symbol of a CORESET where the UE detects the DCI format; otherwise, the UE cancels the PUCCH, or the PUSCH, or an actual repetition of the PUSCH [6, TS38.214], determined from clauses 9 and 9.2.5 or clause 6.1 of [6, TS38.214], or the PRACH transmission in the set of symbols.
- If the UE indicates the capability of [partialCancellation], the UE does not expect to cancel the transmission of the PUCCH or PUSCH or PRACH in symbols from the set of symbols that occur within \( T_{p r o c, 2} \) relative to a last symbol of a CORESET where the UE detects the DCI format. The UE cancels the PUCCH, or the PUSCH, or an actual repetition of the PUSCH [6, TS 38.214], determined from clauses 9 and 9.2 .5 or clause 6.1 of [6, TS 38.214], or the PRACH transmission in remaining symbols from the set of symbols.
- The UE does not expect to cancel the transmission of SRS in symbols from the subset of symbols that occur within \( T_{\text {proc }, 2} \) relative to a last symbol of a CORESET where the UE detects the DCI format. The UE cancels the SRS transmission in remaining symbols from the subset of symbols.

ETSI


--- Page 181  ---


3GPP TS 38.213 version 17.1.0 Release 17
180
ETSI TS 138213 V17.1.0 (2022-05)

\( T_{\text {proc }, 2} \) is the PUSCH preparation time for the corresponding UE processing capability [6, TS 38.214] assuming \( d_{2,1}=1 \) and \( \mu \) corresponds to the smallest SCS configuration between the SCS configuration of the PDCCH carrying the DCI format and the SCS configuration of the SRS, PUCCH, PUSCH or \( \mu_{r} \), where \( \mu_{r} \) corresponds to the SCS configuration of the PRACH if it is 15 kHz or higher; otherwise \( \mu_{r}=0 \).

If a UE is configured by higher layers to receive a CSI-RS or detects a DCI format \( 0 \_1 \) indicating to the UE to receive a CSI-RS in one or more RB sets and a set of symbols of a slot, and the UE detects a DCI format \( 2 \_0 \) with bitmap indicating that any RB set from the one or more RB sets is not available for reception, the UE cancels the CSI-RS reception in the set of symbols of the slot.

A UE assumes that flexible symbols in a CORESET configured to the UE for PDCCH monitoring are downlink symbols if the UE does not detect an SFI-index field value in DCI format 2_0 indicating the set of symbols of the slot as flexible or uplink and the UE does not detect a DCI format indicating to the UE to transmit SRS, PUSCH, PUCCH, or PRACH in the set of symbols.

For a set of symbols of a slot that are indicated as flexible by tdd-UL-DL-ConfigurationCommon, and tdd-UL-DLConfigurationDedicated if provided, or when tdd-UL-DL-ConfigurationCommon, and tdd-UL-DLConfigurationDedicated are not provided to the UE, and if the UE does not detect a DCI format \( 2-0 \) providing a slot format for the slot
- the UE receives PDSCH or CSI-RS in the set of symbols of the slot if the UE receives a corresponding indication by a DCI format
- the UE transmits PUSCH, PUCCH, PRACH, or SRS in the set of symbols of the slot if the UE receives a corresponding indication by a DCI format, a RAR UL grant, fallbackRAR UL grant, or successRAR
- the UE receives PDCCH as described in clause 10.1
- if the UE is configured by higher layers to receive PDSCH in the set of symbols of the slot, the UE does not receive the PDSCH in the set of symbols of the slot
- if the UE is configured by higher layers to receive CSI-RS in the set of symbols of the slot, the UE does not receive the CSI-RS in the set of symbols of the slot, except when UE is provided CO-DurationsPerCell and the set of symbols of the slot are within the remaining channel occupancy duration.
- if the UE is configured by higher layers to receive DL PRS in the set of symbols of the slot, the UE receives the DL PRS
- if the UE is configured by higher layers to transmit SRS, or PUCCH, or PUSCH, or PRACH in the set of symbols of the slot and the UE is not provided enableConfiguredUL, then
- if the UE does not indicate the capability of [partialCancellation], the UE does not expect to cancel the transmission of the PUCCH, or the PUSCH, or an actual repetition of the PUSCH [6, TS 38.214], as determined in clauses 9 and 9.2.5 or in clause 6.1 of [6. TS 38.214], or the PRACH in the slot if the first symbol of the PUCCH or the PUSCH or actual repetition of the PUSCH or the PRACH in the slot occurs within \( T_{\text {proc }, 2} \) relative to a last symbol of a CORESET where the UE is configured to monitor PDCCH for DCI format 2_0; otherwise, the UE cancels the PUCCH, or the PUSCH, or an actual repetition of the PUSCH [6, TS 38.214], as determined in clauses 9 and 9.2.5 or in clause 6.1 of [6. TS 38.214], or the PRACH in the slot;
- if the UE indicates the capability of [partialCancellation], the UE does not expect to cancel the transmission of the PUCCH, or the PUSCH, or an actual repetition of the PUSCH [6, TS 38.214], as determined in clauses 9 and 9.2.5 or in clause 6.1 of [6. TS 38.214], or the PRACH in symbols from the set of symbols that occur within \( T_{\text {proc }, 2} \) relative to a last symbol of a CORESET where the UE is configured to monitor PDCCH for DCI format 2_0. The UE cancels the PUCCH, or the PUSCH, or an actual repetition of the PUSCH [6, TS 38.214], as determined in clauses 9 and 9.25 or in clause 6.1 of [6. TS 38.214], or the PRACH transmission in remaining symbols from the set of symbols;
- the UE does not expect to cancel the transmission of SRS in symbols from the set of symbols that occur within \( T_{\text {proc }, 2} \) relative to a last symbol of a CORESET where the UE is configured to monitor PDCCH for DCI format 2_0. The UE cancels the SRS transmission in remaining symbols from the set of symbols;
- \( T_{\text {proc }, 2} \) is the PUSCH preparation time for the corresponding UE processing capability [6, TS 38.214] assuming \( d_{2,1}=1 \) and \( \mu \) corresponds to the smallest SCS configuration between the SCS configuration of

ETSI


--- Page 182  ---


3GPP TS 38.213 version 17.1.0 Release 17
181
ETSI TS 138213 V17.1.0 (2022-05)

the PDCCH carrying the DCI format \( 2-0 \) and the SCS configuration of the SRS, PUCCH, PUSCH or \( \mu_{r} \), where \( \mu_{r} \) corresponds to the SCS configuration of the PRACH if it is 15 kHz or higher; otherwise \( \mu_{r}=0 \);
- if the UE is configured by higher layers to transmit SRS, or PUCCH, or PUSCH, or PRACH in the set of symbols of the slot and the UE is provided enableConfiguredUL, the UE can transmit the SRS, or PUCCH, or PUSCH, or PRACH, respectively.

For unpaired spectrum operation for a UE on a cell in a frequency band of FR1, and when the scheduling restrictions due to RRM measurements [10, TS 38.133 ] are not applicable, if the UE detects a DCI format indicating to the UE to transmit in a set of symbols, the UE is not required to perform RRM measurements [10, TS 38.133] based on a SS/PBCH block or CSI-RS reception on a different cell in the frequency band if the SS/PBCH block or CSI-RS reception includes at least one symbol from the set of symbols.
11.2 Interrupted transmission indication

If a UE is provided DownlinkPreemption, the UE is configured with an [NT-RNT] provided by int-RNTI for monitoring PDCCH conveying DCI format 2_1 [5, TS 38.212]. The UE is additionally configured with
- a set of serving cells by int-ConfigurationPerServingCell that includes a set of serving cell indexes provided by corresponding servingCellld and a corresponding set of locations for fields in DCI format 2 _ 1 by positionInDCI
- an information payload size for DCI format 2 _ 1 by dci-PayloadSize
- an indication granularity for time-frequency resources by timeFrequencySet

If a UE detects a DCI format 2_1 for a serving cell from the configured set of serving cells, the UE may assume that no transmission to the UE is present in PRBs and in symbols that are indicated by the DCI format 2 , from a set of PRBs and a set of symbols of the last monitoring period. The indication by the DCI format 2 _ 1 is not applicable to receptions of SS/PBCH blocks.

The set of PRBs is equal to the active DL BWP as defined in clause 12 and includes \( B_{\text {INT }} \) PRBs.
If a UE detects a DCI format \( 2 \_1 \) in a PDCCH reception in a slot, the set of symbols is the last \( N_{\text {symb }}^{\text {slet }} \cdot T_{\text {INT }} \cdot 2^{\mu-\rho_{\text {IMT }}} \) symbols prior to the first symbol of the PDCCH reception in the slot where \( T_{\text {INT }} \) is the PDCCH monitoring periodicity provided by the value of monitoringSlotPeriodicityAndOffset, as described in clause \( 10.1, N_{\text {symb }}^{\text {slot }} \) is the number of symbols per slot, \( \mu \) is the SCS configuration for a serving cell with mapping to a respective field in the DCI format 2_1, \( \mu_{\text {INT }} \) is the SCS configuration of the DL BWP where the UE receives the PDCCH with the DCI format 2_1. If the UE is provided tdd-UL-DL-ConfigurationCommon, symbols indicated as uplink by tdd-UL-DL-ConfigurationCommon are excluded from the last \( N_{\text {symb }}^{\text {slot }} \cdot T_{\text {INT }} \cdot 2^{\mu-\mu_{\text {MT }}} \) symbols prior to the first symbol of the PDCCH reception in the slot. The resulting set of symbols includes a number of symbols that is denoted as \( N_{\text {INT }} \) -

The UE does not expect to be provided values of \( \mu_{,} \mu_{\text {INT }} \), and \( T_{\text {INT }} \) resulting to a value of \( N_{\text {symb }}^{\text {slot }} \cdot T_{\text {INT }} \cdot 2^{\mu-\mu_{\text {INT }}} \) that is not an integer. The UE does not expect to be configured by monitoringSymbols WithinSlot with more than one PDCCH monitoring occasion for DCI format 2_1 in a slot.

A UE is provided the indication granularity for the set of PRBs and for the set of symbols by timeFrequencySet.
If the value of timeFrequencySet is 'set0', 14 bits from MSB of a field in DCI format 2 _ 1 have a one-to-one mapping with 14 groups of consecutive symbols from the set of symbols where each of the first \( N_{\text {INT }}-\left\lfloor N_{\text {INT }} / 14\right\rfloor 14 \) symbol groups includes \( \left\lceil N_{\text {INT }} / 14\right\rceil \) symbols, each of the last \( 14-N_{\text {INT }}+\left\lfloor N_{\text {INT }} / 14\right\rfloor 14 \) symbol groups includes \( \left\lfloor N_{\text {INT }} / 14\right\rfloor \) symbols, a bit value of 0 indicates transmission to the UE in the corresponding symbol group and a bit value of 1 indicates no transmission to the UE in the corresponding symbol group.

If the value of timeFrequencySet is 'set1', 7 pairs of bits from MSB of a field in the DCI format 21 have a one-to-one mapping with 7 groups of consecutive symbols where each of the first \( N_{\text {INT }}-\left\lfloor N_{\text {INT }} / 7\right\rfloor .7 \) symbol groups includes \( \left\lceil N_{\text {INT }} / 7\right\rceil \) symbols, each of the last \( 7-N_{\text {INT }}+\left\lfloor N_{\text {INT }} / 7\right\rfloor .7 \) symbol groups includes \( \left\lfloor N_{\text {INT }} / 7\right\rfloor \) symbols, a first bit in a pair of bits for a symbol group is applicable to the subset of first \( \left\lceil B_{\text {INT }} / 2\right\rceil \) PRBs from the set of \( B_{\text {INT }} \) PRBs, a second bit in the pair of bits for the symbol group is applicable to the subset of last \( \left\lfloor B_{\text {INT }} / 2\right\rfloor \) PRBs from the set of \( B_{\text {INT }} \) PRBs,

ETSI


--- Page 183  ---


3GPP TS 38.213 version 17.1.0 Release 17
182
ETSI TS 138213 V17.1.0 (2022-05)

a bit value of 0 indicates transmission to the UE in the corresponding symbol group and subset of PRBs, and a bit value of 1 indicates no transmission to the UE in the corresponding symbol group and subset of PRBs.
11.2A Cancellation indication

If a UE is provided UplinkCancellation, the UE is provided, in one or more serving cells, search space sets for monitoring the first PDCCH candidate with a CCE aggregation level of \( L_{C I} \) CCEs of each search space set for detection of a DCI format 2_4 [5, TS 38.212] with a CI-RNTI provided by ci-RNTI as described in clause 10.1. UplinkCancellation additionally provides to the UE
- a set of serving cells, by ci-ConfigurationPerServingCell, that includes a set of serving cell indexes and a corresponding set of locations for fields in DCI format 2_4 by positionInDCI
- a number of fields in DCI format 2_4, by positionInDCI-forSUL, for each serving cell for a SUL carrier, if the serving cell is configured with a SUL carrier
- an information payload size for DCI format 2_4 by dci-PayloadSize-ForCI
- an indication for time-frequency resources by timeFrequencyRegion

For a serving cell having an associated field in a DCI format 2_4, for the field denote by
- \( \quad N_{\mathrm{Cl}} \) a number of bits provided by ci-PayloadSize
- \( \quad B_{\mathrm{Cl}} \) a number of PRBs provided by frequencyRegionforCI in timeFrequencyRegion
- \( \quad T_{\mathrm{Cl}} \) a number of symbols, excluding symbols for reception of SS/PBCH blocks and DL symbols indicated by tdd-UL-DL-ConfigurationCommon, from a number of symbols that
- is provided by timeDurationforCI in timeFrequencyRegion, if the PDCCH monitoring periodicity for the search space set with the DCI format 2_4 is one slot and there are more than one PDCCH monitoring occasions in a slot, or
- is equal to the PDCCH monitoring periodicity, otherwise.
- \( G_{\mathrm{Cl}} \) a number of partitions for the \( T_{\mathrm{Cl}} \) symbols provided by timeGranularityforCI in timeFrequencyRegion
\( G_{\mathrm{Cl}} \) sets of bits from the MSB of the \( N_{\mathrm{Cl}} \) bits have a one-to-one mapping with \( G_{\mathrm{Cl}} \) groups of symbols where each of the first \( G_{\mathrm{Cl}}-T_{\mathrm{Cl}}+\left\lfloor T_{\mathrm{Cl}} / G_{\mathrm{Cl}}\right\rfloor \cdot G_{\mathrm{Cl}} \) groups includes \( \left\lfloor T_{\mathrm{Cl}} / G_{\mathrm{Cl}}\right\rfloor \) symbols and each of the remaining \( T_{\mathrm{Cl}}-\left\lfloor T_{\mathrm{Cl}} / G_{\mathrm{Cl}}\right\rfloor \cdot G_{\mathrm{Cl}} \) groups includes \( \left[T_{\mathrm{CI}} / G_{\mathrm{CI}}\right] \) symbols. A UE determines a symbol duration with respect to a SCS configuration of an active DL BWP where the UE monitors PDCCH for DCI format 2_4 detection.

For a group of symbols, \( N_{\mathrm{BI}}=N_{\mathrm{Cl}} / G_{C I} \) bits from MSB of each set of bits have a one-to-one mapping with \( N_{\mathrm{Bl}} \) groups of PRBs where each of the first \( N_{\mathrm{BI}}-B_{\mathrm{Cl}}+\left\lfloor B_{\mathrm{Cl}} / N_{\mathrm{BI}}\right\rfloor \cdot N_{\mathrm{BI}} \) groups includes \( \left\lfloor B_{\mathrm{CI}} / N_{\mathrm{BI}}\right\rfloor \) PRBs and each of the remaining \( B_{\mathrm{Cl}}-\left\lfloor B_{\mathrm{Cl}} / N_{\mathrm{Bl}}\right\rfloor \cdot N_{\mathrm{Bl}} \) groups includes \( \left\lceil B_{\mathrm{Cl}} / N_{\mathrm{Bl}}\right\rceil \) PRBs. A UE determines a first PRB index as \( N_{R F R}^{\text {start }}=O_{\text {carrier }}+ R B_{\text {start }} \) and a number of contiguous RBs as \( B_{\mathrm{Cl}}=L_{\mathrm{RB}} \) from frequencyRegionfor \( C I \) that indicates an offset \( R B_{\text {start }} \) and a length \( L_{\mathrm{RB}} \) as RIV according to [6, TS 38.214], and from offsetToCarrier in FrequencyInfoUL-SIB or FrequencyInfoUL that indicates \( O_{\text {carrier }} \) for a SCS configuration of an active DL BWP where the UE monitors PDCCH for DCI format 2_4 detection.

An indication by a DCI format 2_4 for a serving cell is applicable to a PUSCH transmission or an SRS transmission on the serving cell. If the PUSCH transmission or the SRS transmission is scheduled by a DCI format, the indication by the DCI format 2_4 is applicable to the PUSCH transmission or SRS transmission only if the last symbol of the PDCCH reception providing the DCI format is earlier than the first symbol of the PDCCH reception providing the DCI format 2_4.

For the serving cell, the UE determines the first symbol of the \( T_{\mathrm{CI}} \) symbols to be the first symbol that is after \( T^{\prime}{ }_{\text {proc, } 2} \) from the end of a PDCCH reception where the UE detects the DCI format 2_4, where \( T^{\prime}{ }_{\text {proc }, 2} \) is obtained from \( T_{\text {proc }, 2} \) for PUSCH processing capability 2 [6, TS 38.214] assuming \( d_{2,1}=d_{\text {offset }} \cdot 2^{-\mu \nu L} / 2^{-\mu} \) where \( d_{\text {offset }} \) is provided by delta_Offset, \( \mu \) being the smallest SCS configuration between the SCS configuration of the PDCCH and the smallest SCS configuration \( \mu_{\mathrm{UL}} \) provided in scs-SpecificCarrierList of FrequencyInfoUL or FrequencyInfoUL-SIB. The UE does

ETSI


--- Page 184  ---


3GPP TS 38.213 version 17.1.0 Release 17
183
ETSI TS 138213 V17.1.0 (2022-05)

not expect to cancel the PUSCH transmission or the SRS transmission before a corresponding symbol that is \( T_{\text {proc }, 2} \) assuming that \( d_{2,1}=0 \) after a last symbol of the PDCCH reception where the UE detects the DCI format 2_4.

A UE that detects a DCI format 2_4 for a serving cell cancels a PUSCH transmission or an actual repetition of a PUSCH transmission [6, TS 38.214] if the PUSCH transmission is with repetition Type B, as determined in clauses 9 and 9.2.5 or in clause 6.1 of [6, TS 38.214], or an SRS transmission on the serving cell if, respectively,
- the transmission is PUSCH with priority 0 , if the UE is provided uplinkCancellationPriority,
- a group of symbols, from the \( T_{\mathrm{Cl}} \) symbols, has at least one bit value of ' 1 ' in the corresponding set of \( N_{\mathrm{Bl}} \) bits in the DCI format 2_4 and includes a symbol of the (repetition of the) PUSCH transmission or of the SRS transmission, and
- a group of PRBs, from the \( B_{\mathrm{Cl}} \mathrm{PRBs} \), has a corresponding bit value of ' 1 ' in the set of bits corresponding to the group of symbols in the DCI format 2_4 and includes a PRB of the (repetition of the) PUSCH transmission or of the SRS transmission,
where
- the cancellation of the (repetition of the) PUSCH transmission includes all symbols from the earliest symbol of the (repetition of the) PUSCH transmission that is in a group of symbols having corresponding bit values of ' 1 ' in the DCI format 2_4;
- the cancellation of the SRS transmission includes only symbols that are in one or more groups of symbols having corresponding bit values of ' 1 ' in the DCI format 2_4.

If, based on an indication by a DCI format 2_4, a UE cancels a PUSCH transmission or an SRS transmission, the UE does not expect to be scheduled by a second DCI format to transmit a PUSCH or an SRS over symbols that include symbols of the cancelled PUSCH transmission or SRS transmission, where the last symbol of the PDCCH reception providing the second DCI format is later than the first symbol of the PDCCH reception providing the DCI format 2_4.
11.3 Group TPC commands for PUCCH/PUSCH

For PUCCH transmission on a serving cell, a UE can be provided
- a TPC-PUCCH-RNTI for a DCI format 2_2 by tpc-PUCCH-RNTI
- a field in DCI format 2_2 is a TPC command of 2 bits mapping to \( \delta_{\mathrm{PUCCH}, b, f, c} \) values as described in clause 7.2.1
- an index for a location in DCI format 22 of a first bit for a TPC command field for the PCell, or for a carrier of the PCell by tpc-IndexPCell
- an index for a location in DCI format 22 of a first bit for a TPC command field for a PUCCH-sSCell in the primary PUCCH cell group, by tpc-IndexsScell
- an index for a location in DCI format 22 of a first bit for a TPC command field for the PUCCH-SCell or for a carrier for the PUCCH-SCell by tpc-IndexPUCCH-Scell
- an index for a location in DCI format 2_2 of a first bit for a TPC command field for a PUCCH-sSCell in the secondary PUCCH cell group, by tpc-IndexsScell-secondaryPUCCHgroup
- a mapping for the PUCCH power control adjustment state \( l \in\{0,1\} \), by a corresponding \( \{0,1\} \) value of a closed loop index field that is appended to the TPC command field in DCI format 22 if the UE indicates a capability to support two PUCCH power control adjustment states by twoDifferentTPC-Loop-PUCCH, and if the UE is configured for two PUCCH power control adjustment states by twoPUCCH-PC-AdjustmentStates

The UE is also provided on a serving cell with a configuration for a search space set \( s \) and a corresponding CORESET \( p \) for monitoring PDCCH candidates for DCI format \( 2 \_2 \) with CRC scrambled by a TPC-PUCCH-RNTI as described in clause 10.1.

For PUSCH transmission on a serving cell, a UE can be provided
- a TPC-PUSCH-RNTI for a DCI format 2_2 by tpc-PUSCH-RNTI

ETSI


--- Page 185  ---


3GPP TS 38.213 version 17.1.0 Release 17
184
ETSI TS 138213 V17.1.0 (2022-05)
- a field in DCI format 2_2 is a TPC command of 2 bits mapping to \( \delta_{\mathrm{PUSCH}, b, f, c} \) values as described in clause 7.1.1
- an index for a location in DCI format 2_2 of a first bit for a TPC command field for an uplink carrier of the serving cell by tpc-Index
- an index for a location in DCI format 2_2 of a first bit for a TPC command field for a supplementary uplink carrier of the serving cell by tpc-IndexSUL
- an index of the serving cell by targetCell. If targetCell is not provided, the serving cell is the cell of the PDCCH reception for DCI format 2_2
- a mapping for the PUSCH power control adjustment state \( l \in\{0,1\} \), by a corresponding \( \{0,1\} \) value of a closed loop index field that is appended to the TPC command field for the uplink carrier or for the supplementary uplink carrier of the serving cell in DCI format 2 2 if the UE indicates a capability to support two PUSCH power control adjustment states, by twoDifferentTPC-Loop-PUSCH, and if the UE is configured for two PUSCH power control adjustment states by twoPUSCH-PC-AdjustmentStates

The UE is also provided for the serving cell of the PDCCH reception for DCI format 2_2 with a configuration for a search space set \( s \) and a corresponding CORESET \( p \) for monitoring PDCCH candidates for DCI format \( 2 \_2 \) with CRC scrambled by a TPC-PUSCH-RNTI as described in clause 10.1.
11.4 SRS switching

DCI format 2_3 is applicable for uplink carrier(s) of serving cells where a UE is not configured for PUSCH/PUCCH transmission or for uplink carrier(s) of a serving cell where srs-PowerControlAdjustmentStates indicates a separate power control adjustment state between SRS transmissions and PUSCH transmissions.

A UE configured by higher layers with parameter carrierSwitching is provided
- a TPC-SRS-RNTI for a DCI format 2 _ 3 by tpc-SRS-RNTI
- an index of a serving cell where the UE interrupts transmission in order to transmit SRS on one or more other serving cells by srs-SwitchFromServCellIndex
- an indication of an uplink carrier where the UE interrupts transmission in order to transmit SRS on one or more other serving cells by srs-SwitchFromCarrier
- a DCI format 2_3 field configuration type by typeA or typeB
- for typeA, an index for a set of serving cells is provided by cc-SetIndex, indexes of serving cells in the set of serving cells are provided by cc-IndexInOneCC-Set, and a DCI format 2_3 field includes a TPC command for each serving cell from the set of serving cells and can also include a SRS request for SRS transmission on the set of serving cells
- for typeB, DCI format 2_3 field includes a TPC command for a serving cell index and can also include a SRS request for SRS transmission on the serving cell
- an indication for a serving cell for whether or not a field in DCI format 2 _ 3 includes a SRS request by fieldTypeFormat \( 2-3 \) where a value of \( 0 / 1 \) indicates absence/presence of the SRS request - a mapping for a 2 bit SRS request to SRS resource sets is as provided in [6, TS 38.214]
- an index for a location in DCI format 2_3 of a first bit for a field for a non-supplementary uplink carrier of the serving cell by startingBitOfFormat2-3
- an index for a location in DCI format 2 _ 3 of a first bit for a field for a supplementary uplink carrier of the serving cell by startingBitOfFormat2-3SUL-v1530

12 Bandwidth part operation
If the UE is configured with a SCG, the UE shall apply the procedures described in this clause for both MCG and SCG

ETSI


--- Page 186  ---


3GPP TS 38.213 version 17.1.0 Release 17
185
ETSI TS 138213 V17.1.0 (2022-05)
- When the procedures are applied for MCG, the terms 'secondary cell', 'secondary cells', 'serving cell', 'serving cells' in this clause refer to secondary cell, secondary cells, serving cell, serving cells belonging to the MCG respectively.
- When the procedures are applied for SCG, the terms 'secondary cell', 'secondary cells', 'serving cell', 'serving cells' in this clause refer to secondary cell, secondary cells (not including PSCell), serving cell, serving cells belonging to the SCG respectively. The term 'primary cell' in this clause refers to the PSCell of the SCG.

A UE configured for operation in bandwidth parts (BWPs) of a serving cell, is configured by higher layers for the serving cell a set of at most four bandwidth parts (BWPs) for receptions by the UE (DL BWP set) in a DL bandwidth by parameter BWP-Downlink or by parameter mitialDownlinkBWP with a set of parameters configured by BWPDownlinkCommon and BWP-DownlinkDedicated, and a set of at most four BWPs for transmissions by the UE (UL BWP set) in an UL bandwidth by parameter BWP-Uplink or by parameter initialUplinkBWP with a set of parameters configured by BWP-UplinkCommon and BWP-UplinkDedicated.

For operation with shared spectrum channel access, a UE expects that the BWP configured by the parameter initialUplinkBWP provided in UplinkConfigCommonSIB is mapped to only a single RB set.

If a UE is not provided initialDownlinkBWP, an initial DL BWP is defined by a location and number of contiguous PRBs, starting from a PRB with the lowest index and ending at a PRB with the highest index among PRBs of a CORESET for Type0-PDCCH CSS set, and a SCS and a cyclic prefix for PDCCH reception in the CORESET for Type0-PDCCH CSS set; otherwise, the initial DL BWP is provided by initialDownlinkBWP. For operation on the primary cell or on a secondary cell, a UE is provided an initial UL BWP by initialUplinkBWP. If the UE is configured with a supplementary UL carrier, the UE can be provided an initial UL BWP on the supplementary UL carrier by initialUplinkBWP.

If a UE has dedicated BWP configuration, the UE can be provided by firstActiveDownlinkBWP-Id a first active DL BWP for receptions and by firstActiveUplinkBWP-Id a first active UL BWP for transmissions on a carrier of the primary cell.

For each DL BWP or UL BWP in a set of DL BWPs or UL BWPs, respectively, the UE is provided the following parameters for the serving cell as defined in [4, TS 38.211] or [6, TS 38.214]:
- a SCS by subcarrierSpacing
- a cyclic prefix by cyclicPrefix
- a common RB \( N_{\mathrm{BWP}}^{\text {start }}=O_{\text {carrier }}+R B_{\text {start }} \) and a number of contiguous RBs \( N_{\mathrm{BWP}}^{\text {size }}=L_{\mathrm{RB}} \) provided by locationAndBandwidth that indicates an offset \( R B_{\text {start }} \) and a length \( L_{\mathrm{RB}} \) as RIV according to [6, TS 38.214], setting \( N_{\text {BWP }}^{\text {size }}=275 \), and a value \( O_{\text {carrier }} \) provided by offsetToCarrier for the subcarrierSpacing
- an index in the set of DL BWPs or UL BWPs by respective BWP-Id
- a set of BWP-common and a set of BWP-dedicated parameters by BWP-DownlinkCommon and BWPDownlinkDedicated for the DL BWP, or BWP-UplinkCommon and BWP-UplinkDedicated for the UL BWP [12, TS 38.331]

For unpaired spectrum operation, a DL BWP from the set of configured DL BWPs with index provided by BWP-Id is linked with an UL BWP from the set of configured UL BWPs with index provided by BWP-Id when the DL BWP index and the UL BWP index are same. For unpaired spectrum operation, a UE does not expect to receive a configuration where the center frequency for a DL BWP is different than the center frequency for an UL BWP when the BWP-Id of the DL BWP is same as the BWP-Id of the UL BWP.

For each DL BWP in a set of DL BWPs of the PCell, a UE can be configured CORESETs for every type of CSS sets and for USS as described in clause 10.1. The UE does not expect to be configured without a CSS set on the PCell in the active DL BWP.

If a UE is provided controlResourceSetZero and searchSpaceZero in PDCCH-ConfigSIBl or PDCCH-ConfigCommon, the UE determines a CORESET for a search space set from controlResourcesetZero as described in clause 13 and for Tables 13-1 through 13-10, and determines corresponding PDCCH monitoring occasions as described in clause 13 and for Tables 13-11 through 13-15. If the active DL BWP is not the initial DL BWP, the UE determines PDCCH monitoring occasions for the search space set only if the CORESET bandwidth is within the active DL BWP and the active DL BWP has same SCS configuration and same cyclic prefix as the initial DL BWP.

ETSI


--- Page 187  ---


3GPP TS 38.213 version 17.1.0 Release 17
186
ETSI TS 138213 V17.1.0 (2022-05)

For each UL BWP in a set of UL BWPs of the PCell or of the PUCCH-SCell, the UE is configured resource sets for PUCCH transmissions as described in clause 9.2.1.

A UE receives PDCCH and PDSCH in a DL BWP according to a configured SCS and CP length for the DL BWP. A UE transmits PUCCH and PUSCH in an UL BWP according to a configured SCS and CP length for the UL BWP.

If a bandwidth part indicator field is configured in a DCI format, the bandwidth part indicator field value indicates the active DL BWP, from the configured DL BWP set, for DL receptions as described in [5, TS 38.212]. If a bandwidth part indicator field is configured in a DCI format, the bandwidth part indicator field value indicates the active UL BWP, from the configured UL BWP set, for UL transmissions as described in [5, TS 38.212]. If a band width part indicator field is configured in a DCI format and indicates an UL BWP or a DL BWP different from the active UL BWP or DL BWP, respectively, the UE shall
- for each information field in the DCI format
- if the size of the information field is smaller than the one required for the DCI format interpretation for the UL BWP or DL BWP that is indicated by the bandwidth part indicator, the UE prepends zeros to the information field until its size is the one required for the interpretation of the information field for the UL BWP or DL BWP prior to interpreting the DCI format information fields, respectively
- if the size of the information field is larger than the one required for the DCI format interpretation for the UL BWP or DL BWP that is indicated by the bandwidth part indicator, the UE uses a number of least significant bits of the DCI format equal to the one required for the UL BWP or DL BWP indicated by bandwidth part indicator prior to interpreting the DCI format information fields, respectively
- set the active UL BWP or DL BWP to the UL BWP or DL BWP indicated by the bandwidth part indicator in the DCI format

If a bandwidth part indicator field is configured in a DCI format \( 0 \_1 \) and indicates an active UL BWP with different SCS configuration \( \mu \), or with different number \( N_{\text {RB-set, UL }}^{\text {BWP }} \) of RB sets, than a current active UL BWP, the UE determines an uplink frequency domain resource allocation Type 2 based on \( X^{\prime} \) bits and \( Y^{\prime} \) bits that are generated by independently truncating or padding the \( X \) MSBs and the \( Y \) LSBs [6, TS 38.214] of the frequency domain resource assignment field of DCI format \( 0 \_1 \), where truncation starts from the MSBs of the X bits or the Y bits, zero-padding prepends zeros to the X bits or the Y bits, and
- if the indicated active UL BWP has SCS configuration \( \mu=1 \) and the current active BWP has SCS configuration \( \mu=0 \), the \( X \) MSBs are truncated to \( X^{\prime}=X-1 \) bits, or
- if the indicated active UL BWP has SCS configuration \( \mu=0 \) and the current active BWP has SCS configuration \( \mu=1 \), the \( X \) MSBs are zero-padded to \( X^{\prime}=X+1 \) bits
- otherwise, the \( X \) MSBs are unchanged
and
- the \( Y \) LSBs are truncated or zero-padded to \( Y^{\prime}=\left\lceil\log _{2}\left(\frac{N_{\mathrm{RB}-\text { set, UL }}^{\mathrm{BWP}}\left(N_{\mathrm{RB}-\text { set, UL }}^{\mathrm{BWP}}+1\right)}{2}\right)\right\rceil \) bits where \( N_{\mathrm{RB}-\text { set, UL }}^{\mathrm{BWP}} \) is a number of RB sets configured for the indicated active UL BWP

A UE does not expect to detect a DCI format with a BWP indicator field that indicates an active DL BWP or an active UL BWP change with the corresponding time domain resource assignment field providing a slot offset value for a PDSCH reception or PUSCH transmission that is smaller than a delay required by the UE for an active DL BWP change or UL BWP change, respectively [10, TS 38.133].

If a UE detects a DCI format with a BWP indicator field that indicates an active DL BWP change for a cell, the UE is not required to receive or transmit in the cell during a time duration from the end of the third symbol of a slot where the UE receives the PDCCH that includes the DCI format in a scheduling cell until the beginning of a slot indicated by the slot offset value of the time domain resource assignment field in the DCI format.

If a UE detects a DCI format with SCell dormancy indication that indicates an active DL BWP change for an Scell in slot \( n \) of primary cell, the UE is not required to receive or transmit in the SCell during a time duration specified in [10, TS 38.133].

ETSI


--- Page 188  ---


3GPP TS 38.213 version 17.1.0 Release 17
187
ETSI TS 138213 V17.1.0 (2022-05)

If a UE detects a DCI format indicating an active UL BWP change for a cell, the UE is not required to receive or transmit in the cell during a time duration from the end of the third symbol of a slot where the UE receives the PDCCH that includes the DCI format in the scheduling cell until the beginning of a slot indicated by the slot offset value of the time domain resource assignment field in the DCI format.

A UE does not expect to detect a DCI format indicating an active DL BWP change or an active UL BWP change for a scheduled cell within FR1 (or FR2) in a slot other than the first slot of a set of slots for the DL SCS of the scheduling cell that overlaps with a time duration where the UE is not required to receive or transmit, respectively, for an active BWP change in a different cell from the scheduled cell within FR1 (or FR2).

A UE expects to detect a DCI format with a BWP indicator field that indicates an active UL BWP change or an active DL BWP change only if a corresponding PDCCH is received within the first 3 symbols of a slot. If the UE detects the DCI format from two PDCCH receptions in search space sets \( s_{i} \) and \( s_{j} \) that include searchSpaceLinking with value \( s_{j} \) and \( s_{i} \), respectively, as described in clause 10.1 , the UE considers the PDCCH reception where the UE detects the DCI format to be the one from the two PDCCH receptions that ends later.

For a serving cell, a UE can be provided by defaultDownlinkBWP-Id a default DL BWP among the configured DL BWPs. If a UE is not provided a default DL BWP by defaultDownlinkBWP-Id, the default DL BWP is the initial DL BWP.

If a UE is provided by bwp-InactivityTimer a timer value for the serving cell [11, TS 38.321] and the timer is running, the UE decrements the timer at the end of a subframe for FR1 or at the end of a half subframe for FR2 if the restarting conditions in [11, TS 38.321] are not met during the interval of the subframe for FR1 or of the half subframe for FR2.

For a cell where a UE changes an active DL BWP due to a BWP inactivity timer expiration and for accommodating a delay in the active DL BWP change or the active UL BWP change required by the UE [10, TS 38.133], the UE is not required to receive or transmit in the cell during a time duration from the beginning of a subframe for FR1, or of half of a subframe for FR2, that is immediately after the BWP inactivity timer expires until the beginning of a slot where the UE can receive or transmit.

When a UE's BWP inactivity timer for a cell within FR1 (or FR2) expires within a time duration where the UE is not required to receive or transmit for an active UL/DL BWP change in the cell or in a different cell within FR1 (or FR2), the UE delays the active UL/DL BWP change triggered by the BWP inactivity timer expiration until a subframe for FR1 or half a subframe for FR2 that is immediately after the UE completes the active UL/DL BWP change in the cell or in the different cell within FR1 (or FR2).

If a UE is provided by firstActiveDownlinkBWP-Id a first active DL BWP and by firstActiveUplinkBWP-Id a first active UL BWP on a carrier of a secondary cell, the UE uses the indicated DL BWP and the indicated UL BWP as the respective first active DL BWP on the secondary cell and first active UL BWP on the carrier of the secondary cell.

A UE does not expect to monitor PDCCH when the UE performs RRM measurements [10, TS 38.133] over a bandwidth that is not within the active DL BWP for the UE.

13 UE procedure for monitoring Type0-PDCCH CSS sets

If during cell search a UE determines from MIB that a CORESET for Type0-PDCCH CSS set is present, as described in clause 4.1, the UE determines a number of consecutive resource blocks and a number of consecutive symbols for the CORESET of the Type0-PDCCH CSS set from controlResourceSetZero in pdcch-ConfigSIB1, as described in Tables 13-1 through 13-10, for operation without shared spectrum channel access in FR1 and FR2-1, or as described in Tables 13-1A and 13-4A for operation with shared spectrum channel access in FR1, or as described in Table 13-10A for FR22, and determines PDCCH monitoring occasions from searchSpaceZero in pdcch-ConfigSIBI, included in MIB, as described in Tables 13-11 through 13-15. SFN \( { }_{\mathrm{c}} \) and \( n_{\mathrm{c}} \) are the SFN and slot index within a frame of the CORESET based on SCS of the CORESET and SFN \( \mathrm{SSB}_{i} \) and \( n_{\mathrm{SSB}, i} \) are the SFN and slot index based on SCS of the CORESET, respectively, where the \( \mathrm{SS} / \mathrm{PBCH} \) block with index \( i \) overlaps in time with system frame \( \mathrm{SFN}_{\mathrm{SSB}, i} \) and slot \( n_{\mathrm{SSB}, i} \). The symbols of the CORESET associated with pdcch-ConfigSIB1 in MIB or with searchSpaceSIB1 in PDCCHConfigCommon have normal cyclic prefix.

For operation with shared spectrum channel access in FR2-2 and for operation without shared spectrum channel access, a UE assumes that the offset in Tables 13-1 through 13-10A is defined with respect to the SCS of the CORESET for Type0-PDCCH CSS set from the smallest RB index of the CORESET for Type0-PDCCH CSS set to the smallest RB

ETSI


--- Page 189  ---


3GPP TS 38.213 version 17.1.0 Release 17
188
ETSI TS 138213 V17.1.0 (2022-05)

index of the common RB overlapping with the first RB of the corresponding SS/PBCH block. The SCS of the CORESET for Type0-PDCCH CSS set is provided by subCarrierSpacingCommon for FR1 and FR2-1 and same as the SCS of the corresponding SS/PBCH block for FR2-2. In Tables 13-7, 13-8, and 13-10, \( k_{\text {SSB }} \) is defined in \( [4 \), TS 38.211].

For operation with shared spectrum channel access in FR1, a UE determines an offset from a smallest RB index of the CORESET for Type0-PDCCH CSS set to a smallest RB index of the common RB overlapping with a first RB of the corresponding SS/PBCH block
- according to the offset in Table 13-1A or Table 13-4A, if the frequency position of the SS/PBCH block corresponds to the GSCN of a synchronization raster entry as defined in [8-1, TS 38.101-1], and
- according to a sum of a first offset and a second offset if the frequency position of the SS/PBCH block is provided by ssbFrequency in a measurement configuration associated with a reporting configuration providing reportCGI and does not correspond to the GSCN of a synchronization raster entry as defined in [8-1, TS 38.1011], where
- the first offset is provided in Table 13-1A or Table 13-4A, and
- the second offset is determined as the offset from a smallest RB index of the common RB overlapping with the first RB of the SS/PBCH block indicated in the measurement configuration to a smallest RB index of the common RB overlapping with the first RB of a SS/PBCH block hypothetically located at the GSCN of a synchronization raster entry, where the single synchronization raster entry is located in the same channel as the SS/PBCH block used for the shared spectrum channel access procedure, as described in [15, TS 37.213]
where the offsets are defined with respect to the SCS of the CORESET for Type0-PDCCH CSS set that is same as the SCS of the corresponding SS/PBCH block.

For operation without shared spectrum channel access and for the SS/PBCH block and CORESET multiplexing pattern 1, a UE monitors PDCCH in the Type0-PDCCH CSS set over two slots. For SS/PBCH block with index \( i \), the UE determines an index of slot \( n_{0} \) as \( n_{0}=\left(O \cdot 2^{\mu}+\lfloor i \cdot M\rfloor\right) \bmod N_{\text {slot }}^{\text {frame } \mu} \) that is in a frame with system frame number (SFN) SFN \( { }_{\mathrm{C}} \) satisfying \( \mathrm{SFN}_{\mathrm{c}} \bmod 2=0 \) if \( \left\lfloor\left(O \cdot 2^{\mu}+\lfloor i \cdot M\rfloor\right) / N_{\text {slot }}^{\text {fram }{ }^{\mu}, \mu}\right\rfloor \bmod 2=0 \), or in a frame with SFN satisfying \( \mathrm{SFN}_{\mathrm{c}} \bmod 2=1 \) if \( \left\lfloor\left(O \cdot 2^{\mu}+\lfloor i \cdot M\rfloor\right) / N_{\text {slot }}^{\text {frame }, \mu}\right\rfloor \bmod 2=1 \) where \( \mu \in\{0,1,2,3,5,6\} \) based on the SCS for PDCCH receptions in the CORESET [4, TS 38.211].
- For \( \mu \in\{0,1,2,3\} \) and for a SS/PBCH block index \( i \), the two slots including the associated Type0-PDCCH monitoring occasions are slots \( n_{0} \) and \( n_{0}+1 . M, O \), and the index of the first symbol of the CORESET in slots \( n_{0} \) and \( n_{0}+1 \) are provided by Table 13-11 and Table 13-12.
- For \( \mu=5 \) and for a SS/PBCH block index \( i \), the two slots including the associated Type0-PDCCH monitoring occasions are slots \( n_{0} \) and \( n_{0}+4 . M, O \), and the index of the first symbol of the CORESET in slots \( n_{0} \) and \( n_{0}+ \) 4 are provided by Table 13-12A, where \( X=1.25 \).
- For \( \mu=6 \) and for a SS/PBCH block index \( i \), the two slots including the associated Type0-PDCCH monitoring occasions are slots \( n_{0} \) and \( n_{0}+8 . M, O \), and the index of the first symbol of the CORESET in slots \( n_{0} \) and \( n_{0}+ \) 8 are provided by Table 13-12A, where \( X=0.625 \).

For operation with shared spectrum channel access and for the SS/PBCH block and CORESET multiplexing pattern 1, a UE monitors PDCCH in the Type0-PDCCH CSS set over slots that include Type0-PDCCH monitoring occasions associated with SS/PBCH blocks that are quasi co-located with the SS/PBCH block that provides a CORESET for Type0-PDCCH CSS set with respect to average gain, quasi co-location 'type A' and 'typeD' properties, when applicable [6, TS 38.214]. For a candidate SS/PBCH block index \( \bar{\imath} \), where \( 0 \leq \bar{\imath} \leq \bar{L}_{\text {max }}-1 \), two slots include the associated Type0-PDCCH monitoring occasions. The UE determines an index of slot \( n_{0} \) as \( n_{0}=\left(O \cdot 2^{\mu}+\lfloor\bar{\imath} \cdot M\rfloor\right) \bmod N_{\text {slot }}^{\text {frame } \mu} \) that is in a frame with system frame number (SFN) \( \mathrm{SFN}_{C} \) satisfying \( \mathrm{SFN}_{C} \bmod 2=0 \) if \( \left\lfloor\left(O \cdot 2^{\mu}+\lfloor\bar{\imath} \cdot M\rfloor\right) /\right. \left.N_{\text {slot }}^{\text {frame }, \mu}\right] \bmod 2=0 \), or in a frame with SFN satisfying SFN \( { }_{C} \bmod 2=1 \) if \( \left\lfloor\left(O \cdot 2^{\mu}+\lfloor\bar{l} \cdot M\rfloor\right) / N_{\text {slot }}^{\text {frame }, \mu}\right\rfloor \bmod 2=1 \) where \( \mu \in\{0,1,3,5,6\} \) based on the SCS for PDCCH receptions in the CORESET [4, TS 38.211].
- For \( \mu \in\{0,1\} \) and for a candidate SS/PBCH block index \( \bar{l} \), the two slots including the associated Type0-PDCCH monitoring occasions are slots \( n_{0} \) and \( n_{0}+1 . M, O \), and the index of the first symbol of the CORESET in slots \( n_{0} \) and \( n_{0}+1 \) are provided by Table 13-11. The UE does not expect to be configured with \( M=1 / 2 \), or with \( M=2 \), when \( N_{S S B}^{Q C L}=1 \).

ETSI


--- Page 190  ---


3GPP TS 38.213 version 17.1.0 Release 17
189
ETSI TS 138213 V17.1.0 (2022-05)
- For \( \mu=3 \) and for a candidate SS/PBCH block index \( \bar{\imath} \), the two slots including the associated Type0-PDCCH monitoring occasions are slots \( n_{0} \) and \( n_{0}+1 . M, O \), and the index of the first symbol of the CORESET in slots \( n_{0} \) and \( n_{0}+1 \) are provided by Table 13-12.
- For \( \mu=5 \) and for a candidate SS/PBCH block index \( \bar{l} \), the two slots including the associated Type0-PDCCH monitoring occasions are slots \( n_{0} \) and \( n_{0}+4 . M, O \), and the index of the first symbol of the CORESET in slots \( n_{0} \) and \( n_{0}+4 \) are provided by Table 13-12A, where \( X=1.25 \).
- For \( \mu=6 \) and for a candidate SS/PBCH block index \( \bar{\imath} \), the two slots including the associated Type0-PDCCH monitoring occasions are slots \( n_{0} \) and \( n_{0}+8 . M, O \), and the index of the first symbol of the CORESET in slots \( n_{0} \) and \( n_{0}+8 \) are provided by Table 13-12A, where \( X=0.625 \).

For operation without shared spectrum channel access and for the SS/PBCH block and CORESET multiplexing patterns 2 and 3, a UE monitors PDCCH in the Type0-PDCCH CSS set over one slot with Type0-PDCCH CSS set periodicity equal to the periodicity of SS/PBCH block. For a SS/PBCH block with index \( i \), the UE determines the slot index \( n_{\mathrm{c}} \) and \( \mathrm{SFN}_{\mathrm{c}} \) based on parameters provided by Tables 13-13 through 13-15A.

For operation with shared spectrum channel access and for SS/PBCH block and CORESET multiplexing pattern 3, a UE monitors PDCCH in the Type0-PDCCH CSS set over slots that include Type0-PDCCH monitoring occasions associated with SS/PBCH blocks that are quasi co-located with the SS/PBCH block that provides a CORESET for Type0-PDCCH CSS set with respect to average gain, quasi co-location 'type A' and 'typeD' properties, when applicable. For a candidate SS/PBCH block index \( \bar{\imath} \), where \( 0 \leq \bar{\imath} \leq \bar{L}_{\max }-1 \), the periodicity of the slot including the associated Type0-PDCCH monitoring occasion is same as the periodicity of the candidate SS/PBCH block, and the UE determines the slot index \( n_{\mathrm{c}} \) and \( \mathrm{SFN}_{\mathrm{c}} \) based on parameters provided by Tables 13-15 and 13-15A, where \( i \) is replaced by \( \bar{\imath} \) for operation with shared spectrum channel access in FR2-2.

For the SS/PBCH block and CORESET multiplexing patterns 2 and 3, if the active DL BWP is the initial DL BWP, the UE is expected to be able to perform radio link monitoring, as described in clause 5, and measurements for radio resource management [10, TS 38.133] using a SS/PBCH block that provides a CORESET for Type0-PDCCH CSS set.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-1: Set of resource blocks and slot symbols of CORESET for Type0-PDCCH search space set when \( \{\mathrm{SS} / \mathrm{PBCH} \) block, PDCCH\( \} \mathrm{SCS} \) is \( \{15,15\} \mathrm{kHz} \) for frequency bands with minimum channel bandwidth \( \mathbf{5 ~ M H z} \) or \( \mathbf{1 0 ~ M H z} \)}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & SS/PBCH block and CORESET multiplexing pattern & Number of RBs \( N_{\mathrm{RB}}^{\text {CORES ET }} \) & Number of Symbols \( N_{\text {symb }}^{\text {CORES }} \) & Offset (RBs) \\
\hline 0 & 1 & 24 & 2 & 0 \\
\hline 1 & 1 & 24 & 2 & 2 \\
\hline 2 & 1 & 24 & 2 & 4 \\
\hline 3 & 1 & 24 & 3 & 0 \\
\hline 4 & 1 & 24 & 3 & 2 \\
\hline 5 & 1 & 24 & 3 & 4 \\
\hline 6 & 1 & 48 & 1 & 12 \\
\hline 7 & 1 & 48 & 1 & 16 \\
\hline 8 & 1 & 48 & 2 & 12 \\
\hline 9 & 1 & 48 & 2 & 16 \\
\hline 10 & 1 & 48 & 3 & 12 \\
\hline 11 & 1 & 48 & 3 & 16 \\
\hline 12 & 1 & 96 & 1 & 38 \\
\hline 13 & 1 & 96 & 2 & 38 \\
\hline 14 & 1 & 96 & 3 & 38 \\
\hline 15 & \multicolumn{4}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 191  ---


3GPP TS 38.213 version 17.1.0 Release 17
190
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-1A: Set of resource blocks and slot symbols of CORESET for Type0-PDCCH search space set when \( \{ \) SS/PBCH block, PDCCH\( \} \) SCS is \( \{15,15\} \mathrm{kHz} \) for frequency bands operated with shared spectrum channel access}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & SS/PBCH block and CORESET multiplexing pattern & Number of RBs \( N_{\text {RB }}^{\text {CORESET }} \) & Number of Symbols \( \boldsymbol{N}_{\text {symb }}^{\text {CORESET }} \) & Offset (RBs) \\
\hline 0 & 1 & 96 & 1 & 10 \\
\hline 1 & 1 & 96 & 1 & 12 \\
\hline 2 & 1 & 96 & 1 & 14 \\
\hline 3 & 1 & 96 & 1 & 16 \\
\hline 4 & 1 & 96 & 2 & 10 \\
\hline 5 & 1 & 96 & 2 & 12 \\
\hline 6 & 1 & 96 & 2 & 14 \\
\hline 7 & 1 & 96 & 2 & 16 \\
\hline 8 & \multicolumn{4}{|c|}{Reserved} \\
\hline 9 & \multicolumn{4}{|c|}{Reserved} \\
\hline 10 & \multicolumn{4}{|c|}{Reserved} \\
\hline 11 & \multicolumn{4}{|c|}{Reserved} \\
\hline 12 & \multicolumn{4}{|c|}{Reserved} \\
\hline 13 & \multicolumn{4}{|c|}{Reserved} \\
\hline 14 & \multicolumn{4}{|c|}{Reserved} \\
\hline 15 & \multicolumn{4}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-2: Set of resource blocks and slot symbols of CORESET for Type0-PDCCH search space set when \( \{\mathrm{SS} / \mathrm{PBCH} \) block, PDCCH\( \} \mathrm{SCS} \) is \( \{15,30\} \mathrm{kHz} \) for frequency bands with minimum channel bandwidth 5 MHz or 10 MHz}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & SS/PBCH block and CORESET multiplexing pattern & Number of RBs \( N_{\text {RB }}^{\text {CORESET }} \) & Number of Symbols \( N_{\text {symb }}^{\text {COREST }} \) & Offset (RBs) \\
\hline 0 & 1 & 24 & 2 & 5 \\
\hline 1 & 1 & 24 & 2 & 6 \\
\hline 2 & 1 & 24 & 2 & 7 \\
\hline 3 & 1 & 24 & 2 & 8 \\
\hline 4 & 1 & 24 & 3 & 5 \\
\hline 5 & 1 & 24 & 3 & 6 \\
\hline 6 & 1 & 24 & 3 & 7 \\
\hline 7 & 1 & 24 & 3 & 8 \\
\hline 8 & 1 & 48 & 1 & 18 \\
\hline 9 & 1 & 48 & 1 & 20 \\
\hline 10 & 1 & 48 & 2 & 18 \\
\hline 11 & 1 & 48 & 2 & 20 \\
\hline 12 & 1 & 48 & 3 & 18 \\
\hline 13 & 1 & 48 & 3 & 20 \\
\hline 14 & \multicolumn{4}{|c|}{Reserved} \\
\hline 15 & \multicolumn{4}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 192  ---


3GPP TS 38.213 version 17.1.0 Release 17
191
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-3: Set of resource blocks and slot symbols of CORESET for Type0-PDCCH search space set when \( \{\mathrm{SS} / \mathrm{PBCH} \) block, PDCCH\( \} \mathrm{SCS} \) is \( \{30,15\} \mathrm{kHz} \) for frequency bands with minimum channel bandwidth 5 MHz or 10 MHz except for the frequency bands given in [5, TS38.101-1]}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & SS/PBCH block and CORESET multiplexing pattern & Number of RBs \( N_{\text {RB }}^{\text {CORESET }} \) & Number of Symbols \( N_{\text {symb }}^{\text {COREST }} \) & Offset (RBs) \\
\hline 0 & 1 & 48 & 1 & 2 \\
\hline 1 & 1 & 48 & 1 & 6 \\
\hline 2 & 1 & 48 & 2 & 2 \\
\hline 3 & 1 & 48 & 2 & 6 \\
\hline 4 & 1 & 48 & 3 & 2 \\
\hline 5 & 1 & 48 & 3 & 6 \\
\hline 6 & 1 & 96 & 1 & 28 \\
\hline 7 & 1 & 96 & 2 & 28 \\
\hline 8 & 1 & 96 & 3 & 28 \\
\hline 9 & \multicolumn{4}{|c|}{Reserved} \\
\hline 10 & \multicolumn{4}{|c|}{Reserved} \\
\hline 11 & \multicolumn{4}{|c|}{Reserved} \\
\hline 12 & \multicolumn{4}{|c|}{Reserved} \\
\hline 13 & \multicolumn{4}{|c|}{Reserved} \\
\hline 14 & \multicolumn{4}{|c|}{Reserved} \\
\hline 15 & \multicolumn{4}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-4: Set of resource blocks and slot symbols of CORESET for Type0-PDCCH search space set when \( \{\mathrm{SS} / \mathrm{PBCH} \) block, PDCCH\( \} \mathrm{SCS} \) is \( \{30,30\} \mathrm{kHz} \) for frequency bands with minimum channel bandwidth 5 MHz or 10 MHz except for the frequency bands given in [5, TS38.101-1]}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & SS/PBCH block and CORESET multiplexing pattern & Number of RBs \( N_{\mathrm{RB}}^{\text {CORESET }} \) & Number of Symbols \( N_{\text {symb }}^{\text {CORESET }} \) & Offset (RBs) \\
\hline 0 & 1 & 24 & 2 & 0 \\
\hline 1 & 1 & 24 & 2 & 1 \\
\hline 2 & 1 & 24 & 2 & 2 \\
\hline 3 & 1 & 24 & 2 & 3 \\
\hline 4 & 1 & 24 & 2 & 4 \\
\hline 5 & 1 & 24 & 3 & 0 \\
\hline 6 & 1 & 24 & 3 & 1 \\
\hline 7 & 1 & 24 & 3 & 2 \\
\hline 8 & 1 & 24 & 3 & 3 \\
\hline 9 & 1 & 24 & 3 & 4 \\
\hline 10 & 1 & 48 & 1 & 12 \\
\hline 11 & 1 & 48 & 1 & 14 \\
\hline 12 & 1 & 48 & 1 & 16 \\
\hline 13 & 1 & 48 & 2 & 12 \\
\hline 14 & 1 & 48 & 2 & 14 \\
\hline 15 & 1 & 48 & 2 & 16 \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 193  ---


3GPP TS 38.213 version 17.1.0 Release 17
192
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-4A: Set of resource blocks and slot symbols of CORESET for Type0-PDCCH search space set when \( \{\mathrm{SS} / \mathrm{PBCH} \) block, PDCCH\( \} \mathrm{SCS} \) is \( \{30,30\} \mathrm{kHz} \) for frequency bands operated with shared spectrum channel access}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & SS/PBCH block and CORESET multiplexing pattern & Number of RBs \( N_{\text {RB }}^{\text {CORESET }} \) & Number of Symbols \( \boldsymbol{N}_{\text {symb }}^{\text {CORESET }} \) & Offset (RBs) \\
\hline 0 & 1 & 48 & 1 & 0 \\
\hline 1 & 1 & 48 & 1 & 1 \\
\hline 2 & 1 & 48 & 1 & 2 \\
\hline 3 & 1 & 48 & 1 & 3 \\
\hline 4 & 1 & 48 & 2 & 0 \\
\hline 5 & 1 & 48 & 2 & 1 \\
\hline 6 & 1 & 48 & 2 & 2 \\
\hline 7 & 1 & 48 & 2 & 3 \\
\hline 8 & \multicolumn{4}{|c|}{Reserved} \\
\hline 9 & \multicolumn{4}{|c|}{Reserved} \\
\hline 10 & \multicolumn{4}{|c|}{Reserved} \\
\hline 11 & \multicolumn{4}{|c|}{Reserved} \\
\hline 12 & \multicolumn{4}{|c|}{Reserved} \\
\hline 13 & \multicolumn{4}{|c|}{Reserved} \\
\hline 14 & \multicolumn{4}{|c|}{Reserved} \\
\hline 15 & \multicolumn{4}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-5: Set of resource blocks and slot symbols of CORESET for Type0-PDCCH search space set when \( \{\mathrm{SS} / \mathrm{PBCH} \) block, PDCCH\( \} \mathrm{SCS} \) is \( \{30,15\} \mathrm{kHz} \) for frequency bands with minimum channel bandwidth 40 MHz or for the frequency bands given in [5, TS38.101-1]}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & SS/PBCH block and CORESET multiplexing pattern & Number of RBs \( N_{\text {RB }}^{\text {CORESET }} \) & Number of Symbols \( N_{\text {symb }}^{\text {CORESET }} \) & Offset (RBs) \\
\hline 0 & 1 & 48 & 1 & 4 \\
\hline 1 & 1 & 48 & 2 & 4 \\
\hline 2 & 1 & 48 & 3 & 4 \\
\hline 3 & 1 & 96 & 1 & 0 \\
\hline 4 & 1 & 96 & 1 & 56 \\
\hline 5 & 1 & 96 & 2 & 0 \\
\hline 6 & 1 & 96 & 2 & 56 \\
\hline 7 & 1 & 96 & 3 & 0 \\
\hline 8 & 1 & 96 & 3 & 56 \\
\hline 9 & \multicolumn{4}{|c|}{Reserved} \\
\hline 10 & \multicolumn{4}{|c|}{Reserved} \\
\hline 11 & \multicolumn{4}{|c|}{Reserved} \\
\hline 12 & \multicolumn{4}{|c|}{Reserved} \\
\hline 13 & \multicolumn{4}{|c|}{Reserved} \\
\hline 14 & \multicolumn{4}{|c|}{Reserved} \\
\hline 15 & \multicolumn{4}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 194  ---


3GPP TS 38.213 version 17.1.0 Release 17
193
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-6: Set of resource blocks and slot symbols of CORESET for Type0-PDCCH search space set when \( \{\mathrm{SS} / \mathrm{PBCH} \) block, PDCCH\( \} \mathrm{SCS} \) is \( \{30,30\} \mathrm{kHz} \) for frequency bands with minimum channel bandwidth 40 MHz or for the frequency bands given in [5, TS38.101-1]}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & SS/PBCH block and CORESET multiplexing pattern & Number of RBs \( N_{\text {RB }}^{\text {CORESET }} \) & Number of Symbols \( N_{\text {symb }}^{\text {CORESET }} \) & Offset (RBs) \\
\hline 0 & 1 & 24 & 2 & 0 \\
\hline 1 & 1 & 24 & 2 & 4 \\
\hline 2 & 1 & 24 & 3 & 0 \\
\hline 3 & 1 & 24 & 3 & 4 \\
\hline 4 & 1 & 48 & 1 & 0 \\
\hline 5 & 1 & 48 & 1 & 28 \\
\hline 6 & 1 & 48 & 2 & 0 \\
\hline 7 & 1 & 48 & 2 & 28 \\
\hline 8 & 1 & 48 & 3 & 0 \\
\hline 9 & 1 & 48 & 3 & 28 \\
\hline 10 & \multicolumn{4}{|c|}{Reserved} \\
\hline 11 & \multicolumn{4}{|c|}{Reserved} \\
\hline 12 & \multicolumn{4}{|c|}{Reserved} \\
\hline 13 & \multicolumn{4}{|c|}{Reserved} \\
\hline 14 & \multicolumn{4}{|c|}{Reserved} \\
\hline 15 & \multicolumn{4}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-7: Set of resource blocks and slot symbols of CORESET for Type0-PDCCH search space set when \( \{ \) SS/PBCH block, PDCCH\( \} \) SCS is \( \{120,60\} \mathrm{kHz} \)}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & SS/PBCH block and CORESET multiplexing pattern & Number of RBs \( N_{\mathrm{RB}}^{\text {CORESET }} \) & Number of Symbols \( N_{\text {symb }}^{\text {CORESET }} \) & Offset (RBs) \\
\hline 0 & 1 & 48 & 1 & 0 \\
\hline 1 & 1 & 48 & 1 & 8 \\
\hline 2 & 1 & 48 & 2 & 0 \\
\hline 3 & 1 & 48 & 2 & 8 \\
\hline 4 & 1 & 48 & 3 & 0 \\
\hline 5 & 1 & 48 & 3 & 8 \\
\hline 6 & 1 & 96 & 1 & 28 \\
\hline 7 & 1 & 96 & 2 & 28 \\
\hline 8 & 2 & 48 & 1 & \[
\begin{array}{l}
-41 \text { if } k_{\mathrm{SSB}}=0 \\
-42 \text { if } k_{\mathrm{SSB}}>0 \\
\hline
\end{array}
\] \\
\hline 9 & 2 & 48 & 1 & 49 \\
\hline 10 & 2 & 96 & 1 & \[
\begin{array}{l}
-41 \text { if } k_{\mathrm{SSB}}=0 \\
-42 \text { if } k_{\mathrm{SSB}}>0 \\
\hline
\end{array}
\] \\
\hline 11 & 2 & 96 & 1 & 97 \\
\hline 12 & \multicolumn{4}{|c|}{Reserved} \\
\hline 13 & \multicolumn{4}{|c|}{Reserved} \\
\hline 14 & \multicolumn{4}{|c|}{Reserved} \\
\hline 15 & \multicolumn{4}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 195  ---


3GPP TS 38.213 version 17.1.0 Release 17
194
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-8: Set of resource blocks and slot symbols of CORESET for Type0-PDCCH search space set when \( \{ \) SS/PBCH block, PDCCH\( \} \) SCS is \( \{120,120\} \mathrm{kHz} \) for FR2-1}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & SS/PBCH block and CORESET multiplexing pattern & Number of RBs \( N_{\mathrm{RB}}^{\text {CORESET }} \) & Number of Symbols \( N_{\text {symb }}^{\text {CORESET }} \) & Offset (RBs) \\
\hline 0 & 1 & 24 & 2 & 0 \\
\hline 1 & 1 & 24 & 2 & 4 \\
\hline 2 & 1 & 48 & 1 & 14 \\
\hline 3 & 1 & 48 & 2 & 14 \\
\hline 4 & 3 & 24 & 2 & \[
\begin{array}{l}
-20 \text { if } k_{\mathrm{SSB}}=0 \\
-21 \text { if } k_{\mathrm{SSB}}>0 \\
\hline
\end{array}
\] \\
\hline 5 & 3 & 24 & 2 & 24 \\
\hline 6 & 3 & 48 & 2 & \[
\begin{array}{l}
-20 \text { if } k_{\mathrm{SSB}}=0 \\
-21 \text { if } k_{\mathrm{SSB}}>0 \\
\hline
\end{array}
\] \\
\hline 7 & 3 & 48 & 2 & 48 \\
\hline 8 & \multicolumn{4}{|c|}{Reserved} \\
\hline 9 & \multicolumn{4}{|c|}{Reserved} \\
\hline 10 & \multicolumn{4}{|c|}{Reserved} \\
\hline 11 & \multicolumn{4}{|c|}{Reserved} \\
\hline 12 & \multicolumn{4}{|c|}{Reserved} \\
\hline 13 & \multicolumn{4}{|c|}{Reserved} \\
\hline 14 & \multicolumn{4}{|c|}{Reserved} \\
\hline 15 & \multicolumn{4}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-9: Set of resource blocks and slot symbols of CORESET for Type0-PDCCH search space set when \( \{ \) SS/PBCH block, PDCCH SCS is \( \{240,60\} \mathrm{kHz} \)}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & SS/PBCH block and CORESET multiplexing pattern & Number of RBs \( N_{\mathrm{RB}}^{\text {CORESET }} \) & Number of Symbols \( N_{\text {symb }}^{\text {COREST }} \) & Offset (RBs) \\
\hline 0 & 1 & 96 & 1 & 0 \\
\hline 1 & 1 & 96 & 1 & 16 \\
\hline 2 & 1 & 96 & 2 & 0 \\
\hline 3 & 1 & 96 & 2 & 16 \\
\hline 4 & \multicolumn{4}{|c|}{Reserved} \\
\hline 5 & \multicolumn{4}{|c|}{Reserved} \\
\hline 6 & \multicolumn{4}{|c|}{Reserved} \\
\hline 7 & \multicolumn{4}{|c|}{Reserved} \\
\hline 8 & \multicolumn{4}{|c|}{Reserved} \\
\hline 9 & \multicolumn{4}{|c|}{Reserved} \\
\hline 10 & \multicolumn{4}{|c|}{Reserved} \\
\hline 11 & \multicolumn{4}{|c|}{Reserved} \\
\hline 12 & \multicolumn{4}{|c|}{Reserved} \\
\hline 13 & \multicolumn{4}{|c|}{Reserved} \\
\hline 14 & \multicolumn{4}{|c|}{Reserved} \\
\hline 15 & \multicolumn{4}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 196  ---


3GPP TS 38.213 version 17.1.0 Release 17
195
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-10: Set of resource blocks and slot symbols of CORESET for Type0-PDCCH search space set when \( \{ \) SS/PBCH block, PDCCH\( \} \) SCS is \( \{240,120\} \mathrm{kHz} \)}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & SS/PBCH block and CORESET multiplexing pattern & Number of RBs \( N_{\text {RB }}^{\text {CORESET }} \) & Number of Symbols \( N_{\text {symb }}^{\text {CORESET }} \) & Offset (RBs) \\
\hline 0 & 1 & 48 & 1 & 0 \\
\hline 1 & 1 & 48 & 1 & 8 \\
\hline 2 & 1 & 48 & 2 & 0 \\
\hline 3 & 1 & 48 & 2 & 8 \\
\hline 4 & 2 & 24 & 1 & \[
\begin{array}{l}
-41 \text { if } k_{\mathrm{SSB}}=0 \\
-42 \text { if } k_{\mathrm{SSB}}>0 \\
\hline
\end{array}
\] \\
\hline 5 & 2 & 24 & 1 & 25 \\
\hline 6 & 2 & 48 & 1 & \[
\begin{array}{l}
-41 \text { if } k_{\mathrm{SSB}}=0 \\
-42 \text { if } k_{\mathrm{SSB}}>0 \\
\hline
\end{array}
\] \\
\hline 7 & 2 & 48 & 1 & 49 \\
\hline 8 & \multicolumn{4}{|c|}{Reserved} \\
\hline 9 & \multicolumn{4}{|c|}{Reserved} \\
\hline 10 & \multicolumn{4}{|c|}{Reserved} \\
\hline 11 & \multicolumn{4}{|c|}{Reserved} \\
\hline 12 & \multicolumn{4}{|c|}{Reserved} \\
\hline 13 & \multicolumn{4}{|c|}{Reserved} \\
\hline 14 & \multicolumn{4}{|c|}{Reserved} \\
\hline 15 & \multicolumn{4}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-10A: Set of resource blocks and slot symbols of CORESET for Type0-PDCCH search space set when \( \{ \) SS/PBCH block, PDCCH\( \} \) SCS is \( \{120,120\} \mathrm{kHz},\{480,480\} \mathrm{kHz} \), or \( \{960,960\} \mathrm{kHz} \) for FR2-2}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & SS/PBCH block and CORESET multiplexing pattern & Number of RBs \( N_{\text {RB }}^{\text {CORESET }} \) & Number of Symbols \( N_{\text {symb }}^{\text {CORESET }} \) & Offset (RBs) \\
\hline 0 & 1 & 24 & 2 & 0 \\
\hline 1 & 1 & 24 & 2 & 4 \\
\hline 2 & 1 & 48 & 1 & 0 \\
\hline 3 & 1 & 48 & 1 & 14 \\
\hline 4 & 1 & 48 & 1 & 28 \\
\hline 5 & 1 & 48 & 2 & 0 \\
\hline 6 & 1 & 48 & 2 & 14 \\
\hline 7 & 1 & 48 & 2 & 28 \\
\hline 8 & 1 & 96 & 1 & 0 \\
\hline 9 & & & & \\
\hline 10 & 1 & 96 & 2 & 0 \\
\hline 11 & & & & \\
\hline 12 & 3 & 24 & 2 & \[
\begin{array}{l}
-20 \text { if } k_{\mathrm{SSB}}=0 \\
-21 \text { if } k_{\mathrm{SSB}}>0 \\
\hline
\end{array}
\] \\
\hline 13 & 3 & 24 & 2 & -24 \\
\hline 14 & 3 & 48 & 2 & \[
\begin{array}{l}
-20 \text { if } k_{\mathrm{SSB}}=0 \\
-21 \text { if } k_{\mathrm{SSB}}>0 \\
\hline
\end{array}
\] \\
\hline 15 & 3 & 48 & 2 & -48 \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 197  ---


3GPP TS 38.213 version 17.1.0 Release 17
196
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-11: Parameters for PDCCH monitoring occasions for Type0-PDCCH CSS set - SS/PBCH block and CORESET multiplexing pattern 1 and FR1}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & 0 & Number of search space sets per slot & M & First symbol index \\
\hline 0 & 0 & 1 & 1 & 0 \\
\hline 1 & 0 & 2 & 1/2 & \( \{0 \), if \( i \) is even \( \},\left\{N_{\text {symb }}^{\text {CORESET }}\right. \), if \( i \) is odd \( \} \) \\
\hline 2 & 2 & 1 & 1 & 0 \\
\hline 3 & 2 & 2 & 1/2 & \( \{0 \), if \( i \) is even \( \},\left\{N_{\text {symb }}^{\text {CORESET }}\right. \), if \( i \) is odd \( \} \) \\
\hline 4 & 5 & 1 & 1 & 0 \\
\hline 5 & 5 & 2 & 1/2 & \( \{0 \), if \( i \) is even \( \},\left\{N_{\text {symb }}^{\text {CORESET }}\right. \), if \( i \) is odd \( \} \) \\
\hline 6 & 7 & 1 & 1 & 0 \\
\hline 7 & 7 & 2 & 1/2 & \( \{0 \), if \( i \) is even \( \},\left\{N_{\text {symb }}^{\text {CORESET }}\right. \), if \( i \) is odd \( \} \) \\
\hline 8 & 0 & 1 & 2 & 0 \\
\hline 9 & 5 & 1 & 2 & 0 \\
\hline 10 & 0 & 1 & 1 & 1 \\
\hline 11 & 0 & 1 & 1 & 2 \\
\hline 12 & 2 & 1 & 1 & 1 \\
\hline 13 & 2 & 1 & 1 & 2 \\
\hline 14 & 5 & 1 & 1 & 1 \\
\hline 15 & 5 & 1 & 1 & 2 \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-12: Parameters for PDCCH monitoring occasions for Type0-PDCCH CSS set - SS/PBCH block and CORESET multiplexing pattern 1 and FR2-1, or SS/PBCH block and CORESET multiplexing pattern 1 and \{SS/PBCH block, PDCCH\}SCS \( \{120,120\} \) kHz in FR2-2}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & 0 & Number of search space sets per slot & M & First symbol index \\
\hline 0 & 0 & 1 & 1 & 0 \\
\hline 1 & 0 & 2 & 1/2 & \{0, if \( i \) is even\}, \{7, if \( i \) is odd\}\} \\
\hline 2 & 2.5 & 1 & 1 & 0 \\
\hline 3 & 2.5 & 2 & 1/2 & \{0, if \( i \) is even\}, \{7, if \( i \) is odd\}\} \\
\hline 4 & 5 & 1 & 1 & 0 \\
\hline 5 & 5 & 2 & 1/2 & \{0, if \( i \) is even\}, \{7, if \( i \) is odd\}\} \\
\hline 6 & 0 & 2 & 1/2 & \( \{0 \), if \( i \) is even \( \},\left\{N_{\text {symb }}^{\text {CORESET }}\right. \), if \( i \) is odd \( \} \) \\
\hline 7 & 2.5 & 2 & 1/2 & \( \{0 \), if \( i \) is even \( \},\left\{N_{\text {symb }}^{\text {CORESET }}\right. \), if \( i \) is odd \( \} \) \\
\hline 8 & 5 & 2 & 1/2 & \( \{0 \), if \( i \) is even \( \},\left\{N_{\text {symb }}^{\text {CORESET }}\right. \), if \( i \) is odd \( \} \) \\
\hline 9 & 7.5 & 1 & 1 & 0 \\
\hline 10 & 7.5 & 2 & 1/2 & \{0, if \( i \) is even\}, \{7, if \( i \) is odd\} \\
\hline 11 & 7.5 & 2 & 1/2 & \( \{0 \), if \( i \) is even \( \},\left\{N_{\text {symb }}^{\text {CORESET }}\right. \), if \( i \) is odd \( \} \) \\
\hline 12 & 0 & 1 & 2 & 0 \\
\hline 13 & 5 & 1 & 2 & 0 \\
\hline 14 & \multicolumn{4}{|c|}{Reserved} \\
\hline 15 & \multicolumn{4}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 198  ---


3GPP TS 38.213 version 17.1.0 Release 17
197
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-12A: Parameters for PDCCH monitoring occasions for Type0-PDCCH CSS set - SS/PBCH block and CORESET multiplexing pattern 1 and \{SS/PBCH block, PDCCH\}SCS \{480,480\} kHz or \{960, 960\} kHz in FR2-2}
\begin{tabular}{|l|l|l|l|l|}
\hline Index & 0 & Number of search space sets per slot & \( \boldsymbol{M} \) & First symbol index \\
\hline 0 & 0 & 1 & 1 & 0 \\
\hline 1 & 0 & 2 & 1/2 & \{0, if \( i \) is even\}, \{7, if \( i \) is odd\}\} \\
\hline 2 & X & 1 & 1 & 0 \\
\hline 3 & X & 2 & 1/2 & \{0, if \( i \) is even\}, \{7, if \( i \) is odd\}\} \\
\hline 4 & 5 & 1 & 1 & 0 \\
\hline 5 & 5 & 2 & 1/2 & \{0, if \( i \) is even\}, (7, if \( i \) is odd) \\
\hline 6 & 0 & 2 & 1/2 & \{0, if \( i \) is even\}, \( \left\{N_{\text {symb }}^{\text {CORESET }}\right. \), if \( i \) is odd \( \} \) \\
\hline 7 & X & 2 & 1/2 & \{0, if \( i \) is even\}, \( \left\{N_{\text {symb }}^{\text {CORESET }}\right. \), if \( i \) is odd \( \} \) \\
\hline 8 & 5 & 2 & 1/2 & \( \{0 \), if \( i \) is even \( \},\left\{N_{\text {symb }}^{\text {CORESET }}\right. \), if \( i \) is odd \( \} \) \\
\hline 9 & 5+X & 1 & 1 & 0 \\
\hline 10 & 5+X & 2 & 1/2 & \{0, if \( i \) is even\}, \{7, if \( i \) is odd\} \\
\hline 11 & 5+X & 2 & 1/2 & \{0, if \( i \) is even\}, \( \left\{N_{\text {symb }}^{\text {CORESET }}\right. \), if \( i \) is odd \( \} \) \\
\hline 12 & 0 & 1 & 2 & 0 \\
\hline 13 & 5 & 1 & 2 & 0 \\
\hline 14 & \multicolumn{4}{|c|}{Reserved} \\
\hline 15 & \multicolumn{4}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-13: PDCCH monitoring occasions for Type0-PDCCH CSS set - SS/PBCH block and CORESET multiplexing pattern 2 and \{SS/PBCH block, PDCCH\}SCS \( \{120,60\} \mathrm{kHz} \)}
\begin{tabular}{|l|l|l|l|}
\hline Index & \multicolumn{2}{|c|}{PDCCH monitoring occasions (SFN and slot number)} & First symbol index ( \( k=0,1, \ldots 15 \) ) \\
\hline 0 & \multicolumn{2}{|c|}{\[
\begin{aligned}
\mathrm{SFN}_{\mathrm{c}} & =\mathrm{SFN}_{\mathrm{SSB}, i} \\
n_{\mathrm{c}} & =n_{\mathrm{SSB}, i}
\end{aligned}
\]} & 0, 1, 6, 7 for
\[
\begin{array}{c}
i=4 k, i=4 k+1, i=4 k+2, i=4 k+ \\
3
\end{array}
\] \\
\hline 1 & \multicolumn{3}{|c|}{Reserved} \\
\hline 2 & \multicolumn{3}{|c|}{Reserved} \\
\hline 3 & \multicolumn{3}{|c|}{Reserved} \\
\hline 4 & \multicolumn{3}{|c|}{Reserved} \\
\hline 5 & \multicolumn{3}{|c|}{Reserved} \\
\hline 6 & \multicolumn{3}{|c|}{Reserved} \\
\hline 7 & \multicolumn{3}{|c|}{Reserved} \\
\hline 8 & \multicolumn{3}{|c|}{Reserved} \\
\hline 9 & \multicolumn{3}{|c|}{Reserved} \\
\hline 10 & \multicolumn{3}{|c|}{Reserved} \\
\hline 11 & \multicolumn{3}{|c|}{Reserved} \\
\hline 12 & \multicolumn{3}{|c|}{Reserved} \\
\hline 13 & \multicolumn{3}{|c|}{Reserved} \\
\hline 14 & \multicolumn{3}{|c|}{Reserved} \\
\hline 15 & \multicolumn{3}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 199  ---


3GPP TS 38.213 version 17.1.0 Release 17
198
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-14: PDCCH monitoring occasions for Type0-PDCCH CSS set - SS/PBCH block and CORESET multiplexing pattern 2 and \{SS/PBCH block, PDCCH\}SCS \{240, 120\} kHz}
\begin{tabular}{|l|l|l|}
\hline Index & PDCCH monitoring occasions (SFN and slot number) & First symbol index ( \( k=0,1, \ldots, 7 \) ) \\
\hline 0 & \[
\begin{array}{c}
\mathrm{SFN}_{\mathrm{c}}=\mathrm{SFN}_{\mathrm{SSB}, i} \\
n_{\mathrm{c}}=n_{\mathrm{SSB}, i} \text { or } n_{\mathrm{c}}=n_{\mathrm{SSB}, i}-1
\end{array}
\] & \begin{tabular}{l}
\( 0,1,2,3,0,1 \) in \( i=8 k, i=8 k+1, i=8 k+2, i=8 k+3, i= 8 k+6, i=8 k+7\left(n_{\mathrm{c}}=n_{\mathrm{SSB}, i}\right) \) \\
12, 13 in \( i=8 k+4, i=8 k+5\left(n_{\mathrm{c}}=n_{\mathrm{SSB}_{\mathrm{B}, i}}-1\right) \)
\end{tabular} \\
\hline 1 & \multicolumn{2}{|c|}{Reserved} \\
\hline 2 & \multicolumn{2}{|c|}{Reserved} \\
\hline 3 & \multicolumn{2}{|c|}{Reserved} \\
\hline 4 & \multicolumn{2}{|c|}{Reserved} \\
\hline 5 & \multicolumn{2}{|c|}{Reserved} \\
\hline 6 & \multicolumn{2}{|c|}{Reserved} \\
\hline 7 & \multicolumn{2}{|c|}{Reserved} \\
\hline 8 & \multicolumn{2}{|c|}{Reserved} \\
\hline 9 & \multicolumn{2}{|c|}{Reserved} \\
\hline 10 & \multicolumn{2}{|c|}{Reserved} \\
\hline 11 & \multicolumn{2}{|c|}{Reserved} \\
\hline 12 & \multicolumn{2}{|c|}{Reserved} \\
\hline 13 & \multicolumn{2}{|c|}{Reserved} \\
\hline 14 & \multicolumn{2}{|c|}{Reserved} \\
\hline 15 & \multicolumn{2}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-15: PDCCH monitoring occasions for Type0-PDCCH CSS set - SS/PBCH block and CORESET multiplexing pattern 3 and \{SS/PBCH block, PDCCH\}SCS \{120,120\} kHz}
\begin{tabular}{|l|l|l|}
\hline Index & PDCCH monitoring occasions (SFN and slot number) & First symbol index ( \( k=0,1, \ldots 15 \) ) \\
\hline 0 & \[
\begin{aligned}
\mathrm{SFN}_{\mathrm{c}} & =\mathrm{SFN}_{\mathrm{SSB}, i} \\
n_{\mathrm{c}} & =n_{\mathrm{SSB}, i}
\end{aligned}
\] & \[
\begin{array}{c}
4,8,2,6 \mathrm{in} \\
i=4 k, i=4 k+1, i=4 k+2, i=4 k+ \\
3
\end{array}
\] \\
\hline 1 & \multicolumn{2}{|c|}{Reserved} \\
\hline 2 & \multicolumn{2}{|c|}{Reserved} \\
\hline 3 & \multicolumn{2}{|c|}{Reserved} \\
\hline 4 & \multicolumn{2}{|c|}{Reserved} \\
\hline 5 & \multicolumn{2}{|c|}{Reserved} \\
\hline 6 & \multicolumn{2}{|c|}{Reserved} \\
\hline 7 & \multicolumn{2}{|c|}{Reserved} \\
\hline 8 & \multicolumn{2}{|c|}{Reserved} \\
\hline 9 & \multicolumn{2}{|c|}{Reserved} \\
\hline 10 & \multicolumn{2}{|c|}{Reserved} \\
\hline 11 & \multicolumn{2}{|c|}{Reserved} \\
\hline 12 & \multicolumn{2}{|c|}{Reserved} \\
\hline 13 & \multicolumn{2}{|c|}{Reserved} \\
\hline 14 & \multicolumn{2}{|c|}{Reserved} \\
\hline 15 & \multicolumn{2}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 200  ---


3GPP TS 38.213 version 17.1.0 Release 17
199
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-15A: PDCCH monitoring occasions for Type0-PDCCH CSS set-SS/PBCH block and CORESET multiplexing pattern 3 and \{SS/PBCH block, PDCCH\}SCS \{480,480\} kHz or \{960,960\} kHz}
\begin{tabular}{|l|l|l|}
\hline Index & PDCCH monitoring occasions (SFN and slot number) & First symbol index ( \( k=0,1, \ldots 31 \) ) \\
\hline 0 & \[
\begin{aligned}
\mathrm{SFN}_{\mathrm{c}} & =\mathrm{SFN}_{\mathrm{SSB}, i} \\
n_{\mathrm{c}} & =n_{\mathrm{SSB}, i}
\end{aligned}
\] & \[
\begin{array}{c}
2,9 \text { in } \\
i=2 k, i=2 k+1
\end{array}
\] \\
\hline 1 & \multicolumn{2}{|c|}{Reserved} \\
\hline 2 & \multicolumn{2}{|c|}{Reserved} \\
\hline 3 & \multicolumn{2}{|c|}{Reserved} \\
\hline 4 & \multicolumn{2}{|c|}{Reserved} \\
\hline 5 & \multicolumn{2}{|c|}{Reserved} \\
\hline 6 & \multicolumn{2}{|c|}{Reserved} \\
\hline 7 & \multicolumn{2}{|c|}{Reserved} \\
\hline 8 & \multicolumn{2}{|c|}{Reserved} \\
\hline 9 & \multicolumn{2}{|c|}{Reserved} \\
\hline 10 & \multicolumn{2}{|c|}{Reserved} \\
\hline 11 & \multicolumn{2}{|c|}{Reserved} \\
\hline 12 & \multicolumn{2}{|c|}{Reserved} \\
\hline 13 & \multicolumn{2}{|c|}{Reserved} \\
\hline 14 & \multicolumn{2}{|c|}{Reserved} \\
\hline 15 & \multicolumn{2}{|c|}{Reserved} \\
\hline
\end{tabular}
\end{table}

If a UE detects a first SS/PBCH block and determines that a CORESET for Type0-PDCCH CSS set is not present, and for \( 24 \leq k_{\mathrm{SSB}} \leq 29 \) for FR1 or for \( 12 \leq k_{\mathrm{SSB}} \leq 13 \) for FR2, the UE may determine the nearest (in the corresponding frequency direction) global synchronization channel number (GSCN) of a second SS/PBCH block having a CORESET for an associated Type0-PDCCH CSS set as \( N_{\mathrm{GSCN}}^{\mathrm{Reference}}+N_{\mathrm{GSCN}}^{\mathrm{Offset}}-N_{\mathrm{GSCN}}^{\mathrm{Reference}} \) is the GSCN of the first SS/PBCH block and \( N_{\text {GSCN }}^{\text {Offset }} \) is a GSCN offset provided by Table 13-16 for FR1 and Table 13-17 for FR2. If the UE detects the second SS/PBCH block and the second SS/PBCH block does not provide a CORESET for Type0-PDCCH CSS set, as described in clause 4.1, the UE may ignore the information related to GSCN of SS/PBCH block locations for performing cell search.

If a UE detects a SS/PBCH block and determines that a CORESET for Type0-PDCCH CSS set is not present, and for \( k_{\mathrm{SSB}}=31 \) for FR1 or for \( k_{\mathrm{SSB}}=15 \) for FR2, the UE determines that there is no SS/PBCH block having an associated Type0-PDCCH CSS set within a GSCN range \( \left[N_{\mathrm{GSCN}}^{\mathrm{Reference}}-N_{\mathrm{GSCN}}^{\mathrm{Start}}, N_{\mathrm{GSCN}}^{\mathrm{Reference}}+N_{\mathrm{GSCN}}^{\mathrm{End}}\right] . N_{\mathrm{GSCN}}^{\mathrm{Start}} \) and \( N_{\mathrm{GSCN}}^{\mathrm{End}} \) are respectively determined by controlResourceSetZero and searchSpaceZero in pdcch-ConfigSIB1. If the GSCN range is \( \left[N_{\mathrm{GSCN}}^{\mathrm{Reference}}, N_{\mathrm{GSCN}}^{\mathrm{Reference}}\right] \), the UE determines that there is no information for a second SS/PBCH block with a CORESET for an associated Type0-PDCCH CSS set on the detected SS/PBCH block.

If a UE does not detect any SS/PBCH block providing a CORESET for Type0-PDCCH CSS set, as described in clause 4.1, within a time period determined by the UE, the UE may ignore the information related to GSCN of SS/PBCH locations in performing cell search.

ETSI


--- Page 201  ---


3GPP TS 38.213 version 17.1.0 Release 17
200
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-16: Mapping between the combination of \( \boldsymbol{k}_{\text {SSB }} \) and contro/ResourceSetZero and searchSpaceZero in pdcch-ConfigSIB1 to \( N_{\text {GSCN }}^{\text {Offet }} \) for FR1}
\begin{tabular}{|l|l|l|}
\hline \( k_{\text {SSB }} \) & \( 16 \times \) controlResourceSetZero +searchSpaceZero & \( N_{\text {GSCN }}^{\mathrm{Offset}} \) \\
\hline 24 & \( 0,1, \ldots, 255 \) & \( 1,2, \ldots, 256 \) \\
\hline 25 & \( 0,1, \ldots, 255 \) & \( 257,258, \ldots, 512 \) \\
\hline 26 & \( 0,1, \ldots, 255 \) & 513, 514, ...., 768 \\
\hline 27 & \( 0,1, \ldots, 255 \) & \( -1,-2, \ldots,-256 \) \\
\hline 28 & \( 0,1, \ldots, 255 \) & \( -257,-258, \ldots,-512 \) \\
\hline 29 & \( 0,1, \ldots, 255 \) & \( -513,-514, \ldots .,-768 \) \\
\hline 30 & \( 0,1, \ldots, 255 \) & Reserved, Reserved, ..., Reserved \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 13-17: Mapping between the combination of \( \boldsymbol{k}_{\text {SSB }} \) and contro/ResourceSetZero and searchSpaceZero in pdcch-ConfigSIB1 to \( N_{\text {GSCN }}^{\text {Off set }} \) for FR2}
\begin{tabular}{|l|l|l|}
\hline \( k_{\text {SSB }} \) & \( 16 \times \) controlResourceSetZero +searchSpaceZero & \( N_{\text {GSCN }}^{\text {Offset }} \) \\
\hline 12 & \( 0,1, \ldots, 255 \) & \( 1,2, \ldots, 256 \) \\
\hline 13 & \( 0,1, \ldots, 255 \) & \( -1,-2, \ldots,-256 \) \\
\hline 14 & \( 0,1, \ldots, 255 \) & Reserved, Reserved, ..., Reserved \\
\hline
\end{tabular}
\end{table}

14 Integrated access-backhaul operation
Throughout this specification, unless otherwise noted, statements using the term "UE" in clauses 4 through 13 are equally applicable to the IAB-MT of an IAB node.

A procedure for an [AB-MT to perform cell search, system information acquisition, or random access procedure is same as a corresponding one for a UE except for the following.

For initial cell selection, an IAB-MT may assume that half frames with SS/PBCH blocks occur with a periodicity of 16 frames.

For PRACH transmission, an IAB-MT determines frames and subframes/slots within the frames containing PRACH occasions as described in [4, TS 38.211].

The IAB-MT determines an association period for mapping SS/PBCH blocks to PRACH occasions based on a PRACH configuration period as described in clause 8.1 and according to Table 14-1 instead of Table 8.1-1. An association pattern period includes one or more association periods and is determined so that a pattern between PRACH occasions and SS/PBCH blocks repeats at most every 640 msec . A PRACH occasion in a PRACH slot is valid according to the conditions in clause 8.1.

ETSI


--- Page 202  ---


3GPP TS 38.213 version 17.1.0 Release 17
201
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 14-1: Mapping between PRACH configuration period and SS/PBCH block to PRACH occasion association period for an IAB-MT}
\begin{tabular}{|l|l|}
\hline PRACH configuration period (msec) & Association period (number of PRACH configuration periods) \\
\hline 10 & \{1, 2, 4, 8, 16, 32, 64\} \\
\hline 20 & \{1, 2, 4, 8, 16, 32\} \\
\hline 40 & \{1, 2, 4, 8, 16\} \\
\hline 80 & \{1, 2, 4, 8\} \\
\hline 160 & \{1, 2, 4\} \\
\hline 320 & \{1,2\} \\
\hline 640 & \{1\} \\
\hline
\end{tabular}
\end{table}

If an IAB-node is provided an index \( \mathrm{T}_{\text {delta }} \) in a Timing Delta MAC CE [11, TS 38.321] from a serving cell, the IAB-node may assume that \( T_{\mathrm{TA}} / 2+\left(N_{\text {delta }}+T_{\text {delta }} \cdot \mathrm{G}_{\text {step }}-N_{\mathrm{TA}, \text { Offset }} / 2\right) \cdot \mathrm{T}_{\mathrm{c}} \) is a time difference between a DU transmission of a signal from the serving cell and a reception of the signal by the [AB-MT when \( T_{\mathrm{TA}} / 2+\left(N_{\text {delta }}+T_{\text {delta }}\right. \). \( \left.\mathrm{G}_{\text {step }}-N_{\mathrm{TA}_{\mathrm{A}}, \text { Offset }} / 2\right) \cdot \mathrm{T}_{\mathrm{c}}>0 \), where
- \( T_{\mathrm{TA}} \) is the difference between the IAB-MT reception time and the IAB-MT transmission time for IAB-MT transmission timing mode 'Case6', and is defined in clause 4.3 .1 of [4, TS 38.211] for IAB-MT transmission timing mode 'Casel' and parent node reception mode 'Case7'
- \( \quad N_{\text {delta }} \) and \( \mathrm{G}_{\text {step }} \) are determined as
- \( N_{\text {deta }}=-70528 \) and \( G_{\text {step }}=64 \), if the serving cell providing the Timing Delta MAC CE operates in FR1
- \( \quad N_{\text {deta }}=-17664 \) and \( G_{\text {step }}=32 \), if the serving cell providing the Timing Delta MAC CE operates in FR2

The IAB node may assume that a same value of index \( T_{\text {delta }} \) is provided from a serving cell for the IAB-MT transmission timing modes 'Case7' and 'Case1'

The IAB-node may use the time difference to determine a DU transmission time.
For a serving cell of an IAB-MT, the IAB-MT can be provided by Timing Case Indication MAC CE [11, TS 38.321] an indication of the [AB-MT transmission timing mode in a slot. Upon reception of the Timing Case Indication for a serving cell in a TAG, the [AB-MT applies a same [AB-MT transmission timing mode in a slot on all serving cells in the TAG.

If the indicated IAB-MT transmission timing mode in a slot is set to 'Casel', the IAB-MT transmission time is determined as for a "UE" in clause 4.2.

If the indicated IAB-MT transmission timing mode in a slot is set to 'Case6', the IAB-node sets the IAB-MT transmission time to the transmission time of the IAB-DU.

If the indicated IAB-MT transmission timing mode in a slot is set to 'Case 7', the IAB-MT is provided a timing advance offset value \( N_{\text {TA, offset, } 2} \) for a serving cell by 'Case7' Timing Advance Offset MAC CE [11, TS 38.321]. The [AB-MT determines its uplink transmission timing as ( \( N_{\mathrm{TA}}+N_{\mathrm{TA}, \text { offset }}+N_{\mathrm{TA}, \text { offset }, 2} \) ) \( \cdot \mathrm{T}_{\mathrm{c}} \) where \( N_{\mathrm{TA}} \) and \( N_{\mathrm{TA}, \text { offset }} \) are obtained as for a "UE" in clause 4.2 and \( N_{\text {TA,offset, } 2}=T_{\text {offset, } 2} \cdot 16 \cdot 64 / 2^{\mu} \) where \( T_{\text {offset, } 2} \) is provided by the 'Case7' Timing Advance Offset MAC CE [11, TS 38.321].

A slot format for an [AB-DU or an [AB-MT includes downlink symbols, uplink symbols, and flexible symbols.
For each cell of an IAB-DU, the IAB-DU can be provided an indication for a slot format over a number of slots by gNB-DU Cell Resource Configuration [16, TS 38.473].

For each serving cell, an IAB-MT can be provided an indication for a slot format over a number of slots by tdd-UL-DL-ConfigurationDedicated-IAB-MT. If the [AB-MT is provided tdd-UL-DL-ConfigurationDedicated-IAB-MT, the statements in clause 11.1 that include "tdd-UL-DL-ConfigurationDedicated" apply to the IAB-MT of an IAB node by replacing "tdd-UL-DL-ConfigurationDedicated" with "tdd-UL-DL-ConfigurationDedicated-IAB-MT" for the IAB-MT, except that the tdd-UL-DL-Configuration Dedicated-IAB-MT provides
- a set of slot configurations by slotSpecificConfigurationsToAddModList-IAB-MT
- for each slot configuration from the set of slot configurations

ETSI


--- Page 203  ---


3GPP TS 38.213 version 17.1.0 Release 17
202
ETSI TS 138213 V17.1.0 (2022-05)
- a slot index for a slot provided by slotIndex
- a set of symbols for a slot by symbols-IAB-MT where
- if symbols-IAB-MT = allDownlink, all symbols in the slot are downlink
- if symbols-IAB-MT = allUplink, all symbols in the slot are uplink
- if symbols-IAB-MT = explicit, nrofDownlinkSymbols provides a number of downlink first symbols in the slot and nrofUplinkSymbols provides a number of uplink last symbols in the slot. If nrofDownlinkSymbols is not provided, there are no downlink first symbols in the slot and if noofUplinkSymbols is not provided, there are no uplink last symbols in the slot. The remaining symbols in the slot are flexible.
- if symbols-IAB-MT = explicit-IAB-MT, nrofUplinkSymbols provides a number of uplink first symbols in the slot and nrofDownlinkSymbols provides a number of downlink last symbols in the slot. If nrofUplinkSymbols is not provided, there are no uplink first symbols in the slot and if nrofDownlinkSymbols is not provided, there are no downlink last symbols in the slot. The remaining symbols in the slot are flexible.

If an [AB-MT is configured with an MCG and an SCG, is not capable of simultaneous transmission and reception, and would simultaneously transmit and receive on the MCG and the SCG,
- if flexible symbols are configured by both parent nodes for operation with inter-donor NR-DC, the IAB-MT operates according to the scheduling from the MCG
- otherwise, if the [AB-MT is configured with multiple serving cells, is provided directionalCollisionHandlingr17 = 'enabled' for a set of serving cell(s) from the multiple serving cells, and indicates half-DuplexTDD-CASameSCS capability across MCG and SCG for NR-DC operation, the [AB-MT applies the procedures for resolving directional collisions as described in clause 11.1 for resolving directional collisions across serving cells..

An [AB-MT can be provided, by SlotFormatCombinationsPerCell, a list of slot format combinations applicable for one serving cell and, by SlotFormatIndicator, a configuration for monitor a DCI format \( 2-0 \) indicating a slot format combination, from the list of slot format combinations, over a number of slots as described in clause 11.1.1. In addition to the slot formats in Table 11.1.1-1, an SFI field for an [AB-MT in DCI format \( 2 \_0 \) can indicate to the [AB-MT a slot format from the slot formats in Table 14-2.

ETSI


--- Page 204  ---


3GPP TS 38.213 version 17.1.0 Release 17
203
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 14-2: Slot formats for normal cyclic prefix}
\begin{tabular}{|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|}
\hline Slot Format & \multicolumn{14}{|c|}{Symbol number in a slot} \\
\hline & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 \\
\hline 56 & U & U & U & U & U & U & U & U & U & U & U & U & U & F \\
\hline 57 & U & U & U & U & U & U & U & U & U & U & U & U & F & F \\
\hline 58 & U & U & U & U & U & U & U & U & U & U & U & F & F & F \\
\hline 59 & U & U & U & U & U & U & U & U & U & U & F & F & F & F \\
\hline 60 & U & U & U & U & U & U & U & U & U & F & F & F & F & F \\
\hline 61 & U & U & U & U & U & U & U & U & F & F & F & F & F & F \\
\hline 62 & U & U & U & U & U & U & U & F & F & F & F & F & F & F \\
\hline 63 & U & U & U & U & U & U & F & F & F & F & F & F & F & F \\
\hline 64 & U & U & U & U & U & F & F & F & F & F & F & F & F & F \\
\hline 65 & U & U & U & U & F & F & F & F & F & F & F & F & F & F \\
\hline 66 & U & U & U & F & F & F & F & F & F & F & F & F & F & F \\
\hline 67 & U & U & F & F & F & F & F & F & F & F & F & F & F & F \\
\hline 68 & U & F & F & F & F & F & F & F & F & F & F & F & F & F \\
\hline 69 & U & F & F & F & F & F & F & F & F & F & F & F & F & D \\
\hline 70 & U & U & F & F & F & F & F & F & F & F & F & F & F & D \\
\hline 71 & U & U & U & F & F & F & F & F & F & F & F & F & F & D \\
\hline 72 & U & F & F & F & F & F & F & F & F & F & F & F & D & D \\
\hline 73 & U & U & F & F & F & F & F & F & F & F & F & F & D & D \\
\hline 74 & U & U & U & F & F & F & F & F & F & F & F & F & D & D \\
\hline 75 & U & F & F & F & F & F & F & F & F & F & F & D & D & D \\
\hline 76 & U & U & F & F & F & F & F & F & F & F & F & D & D & D \\
\hline 77 & U & U & U & F & F & F & F & F & F & F & F & D & D & D \\
\hline 78 & U & U & U & U & U & U & U & U & U & U & U & U & F & D \\
\hline 79 & U & U & U & U & U & U & U & U & U & U & U & F & F & D \\
\hline 80 & U & U & U & U & U & U & U & U & U & U & F & F & F & D \\
\hline 81 & U & U & U & U & U & U & U & U & U & U & U & F & D & D \\
\hline 82 & U & U & U & U & U & U & U & U & U & U & F & F & D & D \\
\hline 83 & U & U & U & U & U & U & U & U & U & F & F & F & D & D \\
\hline 84 & U & F & D & D & D & D & D & D & D & D & D & D & D & D \\
\hline 85 & U & U & F & D & D & D & D & D & D & D & D & D & D & D \\
\hline 86 & U & U & U & F & D & D & D & D & D & D & D & D & D & D \\
\hline 87 & U & F & F & D & D & D & D & D & D & D & D & D & D & D \\
\hline 88 & U & U & F & F & D & D & D & D & D & D & D & D & D & D \\
\hline 89 & U & U & U & F & F & D & D & D & D & D & D & D & D & D \\
\hline 90 & U & F & F & F & D & D & D & D & D & D & D & D & D & D \\
\hline 91 & U & U & F & F & F & D & D & D & D & D & D & D & D & D \\
\hline 92 & U & U & U & F & F & F & D & D & D & D & D & D & D & D \\
\hline 93 & U & U & U & U & U & U & U & U & U & F & F & F & F & D \\
\hline 94 & U & U & U & U & U & U & F & F & F & F & F & F & D & D \\
\hline 95 & U & U & U & U & U & U & F & F & D & D & D & D & D & D \\
\hline 96 & U & U & U & U & U & U & U & D & D & D & D & D & D & D \\
\hline
\end{tabular}
\end{table}

For a serving cell of an [AB-MT, the [AB-MT can be provided by Provided Guard Symbols MAC CE a number of symbols that will not be used for the [AB-MT in slots where the [AB-node transitions between] [AB-MT and [AB-node DU and a SCS configuration for the number of symbols [11, TS 38.321].

With reference to slots of an [AB-DU cell, a symbol in a slot of an [AB-DU cell can be configured to be of hard, soft, or unavailable type by HSNA Slot Configuration List in gNB-DU Cell Resource Configuration [16, TS 38.473]. When a downlink, uplink, or flexible symbol is configured as hard, the IAB-DU cell can respectively transmit, receive, or either transmit or receive in the symbol.

When a downlink, uplink, or flexible symbol is configured as soft, the IAB-DU cell can respectively transmit, receive or either transmit or receive in the symbol only if
- the [AB-MT does not transmit or receive during the symbol of the [AB-DU cell, or

ETSI


--- Page 205  ---


3GPP TS 38.213 version 17.1.0 Release 17
204
ETSI TS 138213 V17.1.0 (2022-05)
- with respect to all serving cells, the [AB-MT would transmit or receive during the symbol of the [AB-DU cell, and the transmission or reception during the symbol of the [AB-DU cell is not changed due to a use of the symbol by the [AB-DU, or
- the \( [A B-M T \) detects a \( D C I \) format \( 2-5 \) with an \( A I \) index field value indicating the soft symbol as available if the [AB-MT is not configured with an SCG, or
- the IAB-MT detects two DCI formats 2_5 with an AI index field indicating the soft symbol as available from the MCG and SCG, respectively, or
- the [AB-MT detects a DCI format 25 with an AI index field value indicating the soft symbol as available from one cell group and with respect to all serving cells of the other cell group, the [AB-MT would transmit or receive during the symbol of the [AB-DU cell, and the transmission or reception during the symbol of the [AB-DU cell does not change due to a use of the symbol by the [AB-DU.

When the \( [A B-M T \) receives a DCI format \( 2-5 \) from a serving cell in a cell group, the \( [A B-M T \) applies the information of the DCI format 2_5 to all serving cells of the cell group.

When a symbol is configured as unavailable, the [AB-DU neither transmits nor receives in the symbol.
A symbol of a slot is equivalent to being configured as hard if an [AB-DU would transmit a SS/PBCH block, PDCCH for Type0-PDCCH CSS sets configured by pdcchConfigSIB1, or a periodic CSI-RS in the symbol of the slot, or would receive a PRACH or a SR in the symbol of the slot.

With reference to slots of an [AB-DU cell, the [AB-DU can be provided an indication of hard, soft or unavailable type per RB set for symbols configured as downlink, uplink or flexible in a slot by Rel-17 frequency-domain IAB-DU-Resource-Configuration-H/S/NA-Config [16, TS 38.473]. The RB set size and the number of RB sets are configured by RB-Set-Configuration [16, TS 38-473]. If an indication of hard, soft or unavailable type is not provided for an RB set of a symbol in a slot, the [AB-DU applies the configuration of hard, soft or unavailable type provided by HSNA Slot Configuration List in gNB-DU Cell Resource Configuration [16, TS 38-473] for the RB set of the symbol in the slot. If an indication of hard, soft, or unavailable type is provided for an RB set in a symbol of a slot, the [AB-DU applies the configuration of hard, soft, or unavailable type provided by Rel-17 frequency-domain IAB-DU-Resource-Configuration-H/S/NA-Config [16, TS 38-473] when the [AB-node uses simultaneous transmission and reception in the slot.

When an RB set of a downlink, uplink, or flexible symbol is configured as hard, the [AB-DU cell can respectively transmit, receive, or either transmit or receive on the RB set in the symbol.

When an RB set of a downlink, uplink, or flexible symbol is configured as soft, the [AB-DU cell can respectively transmit, receive or either transmit or receive on the RB set in the symbol only if
- the [AB-MT does not transmit or receive on the RB set during the symbol of the [AB-DU cell, or
- with respect to all serving cells, the [AB-MT would transmit or receive on the RB set during the symbol of the [AB-DU cell, and the transmission or reception on the RB set or any RB set that is configured as unavailable or configured as soft and not indicated as available during the symbol of the [AB-DU cell is not changed due to a use of the RB set in the symbol by the [AB-DU, or
- the [AB-MT detects a DCI format 2 with an AI index field value indicating the soft RB set as available if the [AB-MT is not configured with an SCG, or
- the [AB-MT detects two DCI formats 2_5 with an AI index field value indicating the soft RB set as available from the MCG and SCG, respectively, or
- the [AB-MT detects a DCI format 2_5 with an AI index field value indicating the soft \( R B \) set as available from one cell group and with respect to all serving cells of the other cell group, the [AB-MT would transmit or receive on the RB set during the symbol of the [AB-DU cell, and the transmission or reception on the RB set during the symbol of the [AB-DU cell does not change due to a use of the RB set in the symbol by the [AB-DU.

When an RB set of a downlink, uplink, or flexible symbol is configured as unavailable, the [AB-DU neither transmits nor receives in the RB set in the symbol.

If an [AB-node is provided an Availabilitylndicator, the [AB-node is provided an AI-RNTI by ai-RNTI and a payload size of a DCI format 2_5 by dci-PayloadSizeAI. The [AB-node is also provided a search space set configuration, by SearchSpace, for monitoring PDCCH.

ETSI


--- Page 206  ---


3GPP TS 38.213 version 17.1.0 Release 17
205
ETSI TS 138213 V17.1.0 (2022-05)

For each cell of an [AB-DU in a set of cells of the [AB-DU, the [AB-DU can be provided:
- an identity of the IAB-DU cell by iab-DU-Cellldentity
- a location of an availability indicator (AI) index field in DCI format 2 _ 5 by positionInDCI-AI
- a set of availability combinations by availabilityCombinations, where each availability combination in the set of availability combinations includes
- resourceAvailability indicating availability of soft symbols in one or more slots for the IAB-DU cell, or one or multiple resourceAvailability with each resourceAvailablity indicating availability of soft resources in one or more slots for one RB set group where one RB set group includes one or multiple RB sets, and
- a mapping for the soft symbol, and/or for soft resources, availability combinations provided by resourceAvailability to a corresponding AI index field value in DCI format 2_5 provided by availabilityCombinationId

The IAB-DU can assume a same SCS configuration for availabilityCombinations for a cell as an SCS configuration provided by gNB-DU Cell Resource Configuration for the cell.

An AI index field value in a DCI format 2 _ 5 indicates to an [AB-DU a soft symbol or a soft RB set in an RB set group availability in each slot for a number of slots starting from the earliest slot of the [AB-DU which overlaps in time with the slot of the IAB-MT where the IAB-MT detects the DCI format 2_5. The number of slots is equal to or larger than a PDCCH monitoring periodicity for DCI format 2_5 as provided by SearchSpace. The AI index field includes \( \max \left\{\left[\log _{2}(\operatorname{maxAIindex}+1)\right], 1\right\} \) bits where maxAlindex is the maximum of the values provided by corresponding availabilityCombinationId. An availability for a soft symbol or a soft RB set in an RB set group in a slot is identified by a corresponding value resourceAvailability as provided in Table 14-3.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 14-3: Mapping between values of resourceAvailability elements and types of soft symbol or soft RB set availability in a slot}
\begin{tabular}{|l|l|}
\hline Value & Indication \\
\hline 0 & No indication of availability for soft symbols or soft RB sets in an RB set group \\
\hline 1 & DL soft symbols or soft RB sets in an RB set group are indicated available No indication of availability for UL and Flexible soft symbols or RB set group \\
\hline 2 & UL soft symbols or soft RB sets in an RB set group are indicated available No indication of availability for DL and Flexible soft symbols or RB set group \\
\hline 3 & DL and UL soft symbols or soft RB sets in an RB set group are indicated available No indication of availability for Flexible soft symbols or RB set group \\
\hline 4 & Flexible soft symbols or soft RB sets in an RB set group are indicated available No indication of availability for DL and UL soft symbols or RB set group \\
\hline 5 & DL and Flexible soft symbols or soft RB sets in an RB set group are indicated available No indication of availability for UL soft symbols or RB set group \\
\hline 6 & UL and Flexible soft symbols or soft RB sets in an RB set group are indicated available No indication of availability for DL soft symbols or RB set group \\
\hline 7 & DL, UL, and Flexible soft symbols or soft RB sets in an RB set group are indicated available \\
\hline
\end{tabular}
\end{table}

If a PDCCH monitoring periodicity for DCI format \( 2 \_5 \) is smaller than a duration of an availability combination of soft symbols over a number of slots that the [AB-MT obtains at a PDCCH monitoring occasion for DCI format 2 _ 5 by a corresponding AI index field value, and the IAB-MT detects more than one DCI formats \( 2-5 \) indicating an availability combination of soft symbols or of soft RB sets in RB set groups in a slot, the IAB-MT expects that each of the more than one DCI formats 2_5 indicates a same value for the availability combination of the soft symbols or of soft RB sets in an RB set group in the slot. An [AB-MT monitors PDCCH candidates for a DCI format 2 _ 5 with CRC scrambled by AI-RNTI in one or both of the following search space sets:
- a Type3-PDCCH CSS set configured by SearchSpace in PDCCH-Config with searchSpaceType \( = \) common;
- a USS set configured by SearchSpace in PDCCH-Config with searchSpaceType = ue-Specific.

The IAB-node can be provided by the parent node a set of RS resource indexes that indicate quasi co-location properties of an [AB-DU cell where simultaneous transmission/reception from the [AB-MT and transmission from the [AB-DU cells is restricted by Child IAB-DU Restricted Beam Indication MAC CE as described in [11, TS 38.321]. The [AB-DU does not transmit on a cell if the IAB node is operating in a non-TDM multiplexing mode using an indicated RS resource index on a symbol or RB set configured as soft in an IAB-DU cell

ETSI


--- Page 207  ---


3GPP TS 38.213 version 17.1.0 Release 17
206
ETSI TS 138213 V17.1.0 (2022-05)
- when it is not indicated as available by resourceAvailability
- when the [AB-MT is operating on an associated carrier, if that indication is provided
- when the current [AB-DU transmission mode corresponds to an associated multiplexing mode, if that indication is provided
- when one of the associated TCI states, RS resource indexes, or SRI of the [AB-MT, if provided, is simultaneously used for reception or transmission of the [AB-MT
- when simultaneous transmission/reception by the [AB-MT and transmission from the [AB-DU cell occur in nonoverlapping frequency resources, if such indication is provided, or when simultaneous transmission/reception by the [AB-MT and transmission from the [AB-DU cell occur in overlapping frequency resources
- in a given slot, if that indication is provided

For a serving cell of an [AB-MT, the [AB-MT can be provided a set of TCI states or a set of RS resource indexes corresponding to a SS/PBCH block or to a CSI-RS resource index for a slot where a PDSCH EPRE adjustment is indicated by DL Tx Power Adjustment MAC CE as described in [11, TS 38.321]. The PDSCH EPRE can be derived from a downlink CSI-RS EPRE as described in [6, TS 38.214] and a PDSCH power offset provided by powerControlOffsetIAB as described in [11, TS 38.321]. For a downlink DM-RS and/or PT-RS associated with a PDSCH, the [AB-MT may assume that the ratio of PDSCH EPRE to DM-RS EPRE, and/or PT-RS EPRE to PDSCH EPRE, is obtained as for a "UE" in [6, TS 38.214]. [f no TCI state or RS resource index is provided to the [AB-MT, the [AB-MT may assume that a same PDSCH EPRE adjustment applies to all TCI states or RS resource indexes configured for the [AB-MT. A PDSCH EPRE adjustment provided by DL Tx Power Adjustment MAC CE may be restricted to frequency resources of an [AB-node that do not result in simultaneous reception on the same frequency resources by an [AB-MT and [AB-DU in a slot.

15 Dual active protocol stack based handover
If a UE indicates a capability for dual active protocol stack based handover (DAPS HO), the UE can be provided with a source MCG and a target MCG.

If a UE is configured with a target MCG using NR radio access in FR1 or in FR2 and with a source MCG using NR radio access in FR2 or in FR1, respectively, the UE performs transmission power control independently per cell group as described in clauses 7.1 through 7.5 .

If a UE is configured with a target MCG using NR radio access in FR1 and a source MCG using NR radio access in FR1, the UE is configured a maximum power \( P_{\text {MCG }} \) for transmissions on the target MCG by \( p \)-DAPS-Target and a maximum power \( P_{S C G} \) for transmissions on the source MCG by \( p \)-DAPS-Source and with an inter-CG power sharing mode by uplinkPowerSharingDAPS-Mode. The UE determines a transmission power on the target MCG and a transmission power on the source MCG per frequency range.

If the UE indicates support for semi-static power sharing model and is provided uplinkPowerSharingDAPS-Mode \( = \) Semi-static-model, the UE determines a transmission power for the target MCG or for the source MCG as described in clause 7.6 .2 for nrdc-PCmode-FRI = Semi-static-model by considering the target MCG as the MCG and the source MCG as the SCG.

If the UE indicates support for semi-static power sharing mode2 and is provided uplinkPowerSharingDAPS-Mode \( = \) Semi-static-mode2, the UE determines a transmission power for the target MCG or for the source SCG as described in clause 7.62 for nrdc-PCmode-FRI = Semi-static-mode 2 by considering the target MCG as the MCG and the source MCG as the SCG. The UE expects to be provided uplinkPowerSharingDAPS-Mode \( = \) Semi-static-mode 2 only for synchronous DAPS HO operation [10, TS 38.133].

If the UE indicates support for dynamic power sharing and is provided uplinkPowerSharingDAPS-Mode \( = \) Dynamic, the UE determines a transmission power for the target MCG or for the source MCG as described in clause 7.6 .2 for nrdc-PCmode-FRI = Dynamic by considering the target MCG as the MCG and the source MCG as the SCG.

Intra-frequency DAPS handover is described in clause 6.1.3.2 of [10, TS38.133].
For DAPS handover that is not intra-frequency, if
- the UE does not indicate support of interFreqUL-TransCancellationDAPS-r16, and

ETSI


--- Page 208  ---


3GPP TS 38.213 version 17.1.0 Release 17
207
ETSI TS 138213 V17.1.0 (2022-05)
- UE does not indicate a capability for power sharing between source and target MCG in DAPS handover or the UE is not provided with uplinkPowerSharingDAPS-Mode,
the UE does not expect transmissions on the target and source cell in overlapping time resources.
For DAPS handover that is not intra-frequency, if
- the UE indicates support of interFreqUL-TransCancellationDAPS-r16, and
- UE does not indicate a capability for power sharing between source and target MCG in DAPS handover or the UE is not provided with uplinkPowerSharingDAPS-Mode, and
- UE transmissions on the target cell and the source cell are in overlapping time resources,
the UE transmits only on the target cell, and cancels the transmission to source cell.
For intra-frequency DAPS handover, if
- UE transmissions on the target cell and the source cell are in overlapping time resources,
the UE transmits only on the target cell and cancels the transmission on the source cell.
The UE does not expect to cancel a transmission on the source cell if a first symbol of the transmission on the source cell is less than \( T_{\text {proc, } 2}+d \) after a last symbol of a CORESET where the UE receives a PDCCH providing a DCI format scheduling a transmission on the target cell. \( T_{\text {proc }, 2} \) is the PUSCH preparation time for the corresponding PUSCH processing capability [ 6 , TS 38.214] assuming \( d_{2,1}=1, d \) is a time duration corresponding to 2 symbols for SCS configuration \( \mu \), and \( \mu \) is the smallest SCS configuration between the SCS configuration of the PDCCH providing the DCI format and the SCS configuration for the transmission on the source cell. If the UE transmits PRACH using 1.25 kHz or 5 kHz SCS on the source cell, the UE determines \( T_{\text {proc, } 2} \) assuming SCS configuration \( \mu=0 \).

A UE does not expect to cancel a transmission on the source cell if the first symbol of the source cell transmission occurs, relative to a last symbol of a PDSCH reception conveying a RAR message with a RAR UL grant on the target cell, after a number of symbols that is smaller than \( N_{\mathrm{T}, 1}+N_{\mathrm{T}, 2}+0.5 \mathrm{msec} \), where \( N_{\mathrm{T}, 1} \) is a time duration of \( N_{1} \) symbols corresponding to a PDSCH processing time for UE processing capability 1 when additional PDSCH DM-RS is configured, \( N_{T, 2} \) is a time duration of \( N_{2} \) symbols corresponding to a PUSCH preparation time for UE processing capability 1 [6, TS 38.214] and the UE considers that \( N_{1} \) and \( N_{2} \) correspond to the smaller of the SCS configurations for the PDSCH on the target cell and the transmission on the source cell. For \( \mu=0 \), the UE assumes \( N_{1,0}=14[6 \), TS 38.214].

For intra-frequency DAPS handover operation, the UE expects that an active DL BWP and an active UL BWP on the target cell are within an active DL BWP and an active UL BWP on the source cell, respectively.

If a UE is provided search space sets on both the target MCG and the source MCG, in any slot the UE does not expect to have USS sets on both the target MCG and the source MCG that result in the number of monitored PDCCH candidates and the total number of non-overlapped CCEs in both cells that each exceed the corresponding maximum numbers per slot defined in Table 10.1-2 and Table 10.1-3.

For DAPS operation in a same frequency band, a UE does not transmit PUSCH/PUCCH/SRS to the source MCG in a slot overlapping in time with a PRACH transmission to the target MCG or when a gap between a first or last symbol of a PRACH transmission to the target MCG in a first slot would be separated by less than \( N \) symbols from a last or first symbol, respectively, of the PUSCH/PUCCH/SRS transmission to the source MCG in a second slot. For DAPS operation in a same frequency band, a UE does not transmit PRACH on the source MCG in a slot overlapping in time with a PUSCH/PUCCH/SRS transmission on the target MCG or when a gap between the first or last symbol of a PUSCH/PUCCH/SRS transmission on the target MCG is separated by less than \( N \) symbols from a last or a first symbol, respectively, of a PRACH transmission on the source MCG. \( N=2 \) for \( \mu=0 \) or \( \mu=1, N=4 \) for \( \mu=2 \) or \( \mu=3 \), and \( \mu \) is the SCS configuration of the active UL BWP for the PUSCH/PUCCH/SRS transmission. The PUSCH processing capability is the processing capability of source cell.

16 UE procedures for sidelink
A UE is provided by SL-BWP-Config a BWP for SL transmissions (SL BWP) with numerology and resource grid determined as described in [4, TS 38.211]. For a resource pool within the SLBWP, the UE is provided by sl-

ETSI


--- Page 209  ---


3GPP TS 38.213 version 17.1.0 Release 17
208
ETSI TS 138213 V17.1.0 (2022-05)

NumSubchannel a number of sub-channels where each sub-channel includes a number of contiguous RBs provided by sl-SubchannelSize. The first RB of the first sub-channel in the SL BWP is indicated by sl-StartRB-Subchannel.
Available slots for a resource pool are provided by sl-TimeResource and occur with a periodicity of 10240 ms . For an available slot without S-SS/PSBCH blocks, SL transmissions can start from a first symbol indicated by sl-StartSymbol and be within a number of consecutive symbols indicated by sl-LengthSymbols. For an available slot with S-SS/PSBCH blocks, the first symbol and the number of consecutive symbols is predetermined.

The UE expects to use a same numerology in the SL BWP and in an active UL BWP in a same carrier of a same cell. If the active UL BWP numerology is different than the SL BWP numerology, the SL BWP is deactivated.

A priority of a PSSCH according to NR radio access or according to E-UTRA radio access is indicated by a priority field in a respective scheduling SCI format. A priority of a PSSS/SSSS/PSBCH according to E-UTRA radio access is provided by \( s l \)-SSB-PriorityEUTRA [13, TS 36.213]. A priority of an S-SS/PSBCH block is provided by \( s l \)-SSBPriorityNR. A priority of a PSFCH is determined as described in clause 16.2.4.2.

A UE does not expect to be provided search space sets associated with CORESETs on more than one cell to monitor PDCCH for detection of DCI format 3_0 or DCI format 3_1.
16.1 Synchronization procedures

A UE receives the following SL synchronization signals in order to perform synchronization procedures based on SSS/PSBCH blocks: SL primary synchronization signals (S-PSS) and SL secondary synchronization signals (S-SSS) [4, TS 38.211].

A UE assumes that reception occasions of a physical sidelink broadcast channel (PSBCH), S-PSS, and S-SSS are in consecutive symbols [4, TS 38.211] and form a S-SS/PSBCH block.

For reception of a S-SS/PSBCH block, a UE assumes a frequency location corresponding to the subcarrier with index 66 in the S-SS/PSBCH block [4, TS 38.211], is provided by sl-AbsoluteFrequencySSB. The UE assumes that a S-PSS symbol, a S-SSS symbol, and a PSBCH symbol have a same transmission power. The UE assumes a same numerology of the S-SS/PSBCH as for a SL BWP of the S-SS/PSBCH block reception, and that a band width of the S-SS/PSBCH is within a bandwidth of the SL BWP. The UE assumes the subcarrier with index 0 in the S-SS/PSBCH block is aligned with a subcarrier with index 0 in an RB of the SLBWP.

A UE is provided, by sl-NumSSB-WithinPeriod, a number \( N_{\text {period }}^{\text {S-SSB }} \) of S-SS/PSBCH blocks in a period of 16 frames. The UE assumes that a transmission of the S-SS/PSBCH blocks in the period is with a periodicity of 16 frames. The UE determines indexes of slots that include S-SS/PSBCH block as \( N_{\text {offset }}^{\text {S-SSB }}+\left(N_{\text {interval }}^{\text {S-SSB }}+1\right) \cdot i_{\text {S-SSB }} \), where
- index 0 corresponds to a first slot in a frame with SFN of the serving cell satisfying \( (\mathrm{SFN} \bmod 16)=0 \) or DFN satisfying \( ( \) DFN \( \bmod 16)=0 \)
- \( i_{\text {S-SSB }} \) is a S-SS/PSBCH block index within the number of S-SS/PSBCH blocks in the period, with \( 0 \leq i_{\text {S-SSB }} \leq N_{\text {period }}^{\text {S-SSB }}-1 \)
- \( \quad N_{\text {offset }}^{\text {S-SSB }} \) is a slot offset from a start of the period to the first slot including S-SS/PSBCH block, provided by slTimeOffsetSSB
- \( \quad N_{\text {interval }}^{\mathrm{S}-\mathrm{SSB}} \) is a slot interval between S-SS/PSBCH blocks, provided by sl-TimeInterval

For paired spectrum, an S-SS/PSBCH block can be transmitted/received only in a slot of an UL carrier. For unpaired spectrum, an S-SS/PSBCH block can be transmitted/received only in a slot of which all OFDM symbols are configured as UL by tdd-UL-DL-ConfigurationCommon of the serving cell if provided or sl-TDD-Configuration if provided or sl-TDD-Config of the received PSBCH if provided. Or if tdd-UL-DL-ConfigurationCommon and sl-TDD-Configuration are not provided for a spectrum indicated with only PC5 interface in Table 5.2E.1-1 in [TS 38.101-1], an S-SS/PSBCH block can be transmitted/received in any slot of the spectrum.

For transmission of an S-SS/PSBCH block, a UE includes a bit sequence \( a_{0}, a_{1}, a_{2}, a_{3}, \ldots, a_{11} \) in the PSBCH payload to indicate sl-TDD-Config and provide a slot format over a number of slots.

For paired spectrum, or if tdd-UL-DL-ConfigurationCommon and sl-TDD-Configuration are not provided for a spectrum indicated with only PC5 interface in Table 5.2E.1-1 in [TS 38.101-1],
- \( a_{0}, a_{1}, a_{2}, a_{3}, a_{4}, a_{5}, a_{6}, a_{7}, a_{8}, a_{9}, a_{10}, a_{11} \) are set to '1';

ETSI


--- Page 210  ---


3GPP TS 38.213 version 17.1.0 Release 17
209
ETSI TS 138213 V17.1.0 (2022-05)

else
- \( a_{0}=0 \) if pattern I is provided by sl-TDD-Configuration or tdd-UL-DL-ConfigurationCommon; \( a_{0}=1 \) if both pattern 1 and pattern 2 are provided by sl-TDD-Configuration or tdd-UL-DL-ConfigurationCommon as described in clause 11.1
- \( a_{1}, a_{2}, a_{3}, a_{4} \) are determined based on
- \( P \) in pattern \( l \) as described in Table 16.1-1 for \( a_{0}=0 \)
- \( P \) in pattern \( I \) and \( P_{2} \) in pattern 2 as described in Table 16.1-2 for \( a_{0}=1 \) where \( P \) and \( P_{2} \) are as described in clause 11.1
- \( \quad a_{5}, a_{6}, a_{7}, a_{8}, a_{9}, a_{10}, a_{11} \) are the 7 th to 1 st LSBs of \( u_{\text {slots }}^{\text {SL }} \), respectively
- for \( a_{0}=0, u_{\text {slots }}^{\mathrm{SL}}=u_{\text {slots }} * 2^{\mu-\mu_{\mathrm{ref}}}+\left\lfloor\frac{u_{\mathrm{sym}^{*} 2^{\mu-\mu_{\mathrm{ref}}}}}{L}\right\rfloor+I_{1} \)
- for \( a_{0}=1, u_{\text {slots }}^{\mathrm{SL}}=\left\lfloor\frac{\left.\left.u_{\text {slots }, 2^{*} 2^{\mu-\mu_{\mathrm{ref}}}+\left\lfloor\frac{u_{\mathrm{sym}, 2^{* 2}} \mu-\mu_{\mathrm{ref}}}{L}\right\rfloor+I_{2}}^{w}\right\rfloor *\left\lceil\frac{P{ }^{*} 2^{\mu}+1}{w}\right\rceil+\left\lfloor\frac{\left.u_{\text {slots }^{*} 2^{\mu-\mu_{\mathrm{ref}}}+\left\lfloor\frac{u_{\mathrm{sym} * 2} \mu-\mu_{\mathrm{ref}}}{L}\right\rfloor+I_{1}}^{w}\right\rfloor}{w}\right\rfloor\right)}{w}\right. \)
where
- \( L \) is the number of symbols in a slot: \( L=12 \) if cyclicPrefix = "ECP"; else, \( L=14 \)
- \( I_{1} \) is 1 if \( u_{\text {sym }} * 2^{\mu-\mu_{\text {ref }}} \bmod L \geq L-Y \), else \( I_{1} \) is 0
- \( I_{2} \) is 1 if \( u_{\text {sym } 2} * 2^{\mu-\mu_{\text {ref }}} \bmod L \geq L-Y \), else \( I_{2} \) is 0
- \( Y \) is the sidelink starting symbol index provided by sl-StartSymbol
- \( w \) is the granularity of slots indication as described in Table 16.1-2
- \( \mu_{\text {ref },} u_{\text {slots }}, u_{\text {sym },} u_{\text {slots }, 2}, u_{\text {sym }, 2} \) are the parameters of tdd-UL-ConfigurationCommon as described in clause 11.1, or the parameters of sl-TDD-Configuration as defined in [9.3, TS 38.331]
- \( \mu=0,1,2,3 \) corresponds to SL SCS as defined in [4, TS 38.211]

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 16.1-1: Slot configuration period when one pattern is indicated}
\begin{tabular}{|l|l|}
\hline \( a_{1}, a_{2}, a_{3}, a_{4} \) & Slot configuration period of pattern 1 \( P \) (msec) \\
\hline 0, 0, 0, 0 & 0.5 \\
\hline 0, 0, 0, 1 & 0.625 \\
\hline 0, 0, 1, 0 & 1 \\
\hline 0, 0, 1, 1 & 1.25 \\
\hline 0, 1, 0, 0 & 2 \\
\hline 0, 1, 0, 1 & 2.5 \\
\hline 0, 1, 1, 0 & 4 \\
\hline 0, 1, 1, 1 & 5 \\
\hline 1, 0, 0, 0 & 10 \\
\hline Reserved & Reserved \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 16.1-2: Slot configuration period and granularity when two patterns are indicated}
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline\( a_{1}, a_{2}, a_{3}, a_{4} \) & \begin{tabular}{c} 
Slot configuration \\
period of pattern1 \\
\( P(\mathrm{msec}) \)
\end{tabular} & \begin{tabular}{c} 
Slot configuration period \\
of pattern2 \\
\( P_{2}(\mathrm{msec}) \)
\end{tabular} & \multicolumn{4}{|c|}{ Granularity \( w \) in slots with different SCS } \\
\cline { 4 - 7 } & & & 15 kHz & 30 kHz & 60 kHz & 120 kHz \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 211  ---


3GPP TS 38.213 version 17.1.0 Release 17
210
ETSI TS 138213 V17.1.0 (2022-05)

\begin{tabular}{|l|l|l|l|l|l|l|}
\hline - 0, 0, 0, 0 & 0.5 & 0.5 & \multirow{6}{*}{} & \multirow{3}{*}{} & \multirow{14}{*}{} & \multirow{6}{*}{} \\
\hline 0,0,0,1 & 0.625 & 0.625 & & & & \\
\hline 0,0,1,0 & 1 & 1 & & & & \\
\hline 0, 0, 1, 1 & 0.5 & 2 & & & & \\
\hline 0, 1, 0, 0 & 1.25 & 1.25 & & & & \\
\hline 0, 1, 0, 1 & 2 & 0.5 & & & & \\
\hline 0, 1, 1, 0 & 1 & 3 & \multicolumn{2}{|r|}{\multirow{8}{*}{1}} & & \multirow{8}{*}{2} \\
\hline 0, 1, 1, 1 & 2 & 2 & & & & \\
\hline 1, 0, 0, 0 & 3 & 1 & & & & \\
\hline 1, 0, 0, 1 & 1 & 4 & & & & \\
\hline 1, 0, 1, 0 & 2 & 3 & & & & \\
\hline 1, 0, 1, 1 & 2.5 & 2.5 & & & & \\
\hline 1, 1, 0, 0 & 3 & 2 & & & & \\
\hline 1, 1, 0, 1 & 4 & 1 & & & & \\
\hline 1, 1, 1, 0 & 5 & 5 & & & 2 & 4 \\
\hline 1, 1, 1, 1 & 10 & 10 & 1 & 2 & 4 & 8 \\
\hline
\end{tabular}

If a UE would transmit or receive an S-SS/PSBCH block, and the transmission or reception would overlap in time with transmissions or receptions on the sidelink using E-UTRA radio access, the UE transmits or receives the signal/channel with the higher priority.

If a UE would transmit or receive sidelink synchronization signals for E-UTRA radio access, and the transmission or reception would overlap in time with sidelink transmissions or receptions using NR radio access, the UE transmits or receives the signal/channel with the higher priority.
16.2 Power control
16.2.0 S-SS/PSBCH blocks

A UE determines a power \( P_{\mathrm{S}-\mathrm{SSB}}(i) \) for an S-SS/PSBCH block transmission occasion in slot \( i \) on active SLBWP \( b \) of carrier \( f \) as
\[
P_{\mathrm{S}-\mathrm{SSB}}(i)=\min \left(P_{\mathrm{CMAX}}, P_{\mathrm{O}, \mathrm{~S}-\mathrm{SSB}}+10 \log _{10}\left(2^{\mu} \cdot M_{\mathrm{RB}}^{\mathrm{S}-\mathrm{SSB}}\right)+\alpha_{\mathrm{S}-\mathrm{SSB}} \cdot P L\right)[\mathrm{dBm}]
\]
where
- \( P_{\text {CMAX }} \) is defined in [8-1, TS 38.101-1]
- \( \quad P_{0, \mathrm{~S}-\mathrm{SSB}} \) is a value of \( d l-P 0-P S B C H \) if provided; else, \( P_{\mathrm{S}-\mathrm{SSB}}(i)=P_{\mathrm{C} \text { MAX }} \)
- \( \alpha_{\mathrm{S}-\mathrm{SSB}} \) is a value of dl-Alpha-PSBCH, if provided; else, \( \alpha_{\mathrm{S}-\mathrm{SSB}}=1 \)
- \( P L=P L_{b_{1}, f_{1} c}\left(q_{d}\right) \) when the active SL BWP is on a serving cell \( c \), as described in clause 7.1.1 except that
- the RS resource is the one the UE uses for determining a power of a PUSCH transmission scheduled by a DCI format \( 0 \_0 \) in serving cell \( c \) when the UE is configured to monitor PDCCH for detection of DCI format \( 0 \_0 \) in serving cell \( c \)
- the RS resource is the one corresponding to the \( \mathrm{SS} / \mathrm{PBCH} \) block the UE uses to obtain MIB when the UE is not configured to monitor PDCCH for detection of DCI format \( 0 \_0 \) in serving cell \( c \)
- \( M_{\text {RB }}^{S-S S B}=11 \) is a number of resource blocks for a S-SS/PSBCH block transmission with SCS configuration \( \mu \)
16.2.1 PSSCH

A UE determines a power \( P_{\text {PSSCH }}(i) \) for a PSSCH transmission on a resource pool in symbols where a corresponding PSCCH is not transmitted in PSCCH-PSSCH transmission occasion \( i \) on active SL BWP \( b \) of carrier \( f \) as:
\[
P_{\mathrm{PSSCH}}(i)=\min \left(P_{\mathrm{CMAX}}, P_{\mathrm{MAX}, \mathrm{CBR}}, \min \left(P_{\mathrm{PSSCH}, D}(i), P_{\mathrm{PSSCH}, S L}(i)\right)\right)[\mathrm{dBm}]
\]
where
- \( P_{\text {CMAX }} \) is defined in [8-1, TS 38.101-1]

ETSI


--- Page 212  ---


3GPP TS 38.213 version 17.1.0 Release 17
211
ETSI TS 138213 V17.1.0 (2022-05)
- \( P_{\text {MAX, CBR }} \) is determined by a value of \( s l \)-MaxTxPower based on a priority level of the PSSCH transmission and a CBR range that includes a CBR measured in slot \( i-N[6 \), TS 38.214]; if sl-MaxTxPower is not provided, then \( P_{\text {MAX }, \mathrm{CBR}}=P_{\text {CMAX }} \);
- if dl-P0-PSSCH-PSCCH is provided
- \( P_{\mathrm{PSSCH}, D}(i)=P_{\mathrm{O}, D}+10 \log _{10}\left(2^{\mu} \cdot M_{\mathrm{RB}}^{\mathrm{PSSCH}}(i)\right)+\alpha_{D} \cdot P L_{D}[\mathrm{dBm}] \)
- else
- \( P_{\mathrm{PSSCH}, D}(i)=\min \left(P_{\mathrm{CMAX}}, P_{\mathrm{MAX}, \mathrm{CBR}}\right)[\mathrm{dBm}] \)
where
- \( \quad P_{0, D} \) is a value of \( d l-P 0-P S S C H-P S C C H \) if provided
- \( \alpha_{D} \) is a value of dl-Alpha-PSSCH-PSCCH, if provided; else, \( \alpha_{D}=1 \)
- \( P L_{D}=P L_{b_{1} f_{1} c}\left(q_{d}\right) \) when the active SL BWP is on a serving cell \( c \), as described in clause 7.1.1 except that
- the RS resource is the one the UE uses for determining a power of a PUSCH transmission scheduled by a DCI format \( 0 \_0 \) in serving cell \( c \) when the UE is configured to monitor PDCCH for detection of DCI format \( 0 \_0 \) in serving cell \( c \)
- the RS resource is the one corresponding to the \( \mathrm{SS} / \mathrm{PBCH} \) block the UE uses to obtain MIB when the UE is not configured to monitor PDCCH for detection of DCI format \( 0 \_0 \) in serving cell \( c \)
- \( \quad M_{\mathrm{RB}}^{\mathrm{PSSCH}}(i) \) is a number of resource blocks for the PSSCH transmission occasion \( i \) and \( \mu \) is a SCS configuration
- if \( s i-P 0-P S S C H-P S C C H \) is provided and if a SCI format scheduling the PSSCH transmission includes a cast type indicator field indicating unicast or is SCI format 2-C
- \( P_{\mathrm{PSSCH}, S L}(i)=P_{\mathrm{O}, S L}+10 \log _{10}\left(2^{\mu} \cdot M_{\mathrm{RB}}^{\mathrm{PSSCH}}(i)\right)+\alpha_{S L} \cdot P L_{S L}[\mathrm{dBm}] \)
- else
- \( P_{\text {PSSCH }, \text { SL }}(i)=\min \left(P_{\text {CMAX }}, P_{\text {PSSCH }, D}(i)\right)[\mathrm{dBm}] \)
where
- \( P_{0, S L} \) is a value of \( s l-P 0-P S S C H-P S C C H \), if provided
- \( \alpha_{S L} \) is a value of sl-Alpha-PSSCH-PSCCH, if provided; else, \( \alpha_{S L}=1 \)
- \( P L_{S L}= \) referenceSignalPower - higher layer filtered RSRP, where
- referenceSignalPower is obtained from a PSSCH transmit power per RE summed over the antenna ports of the UE, higher layer filtered across PSSCH transmission occasions using a filter configuration provided by sl-FilterCoefficient, and
- higher layer filtered RSRP is a RSRP, as defined in [7, TS 38.215], that is reported to the UE from a UE receiving the PSCCH-PSSCH transmission and is obtained from a PSSCH DM-RS using a filter configuration provided by sl-FilterCoefficient
- \( M_{\mathrm{RB}}^{\mathrm{PSSCH}}(i) \) is a number of resource blocks for PSCCH-PSSCH transmission occasion \( i \) and \( \mu \) is a SCS configuration

The UE splits the power \( P_{\mathrm{PSSCH}}(i) \) equally across the antenna ports on which the UE transmits the PSSCH with nonzero power.

A UE determines a power \( P_{\mathrm{PSSCH} 2}(i) \) for a PSSCH transmission on a resource pool in the symbols where a corresponding PSCCH is transmitted in PSCCH-PSSCH transmission occasion \( i \) on active SL BWP \( b \) of carrier \( f \) as

ETSI


--- Page 213  ---


3GPP TS 38.213 version 17.1.0 Release 17
212
ETSI TS 138213 V17.1.0 (2022-05)

\( P_{\mathrm{PSSCH} 2}(i)=10 \log _{10}\left(\frac{M_{\mathrm{RB}}^{\mathrm{PSSCH}}(i)-M_{\mathrm{RB}}^{\mathrm{PSCCH}}(i)}{M_{\mathrm{RB}}^{\mathrm{PSSCH}}(i)}\right)+P_{\mathrm{PSSCH}}(i)[\mathrm{dBm}] \)
where \( M_{\mathrm{RB}}^{\mathrm{PSCCH}}(i) \) is a number of resource blocks for the corresponding PSCCH transmission in PSCCH-PSSCH transmission occasion \( i \).

The UE splits the power \( P_{\mathrm{PSSCH} 2}(i) \) equally across the antenna ports on which the UE transmits the PSSCH with nonzero power.
16.2.2 PSCCH

A UE determines a power \( P_{\mathrm{PSCCH}}(i) \) for a PSCCH transmission on a resource pool in PSCCH-PSSCH transmission occasion \( i \) as
\( P_{\mathrm{PSCCH}}(i)=10 \log _{10}\left(\frac{M_{\mathrm{RB}}^{\mathrm{PSCCH}_{\mathrm{RS}}}(i)}{M_{\mathrm{RB}}^{\mathrm{PSSCH}}(i)}\right)+P_{\mathrm{PSSCH}}(i)[\mathrm{dBm}] \)
where
- \( \quad P_{\mathrm{PSSCH}}(i) \) is specified in clause 16.2.1
- \( M_{\text {RB }}^{\text {PSCCH }}(i) \) is a number of resource blocks for the PSCCH transmission in PSCCH-PSSCH transmission occasion i
- \( \quad M_{\mathrm{RB}}^{\mathrm{PSSCH}}(i) \) is a number of resource blocks for PSCCH-PSSCH transmission occasion \( i \)
16.2.3 PSFCH

A UE with \( N_{\text {sch, Tx, PSFCH }} \) scheduled PSFCH transmissions for HARQ-ACK information and conflict information, and capable of transmitting a maximum of \( N_{\text {max, PSFCH }} \) PSFCHs, determines a number \( N_{\mathrm{Tx}, \mathrm{PSFCH}} \) of simultaneous PSFCH transmissions and a power \( P_{\mathrm{PSFCH}, \mathrm{k}}(i) \) for a PSFCH transmission \( k, 1 \leq k \leq N_{\mathrm{Tx}, \mathrm{PSFCH}} \), on a resource pool in PSFCH transmission occasion \( i \) on active SL BWP \( b \) of carrier \( f \) as
- if dl-P0-PSFCH is provided,
\[
P_{\text {PSFCH, one }}=P_{\mathrm{O}, \text { PSFCH }}+10 \log _{10}\left(2^{\mu}\right)+\alpha_{\text {PSFCH }} \cdot P L[\mathrm{dBm}]
\]
where
- \( P_{\mathrm{O}, \text { PSFCH }} \) is a value of dl-P0-PSFCH
- \( \quad \alpha_{\text {PSFCH }} \) is a value of dl-Alpha-PSFCH, if provided; else, \( \alpha_{\text {PFSCH }}=1 \)
- \( P L=P L_{b, f, c}\left(q_{d}\right) \) when the active SLBWP is on a serving cell \( c \), as described in clause 7.1.1 except that
- the RS resource is the one the UE uses for determining a power of a PUSCH transmission scheduled by a DCI format \( 0 \_0 \) in serving cell \( c \) when the UE is configured to monitor PDCCH for detection of DCI format \( 0 \_0 \) in serving cell \( c \)
- the RS resource is the one corresponding to the \( \mathrm{SS} / \mathrm{PBCH} \) block the UE uses to obtain MIB when the UE is not configured to monitor PDCCH for detection of DCI format \( 0 \_0 \) in serving cell \( c \)
- if \( N_{\text {sch, Tx, PSFCH }} \leq N_{\text {max, PSFCH }} \)
- if \( P_{\text {PSFCHone }}+10 \log _{10}\left(N_{\text {sch,Tx,PSFCH }}\right) \leq P_{\text {CMAX }} \), where \( P_{\text {CMAX }} \) is determined for \( N_{\text {sch,Tx,PSFCH }} \) PSFCH transmissions according to [8-1, TS 38.101-1]
- \( \quad N_{\mathrm{Tx}, \mathrm{PSFCH}}=N_{\text {sch, Tx, PSFCH }} \) and \( P_{\text {PSFCH, } \mathrm{k}}(i)=P_{\text {PSFCH,one }}[\mathrm{dBm}] \)
- else
- UE autonomously determines \( N_{\mathrm{Tx}, \mathrm{PSFCH}} \) PSFCH transmissions first with ascending order of corresponding priority field values as described in clause 16.2.4.2 over the PSFCH transmissions with HARQ-ACK information, if any, and then with ascending order of priority value over the PSFCH transmissions with conflict information, if any, such that \( N_{\mathrm{Tx}, \mathrm{PSFCH}} \geq \max \left(1, \sum_{i=1}^{K} M_{i}\right) \) where \( M_{i} \), for

ETSI


--- Page 214  ---


3GPP TS 38.213 version 17.1.0 Release 17
213
ETSI TS 138213 V17.1.0 (2022-05)

\( 1 \leq i \leq 8 \), is a number of PSFCHs with priority value \( i \) for PSFCH with HARQ-ACK information and \( M_{i} \), for \( i>8 \), is a number of PSFCHs with priority value \( i-8 \) for PSFCH with conflict information and \( K \) is defined as
- the largest value satisfying \( P_{\text {PSFCH one }}+10 \log _{10}\left(\max \left(1, \sum_{i=1}^{K} M_{i}\right)\right) \leq P_{\text {CMAX }} \) where \( P_{\text {CMAX }} \) is determined according to [8-1, TS 38.101-1] for transmission of all PSFCHs in \( \sum_{i=1}^{K} M_{i} \), if any
- zero, otherwise
and
\[
P_{\text {PSFCH, } \mathrm{k}}(i)=\min \left(P_{\text {CMAX }}-10 \log _{10}\left(N_{\mathrm{Tx}, \mathrm{PSFCH}}\right), P_{\text {PSFCH,one }}\right)[\mathrm{dBm}]
\]
where \( P_{\text {CMAX }} \) is defined in [8-1, TS 38.101-1] and is determined for the \( N_{\text {Tx PSFCH }} \) PSFCH transmissions
- else
- the UE autonomously selects \( N_{\text {max, PSFCH }} \) PSFCH transmissions with ascending order of corresponding priority field values as described in clause 16.2.4.2
- if \( P_{\text {PSFCH } 0 \text { one }}+10 \log _{10}\left(N_{\text {max }, \text { PSFCH }}\right) \leq P_{\text {CMAX }} \), where \( P_{\text {CMAX }} \) is determined for the \( N_{\text {max }, \text { PSFCH }} \) PSFCH transmissions according to [8-1, TS 38.101-1]
- \( \quad N_{\text {Tx, PSFCH }}=N_{\text {max, PSFCH }} \) and \( P_{\text {PSFCH, } \mathrm{k}}(i)=P_{\text {PSFCH, one }}[\mathrm{dBm}] \)
- else
- the UE autonomously selects \( N_{\mathrm{Tx}, \mathrm{PSFCH}} \) PSFCH transmissions in ascending order of corresponding priority field values as described in clause 16.2.4.2 over the PSFCH transmissions with HARQACK information, if any, and then with ascending order of priority value over the PSFCH transmissions with conflict information, if any, such that \( N_{\mathrm{Tx}, \mathrm{PSFCH}} \geq \max \left(1, \sum_{i=1}^{K} M_{i}\right) \) where \( M_{i} \) is a number of PSFCHs with priority value \( i \) for PSFCH with HARQ-ACK information and \( M_{i} \) is a number of PSFCHs with priority value \( i-8 \) for PSFCH with conflict information and \( K \) is defined as
- the largest value satisfying \( P_{\text {PSFCH one }}+10 \log _{10}\left(\max \left(1, \sum_{i=1}^{K} M_{i}\right)\right) \leq P_{\text {CMAX }} \) where \( P_{\text {CMAX }} \) is determined according to [8-1, TS 38.101-1] for transmission of all PSFCHs in \( \sum_{i=1}^{K} M_{i} \), if any
- zero, otherwise
and
\[
P_{\mathrm{PSFCH}, \mathrm{k}}(i)=\min \left(P_{\mathrm{CMAX}}-10 \log _{10}\left(N_{\mathrm{Tx}, \mathrm{PSFCH}}\right), P_{\mathrm{PSFCH}, \text { one }}\right)[\mathrm{dBm}]
\]
where \( P_{\text {CMAX }} \) is determined for the \( N_{\mathrm{Tx}, \text { PSFCH }} \) simultaneous PSFCH transmissions according to [81, TS 38.101-1]
- else
\[
P_{\text {PSFCH, } \mathrm{k}}(i)=P_{\text {CMAX }}-10 \log _{10}\left(N_{\mathrm{Tx}, \mathrm{PSFCH}}\right)[\mathrm{dBm}]
\]
where the UE autonomously determines \( N_{\mathrm{Tx}, \mathrm{PSFCH}} \) PSFCH transmissions with ascending order of corresponding priority field values as described in clause 16.2.4.2 over the PSFCH transmissions with HARQ-ACK information, if any, and then with ascending order of priority value over the PSFCH transmissions with conflict information, if any, such that \( N_{\mathrm{Tx}, \mathrm{PSFCH}} \geq 1 \) and where \( P_{\mathrm{CMAX}} \) is determined for the \( N_{\mathrm{Tx}, \mathrm{PSFCH}} \) PSFCH transmissions according to [8-1, TS 38.101-1].
16.2.4 Prioritization of transmissions/receptions
16.2.4.1 Simultaneous NR and E-UTRA transmission/reception

If a UE

ETSI


--- Page 215  ---


3GPP TS 38.213 version 17.1.0 Release 17
214
ETSI TS 138213 V17.1.0 (2022-05)
- would transmit a first channel/signal using E-UTRA radio access and second channels/signals using NR radio access, and
- a transmission of the first channel/signal would overlap in time with a transmission of the second channels/signals, and
- the priorities of the channels/signals are known to both E-UTRA radio access and NR radio access at the UE \( T \) msec prior to the start of the earliest of the two transmissions, where \( T \leq 4 \) and is based on UE implementation,
the UE transmits only the channels/signals of the radio access technology with the highest priority
- as determined by the SCI formats scheduling the transmissions, or
- as indicated by higher layers in case of a S-SS/PSBCH block or a sidelink synchronization signal using E-UTRA radio access, or
- as determined in clause 16.2.4.2 in case of PSFCH transmissions.

If a UE
- would respectively transmit or receive a first channel/signal using E-UTRA radio access and receive a second channel/signal or transmit second channels/signals using NR radio access, and
- a transmission or reception of the first channel/signal would respectively overlap in time with a reception of the second channel/signal or transmission of the second channels/signals, and
- the priorities of the channels/signals are known to both E-UTRA radio access and NR radio access at the UE \( T \) msec prior to the start of the earliest transmission or reception, where \( T \leq 4 \) and is based on UE implementation,
the UE transmits or receives the channels/signals of the radio access technology with the highest priority
- as determined by the SCI formats scheduling the transmissions, or
- as indicated by higher layers in case of a S-SS/PSBCH block or a sidelink synchronization signal using E-UTRA radio access, or
- as determined in clause 16.2.4.2 among PSFCH transmissions/receptions.
16.2.4.2 Simultaneous PSFCH transmission/reception

For a PSFCH transmission or reception with HARQ-ACK information, a priority value for the PSFCH is equal to the priority value indicated by an SCI format 1-A associated with the PSFCH.

For PSFCH transmission with conflict information, a priority value for the PSFCH is equal to the smallest priority value determined by the corresponding SCI formats \( 1-\mathrm{A} \) for the conflicting resources.

For PSFCH reception with conflict information, a priority value for the PSFCH is equal to the priority value determined by the corresponding SCI format \( 1-\mathrm{A} \) for the conflicting resource.

If a UE
- would transmit \( N_{\text {sch, Tx, PSFCH }} \) PSFCHs and receive \( N_{\text {sch, Rx, PSFCH }} \) PSFCHs, and
- transmissions of the \( N_{\text {sch, Tx, PSFCH }} \) PSFCHs would overlap in time with receptions of the \( N_{\text {sch, Rx, PSFCH }} \) PSFCHs
the UE transmits or receives only a set of PSFCHs corresponding to the smallest priority field value, as determined by a first set of SCI format 1-A and/or a second set of SCI format 1-A [5, TS 38.212] that are respectively associated with PSFCHs with HARQ-ACK information from the \( N_{\text {sch, Tx, PSFCH }} \) PSFCHs and PSFCHs with HARQ-ACK information from the \( N_{\text {sch, } \mathrm{Rx}_{1} \text { PSFCH }} \) PSFCHs when one or more of the PSFCHs provide HARQ-ACK information. If none of the \( N_{\text {sch, Tx, PSFCH }} \) PSFCHs and none of the \( N_{\text {sch, Rx, PSFCH }} \) PSFCHs provide HARQ-ACK information, the UE transmits or receives only a set of PSFCHs corresponding to the smallest priority value of the first set of PSFCHs and the second set of PSFCHs that are respectively associated with the \( N_{\text {sch, Tx, PSFCH }} \) PSFCHs and the \( N_{\text {sch, Rx, PSFCH }} \) PSFCHs when the PSFCHs provide conflict information...

ETSI


--- Page 216  ---


3GPP TS 38.213 version 17.1.0 Release 17
215
ETSI TS 138213 V17.1.0 (2022-05)

If a UE would transmit \( N_{\text {sch, Tx, PSFCH }} \) PSFCHs in a PSFCH transmission occasion, the UE first transmits PSFCHs with HARQ-ACK information from \( N_{\text {Tx }, \text { PSF CH }} \) PSFCHs corresponding to the smallest priority field values from the \( N_{\text {Tx PSFCH }} \) priority field values. Subsequently, the UE transmits remaining PSFCHs with conflict information corresponding to the smallest remaining priority field values from the \( N_{\mathrm{Tx}, \mathrm{PSFCH}} \) priority field values, if any.

If a UE indicates a capability to receive \( N_{\mathrm{Rx}, \mathrm{PSFCH}} \mathrm{PSFCHs} \) in a PSFCH reception occasion [18, TS 38.306], the UE first receives PSFCHs with HARQ-ACK information, if any, and subsequently receives PSFCHs with conflict information, if any.
16.2.4.3 Simultaneous SL and UL transmissions/receptions

If a UE
- would simultaneously transmit on the UL and on the SL in a carrier or in two respective carriers, and
- the UE is not capable of simultaneous transmissions on the UL and on the SL in the carrier or in the two respective carriers
the UE transmits only on the link, UL or SL, with the higher priority.
If a UE
- would simultaneously transmit on the UL and receive on the SL in a carrier, or
- would simultaneously transmit on the UL and receive on the SL in two respective carriers and the UE is not capable of simultaneous transmission on the UL and reception on the SL in the two respective carriers
the UE transmits on UL or receives on SL, with the higher priority.
If a UE
- is capable of simultaneous transmissions on the UL and on the SL in two respective carriers,
- would transmit on the UL and on the SL in the two respective carriers,
- the transmission on the UL would overlap with the transmission on the SL over a time period, and
- the total UE transmission power over the time period would exceed \( P_{\text {CMAX }} \)
the UE
- reduces the power for the UL transmission prior to the start of the UL transmission, if the SL transmission has higher priority than the UL transmission as determined in clause 16.2.4.3.1, so that the total UE transmission power would not exceed \( P_{\text {CMAX }} \)
- reduces the power for the SL transmission prior to the start of the SL transmission, if the UL transmission has higher priority than the SL transmission as determined in clause 16.2.4.3.1, so that the total UE transmission power would not exceed \( P_{\text {CMAX }} \)
16.2.4.3.1 Prioritizations for sidelink and uplink transmissions/receptions

A UE performs prioritization between SL transmissions/receptions and UL transmissions after performing the procedures described in clause 9, clause 9.2.5, and clause 9.2.6, and in clause 6.1 of [6, TS 38.214].

PSFCH transmissions in a slot, as determined in clause 16.2.4.2, have a same priority value as the smallest priority value among PSSCH receptions with corresponding HARQ-ACK information provided by the PSFCH transmissions in the slot, if any, and among PSFCH transmissions with conflict information in the slot, if any, where each priority value is equal to the smallest priority value determined by corresponding SCI formats \( 1-\mathrm{A} \) as described in clause 16.3.

PSFCH receptions in a slot, as determined in clause 16.2.4.2, have a same priority value as the smallest priority value among PSSCH transmissions with corresponding HARQ-ACK information provided by the PSFCH receptions in the slot, if any, and among PSFCH receptions with conflict information in the slot, if any, where each priority value is equal to the priority value determined by corresponding SCI format 1-A as described in clause 16.3.

A priority of S-SS/PSBCH block transmission or reception is provided by sl-SSB-PriorityNR.

ETSI


--- Page 217  ---


3GPP TS 38.213 version 17.1.0 Release 17
216
ETSI TS 138213 V17.1.0 (2022-05)

For prioritization between SL transmission or PSFCH/S-SS/PSBCH block reception and UL transmission other than a PRACH, or a PUSCH scheduled by an UL grant in a RAR and its retransmission, or a PUSCH corresponding to Type-2 random access procedure and its retransmission, or a PUCCH with sidelink HARQ-ACK information report
- if the UL transmission is for a PUSCH or for a PUCCH with priority index 1,
- if sl-PriorityThreshold-UL-URLLC is provided
- the SL transmission or reception has higher priority than the UL transmission if the priority value of the SL transmission or reception is smaller than sl-PriorityThreshold-UL-URLLC; otherwise, the UL transmission has higher priority than the SL transmission or reception
- else
- the UL transmission has higher priority than the SL transmission or reception
- else
- the SL transmission or reception has higher priority than the UL transmission if the priority value of the SL transmission(s) or reception is smaller than sl-PriorityThreshold; otherwise, the UL transmission has higher priority than the SL transmission or reception

A PRACH transmission, or a PUSCH scheduled by an UL grant in a RAR and its retransmission, or a PUSCH for Type-2 random access procedure and its retransmission, or a PUCCH with HARQ-ACK information in response to successRAR, or a PUCCH indicated by a DCI format \( 1 \_0 \) with CRC scrambled by a corresponding TC-RNTI has higher priority than a SL transmission or reception.

A PUCCH transmission with a sidelink HARQ-ACK information report has higher priority than a SL transmission if a priority value of the PUCCH is smaller than a priority value of the SL transmission. The priority value of the PUCCH transmission is as described in clause 16.5. If the priority value of the PUCCH transmission is larger than the priority value of the SL transmission, the SL transmission has higher priority.

A PUCCH transmission with a sidelink HARQ-ACK information report has higher priority than a PSFCH/SSS/PSBCH block reception if a priority value of the PUCCH is smaller than a priority value of the SL reception. If the priority value of the PUCCH transmission is larger than the priority value of the PSFCH/S-SS/PSBCH block reception, the SL reception has higher priority.

When one or more SL transmissions from a UE overlap in time with multiple non-overlapping UL transmissions from the UE, the UE performs the SL transmissions if at least one SL transmission is prioritized over all UL transmissions subject to the UE processing timeline with respect to the first SL transmission and the first UL transmission.

When one or more UL transmissions from a UE overlap in time with multiple non-overlapping SL transmissions, the UE performs the UL transmissions if at least one UL transmission is prioritized over all SL transmissions subject to the UE processing timeline with respect to the first SL transmission and the first UL transmission.

When one SL transmission overlaps in time with one or more overlapping UL transmissions, the UE performs the SL transmission if the SL transmission is prioritized over all UL transmissions subject to both the UE multiplexing and processing timelines with respect to the first SL transmission and the first UL transmission, where the UE processing timeline with respect to the first SL transmission and the first UL transmission is same as when one or more SL transmissions overlap in time with multiple non-overlapping UL transmissions.

When one SL transmission overlaps in time with one or more overlapping UL transmissions, the UE performs the UL transmission if at least one UL transmission is prioritized over the SL transmission subject to both the UE multiplexing and processing timelines with respect to the first SL transmission and the first UL transmission, where the UE processing timeline with respect to the first SL transmission and the first UL transmission is same as when one or more SL transmissions overlap in time with multiple non-overlapping UL transmissions.
16.3 UE procedure for reporting and obtaining control information in PSFCH

Control information provided by a PSFCH transmission includes HARQ-ACK information or conflict information.

ETSI


--- Page 218  ---


3GPP TS 38.213 version 17.1.0 Release 17
217
ETSI TS 138213 V17.1.0 (2022-05)
16.3.0 UE procedure for transmitting PSFCH with control information

A UE can be indicated by an SCI format scheduling a PSSCH reception to transmit a PSFCH with HARQ-ACK information in response to the PSSCH reception. The UE provides HARQ-ACK information that includes ACK or NACK, or only NACK.

A UE can be provided, by \( s l-P S F C H-P e r i o d \), a number of slots in a resource pool for a period of PSFCH transmission occasion resources. If the number is zero, PSFCH transmissions from the UE in the resource pool are disabled.

A UE can be enabled, by inter-UECoordinationScheme2, to transmit a PSFCH with conflict information in a resource pool. The UE can determine, based on an indication by a SCI format 1-A, a set of resources that includes one or more slots and resource blocks that are reserved for PSSCH transmission. If the UE determines a conflict for a reserved resource for PSSCH transmission, the UE provides conflict information in a PSFCH.

A UE expects that a slot \( t^{\prime}{ }_{k}\left(0 \leq k<T^{\prime}{ }_{\max }\right) \) has a PSFCH transmission occasion resource if \( k \bmod N_{\mathrm{PSSCH}}^{\mathrm{PSFCH}}=0 \), where \( t^{\prime S L}{ }_{k} \) is defined in [6, TS 38.214], and \( T^{\prime}{ }_{\text {max }} \) is a number of slots that belong to the resource pool within 10240 msec according to [6, TS 38.214], and \( N_{\text {PSSCH }}^{\text {PSFC }} \) is provided by sl-PSFCH-Period.

A UE may be indicated by higher layers to not transmit a PSFCH that includes HARQ-ACK information in response to a PSSCH reception [11, TS 38.321].

If a UE receives a PSSCH in a resource pool and the HARQ feedback enabled/disabled indicator field in an associated SCI format 2-A/2-B/2-C has value 1 [5, TS 38.212], the UE provides the HARQ-ACK information in a PSFCH transmission in the resource pool. The UE transmits the PSFCH in a first slot that includes PSFCH resources and is at least a number of slots, provided by sl-MinTimeGapPSFCH, of the resource pool after a last slot of the PSSCH reception.

A UE is provided by \( s l-P S F C H-R B \)-Set a set of \( M_{\mathrm{PRB}}^{\mathrm{PSEC}} \) set PRBs in a resource pool for PSFCH transmission with HARQACK information in a PRB of the resource pool. A UE can be provided by sl-PSFCH-Conflict-RB-Set a set of \( M_{\mathrm{PRB}}^{\mathrm{PSFCH}} \) set PRBs in a resource pool for PSFCH transmission with conflict information in a PRB of the resource pool. A UE expects that different PRBs are (pre)configured for conflict information and HARQ-ACK information. For a number of \( N_{\text {subch }} \) sub-channels for the resource pool, provided by sl-NumSubchannel, and a number of PSSCH slots associated with a PSFCH slot that is less than or equal to \( N_{\mathrm{PSSCH}}^{\mathrm{PSFCH}} \), the UE allocates the \( \left[\left(i+j \cdot N_{\mathrm{PSSCH}}^{\mathrm{PSFCH}}\right) \cdot M_{\mathrm{subch}, \mathrm{slot}}^{\mathrm{PSFCH}},\left(i+1+j \cdot N_{\mathrm{PSSCH}}^{\mathrm{PSFCH}}\right)\right. \). \( \left.M_{\text {subch, slot }}^{\text {PSFC }}-1\right] \) PRBs from the \( M_{\text {PRB, set }}^{\text {PSECH }} \) PRBs to slot \( i \) among the PSSCH slots associated with the PSFCH slot and subchannel \( j \), where \( M_{\text {subch, slot }}^{\mathrm{PSFCH}}=M_{\mathrm{PRB}, \mathrm{set}}^{\mathrm{PSFCH}} /\left(N_{\text {subch }} \cdot N_{\mathrm{PSSCH}}^{\mathrm{PSFCH}}\right), 0 \leq i<N_{\mathrm{PSSCH}}^{\mathrm{PSFCH}}, 0 \leq j<N_{\text {subch }} \), and the allocation starts in an ascending order of \( i \) and continues in an ascending order of \( j \). The UE expects that \( M_{\text {PRB }}^{\text {PSEt }} \) is a multiple of \( N_{\text {subch }} \). \( N_{\text {PSSCH }}^{\text {PSFCH }} \).

The second OFDM symbol \( l^{\prime} \) of PSFCH transmission in a slot is defined as \( l^{\prime}=s l \)-StartSymbol + sl-LengthSymbols -2 .

A UE determines a number of PSFCH resources available for multiplexing HARQ-ACK or conflict information in a PSFCH transmission as \( R_{\text {PRB, CS }}^{\text {PSFCH }}=N_{\text {type }}^{\text {PSFCH }} \cdot M_{\text {subch, slot }}^{\text {PSFCH }} \cdot N_{\text {CS }}^{\text {PSFCH }} \) where \( N_{\text {CS }}^{\text {PSFCH }} \) is a number of cyclic shift pairs for the resource pool provided by sl-NumMuxCS-Pair and, based on an indication by sl-PSFCH-CandidateResourceType,
- if sl-PSFCH-CandidateResourceType is configured as startSubCH, \( N_{\mathrm{type}}^{\mathrm{PSFCH}}=1 \) and the \( M_{\mathrm{subch}, \mathrm{slot}}^{\mathrm{PSFCH}} \) PRBs are associated with the starting sub-channel of the corresponding PSSCH
- if sl-PSFCH-CandidateResourceType is configured as allocSubCH, \( N_{\text {type }}^{\text {PSFCH }}=N_{\text {subch }}^{\text {PSSCH }} \) and the \( N_{\text {subch }}^{\text {PSSCH }} \cdot M_{\text {subch }, \text { slot }}^{\text {PSFCH }} \) PRBs are associated with the \( N_{\text {subch }}^{\text {PSSCH }} \) sub-channels of the corresponding PSSCH
- for conflict information, the corresponding PSSCH is determined based on PSFCHOccasionScheme2

The PSFCH resources are first indexed according to an ascending order of the PRB index, from the \( N_{\text {type }}^{\text {PSFCH }} \cdot M_{\text {subch, slot }}^{\text {PSFCH }} \) PRBs, and then according to an ascending order of the cyclic shift pair index from the \( N_{\mathrm{CS}}^{\mathrm{PSFCH}} \) cyclic shift pairs.

A UE determines an index of a PSFCH resource for a PSFCH transmission with HARQ-ACK information in response to a PSSCH reception or with conflict information corresponding to a reserved resource as ( \( \left.P_{\mathrm{ID}}+M_{\mathrm{ID}}\right) \bmod R_{\mathrm{PRB}, \mathrm{CS}}^{\mathrm{PSFCH}} \) where \( P_{\mathrm{ID}} \) is a physical layer source ID provided by SCI format 2-A/2-B/2-C [5, TS 38.212] scheduling the PSSCH reception, or by SCI format \( 2-\mathrm{A} / 2-\mathrm{B} / 2-\mathrm{C} \) with corresponding SCI format \( 1-\mathrm{A} \) reserving the resource from another UE to be provided with the conflict information. For HARQ-ACK information, \( M_{\mathrm{ID}} \) is the identity of the UE receiving the

ETSI


--- Page 219  ---


3GPP TS 38.213 version 17.1.0 Release 17
218
ETSI TS 138213 V17.1.0 (2022-05)

PSSCH as indicated by higher layers if the UE detects a SCI format 2-A with Cast type indicator field value of " 01 "; otherwise, \( M_{\mathrm{ID}} \) is zero. For conflict information, \( M_{\mathrm{ID}} \) is zero.

For a PSFCH transmission with HARQ-ACK information or conflict information, a UE determines a \( m_{0} \) value, for computing a value of cyclic shift \( \alpha \) [4, TS 38.211], from a cyclic shift pair index corresponding to a PSFCH resource index and from \( N_{\mathrm{CS}}^{\mathrm{PSFCH}} \) using Table 16.3-1.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 16.3-1: Set of cyclic shift pairs}
\begin{tabular}{|l|l|l|l|l|l|l|}
\hline \multirow{2}{*}{\( \boldsymbol{N}_{\text {CS }}^{\text {PSFCH }} \)} & \multicolumn{6}{|c|}{\( \boldsymbol{m}_{\mathbf{0}} \)} \\
\hline & Cyclic Shift Pair Index 0 & Cyclic Shift Pair Index 1 & Cyclic Shift Pair Index 2 & Cyclic Shift Pair Index 3 & Cyclic Shift Pair Index 4 & Cyclic Shift Pair Index 5 \\
\hline 1 & 0 & - & - & - & - & - \\
\hline 2 & 0 & 3 & - & - & - & - \\
\hline 3 & 0 & 2 & 4 & - & - & - \\
\hline 6 & 0 & 1 & 2 & 3 & 4 & 5 \\
\hline
\end{tabular}
\end{table}

For a PSFCH transmission with HARQ-ACK information, a UE determines a \( m_{\mathrm{cs}} \) value, for computing a value of cyclic shift \( \alpha \) [4, TS 38.211], as in Table 16.3-2 if the UE detects a SCI format 2-A with Cast type indicator field value of " 01 " or " 10 " or a SCI format 2-C, or as in Table 16.3-3 if the UE detects a SCI format 2-B or a SCI format 2-A with Cast type indicator field value of " 11 ". For a PSFCH transmission with conflict information, a UE determines a \( m_{\mathrm{cs}} \) value for computing a value of cyclic shift \( \alpha \) [4, TS 38.211] as in Table 16.3-4. The UE applies one cyclic shift from a cyclic shift pair to a sequence used for the PSFCH transmission [4, TS 38.211].

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 16.3-2: Mapping of HARQ-ACK information bit values to a cyclic shift, from a cyclic shift pair, of a sequence for a PSFCH transmission when HARQ-ACK information includes ACK or NACK}
\begin{tabular}{|c|c|c|}
\hline HARQ-ACK Value & \( \mathbf{0} \) (NACK) & \( \mathbf{1} \) (ACK) \\
\hline Sequence cyclic shift & 0 & 6 \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 16.3-3: Mapping of HARQ-ACK information bit values to a cyclic shift, from a cyclic shift pair, of a sequence for a PSFCH transmission when HARQ-ACK information includes only NACK}
\begin{tabular}{|c|c|c|}
\hline HARQ-ACK Value & \( \mathbf{0} \) (NACK) & \( \mathbf{1} \) (ACK) \\
\hline Sequence cyclic shift & 0 & N/A \\
\hline
\end{tabular}
\end{table}

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 16.3-4: Mapping of conflict information bit values to a cyclic shift, from a cyclic shift pair, of a sequence for a PSFCH transmission}
\begin{tabular}{|c|c|}
\hline Conflict information & Conflict information for a next in time reserved resource indicated in SCI \\
\hline Sequence cyclic shift & 0 \\
\hline
\end{tabular}
\end{table}

A first UE determines a second UE for providing the conflict information to in a PSFCH as follows
- if the first UE is an intended receiver of the second UE for a reserved resource of a PSSCH transmission in a slot,
- does not expect to perform reception on the sidelink due to half-duplex operation in the slot, and
- determines to transmit to the second UE the PSFCH with the conflict information.

A first UE determines a UE for providing the conflict information to in a PSFCH as follows

ETSI


--- Page 220  ---


3GPP TS 38.213 version 17.1.0 Release 17
219
ETSI TS 138213 V17.1.0 (2022-05)
- if, for a resource pool, typeAUEScheme 2 is disabled, the first UE has been indicated a first reserved resource and a second reserved resource as resources for PSSCH reception or, if for a resource pool typeAUEScheme 2 is enabled, has been indicated at least the first reserved resource or the second reserved resource for PSSCH reception,
- detects a first SCI format 1 - A that includes a first priority value, \( p_{1} \), and the first reserved resource for PSSCH transmission from a second UE,
- detects a second SCI format 1 -A that includes a second priority value, \( p_{2}<p_{1} \), and the second reserved resource for PSSCH transmission from a third UE, and
- determines that the first and second resources overlap in time and frequency
- the PSFCH occasions for resource conflict information of the second UE and the third UE are valid
- the indicationUEB flag in SCI Format 1-A from the second UE and the third UE is set to 1 , if indicationUEBScheme2 = 'enabled'
- determines the first SCI format 1 - A and the second SCI format 1 - A are not received later than \( s / \) MinTimeGapPSFCH before the PSFCH occasion for conflict information
- determines to transmit to the second UE the PSFCH with the conflict information
- determines to transmit to either the second UE or the third UE the PSFCH with the conflict information, if \( p_{2}= p_{1} \)

The first UE can be provided conditions by optionForCondition2A1Scheme2 to determine conflict of reserved resources in a resource pool
- if optionForCondition2A1Scheme2 = 'RSRP-ThresPerPriorities', the first UE can be provided by, ThresPSSCH-RSRP-List \( T h\left(p_{i}, p_{j}\right) \), a list of RSRP thresholds for each priority combination \( \left(p_{i}, p_{j}\right)[6 \), TS 38.214]
- if the first UE is an intended receiver for PSSCH in a reserved resource of the second UE, the first UE determines a resource conflict if the \( \operatorname{RSRP}[6, \operatorname{TS} 38.214] \) of the third UE is above a threshold \( \operatorname{Th}\left(p_{2}, p_{1}\right) \)
- if the first UE is an intended receiver for PSSCH in a reserved resource of the third UE, the first UE determines a resource conflict if the RSRP of the second UE is above a threshold \( \operatorname{Th}\left(p_{1}, p_{2}\right) \)
- if optionForCondition2A1Scheme2 = 'RSRP-ThresWithRsrpMeasurement', the first UE can be provided a value Delta_Th by deltaRSRPThresh
- if the first UE is an intended receiver for PSSCH in a reserved resource of the second UE, the first UE determines a resource conflict if \( R S R P_{2}>R S R P_{1}+ \) Delta_Th, where \( R S R P_{1} \) and \( R S R P_{2} \) are the RSRP measurements from the first UE for the second UE and the third UE, respectively
- if the first UE is an intended receiver for PSSCH in a reserved resource of the third UE, the first UE determines a resource conflict if \( R S R P_{1}>R S R P_{2}+ \) Delta_Th

If a UE transmits a PSFCH with conflict information corresponding to a reserved resource indicated in an SCI format 1A, the UE transmits the PSFCH in the resource pool in a slot determined based on PSFCHOccasionScheme 2
- If PSFCHOccasionScheme2 = 'followSCI', the UE transmits the PSFCH in a first slot that includes PSFCH resources and is at least a number of slots, provided by s/-MinTimeGapPSFCH, of the resource pool after a slot of a PSCCH reception that provides the SCI format 1-A. The PSFCH resource is in a slot that is at least \( T_{3} \) slots [6, TS 38.214] before the resource associated with the conflict information; otherwise, the UE does not transmit the PSFCH with conflict information.
- If PSFCHOccasionScheme2 = 'follow ReservedResource', the UE transmits the PSFCH in a latest slot that includes PSFCH resources and is at least \( T_{3} \) slots before a slot of the resource associated with conflict information. The PSFCH resource is in a slot that is at least s/-MinTimeGapPSFCH slots after a slot of a PSCCH reception that provides the SCI format 1-A; otherwise, the UE does not transmit the PSFCH with conflict information.

ETSI


--- Page 221  ---


3GPP TS 38.213 version 17.1.0 Release 17
220
ETSI TS 138213 V17.1.0 (2022-05)
16.3.1 UE procedure for receiving PSFCH with control information

A UE that transmitted a PSSCH scheduled by a SCI format 2-A/2-B/2-C that indicates HARQ feedback enabled, attempts to receive associated PSFCHs with HARQ-ACK information according to PSFCH resources determined as described in clause 16.3.0. The UE determines an ACK or a NACK value for HARQ-ACK information provided in each PSFCH resource as described in [8-4, TS 38.101-4]. The UE does not determine both an ACK value and a NACK value at a same time for a PSFCH resource.

For each PSFCH reception occasion, from a number of PSFCH reception occasions, the UE generates HARQ-ACK information to report to higher layers. For generating the HARQ-ACK information, the UE can be indicated by a SCI format to perform one of the following
- if the UE receives a PSFCH associated with a SCI format 2-A with Cast type indicator field value of "10" or a SCI format 2-C
- report to higher layers HARQ-ACK information with same value as a value of HARQ-ACK information that the UE determines from the PSFCH reception
- if the UE receives a PSFCH associated with a SCI format 2-A with Cast type indicator field value of " 01 "
- report an ACK value to higher layers if the UE determines an ACK value from at least one PSFCH reception occasion from the number of PSFCH reception occasions in PSFCH resources corresponding to every identity \( M_{\mathrm{ID}} \) of UEs that the UE expects to receive corresponding PSSCHs as described in clause 16.3; otherwise, report a NACK value to higher layers
- if the PSFCH reception occasion is associated with a SCI format 2-B or a SCI format 2-A with Cast type indicator field value of "11"
- report to higher layers an ACK value if the UE determines absence of PSFCH reception for the PSFCH reception occasion; otherwise, report a NACK value to higher layers

A UE that transmitted SCI format \( 1-\mathrm{A} \), indicating one or more reserved resources in a resource pool enabled by interUECoordinationScheme2, attempts to receive associated PSFCH with conflict information in a resource pool with PSFCH resources that the UE determines as described in clause 16.3.0. If the UE determines presence of a resource conflict based on conflict information in a PSFCH reception, the UE reports the resource conflict to higher layers
- if slotLevelResourceExclusionScheme2 is not provided, the UE reports resources overlapping with a next in time reserved resource indicated by the SCI format \( 1-\mathrm{A} \)
- if slotLevelResourceExclusionScheme2 is provided, the UE reports resources in a slot of a next in time reserved resource indicated by the SCI format 1-A

If a UE receives a PSFCH with conflict information corresponding to a reserved resource indicated in an SCI format 1A, the UE receives the PSFCH in the resource pool in a slot determined based on PSFCHOccasionScheme2
- If PSFCHOccasionScheme2 = 'followSCI', the UE receives the PSFCH in a first slot that includes PSFCH resources and is at least a number of slots, provided by sl-MinTimeGapPSFCH, of the resource pool after a slot of a PSCCH transmission that provides the SCI format 1-A. The PSFCH resource is in a slot that is at least \( T_{3} \) slots [6, TS 38.214] before the resource associated with the conflict information; otherwise, the UE does not receive the PSFCH with conflict information
- If PSFCHOccasionScheme2 = 'follow ReservedResource', the UE receives the PSFCH in a latest slot that includes PSFCH resources and is at least \( T_{3} \) slots before a slot of the resource associated with conflict information. The PSFCH resource is in a slot that is at least s/-MinTimeGapPSFCH slots after a slot of a PSCCH transmission that provides the SCI format 1-A; otherwise, the UE does not receive the PSFCH with conflict information
16.4 UE procedure for transmitting PSCCH

A UE can be provided a number of symbols in a resource pool, by sl-TimeResourcePSCCH, starting from a second symbol that is available for SL transmissions in a slot, and a number of PRBs in the resource pool, by slFreqResourcePSCCH, starting from the lowest PRB of the lowest sub-channel of the associated PSSCH, for a PSCCH transmission with a SCI format 1-A.

ETSI


--- Page 222  ---


3GPP TS 38.213 version 17.1.0 Release 17
221
ETSI TS 138213 V17.1.0 (2022-05)

A UE that transmits a PSCCH with SCI format 1-A using sidelink resource allocation mode 2 [6, TS 38.214] sets
- "Resource reservation period" as an index in sl-ResourceReservePeriodList corresponding to a reservation period provided by higher layers [11, TS 38.321], if the UE is provided sl-MultiReserveResource
- the values of the frequency resource assignment field and the time resource assignment field as described in [6, TS 38.214] to indicate \( N \) resources from a set \( \left\{R_{\mathrm{y}}\right\} \) of resources selected by higher layers as described in [11, TS 38.321] with \( N \) smallest slot indices \( y_{i} \) for \( 0 \leq i \leq N-1 \) such that \( y_{0}<y_{1}<\cdots<y_{N-1} \leq y_{0}+31 \), where:
- \( \quad N=\min \left(N_{\text {selected }}, N_{\text {max_reserve }}\right) \), where \( N_{\text {selected }} \) is a number of resources in the set \( \left\{R_{\mathrm{y}}\right\} \) with slot indices \( y_{j}, 0 \leq j \leq N_{\text {selected }}-1 \), such that \( y_{0}<y_{1}<\cdots<y_{N_{\text {selected }}-1} \leq y_{0}+31 \), and \( N_{\text {max_reserve }} \) is provided by sl-MaxNumPerReserve
- each resource, from the set of \( \left\{R_{\mathrm{y}}\right\} \) resources, corresponds to \( L_{\text {subcH }} \) contiguous sub-channels and a slot in a set of slots \( \left\{t_{y}^{\prime S L}\right\} \), where \( L_{\text {subCH }} \) is the number of sub-channels available for PSSCH/PSCCH transmission in a slot
- \( \left(t_{0}^{S L}, t_{1}^{S L}, t_{2}^{S L}, \ldots\right) \) is a set of slots in a sidelink resource pool \( [6 \), TS 38.214]
- \( y_{0} \) is an index of a slot where the PSCCH with SCI format \( 1-\mathrm{A} \) is transmitted.

A UE that transmits a PSCCH with SCI format 1-A using sidelink resource allocation mode 1 [6, TS 38.214] sets
- the values of the frequency resource assignment field and the time resource assignment field for the SCI format 1-A transmitted in the \( m \)-th resource for PSCCH/PSSCH transmission provided by a dynamic grant or by a SL configured grant, where \( m=\{1, \ldots, M\} \) and M is the total number of resources for \( \mathrm{PSCCH} / \mathrm{PSSCH} \) transmission provided by a dynamic grant or the number of resources for PSCCH/PSSCH transmission in a period provided by a SL configured grant type 1 or SL configured grant type 2, as follows:
- the frequency resource assignment field and time resource assignment field indicate the \( m \)-th to \( M \)-th resources as described in [6, TS 38.214].

For decoding of a SCI format 1 -A, a UE may assume that a number of bits provided by sl-NumReservedBits can have any value.
16.5 UE procedure for reporting HARQ-ACK on uplink

A UE can be provided PUCCH resources or PUSCH resources [12, TS 38.331] to report HARQ-ACK information that the UE generates based on HARQ-ACK information that the UE obtains from PSFCH receptions, or from absence of PSFCH receptions. The UE reports HARQ-ACK information on the primary cell of the PUCCH group, as described in clause 9, of the cell where the UE monitors PDCCH for detection of DCI format 3_0.

For SL configured grant Type 1 or Type 2 PSSCH transmissions by a UE within a time period provided by slPeriodCG, the UE generates one HARQ-ACK information bit in response to the PSFCH receptions to multiplex in a PUCCH transmission occasion that is after a last time resource, in a set of time resources.

For PSSCH transmissions scheduled by a DCI format 3_0, a UE generates HARQ-ACK information in response to PSFCH receptions to multiplex in a PUCCH transmission occasion that is after a last time resource in a set of time resources provided by the DCI format \( 3 \_0 \).

From a number of PSFCH reception occasions, the UE generates HARQ-ACK information to report in a PUCCH or PUSCH transmission. The UE can be indicated by a SCI format to perform one of the following and the UE constructs a HARQ-ACK codeword with HARQ-ACK information, when applicable
- for one or more PSFCH reception occasions associated with SCI format 2-A with Cast type indicator field value of " 10 "
- generate HARQ-ACK information with same value as a value of HARQ-ACK information the UE determines from the last PSFCH reception from the number of PSFCH reception occasions corresponding to PSSCH transmissions or, if the UE determines that a PSFCH is not received at the last PSFCH reception occasion and ACK is not received in any of previous PSFCH reception occasions, generate NACK

ETSI


--- Page 223  ---


3GPP TS 38.213 version 17.1.0 Release 17
222
ETSI TS 138213 V17.1.0 (2022-05)
- for one or more PSFCH reception occasions associated with SCI format 2-A with Cast type indicator field value of "01"
- generate ACK if the UE determines ACK from at least one PSFCH reception occasion, from the number of PSFCH reception occasions corresponding to PSSCH transmissions, in PSFCH resources corresponding to every identity \( M_{\text {ID }} \) of the UEs that the UE expects to receive the PSSCH, as described in clause 16.3; otherwise, generate NACK
- for one or more PSFCH reception occasions associated with SCI format 2-B or SCI format 2-A with Cast type indicator field value of " 11 "
- generate ACK when the UE determines absence of PSFCH reception for the last PSFCH reception occasion from the number of PSFCH reception occasions corresponding to PSSCH transmissions; otherwise, generate NACK

After a UE transmits PSSCHs and receives PSFCHs in corresponding PSFCH resource occasions, the priority value of HARQ-ACK information is same as the priority value of the PSSCH transmissions that is associated with the PSFCH reception occasions providing the HARQ-ACK information.

The UE generates a NACK when, due to prioritization, as described in clause 16.2.4, the UE does not receive PSFCH in any PSFCH reception occasion associated with a PSSCH transmission in a resource provided by a DCI format \( 3-0 \) or, for a configured grant, in a resource provided in a single period and for which the UE is provided a PUCCH resource to report HARQ-ACK information. The priority value of the NACK is same as the priority value of the PSSCH transmission.

The UE generates a NACK when, due to prioritization as described in clause 16.2.4, the UE does not transmit a PSSCH in any of the resources provided by a DCI format 3.0 or, for a configured grant, in any of the resources provided in a single period and for which the UE is provided a PUCCH resource to report HARQ-ACK information. The priority value of the NACK is same as the priority value of the PSSCH that was not transmitted due to prioritization.

The UE generates an ACK if the UE does not transmit a PSCCH with a SCI format 1-A scheduling a PSSCH in any of the resources provided by a configured grant in a single period and for which the UE is provided a PUCCH resource to report HARQ-ACK information. The priority value of the ACK is same as the largest priority value among the possible priority values for the configured grant.

The UE generates an ACK if the UE does not transmit a PSCCH with a SCI format 1-A scheduling a PSSCH in any of the resources provided by a DCI format \( 3 \_0 \) and for which the UE is provided a PUCCH resource to report HARQACK information. The priority value of the ACK is same as the largest priority value among the possible priority values for the dynamic grant.

For reporting HARQ-ACK information on uplink corresponding to one or multiple PSSCH transmissions with a corresponding SCI format with the field 'HARQ feedback enabled/disabled indicator' set to disabled, the UE generates HARQ-ACK information with the contents instructed by higher layer. The priority value of the HARQ-ACK information is same as the priority value of the PSSCH transmission.

A UE does not expect to be provided PUCCH resources or PUSCH resources to report HARQ-ACK information that start earlier than \( T_{\text {prep }}=(N+1) \cdot(2048+144) \cdot \kappa \cdot 2^{-\mu} \cdot T_{c} \) after the end of a last symbol of a last PSFCH reception occasion, from a number of PSFCH reception occasions that the UE generates HARQ-ACK information to report in a PUCCH or PUSCH transmission, where
- \( \kappa \) and \( T_{c} \) are defined in [4, TS 38.211]
- \( \mu=\min \left(\mu_{S L}, \mu_{U L}\right) \), where \( \mu_{S L} \) is the SCS configuration of the SLBWP and \( \mu_{U L} \) is the SCS configuration of the active UL BWP on the primary cell
- \( N \) is determined from \( \mu \) according to Table 16.5-1

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 16.5-1: Values of \( N \)}
\begin{tabular}{|c|c|}
\hline \( \boldsymbol{\mu} \) & \( \boldsymbol{N} \) \\
\hline 0 & 14 \\
\hline 1 & 18 \\
\hline 2 & 28 \\
\hline 3 & 32 \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 224  ---


3GPP TS 38.213 version 17.1.0 Release 17
223
ETSI TS 138213 V17.1.0 (2022-05)

For DCI format 3_0, if present, the PSFCH-to-HARQ_feedback timing indicator field values map to values for a set of number of slots provided by sl-PSFCH-ToPUCCH as defined in Table 16.5-2.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 16.5-2: Mapping of PSFCH-to-HARQ_feedback timing indicator field values to numbers of slots}
\begin{tabular}{|l|l|l|l|}
\hline \multicolumn{3}{|l|}{PSFCH-to-HARQ_feedback timing indicator} & Number of slots \( k \) \\
\hline 1 bit & 2 bits & 3 bits & \\
\hline \( 0^{\prime} \) & '00' & '000' & \( 1^{\text {st }} \) value provided by sl-PSFCH-ToPUCCH \\
\hline '1' & '01' & '001' & \( 2^{\text {nd }} \) value provided by sl-PSFCH-ToPUCCH \\
\hline & '10' & '010' & \( 3^{\text {rd }} \) value provided by si-PSFCH-ToPUCCH \\
\hline & '11' & '011' & \( 4{ }^{\text {th }} \) value provided by si-PSFCH-ToPUCCH \\
\hline & & '100' & \( 5^{\text {th }} \) value provided by si-PSFCH-ToPUCCH \\
\hline & & '101' & \( 6{ }^{\text {th }} \) value provided by sl-PSFCH-ToPUCCH \\
\hline & & '110' & \( 7^{\text {th }} \) value provided by si-PSFCH-ToPUCCH \\
\hline & & '111' & \( 8{ }^{\text {th }} \) value provided by sl-PSFCH-ToPUCCH \\
\hline
\end{tabular}
\end{table}

With reference to slots for PUCCH transmissions and for a number of PSFCH reception occasions ending in slot \( n \), the UE provides the generated HARQ-ACK information in a PUCCH transmission within slot \( n+k \), subject to the overlapping conditions in clause 9.2.5, where \( k \) is a number of slots indicated by a PSFCH-to-HARQ_feedback timing indicator field, if present, in a DCI format indicating a slot for PUCCH transmission to report the HARQ-ACK information, or \( k \) is provided by sl-PSFCH-ToPUCCH for a transmission scheduled by a DCI format or for a SL configured grant type 2, or by sl-PSFCH-ToPUCCH-CG-Typel for a SL configured grant type 1. \( k=0 \) corresponds to a last slot for a PUCCH transmission that would overlap with the last PSFCH reception occasion assuming that the start of the sidelink frame is same as the start of the downlink frame [4, TS 38.211].

For a PSSCH transmission by a UE that is scheduled by a DCI format, or for a SL configured grant Type 2 PSSCH transmission activated by a DCI format, the DCI format indicates to the UE that a PUCCH resource is not provided when a value of the PUCCH resource indicator field is zero and a value of PSFCH-to-HARQ feedback timing indicator field, if present, is zero. For a SL configured grant Type 2 PSSCH transmission without a corresponding PDCCH, the DCI format activating the SL configured grant Type 2 indicates to the UE that a PUCCH resource is not provided when a value of the PUCCH resource indicator field is zero and a value of PSFCH-to-HARQ feedback timing indicator field, if present, is zero. For a SL configured grant Type 1 PSSCH transmission, a PUCCH resource can be provided by sl-NIPUCCH-AN and sl-PSFCH-ToPUCCH-CG-Typel. For transmission of HARQ-ACK information corresponding only to a SL configured grant Type 2 PSSCH transmission without a corresponding PDCCH, a UE can be provided a PUCCH resource by sl-NIPUCCH-AN-Type2. If a PUCCH resource is not provided, the UE does not transmit a PUCCH with generated HARQ-ACK information from PSFCH reception occasions.

For a PUCCH transmission with HARQ-ACK information, a UE determines a PUCCH resource after determining a set of PUCCH resources from up to four PUCCH resource sets provided by sl-PUCCH-Config, for \( O_{U C I} \) HARQ-ACK information bits, as described in clause 9.2.1. The PUCCH resource determination is based on a PUCCH resource indicator field [5, TS 38.212] in a last DCI format 3_0, among the DCI formats \( 3 \_0 \) that have a value of a PSFCH-toHARQ_feedback timing indicator field indicating a same slot for the PUCCH transmission, that the UE detects and for which the UE transmits corresponding HARQ-ACK information in the PUCCH where, for PUCCH resource determination, detected DCI formats are indexed in an ascending order across PDCCH monitoring occasion indexes.

The PUCCH resource indicator field values map to values of a set of PUCCH resource indexes, as described in clause 9.2.3.

A UE transmits a PUCCH with HARQ-ACK information using PUCCH format 0 or PUCCH format 1 or PUCCH format 2 or PUCCH format 3 or PUCCH format 4 as described in clause 9.2.3.

A UE does not expect to multiplex HARQ-ACK information for more than one SL configured grants in a same PUCCH.

A priority value of a PUCCH transmission with one or more sidelink HARQ-ACK information bits is the smallest priority value for the one or more HARQ-ACK information bits.

In the following, the CRC for DCI format \( 3 \_0 \) is scrambled with a SL-RNTI or a SL-CS-RNTI.
16.5.1 Type-1 HARQ-ACK codebook determination

This clause applies if the UE is configured with pdsch-HARQ-ACK-Codebook \( = \) semi-static.

ETSI


--- Page 225  ---


3GPP TS 38.213 version 17.1.0 Release 17
224
ETSI TS 138213 V17.1.0 (2022-05)

If a UE is configured a SL configured grant Type 1, and the UE is configured a SL configured grant Type 2 or to monitor PDCCH for detection of DCI format \( 3 \_0 \) with CRC scrambled by SL-RNTI or SL-CS-RNTI, and the UE is provided a set of slot timing values \( K_{1} \) associated with a SL BWP by sl-PSFCH-ToPUCCH and sl-PSFCH-ToPUCCH-CG-Typel, the sl-PSFCH-ToPUCCH-CG-Typel is one of sl-PSFCH-ToPUCCH.
A UE reports HARQ-ACK information for PSSCH transmissions with corresponding PSFCH reception occasions in slot \( n \) only in a HARQ-ACK codebook that the UE includes in a PUCCH or PUSCH transmission in slot \( n+k \), where \( k \) is a number of slots indicated by the PSFCH-to-HARQ_feedback timing indicator field in a DCI format \( 3 \_0 \) scheduling the PSSCH transmissions, or by a value of PSFCH-to-HARQ feedback timing indicator field in a DCI format \( 3-0 \) activating a SL configured grant Type-2 transmission, or by a value of sl-PSFCH-ToPUCCH-CG-Typel for a SL configured grant Type-1. If the UE reports HARQ-ACK information for the PSSCH transmissions with corresponding PSFCH reception occasions in a slot other than slot \( n+k \), the UE sets a value for each corresponding HARQ-ACK information bit to NACK.

If a UE reports HARQ-ACK information in a PUCCH only for
- PSFCH reception occasions associated with PSSCH transmissions scheduled by a DCI format \( 3 \_0 \) with counter SAI field value of 1 , or
- PSFCH reception occasions associated with PSSCH transmissions corresponding to a SL configured grant
within a set \( M_{A} \) of occasions for candidate PSSCH transmissions with corresponding PSFCH reception occasions as determined in clause 16.5.1.1, the UE determines a HARQ-ACK codebook only for the PSFCH reception occasion associated with PSSCH transmissions scheduled by DCI format \( 3 \_0 \) or only for the PSFCH reception occasion associated with PSSCH transmissions corresponding to a SL configured grant according to corresponding set \( M_{A} \) of occasions, where a value of a counter SAI in DCI format \( 3-0 \) is according to Table 16.5.2.1-1. Otherwise, the procedures in clause 16.5.1.1 and in clause 16.5.1.2 for a HARQ-ACK codebook determination apply.
16.5.1.1 Type-1 HARQ-ACK codebook in physical uplink control channel

For a SL BWP on a carrier, and an active UL BWP on the primary cell, as described in clause 12, a UE determines a set \( M_{A} \) of occasions for candidate PSSCH transmissions with corresponding PSFCH reception occasions for which the UE can multiplex corresponding HARQ-ACK information in a PUCCH transmission in slot \( n_{U} \). The determination is based on:
a) a set of slot timing values \( K_{1} \) associated with the SLBWP where \( K_{1} \) is provided by sl-PSFCH-ToPUCCH for DCI format \( 3 \_0 \) or by sl-PSFCH-ToPUCCH-CG-Typel
b) the ratio \( 2^{\mu_{\mathrm{SL}}-\mu_{\mathrm{UL}}} \) between the sidelink SCS configuration \( \mu_{\mathrm{SL}} \) and the uplink SCS configuration \( \mu_{\mathrm{UL}} \) provided by subcarrierSpacing in sl-BWP-Config and BWP-Uplink for the SL BWP and the active UL BWP, respectively
c) a configured sidelink resource pool bitmap
d) a value of a period of PSFCH transmission occasion resources for a sidelink resource pool provided by a respective \( s l \)-PSFCH-Period

For the set of slot timing values \( K_{1} \), the UE determines a set \( M_{A} \) of occasions for candidate PSSCH transmissions with corresponding PSFCH reception occasions according to the following pseudo-code.

Set \( j=0 \) - index of occasion for candidate PSSCH transmissions with corresponding PSFCH reception occasions
Set \( M_{A}=\emptyset \)
Set \( c\left(K_{1}\right) \) to the cardinality of set \( K_{1} \)
Set \( k=0 \)-index of slot timing values \( K_{1, k} \), in descending order of the slot timing values, in set \( K_{1} \)
Set \( N_{\text {PSFCH }} \) to the value of the period of PSFCH transmission occasion resources for the sidelink resource pool
while \( k<\mathscr{C}\left(K_{1}\right) \)
if \( \bmod \left(n_{U}-K_{1, k}+1, \max \left(2^{\mu_{\text {UL }}-\mu_{\text {SL }}}, 1\right)\right)=0 \)
Set \( n_{S}=0 \) - index of a SL slot within an UL slot

ETSI


--- Page 226  ---


3GPP TS 38.213 version 17.1.0 Release 17
225
ETSI TS 138213 V17.1.0 (2022-05)
```
while \( n_{S}<\max \left(2^{\mu_{\mathrm{SL}}-\mu_{\mathrm{UL}}}, 1\right) \)
```

if slot \( n_{U} \) starts at a same time as or after a slot for an active UL BWP change on the PCell and slot \( \left\lfloor\left(n_{U}-K_{1, k}\right) \cdot 2^{\mu_{\mathrm{SL}}-\mu_{\mathrm{UL}}}\right\rfloor+n_{S} \) is before the slot for the active UL BWP change on the PCell
\[
n_{S}=n_{S}+1 ;
\]
else
if slot \( \left\lfloor\left(n_{U}-K_{1, k}\right) \cdot 2^{\mu_{\mathrm{SL}}-\mu_{\mathrm{UL}}}\right\rfloor+n_{S} \) belongs to the sidelink resource pool and includes PSFCH resources as indicated by a sidelink resource pool bitmap and sl-PSFCH-Period, where \( K_{1, k} \) is the \( k \)-th slot timing value in set \( K_{1} \)

Set \( n_{F}=0- \) index of a SL slot within an PSFCH period
while \( n_{F}<N_{\text {PSFCH }} \)
\[
M_{A}=M_{A} \cup j
\]
\[
n_{F}=n_{F}+1
\]
end while
end if
\[
n_{S}=n_{S}+1 ;
\]
end if
end while
end if
\( k=k+1 ; \)
end while
The cardinality of the set \( M_{A} \) defines a total number \( M \) of occasions for candidate PSSCH transmissions with corresponding PSFCH reception occasions corresponding to the HARQ-ACK information bits. A UE determines \( \tilde{o}_{0}^{A C K}, \tilde{o}_{1}^{A C K}, \ldots, \tilde{o}_{O_{\mathrm{ACK}}-1}^{A C K} \) HARQ-ACK information bits, for a total number of \( O_{\text {ACK }} \) HARQ-ACK information bits as \( \tilde{o}_{j}^{A C K}= \) HARQ-ACK information bit for candidate PSSCH transmission with index \( j \) with corresponding PSFCH reception, for \( 0 \leq j<M \), as described in clause 16.5. If the UE does not transmit a PSSCH in an occasion for candidate PSSCH transmission with corresponding PSFCH reception occasion, due to the UE not detecting a corresponding DCI format \( 3 \_0 \), the UE generates a NACK value for the occasion for candidate PSSCH transmission with corresponding PSFCH reception occasion.

If \( O_{\mathrm{ACK}} \leq 11 \), the UE determines a number of HARQ-ACK information bits \( n_{\mathrm{HARQ}-\mathrm{ACK}} \) for obtaining a transmission power for a PUCCH, as described in clause 7.2.1, as \( n_{\text {HARQ-ACK }}=\sum_{\mathrm{m}=0}^{\mathrm{M}-1} N_{\mathrm{m}}^{\text {received }} \) where \( N_{m}^{\text {received }} \) is a number of HARQ-ACK information bits determined for corresponding PSSCH transmissions with corresponding PSFCH reception occasions in PSFCH reception occasion \( m \).
16.5.1.2 Type-1 HARQ-ACK codebook in physical uplink shared channel

If a UE would multiplex HARQ-ACK information in a PUSCH transmission that is not scheduled by a DCI format or is scheduled by a DCI format without an SAI field, then
- if the UE
- has not received any PDCCH with a DCI format \( 3 \_0 \) scheduling PSSCH transmissions with corresponding PSFCH reception occasions that the UE transmits corresponding HARQ-ACK information in the PUSCH, based on a value of a respective PSFCH-to-HARQ_feedback timing indicator field in a DCI format

ETSI


--- Page 227  ---


3GPP TS 38.213 version 17.1.0 Release 17
226
ETSI TS 138213 V17.1.0 (2022-05)

scheduling the PSSCH transmissions or on the value of PSFCH-to-HARQ feedback timing indicator field in a DCI format 3_0 activating a SL configured grant Type 2 transmission, or
- has not been provided PSSCH resources with corresponding PSFCH reception occasions that the UE transmits corresponding HARQ-ACK information based on the value of sl-PSFCH-ToPUCCH-CG-Typel for a SL configured grant Type 1, in any of the set \( M_{A} \) of occasions for candidate PSSCH transmissions with corresponding PSFCH reception occasions, as described in clause 16.5.1.1,
the UE does not multiplex HARQ-ACK information in the PUSCH transmission;
- else the UE generates the HARQ-ACK codebook as described in clause 16.5.1.1, unless the UE generates HARQ-ACK information only for
- PSFCH reception occasions associated with PSSCH transmissions corresponding to a SL configured grant, or
- PSFCH reception occasions associated with PSSCH transmissions that are scheduled by DCI format \( 3 \_0 \) with a counter SAI field value of 1 in the set \( M_{A} \) of occasions for candidate PSSCH transmissions with corresponding PSFCH reception occasions,
in which case the UE generates HARQ-ACK information only for the PSFCH reception occasions as described in clause 16.5.1.

A UE sets to NACK value in the HARQ-ACK codebook any HARQ-ACK information corresponding to PSFCH reception occasions associated with PSSCH transmissions scheduled by a DCI format 3.0 that the UE detects in a PDCCH monitoring occasion that starts after a PDCCH monitoring occasion where the UE detects a DCI format scheduling the PUSCH transmission.

If a UE multiplexes HARQ-ACK information in a PUSCH transmission that is scheduled by a DCI format that includes a SAI field, the UE generates the HARQ-ACK codebook as described in clause 16.5.1.1 when a value of the SAI field in the DCI format is \( V_{T-S A I}^{U L}=1 \). The UE does not generate a HARQ-ACK codebook for multiplexing in the PUSCH transmission when \( V_{T-\text { SAI }}^{\mathrm{UL}}=0 \) unless the UE generates HARQ-ACK information only for
- PSFCH reception occasions associated with PSSCH transmissions corresponding to a SL configured grant, or
- PSFCH reception occasions associated with PSSCH transmissions that are scheduled by a DCI format \( 3 \_0 \) with a counter SAI field value of 1 in the set \( M_{A} \) of occasions for candidate PSSCH transmissions with corresponding PSFCH reception occasions as described in clause 16.5.1.
\( V_{T-\text { SAI }}^{\mathrm{UL}}=0 \) if the SAI field in the DCI format is set to ' 0 '; otherwise, \( V_{T-\text { SAI }}^{\mathrm{UL}}=1 \).
16.5.2 Type-2 HARQ-ACK codebook determination

This clause applies if the UE is configured with pdsch-HARQ-ACK-Codebook \( = \) dynamic.
16.5.2.1 Type-2 HARQ-ACK codebook in physical uplink control channel

A UE determines monitoring occasions for PDCCH with DCI format \( 3 \_0 \) for scheduling PSSCH transmissions with associated PSFCH reception occasions on an active DL BWP of a serving cell \( c \), as described in clause 10.1, and for which the UE transmits HARQ-ACK information in a same PUCCH in slot \( n \) based on
- PSFCH-to-HARQ_feedback timing indicator field values, or a value provided by sl-PSFCH-ToPUCCH-CGTypel, for PUCCH transmission with HARQ-ACK information in slot \( n \) in response to PSFCH receptions;
- time gap field in DCI format 3_0 for scheduling PSSCH transmissions with associated PSFCH receptions;
- time resource assignment in DCI format \( 3 \_0 \) for scheduling PSSCH transmissions with associated PSFCH receptions;
- a configured sidelink resource pool bitmap;
- a value of a period of PSFCH resources provided in sl-PSFCH-Period;
- a value of a minimum time gap provided in sl-MinTimeGapPSFCH.

ETSI


--- Page 228  ---


3GPP TS 38.213 version 17.1.0 Release 17
227
ETSI TS 138213 V17.1.0 (2022-05)

The set of PDCCH monitoring occasions for DCI format \( 3 \_0 \) for scheduling PSSCH transmissions with associated PSFCH reception occasions is defined as the PDCCH monitoring occasions in the active DL BWP of the configured serving cell, indexed in ascending order of start time of the associated search space sets. The cardinality of the set of PDCCH monitoring occasions defines a total number \( M \) of PDCCH monitoring occasions.

A value of a counter sidelink assignment indicator (SAI) field in DCI format 3.0 denotes an accumulative number of PDCCH monitoring occasions where PSSCH transmissions with associated PSFCH receptions are scheduled, up to a current PDCCH monitoring occasion, in ascending order of PDCCH monitoring occasion index \( m \), where \( 0 \leq m<M \).

Denote by \( V_{C-\mathrm{SAl}, m}^{\mathrm{SL}} \) the value of the counter SAI in DCI format \( 3 \_0 \) in PDCCH monitoring occasion \( m \) according to Table 16.5.2.1-1.

If the UE transmits HARQ-ACK information in a PUCCH in slot \( n \), the UE determines the \( \tilde{o}_{0}^{A C K}, \tilde{o}_{1}^{A C K}, \ldots, \tilde{o}_{O_{\mathrm{ACK}}-1}^{A C K} \), for a total number of \( O_{\text {ACK }} \) HARQ-ACK information bits, according to the following pseudo-code:

Set \( m=0-\mathrm{PDCCH} \) with DCI format \( 3 \_0 \) monitoring occasion index: lower index corresponds to earlier PDCCH with DCI format 3_0 monitoring occasion

Set \( j=0 \)
Set \( V_{\text {temp }}=0 \)
Set \( V_{s}=\emptyset \)
Set \( M \) to the number of PDCCH monitoring occasions
while \( m<M \)
if PDCCH monitoring occasion \( m \) is before an active UL BWP change on the PCell
\( m=M ; \)
else
if there is a PSFCH reception occasion associated with a PSSCH transmission scheduled by a DCI format in PDCCH monitoring occasion \( m \)
if \( V_{C-\mathrm{SAl}, m}^{\mathrm{SL}} \leq V_{\text {temp }} \)
\( j=j+1 ; \)
end if
\( V_{\text {temp }}=V_{C-\mathrm{SAl}, m}^{\mathrm{SL}} \)
\( \tilde{o}_{4 j+V_{C-S A L, m-1}^{S L}}^{A C K}= \) HARQ-ACK information bit
\( V_{s}=V_{s} \cup\left\{4 j+V_{C-\mathrm{SA} 1, m}^{\mathrm{SL}}-1\right\} \)
end if
end if
\( m=m+1 ; \)
end while
\( O_{\text {ACK }}=4 \cdot j+V_{\text {temp }} \)
\( \tilde{o}_{i}^{A C K}=N A C K \) for any \( i \in\left\{0,1, \ldots, O_{A C K}-1\right\} \backslash V_{s} \)
if a SL configured grant Type 1 is configured for a UE, or a SL configured grant Type 2 is configured and activated for a UE, and the SL configured grant provides a grant for PSSCH transmissions with PSFCH reception occasions in a slot \( n-K_{1} \), where \( K_{1} \) is the PSFCH-to-HARQ-feedback timing value for the SL configured grant

ETSI


--- Page 229  ---


3GPP TS 38.213 version 17.1.0 Release 17
228
ETSI TS 138213 V17.1.0 (2022-05)
\[
\begin{array}{l}
O_{A C K}=O_{A C K}+1 ; \\
\tilde{o}_{O_{A C K}-1}^{A C K}=\text { HARQ-ACK information bit associated with the PSFCH reception occasions associated with the } \\
\text { PSSCH transmissions scheduled by the SL configured grant }
\end{array}
\]
end if
If \( O_{\mathrm{ACK}} \leq 11 \), the UE determines a number of HARQ-ACK information bits \( n_{\mathrm{HARQ}-\mathrm{ACK}} \) for obtaining a transmission power for a PUCCH , as described in clause 7.2.1, as
\[
\mathrm{n}_{\mathrm{HARQ}-\mathrm{ACK}}=\left(V_{\mathrm{SAI}, \mathrm{~m}_{\text {last }}}^{\mathrm{SL}}-U_{\mathrm{SAJ}}\right) \bmod 4+\sum_{\mathrm{m}=0}^{\mathrm{M}-1} N_{\mathrm{m}}^{\text {received }}+N_{\mathrm{CG}}
\]
where
- \( \quad V_{\mathrm{SAl}, m_{\text {last }}}^{\mathrm{SL}} \) is a value of a counter SAI field in a last DCI format 30 scheduling PSSCH transmissions associated with PSFCH reception occasions that the UE detects within the \( M \) PDCCH monitoring occasions
- \( V_{\mathrm{SAl}, m_{\text {last }}}^{\mathrm{SL}}=0 \) if the UE does not detect any DCI format \( 3 \_0 \) scheduling PSSCH transmissions associated with PSFCH reception occasions in any of the \( M \) PDCCH monitoring occasions
- \( U_{\text {SAI }} \) is a total number of DCI format \( 3 \_0 \), scheduling PSSCH transmissions associated with PSFCH reception occasions, that the UE detects within the \( M \) PDCCH monitoring occasions. \( U_{\text {SAI }}=0 \) if the UE does not detect any DCI format \( 3-0 \) scheduling PSSCH transmissions with associated PSFCH reception occasions in any of the \( M \) PDCCH monitoring occasions
- \( \quad N_{m}^{\text {received }} \) is a number of DCI format \( 3 \_0 \) scheduling PSSCH transmissions with associated PSFCH reception occasions that the UE detects in PDCCH monitoring occasion \( m \)
- \( \quad N_{\mathrm{CG}} \) is a number of SL configured grants for which the UE transmits corresponding HARQ-ACK information in a same PUCCH as for HARQ-ACK information corresponding to PSFCH reception occasions within the \( M \) PDCCH monitoring occasions

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 16.5.2.1-1: Value of counter SAI in DCI format 3_0}
\begin{tabular}{|l|l|l|}
\hline SAI MSB, LSB & \( \boldsymbol{V}_{\boldsymbol{C}-\boldsymbol{S} \mathbf{A I}}^{\mathrm{SL}} \) & Number of PDCCH monitoring occasions in which DCI format 3_0 scheduling PSSCH transmissions with corresponding PSFCH reception occasions is present, denoted as \( Y \) and \( Y \geq 1 \) \\
\hline 0,0 & 1 & \( (Y-1) \bmod 4+1=1 \) \\
\hline 0,1 & 2 & \( (Y-1) \bmod 4+1=2 \) \\
\hline 1,0 & 3 & \( (Y-1) \bmod 4+1=3 \) \\
\hline 1,1 & 4 & \( (Y-1) \bmod 4+1=4 \) \\
\hline
\end{tabular}
\end{table}
16.5.2.2 Type-2 HARQ-ACK codebook in physical uplink shared channel

If a UE would multiplex HARQ-ACK information in a PUSCH transmission that is not scheduled by a DCI format or is scheduled by a DCI format without an SAI field, then
- if the UE
- has not received any PDCCH within the monitoring occasions for DCI format \( 3 \_0 \) for scheduling PSSCH with corresponding PSFCH reception occasions on any serving cell, and
- does not have HARQ-ACK information in response to a PSSCH transmission with corresponding PSFCH reception occasions associated with a SL configured grant to multiplex in the PUSCH, as described in clause 16.5.2.1,
the UE does not multiplex HARQ-ACK information in the PUSCH transmission;
- else, the UE generates and multiplexes in the PUSCH transmission the HARQ-ACK codebook as described in clause 16.5.2.1.

ETSI


--- Page 230  ---


3GPP TS 38.213 version 17.1.0 Release 17
229
ETSI TS 138213 V17.1.0 (2022-05)

If a UE multiplexes HARQ-ACK information in a PUSCH transmission that is scheduled by a DCI format that includes a SAI field, the UE generates the HARQ-ACK codebook as described in clause 16.5.2.1, with the following modifications:
- For the pseudo-code for the HARQ-ACK codebook generation in clause 16.5.2.1, after the completion of the \( m \) loop, the UE sets \( V_{\text {temp }}=V_{\mathrm{T}-\mathrm{SAI}}^{\mathrm{UL}} \) where \( V_{\mathrm{T}-\mathrm{SAI}}^{\mathrm{UL}} \) is the value of the SAI field in the DCI format according to Table 16.5.2.2-1.

If a UE
- is scheduled for a PUSCH transmission by a DCI format that includes a SAI field with value \( V_{\mathrm{T}-\mathrm{SAI}}^{\mathrm{UL}}=4 \), and
- has not received any PDCCH within the monitoring occasions for PDCCH with DCI format \( 3 \_0 \) for scheduling PSSCH with corresponding PSFCH reception occasions on a serving cell, and
- does not have HARQ-ACK information in response to PSFCH reception occasions associated with a SL configured grant to multiplex in the PUSCH, as described in clause 16.5.2.1,
the UE does not multiplex HARQ-ACK information in the PUSCH transmission.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 16.5.2.2-1: Value of SAI}
\begin{tabular}{|l|l|l|}
\hline SAI MSB, LSB & \( \boldsymbol{V}_{\text {T-SAI }}^{\text {UL }} \) & Number of PDCCH monitoring occasions in which DCI format 3_0 scheduling PSSCH transmissions with corresponding PSFCH reception occasions is present, denoted as \( X \) and \( X \geq 1 \) \\
\hline 0,0 & 1 & \( (X-1) \bmod 4+1=1 \) \\
\hline 0,1 & 2 & \( (X-1) \bmod 4+1=2 \) \\
\hline 1,0 & 3 & \( (X-1) \bmod 4+1=3 \) \\
\hline 1,1 & 4 & \( (X-1) \bmod 4+1=4 \) \\
\hline
\end{tabular}
\end{table}
16.6 UE procedure for LTE sidelink transmission

If the UE detects a DCI format 31 with CRC scrambled by SL Semi-Persistent Scheduling V-RNTI in slot \( n \), the DCI format 3_1 activates or releases an LTE sidelink SPS configuration that is indicated by a SL SPS configuration index field [5, TS 38.212]. If the DCI format 3_1 activates an SL SPS configuration, the UE procedure for transmitting a PSCCH and a PSSCH is as described in [13, TS 36.213] except that a transmission starts no earlier than \( T_{D C I}-\frac{N_{\text {TA }}}{2} \times T_{\mathrm{C}} \times 10^{3}+X+(4+m) \mathrm{ms} \), where \( T_{D C I} \) is a start time of slot \( n, N_{T A} \) and \( T_{C} \) are defined in \( [4, \mathrm{TS} 38.211], X \) is a value indicated by a Timing offset field in DCI format \( 3 \_1 \), and \( m \) is a value indicated by SL index field in DCI format \( 3 \_1 \) if the SL index field is present; otherwise, \( m=0 \).
16.7 Operation for in-device coexistence

If a UE would transmit or receive a first channel/signal using E-UTRA radio access and a second channel/signal using NR radio access, when
- the first channel/signal and the second channel/signal are time-division multiplexed, and
- the UE knows the frame indexes of the first channel/signal and the frame indexes of the second channel/signal,
the UE transmits or receives each channel/signal so that the subframe boundary of the second channel/signal is aligned with the subframe boundary of the first channel/signal where the subframe boundary alignment is achieved by UE implementation means.

17 UE with reduced capabilities
A UE with reduced capabilities (RedCap UE) supports all Layer-1 UE features that are mandatory without capability signalling.

ETSI


--- Page 231  ---


3GPP TS 38.213 version 17.1.0 Release 17
230
ETSI TS 138213 V17.1.0 (2022-05)
17.1 RedCap UE procedures

Procedures for a RedCap UE are same as described for a UE in all other clauses of this document unless stated otherwise. In this clause, the term 'UE' refers to a RedCap UE.

A UE expects the initial DL BWP and the active DL BWP after the UE (re)establishes dedicated RRC connection to be smaller than or equal to the maximum DL bandwidth that the UE supports. A UE can be provided a DL BWP by initialDownlinkBWP in DownlinkConfigCommonRedCapSIB, and an UL BWP by intitalUplinkBWP in UplinkConfigCommonRedCapSIB. If mitialUplinkBWP in UplinkConfigCommonSIB indicates an UL BWP that is larger than a maximum UL BWP that a UE supports, the UE expects to be provided an UL BWP by intialUplinkBWP in UplinkConfigCommonRedCapSIB.

A UE can be provided by BWP-DownlinkDedicated a DL BWP, other than the initial DL BWP. A UE can be provided by BWP-UplinkDedicated an UL BWP, other than the initial UL BWP, that is smaller than or equal to the maximum UL band width that the UE supports.

If a UE is provided RACH-ConfigCommon-RedCap or RACH-ConfigCommonTwoStepRA-RedCap, the UE uses corresponding parameters to perform the procedures in clauses 8.1, 8.1A, and 8.3; otherwise, the UE uses corresponding parameters from RACH-ConfigCommon or RACH-ConfigCommonTwoStepRA.

If a UE is provided initialUplinkBWP in UplinkConfigCommonRedCapSIB and does not have dedicated PUCCH resource configuration, the UE transmits PUCCH with HARQ-ACK information as described in clause 9.2.1 using a PUCCH resource set provided by pucch-ResourceCommonRedCap, except that frequency hopping for the PUCCH transmission is disabled if disable-FH-PUCCH is provided in PUCCH-ConfigCommonRedCap. If frequency hopping of the PUCCH transmission is disabled then, for the PUCCH transmission, the UE determines the initial cyclic shift index in the set of initial cyclic shift indexes as \( r_{\mathrm{PUCCH}} \bmod N_{\mathrm{CS}} \) and determines the PRB index as
- \( R B_{\mathrm{BWP}}^{\text {offset }}+R B_{\mathrm{BWP}}^{\text {offset-add }}+\left\lfloor r_{\mathrm{PUCCH}} / N_{\mathrm{CS}}\right\rfloor \), if BWP-part \( = \) 'FromLowerEdge'
- \( \quad N_{\mathrm{BWP}}^{\mathrm{size}}-R B_{\mathrm{BWP}}^{\text {offset }}-R B_{\mathrm{BWP}}^{\text {offset-add }}-1-\left\lfloor r_{\mathrm{PUCCH}} / N_{\mathrm{CS}}\right\rfloor \), otherwise
where \( R B_{\mathrm{BWP}}^{\mathrm{offset}-\mathrm{add}} \) is provided by additional- \( R B \)-Offset, if provided; otherwise, \( R B_{\mathrm{BWP}}^{\text {offset-add }}=0 \).
For an initial DL BWP provided by initialDownlinkBWP in DownlinkConfigCommonRedCapSIB, if a UE monitors PDCCH according to a Type1-PDCCH CSS set and does not monitor PDCCH according to Type2-PDCCH CSS set, the UE assumes that the initial DL BWP does not include SS/PBCH blocks or the CORESET with index 0 . If the UE monitors PDCCH according to Type2-PDCCH CSS set, the UE assumes that the initial DL BWP
- includes a SS/PBCH block and the CORESET with index 0 if the UE used the SS/PBCH block to obtain SIB1
- includes a SS/PBCH block and does not include the CORESET with index 0 if the initial DL BWP does not include the SS/PBCH block the UE used to obtain SIB1

For an active DL BWP provided by BWP-DownlinkDedicated, a UE assumes that the active DL BWP includes a SS/PBCH block, unless the UE indicates a capability to operate in the DL BWP without receiving an SS/PBCH block, and does not include the CORESET with index 0 .
17.2 Half-Duplex UE in paired spectrum

A half-duplex UE (HD-UE) in paired spectrum is not capable of simultaneous transmissions and receptions on a serving cell with paired spectrum. This clause is applicable for communication of a HD-UE on a serving cell with paired spectrum.

A HD-UE does not expect to detect a DCI format scheduling a reception in a set of symbols and detect a DCI format scheduling a transmission in any symbol from the set of symbols.

If a HD-UE is configured by higher layers to receive a PDCCH, or PDSCH, or CSI-RS, or DL PRS in a set of symbols, the HD-UE receives the PDCCH, or PDSCH, or CSI-RS, or DL PRS if the HD-UE does not detect a DCI format that indicates to the HD-UE to transmit a PUSCH, or PUCCH, or PRACH, or SRS in at least one symbol of the set of symbols; otherwise, the HD-UE does not receive the PDCCH, or PDSCH, or CSI-RS, or DL PRS in the set of symbols.

ETSI


--- Page 232  ---


3GPP TS 38.213 version 17.1.0 Release 17
231
ETSI TS 138213 V17.1.0 (2022-05)

If a HD-UE is configured by higher layers to transmit SRS, or PUCCH, or PUSCH in a set of symbols and the UE detects a DCI format indicating to the HD-UE to receive CSI-RS or PDSCH in a subset of symbols from the set of symbols, then
- the HD-UE does not expect to cancel the transmission of the PUCCH or PUSCH in the set of symbols if the first symbol in the set occurs within \( T_{\text {proc }, 2} \) relative to a last symbol of a CORESET where the HD-UE detects the DCI format; otherwise, the HD-UE cancels the PUCCH, or the PUSCH, or an actual repetition of the PUSCH [6, TS38.214], determined from clauses 9 and 9.2.5 or clause 6.1 of [6, TS38.214].
- the HD-UE does not expect to cancel the transmission of SRS in symbols from the subset of symbols that occur within \( T_{\text {proc }, 2} \) relative to a last symbol of a CORESET where the HD-UE detects the DCI format. The HD-UE cancels the SRS transmission in remaining symbols from the subset of symbols.
\( T_{\text {proc }, 2} \) is the PUSCH preparation time for UE processing capability \( 1[6, \mathrm{TS} 38.214] \) assuming \( d_{2,1}=1 \) and \( \mu \) corresponds to the smallest SCS configuration between the SCS configuration of the PDCCH carrying the DCI format and the SCS configuration of the SRS, PUCCH, PUSCH.

A HD-UE does not expect to receive both dedicated higher layer parameters configuring transmission in a set of symbols and dedicated higher layer parameters configuring reception in the set of symbols. A HD-UE does not expect to receive both a Type-0/0A/1/2-PDCCH CSS set configuration for PDCCH reception in a set of symbols and dedicated higher layer parameters configuring transmission in the set of symbols.

If a HD-UE would transmit a PUSCH, or PUCCH, or SRS based on a configuration by higher layers and the HD-UE is indicated presence of SS/PBCH blocks by ssb-PositionsInBurst in SIBI or in ServingCellConfigCommon, the HD-UE does not transmit
- PUSCH or PUCCH if a last symbol of the PUSCH or PUCCH transmission would not be at least \( N_{\mathrm{Tx}-\mathrm{Rx}} \cdot T_{\mathrm{c}}[4 \), TS 38.211] prior to a first symbol of the next earliest SS/PBCH block
- PUSCH or PUCCH if a first symbol of the PUSCH or PUCCH transmission would not be at least \( N_{\mathrm{Rx}-\mathrm{Tx}} \cdot T_{\mathrm{c}} \) [4, TS 38.211] after a last symbol of the previous latest SS/PBCH block
- SRS in symbols that would not be at least \( N_{\mathrm{T} x-\mathrm{Rx}} \cdot T_{\mathrm{c}} \) prior to a first symbol of the next earliest SS/PBCH block
- SRS in symbols that would not be at least \( N_{\mathrm{Rx}-\mathrm{Tx}} \cdot T_{\mathrm{c}} \) after a last symbol of the previous latest SS/PBCH block

If a HD-UE would transmit a PRACH based on a detected DCI format, or PUSCH, or PUCCH, or SRS and the HD-UE is indicated presence of SS/PBCH blocks by ssb-PositionsInBurst in SIBI or in ServingCellConfigCommon in a set of symbols, the HD-UE does not transmit PUSCH or PUCCH or PRACH if a transmission would overlap with any symbol from the set of symbols and the HD-UE does not transmit SRS in the set of symbols.

If a HD-UE would transmit a PRACH or MsgA PUSCH triggered by higher layers in a set of symbols and would receive a PDCCH, or a PDSCH, or a CSI-RS, or a DL PRS, or is indicated presence of SS/PBCH blocks by ssbPositionsInBurst in SIBI or in ServingCellConfigCommon in symbols that include any symbol from the set of symbols, the HD-UE can select based on its implementation whether to either transmit the PRACH or the MsgA PUSCH or receive the PDSCH , or the \( \mathrm{CSI}-\mathrm{RS} \), or the PL RS , or the PDCCH , or the \( \mathrm{SS} / \mathrm{PBCH} \) blocks.

If a HD-UE would receive a PDCCH, or a PDSCH, or a CSI-RS, or a DL PRS based on a configuration by higher layers or is indicated presence of SS/PBCH blocks by ssb-PositionsInBurst in SIBI or in ServingCellConfigCommon in a set of symbols, and the HD-UE would transmit PRACH or MsgA PUSCH triggered by higher layers starting or ending at a symbol that is earlier or later than \( N_{\mathrm{Rx}-\mathrm{Tx}} \cdot T_{\mathrm{c}} \) or \( N_{\mathrm{Tx}-\mathrm{Rx}} \cdot T_{\mathrm{c}} \), respectively, from the last or first symbol in the set of symbols, the HD-UE can select based on its implementation whether to either transmit the PRACH or the MsgA PUSCH or receive the PDSCH, or the CSI-RS, or the DL PRS, or the PDCCH, or the SS/PBCH blocks.

18 Multicast Broadcast Services
This clause is applicable only for PDCCH receptions, PDSCH receptions, and PUCCH transmissions for MBS on a serving cell. DCI formats with CRC scrambled by G-RNTI or G-CS-RNTI scheduling PDSCH receptions are referred to as multicast DCI formats and the PDSCH receptions are referred to as multicast PDSCH receptions. DCI formats with CRC scrambled by MCCH-RNTI or G-RNTI for MTCH scheduling PDSCH receptions are referred to as broadcast DCI formats and the PDSCH receptions are referred to as broadcast PDSCH receptions. HARQ-ACK

ETSI


--- Page 233  ---


3GPP TS 38.213 version 17.1.0 Release 17
232
ETSI TS 138213 V17.1.0 (2022-05)

information associated with multicast DCI formats or multicast PDSCH receptions is referred to as multicast HARQACK information.

A UE can be provided one or more G-RNTIs per serving cell for scrambling the CRC of multicast DCI formats for scheduling PDSCH receptions. The UE can be provided one or more G-CS-RNTI per serving cell for scrambling the CRC of multicast DCI formats providing activation/release for SPS PDSCH receptions.

A UE can be configured by cfr-Config-MCCH-MTCH an MBS frequency resource for PDCCH and PDSCH receptions providing MCCH and MTCH [12, TS 38.331]; otherwise, the MBS frequency resource is same as for the CORESET with index 0 that is associated with the Type0-PDCCH CSS set for PDCCH and PDSCH receptions providing MCCH and MTCH. A UE monitors PDCCH for scheduling PDSCH receptions for MCCH or MTCH as described in clause 10.1.

In clauses referring to a higher layer parameter value provided by PDCCH-ConfigCommon or PDSCH-ConfigCommon, when applicable a corresponding higher layer parameter value for MCCH/MTCH PDCCH receptions or PDSCH receptions, respectively, is provided as described in [12, TS 38.331].

A UE is not required to simultaneously receive PDSCHs for MCCH or MTCH on two serving cells. A UE in the RRC_IDLE state or in the RRC_INACTIVE state is not required to simultaneously receive on a serving cell
- PDSCHs for MCCH and MTCH, or
- more than one MTCH PDSCHs, or
- PDSCH for MTCH and PBCH, or
- PDSCH for MCCH or MTCH and PDSCH scheduled by a DCI format \( 1 \_0 \) with CRC scrambled by SI-RNTI or by P-RNTI

A UE can be configured, per DL BWP by cfr-Config-Multicast, an MBS frequency resource within the DL BWP for PDCCH and PDSCH receptions [4, TS 38.211]. If cfr-Config-Multicast does not include locationAndBandwidthMulticast, the MBS frequency resource is the active DL BWP. The UE is not required to simultaneously receive PDSCHs on two serving cells. In clauses referring to a higher layer parameter value provided by PDCCH-Config or PDSCH-Config or SPS-Config for a DL BWP, when applicable a corresponding higher layer parameter value for multicast PDCCH, PDSCH, or SPS PDSCH receptions is provided as described in [12, TS 38.331].

In clauses referring to a higher layer parameter value provided by a first or second \( P U C C H \)-Config, when applicable a corresponding higher layer parameter value for PUCCH transmissions associated with multicast PDCCH or PDSCH receptions is provided as described in [12, TS 38.331]. In clauses referring to a higher layer parameter value provided by SPS-PUCCH-AN or SPS-PUCCH-AN-List, when applicable a corresponding higher layer parameter value for PUCCH transmissions associated with multicast SPS PDSCH receptions is provided as described in [12, TS 38.331]. In clauses referring to a higher layer parameter value provided by pdsch-HARQ-ACK-Codebook or pdsch-HARQ-ACKCodebookList, when applicable a corresponding higher layer parameter value for HARQ-ACK codebooks associated with multicast HARQ-ACK information is provided as described in [12, TS 38.331].

A UE monitors PDCCH for scheduling PDSCH receptions or for activation/release of SPS PDSCH receptions for a corresponding SPS PDSCH configuration as described in clause 10.1.

A UE can be configured by harq-Feedback-Option-Multicast for a G-RNTI, or by sps-HARQ-Feedback-OptionMulticast for a G-CS-RNTI, to provide HARQ-ACK information for a transport block reception associated with the GRNTI or with the G-CS-RNTI, respectively, according to the first HARQ-ACK reporting mode or according to the second HARQ-ACK reporting mode. The UE determines a priority for a PUCCH transmission with multicast HARQACK information according to any HARQ-ACK reporting mode as described in clause 9 for a PUCCH transmission with unicast HARQ-ACK information.

For the first HARQ-ACK reporting mode, the UE generates HARQ-ACK information with ACK value when a UE correctly decodes a transport block or detects a DCI format indicating an SPS PDSCH release; otherwise, the UE generates HARQ-ACK information with NACK value, as described in clauses 9 and 9.1 through 9.3.

For the second HARQ-ACK reporting mode, the UE does not transmit a PUCCH that would include only HARQ-ACK information with ACK values. The second HARQ-ACK reporting mode is not applicable when a number of HARQACK information bits is more than four, or for the first SPS PDSCH reception after activation of SPS PDSCH receptions for a SPS configuration, or for DCI formats having associated HARQ-ACK information without scheduling a PDSCH reception.

ETSI


--- Page 234  ---


3GPP TS 38.213 version 17.1.0 Release 17
233
ETSI TS 138213 V17.1.0 (2022-05)

For the second HARQ-ACK reporting mode, when a number of HARQ-ACK information bits is one, a UE transmits a PUCCH only when the HARQ-ACK information bit has NACK value. For a PUCCH resource associated with PUCCH format 0 , the UE transmits the PUCCH as described in [4, TS 38.211] by obtaining \( m_{0} \) as described for HARQ-ACK information in clause 9.2.3 and by setting \( m_{\mathrm{cs}}=0 \). For a PUCCH resource associated with PUCCH format 1 , the UE transmits the PUCCH as described in [4, TS 38.211] by setting \( b(0)=0 \).

For the second HARQ-ACK reporting mode, when a number of HARQ-ACK information bits is 2,3 , or 4 , the UE can be indicated by moreThanOneNackOnly-Mode to provide the HARQ-ACK information bits in a PUCCH either according to the first HARQ-ACK reporting mode or by selecting a resource from a set of resources for the PUCCH transmission based on the values of the HARQ-ACK information bits as described in Table 18-1.

If a UE is provided pucch-Config-Multicastl or pucch-Config-Multicast2 for PUCCH transmissions with a priority value, the UE transmits a PUCCH with the priority value according to pucch-Config-Multicastl or pucch-ConfigMulticast2 for each G-RNTI or G-CS-RNTI that the UE provides associated HARQ-ACK information according to the first HARQ-ACK reporting mode or the second HARQ-ACK reporting mode.

A PDSCH reception providing an initial transmission of a transport block is scheduled only by a multicast DCI format. For the first HARQ-ACK reporting mode, a PDSCH reception providing a retransmission of the transport block can be scheduled either by a multicast DCI format using a same G-RNTI as the G-RNTI of the initial transmission of the transport block, or by a unicast DCI format using a C-RNTI [6, TS 38.214].

An activation for SPS PDSCH receptions using a G-CS-RNTI for a corresponding SPS PDSCH configuration is provided only by a multicast DCI format as described in clause 10.2 by replacing CS-RNTI with the G-CS-RNTI. A release for SPS PDSCH receptions using a G-CS-RNTI for a corresponding SPS PDSCH configuration is provided by a multicast DCI format as described in clause 10.2 by replacing CS-RNTI with the G-CS-RNTI, or by a DCI format with CRC scrambled by CS-RNTI. For the first HARQ-ACK reporting mode and for a transport block that a UE received in a SPS PDSCH, a PDSCH reception providing a retransmission of the transport block can be scheduled either by a unicast DCI format using a CS-RNTI or by a multicast DCI format using a same G-CS-RNTI as the G-CS-RNTI of the initial transmission of the transport block [6, TS 38.214].

A UE can be configured per G-RNTI or per G-CS-RNTI, by harq-FeedbackEnabler-Multicast with value set to 'enabled', to provide HARQ-ACK information for PDSCH receptions. When the UE is not provided harq-FeedbackEnabler-Multicast for a G-RNTI or G-CS-RNTI, or when the UE is provided harq-FeedbackEnablerMulticast with value set to 'disabled', the UE does not provide HARQ-ACK information for respective PDSCH receptions. If a UE is provided harq-FeedbackEnabler-Multicast with value set to 'dci-enabler' for a G-RNTI or a G-CS-RNTI, the UE determines whether or not to provide the HARQ-ACK information for PDSCH receptions based on an indication by the multicast DCI format associated with the G-RNTI or the G-CS-RNTI [4, TS 38.212].

If a UE would multiplex HARQ-ACK information that the UE would provide according to the second HARQ-ACK reporting mode with other UCI in a first PUCCH, or in a PUSCH, as described in clauses 9 and \( 9.2-5 \), the UE provides the HARQ-ACK information according to the first HARQ-ACK reporting mode. For resolving an overlapping among a second PUCCH with HARQ-ACK information according to the second HARQ-ACK reporting mode and other PUCCHs or PUSCHs prior to multiplexing the HARQ-ACK information in a PUCCH or PUSCH, the UE considers that the UE would transmit the second PUCCH when all values of the HARQ-ACK information are 'ACK'.

If a UE is provided multiple G-RNTIs or G-CS-RNTIs, a configuration for a HARQ-ACK codebook type applies to all G-RNTIs or G-CS-RNTIs.

If a UE is provided pdsch-HARQ-ACK-Codebook-Multicast \( = \) semi-static, the UE generates a Type-1 HARQ-ACK codebook as described in clauses 9.1.2, 9.1.2.1, and 9.1.2.2.

If a UE is provided pdsch-HARQ-ACK-Codebook-Multicast \( = \) dynamic, the UE generates a Type-2 HARQ-ACK codebook as described in clause 9.1.3.1.

If, for unicast and multicast HARQ-ACK information of same priority value, a UE
- is provided
- either pdsch-HARQ-ACK-Codebook = dynamic or pdsch-HARQ-ACK-Codebook-r16 and pdsch-HARQ-ACK-Codebook-Multicast \( = \) semi-static,
- or pdsch-HARQ-ACK-Codebook = semi-static and pdsch-HARQ-ACK-Codebook-Multicast = dynamic, and
- would multiplex the unicast and multicast HARQ-ACK information in a same PUCCH or PUSCH

ETSI


--- Page 235  ---


3GPP TS 38.213 version 17.1.0 Release 17
234
ETSI TS 138213 V17.1.0 (2022-05)

the UE
- appends the HARQ-ACK codebooks for the multicast HARQ-ACK information to the HARQ-ACK codebooks for the unicast HARQ-ACK information
- if \( O_{\mathrm{ACK}}+O_{\mathrm{SR}}+O_{\mathrm{CSI}} \leq 11 \), the UE determines \( n_{\mathrm{HARQ}-\mathrm{ACK}} \) for obtaining a power of a PUCCH transmission with the HARQ-ACK information, as described in clause 7.2.1, as a sum of the \( n_{\text {HARQ-ACK }} \) value from clause 9.1.2.1 or clause 9.1.3.3 and the \( n_{\text {HARQ-ACK }} \) value from clause 9.1.3.1.

A UE determines a PUCCH resource for a PUCCH transmission with HARQ-ACK information as described in clauses 9.2 and 9.2.1 through 9.2.5.

If the UE multiplexes HARQ-ACK information of same priority associated with unicast DCI formats and with multicast DCI formats in a same PUCCH, the last DCI format that the UE uses to determine the PUCCH resource, as described in clause 9.2.3, is a last unicast DCI format.

If a UE multiplexes in a PUCCH first HARQ-ACK information associated with multicast SPS PDSCH receptions and second HARQ-ACK information associated with multicast DCI formats and having same priority value as the first HARQ-ACK information, and both the first and second HARQ-ACK information are according to the first HARQACK reporting mode, the UE determines the PUCCH resource based on the last multicast DCI format, as described in clause 9.2.3.

If a UE multiplexes in a PUCCH first HARQ-ACK information associated with unicast SPS PDSCH receptions and second HARQ-ACK information associated with multicast DCI formats and having same priority value as the first HARQ-ACK information in a same PUCCH, the UE determines the PUCCH resource from SPS-PUCCH-AN-List for unicast SPS PDSCH receptions as described in clause 9.2.1.

If a UE multiplexes in a PUCCH first HARQ-ACK information associated with unicast SPS PDSCH receptions and second HARQ-ACK information associated with multicast SPS PDSCH receptions and having same priority value as the first HARQ-ACK information in a same PUCCH, the UE determines the PUCCH resource from SPS-PUCCH-ANList for unicast SPS PDSCH receptions as described in clause 9.2.1.

A UE is not required to multiplex in a PUCCH multicast HARQ-ACK information of a priority and unicast UCI of the priority if the UE is provided subslotLengthForPUCCH for PUCCH transmissions with unicast UCI of the priority.

19 PUSCH transmission in RRC_INACTIVE state
19.1 Configured-grant based PUSCH transmission

A UE indicated to release a dedicated RRC connection can be provided one or more configurations by respective one or more ConfiguredGrantConfig, for configured grant Type 1 PUSCH transmissions on the initial UL BWP [12, TS 38.331]. For the remaining of this clause, PUSCH transmissions refer to configured grant Type-1 PUSCH transmissions for a configuration provided by ConfiguredGrantConfig.

A UE can be provided by sdt-SSB-Subset a number of SS/PBCH block indexes \( N_{\mathrm{PUSCH}}^{\mathrm{SS} / \mathrm{PBCH}} \) to map to a number of valid PUSCH occasions for PUSCH transmissions over an association period. If the UE is not provided sdt-SSB-Subset, the UE determines \( N_{\text {PUSCH }}^{\text {SS/PBCH }} \) from the value of ssb-PositionsInBurst in SIBI or by ServingCellConfigCommon. A PUSCH occasion for a PUSCH transmission is defined by a time resource and a frequency resource and is associated with a DM-RS provided by cg-DMRS-Configuration for the configuration of PUSCH transmissions.

An association period, starting from frame with SFN 0, for mapping \( N_{\text {PUSCH }}^{\text {SS/PBCH }} \) SS/PBCH block indexes, from the number of SS/PBCH block indexes, to valid PUSCH occasions and associated DM-RS resources is the smallest value in the set determined by the PUSCH configuration period provided by periodicity in ConfiguredGrantConfig according to Table 19.1-1 such that \( N_{\text {PUSCH }}^{\text {SS/PBCH }} \) SS/PBCH block indexes are mapped at least once to valid PUSCH occasions and associated DM-RS resources within the association period. A UE is provided a number of SS/PBCH block indexes associated with a PUSCH occasion and a DM-RS resource by sdt-SSB-perCG-PUSCH. If after an integer number of SS/PBCH block indexes to PUSCH occasions and associated DMRS resources mapping cycles within the association period there is a set of PUSCH occasions and associated DMRS resources that are not mapped to \( N_{\text {PUSCH }}^{\text {SS/PBCH }} \) SS/PBCH block indexes, no SS/PBCH block indexes are mapped to the set of PUSCH occasions and associated DMRS resources.

ETSI


--- Page 236  ---


3GPP TS 38.213 version 17.1.0 Release 17
235
ETSI TS 138213 V17.1.0 (2022-05)

An association pattern period includes one or more association periods and is determined so that a pattern between PUSCH occasions with associated DMRS resources and SS/PBCH block indexes repeats at most every 640 msec . PUSCH occasions and associated DMRS resources not associated with SS/PBCH block indexes after an integer number of association periods, if any, are not used for PUSCH transmissions.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 19.1-1: Mapping between PUSCH configuration period and SS/PBCH block to configured PUSCH resource association period}
\begin{tabular}{|l|l|}
\hline PUSCH configuration period \( \boldsymbol{T}_{\boldsymbol{c g}} \) (msec) & Association period (number of PUSCH configuration periods except when PUSCH configuration period is less than 5 msec ) \\
\hline 5 & \{1, 2, 4, 8,16, 32, 64, 128\} \\
\hline 8 & \{1,2,4,5,8,10,16,20,40,80\} \\
\hline 10 & \{1, 2, 4, 8,16, 32, 64\} \\
\hline 16 & \{1, 2, 4, 5, 8,10,20,40\} \\
\hline 20 & \{1, 2, 4, 8,16, 32\} \\
\hline 32 & \{1, 2, 4, 5, 10, 20\} \\
\hline 40 & \{1, 2, 4, 8, 16\} \\
\hline 64 & \{1, 2, 5, 10\} \\
\hline 80 & \{1, 2, 4, 8\} \\
\hline 128 & \{1,5\} \\
\hline 160 & \{1, 2, 4\} \\
\hline 320 & \{1,2\} \\
\hline 640 & \{1\} \\
\hline
\end{tabular}
\end{table}
\( N_{\text {PUSCH }}^{\text {SS/PBCH }} \) SS/PBCH block indexes are mapped to valid PUSCH occasions and associated DMRS resources in the following order
- first, in increasing order of DMRS resource indexes within a PUSCH occasion, where a DMRS resource index \( D M R S_{i d} \) is determined first in an ascending order of a DMRS port index and second in an ascending order of a DMRS sequence index [4, TS 38.211]
- second, in increasing order of PUSCH configuration period indexes

A PUSCH occasion is valid if it does not overlap with a valid PRACH occasion as described in clause 8.1.
For unpaired spectrum and for SS/PBCH blocks with indexes provided by ssb-PositionsInBurst in SIBI or by ServingCellConfigCommon
- if a UE is not provided tdd-UL-DL-ConfigurationCommon, a PUSCH occasion is valid if the PUSCH occasion
- does not precede a SS/PBCH block in the PUSCH slot, and
- starts at least \( N_{\text {gap }} \) symbols after a last SS/PBCH block symbol, where \( N_{\text {gap }} \) is provided in Table 8.1-2
- if a UE is provided tdd-UL-DL-ConfigurationCommon, a PUSCH occasion is valid if the PUSCH occasion
- is within UL symbols
- starts at least \( N_{\text {gap }} \) symbols after a last downlink symbol, and at least \( N_{\text {gap }} \) symbols after a last SS/PBCH block symbol, where \( N_{\text {gap }} \) is provided in Table 8.1-2

A UE determines a power of a PUSCH transmission as described in clause 7.1.1, where the UE obtains \( P L_{b, f, c}\left(q_{d}\right) \) using a RS resource from an SS/PBCH block with index associated with the PUSCH transmission.

A UE can be provided a USS set by sdt-CG-SearchSpace, or a CSS set by sdt-SearchSpace, to monitor PDCCH for detection of DCI format \( 0 \_0 \) with CRC scrambled by C-RNTI or CS-RNTI for scheduling PUSCH transmission or of DCI format \( 1 \_0 \) with CRC scrambled by C-RNTI for scheduling PDSCH receptions [12, TS 38.331]. The UE may assume that the DM-RS antenna port associated with the PDCCH receptions, the DM-RS antenna port associated with the PDSCH receptions, and the SS/PBCH block associated with the PUSCH transmission are quasi co-located with respect to average gain and quasi co-location 'type A ' or 'typeD' properties. The UE transmits a PUCCH with HARQACK information associated with the PDSCH receptions as described in clause 9.2.1 using a same spatial domain transmission filter as for the last PUSCH transmission.

ETSI


--- Page 237  ---


3GPP TS 38.213 version 17.1.0 Release 17
236
ETSI TS 138213 V17.1.0 (2022-05)
19.2 Random-access based PUSCH transmission

A UE indicated to release a dedicated RRC connection can be provided a configuration for a Type-1 and/or a Type-2 random access procedure on the initial UL BWP [12, TS 38.331]. PRACH occasions can have either a common configuration as, or a separate configuration from, PRACH occasions for Type-1 or Type-2 random access procedure as described in clause 8.1. The UE procedure is as described in clause 8, including clauses 8.1 through 8.4. The UE transmits a PRACH preamble with a power determined as described in clause 7.4.

For a common configuration of PRACH occasions and a Type-1 or a Type-2 random access procedure, a UE can be provided a number of SS/PBCH block indexes associated with one PRACH occasion by sdt-CB-PreamblesPerSSBPerSharedRO or sdt-msgA-CB-PreamblesPerSSB-PerSharedRO, respectively. A PRACH transmission can be on a subset of PRACH occasions associated with a same SS/PBCH block index within an SSB-RO mapping cycle as determined by a PRACH mask index provided by sdt-SSB-SharedRO-Masklndex or sdt-msgA-SSB-SharedROMaskIndex according to [11, TS 38.321].

A UE can be provided by sdt-SearchSpace a CSS set to monitor, after contention resolution as described in clause 8.4, PDCCH for detection of a DCI format \( 0 \_0 \) or DCI format \( 1 \_0 \) with CRC scrambled by C-RNTI for scheduling respective PUSCH transmissions or PDSCH receptions; otherwise, if the UE is not provided sdt-SearchSpace, the UE monitors PDCCH according to a Type1-PDCCH CSS set as described in clause 10.1. The UE may assume that the DMRS antenna port associated with the PDCCH receptions, the DM-RS antenna port associated with the PDSCH receptions, and the SS/PBCH block associated with the PRACH transmission are quasi co-located with respect to average gain and quasi co-location 'typeA' or 'typeD' properties.

ETSI


--- Page 238  ---


3GPP TS 38.213 version 17.1.0 Release 17
237
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{Annex A:
Change history}
\begin{tabular}{|l|l|l|l|l|l|l|l|}
\hline Date & TSG \# & TSG Doc. & CR & Rev & Cat & Subject/Comment & New version \\
\hline 2017-04 & RAN1\#89 & R1-1707925 & & & & Draft skeleton & 0.0.0 \\
\hline 2017-07 & AH NR2 & R1-1712015 & & & & Inclusion of agreements until RAN1-adhoc\#2 & 0.0.1 \\
\hline 2017-08 & RAN1\#90 & R1-1714553 & & & & Inclusion of agreements on CA and first revisions & 0.0.2 \\
\hline 2017-08 & RAN1\#90 & R1-1714565 & & & & Second revisions & 0.0.3 \\
\hline 2017-08 & RAN1\#90 & R1-1714658 & & & & Endorsed by RAN1\#90 & 0.1.0 \\
\hline 2017-08 & RAN1\#90 & R1-1715323 & & & & Inclusion of agreements from RAN1\#90 & 0.1.1 \\
\hline 2017-08 & RAN1\#90 & R1-1715330 & & & & Updated editor's version & 0.1.2 \\
\hline 2017-09 & RAN\#77 & RP-171995 & & & & For information to plenary & 1.0.0 \\
\hline 2017-09 & RAN1\#90bi s & R1-1716929 & & & & Inclusion of agreements until RAN1-adhoc\#3 & 1.0.1 \\
\hline 2017-10 & RAN1\#90bi s & R1-1719107 & & & & Endorsed by RAN1\#90bis & 1.1.0 \\
\hline 2017-11 & RAN1\#90bi s & R1-1719226 & & & & Inclusion of agreements from RAN1\#90bis & 1.1.1 \\
\hline 2017-11 & RAN1\#90bi s & R1-1719243 & & & & Updated editor's version & 1.1.2 \\
\hline 2017-11 & RAN1\#90bi s & R1-1721050 & & & & Endorsed by RAN1\#90bis & 1.2.0 \\
\hline 2017-12 & RAN1\#91 & R1-1721343 & & & & Inclusion of agreements from RAN1\#91 & 1.3.0 \\
\hline 2017-12 & RAN\#78 & RP-172703 & & & & Endorsed version for approval by plenary & 2.000 \\
\hline 2017-12 & RAN\#78 & & & & & Approved by plenary - Rel-15 spec under change control & 15.0.0 \\
\hline 2018-03 & RAN\#79 & RP-180200 & 0001 & - & F & CR capturing the NR ad-hoc 1801 and RAN1\#92 meeting agreements & 15.1.0 \\
\hline 2018-06 & RAN\#80 & RP-181172 & 0002 & 1 & F & CR to TS 38.213 capturing the RAN1\#92bis and RAN1\#93 meeting agreements and aligning higher layer parameters with TS 38.331 & 15.2.0 \\
\hline 2018-09 & RAN\#81 & RP-181789 & 0005 & - & F & CR to 38.213 capturing the RAN1\#94 meeting agreements & 15.3.0 \\
\hline 2018-09 & RAN\#81 & RP-182071 & 0006 & - & C & Support maximum 8 SS/PBCH blocks for unpaired spectrum beyond 2.4 GHz & 15.3 .0 \\
\hline 2018-12 & RAN\#82 & RP-182523 & 0007 & 2 & F & Combined CR of all essential corrections to 38.213 from RAN1\#94bis and RAN1\#95. & 15.4.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0009 & - & F & Conrection on search space sharing & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0010 & - & F & CR on timing adjustment indicator & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0011 & - & F & CR on SSB-RO association & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0012 & - & F & Removal of CSI request in RAR grant & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0014 & - & F & Conrection to dynamic HARQ codebook in NR & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0015 & 1 & F & Conrections to TS 38.213 & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0016 & - & F & CR on simultaneous active BWP switching across caniers & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0017 & - & F & CR on using CORESET\#0 in dedicated DL BWP & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0018 & - & F & PDCCH monitoring for overlapped CORESETs & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0019 & - & F & Correction to last PUCCH resource set configuration & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0020 & - & F & Conrection on physical downlink control channel & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0021 & - & F & Conrection to align RAN1 and RAN4 specifications for EN-DC power control & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0022 & - & F & (Late Drop) CR on PRACH Power Ramping Counter Suspension & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0023 & - & F & QCL properties of Msg4 in CONNECTED Mode & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0024 & - & F & CR on latency after gNB response for recovery & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0025 & - & F & Clarifying DL reception and UL transmission related restrictions & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0026 & - & F & CR on QCL assumption for receiving PDCCH for RAR & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0027 & - & F & CR on identifying transmission occasion after resetting a PC closed loop & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0028 & - & F & CR on overlapping of CSI and PUSCH with slot aggregation & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0029 & - & F & Conrection on PHR timing for configured grant & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0030 & - & F & CR on QCL assumption for a CORESET other than 0 & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0031 & - & F & Correction on DCI format 2 3 for SUL cell in TS 38.213 & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0032 & - & F & Correction to support FR1 extension to 7.125 GHz & 15.5 .0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0033 & - & F & CR on UE procedure for reporting multiple UCI types & 15.5.0 \\
\hline 2019-03 & RAN\#83 & RP-190449 & 0034 & - & F & Conrection to transmission timing adjustments in TS 38.213 & 15.5.0 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0035 & - & F & CR on missing case for DCI format 1_1 with CS-RNTI & 15.600 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0036 & 1 & F & CR on the determination of the minimum number of PRBs for PUCCH transmission & 15.60 \\
\hline
\end{tabular}
\end{table}

ETSI


--- Page 239  ---


3GPP TS 38.213 version 17.1.0 Release 17
238
ETSI TS 138213 V17.1.0 (2022-05)

\begin{tabular}{|l|l|l|l|l|l|l|l|}
\hline 2019-06 & RAN\#84 & RP-191283 & 0037 & - & F & CR on PHR determination and transmission & 15.6.0 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0038 & 4 & F & Conrections to 38.213 including alignment of terminology across specifications & 15.6.0 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0039 & 1 & F & Conrection on PUSCH power scaling & 15.6 .0 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0040 & - & F & Correction on PDCCH monitoring & 15.6 .0 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0041 & - & F & Conrection on CRC assumption for multi-CSI resource selection and CSI report(s) selection & 15.6.0 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0042 & - & F & Clarification of reference to PDSCH processing capability 1 in TS 38.213 & 15.6.0 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0043 & - & F & Conrection on the timeline condition of multiplexing two HARQACK information in one slot & 15.6.0 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0044 & - & F & CR on Type-1 HARQ-ACK codebook determination & 15.6.0 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0045 & - & F & Correction on PHR in EN-DC & 15.6 .0 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0046 & - & F & CR to 38.213 on deactivation timing for ScellDeactivationTimer & 15.6 .0 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0047 & - & F & CR on single transmission timing for synchronous intra-band EN-DC & 15.6.0 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0048 & - & F & CR on PDCCH Monitoring for NR-DC & 15.6.0 \\
\hline 2019-06 & RAN\#84 & RP-191283 & 0049 & - & F & CR on Timing for MAC CE Applicability & 15.6.0 \\
\hline 2019-09 & RAN\#85 & RP-191942 & 0051 & - & F & Correction on RA procedure triggered by higher layers & 15.7 .0 \\
\hline 2019-09 & RAN\#85 & RP-191942 & 0052 & 1 & F & CR on UE procedure for reporting multiple UCI types & 15.7.0 \\
\hline 2019-09 & RAN\#85 & RP-191942 & 0053 & - & F & CR to 38.213 fix to HARQ-ACK Type-1 codebook pseudocode & 15.7 .0 \\
\hline 2019-09 & RAN\#85 & RP-191942 & 0054 & - & F & CR to 38.213 on clarification of the RNTI used for scrambling a PUSCH transmission scheduled by RAR UL grant & 15.7 .0 \\
\hline 2019-09 & RAN\#85 & RP-191942 & 0055 & 2 & F & Conrections to 38.213 including alignment of temminology across specifications in RAN1\#98 & 15.7 .0 \\
\hline 2019-09 & RAN\#85 & RP-191942 & 0056 & - & F & Conrection on intra-band EN-DC with single TAG & 15.7 .0 \\
\hline 2019-09 & RAN\#85 & RP-191942 & 0057 & - & F & Conrection on PHR in EN-DC/NE-DC/NR-CA & 15.7 .0 \\
\hline 2019-09 & RAN\#85 & RP-191942 & 0058 & - & F & Correction on the time gap definition & 15.7 .0 \\
\hline 2019-09 & RAN\#85 & RP-191942 & 0059 & - & F & Conrection on slot configuration & 15.7 .0 \\
\hline 2019-09 & RAN\#85 & RP-191942 & 0060 & - & F & CR to 38.213 on PUCCH configuration for NR-DC & 15.7 .0 \\
\hline 2019-09 & RAN\#85 & RP-191942 & 0061 & - & F & Conrection on PUCCH power control & 15.7.0 \\
\hline 2019-12 & RAN\#86 & RP-192626 & 0062 & 1 & F & CR on beta_offset values for UCl reporting in PUSCH & 15.8 .0 \\
\hline 2019-12 & RAN\#86 & RP-192626 & 0063 & - & F & Conrection on RACH occasion & 15.8.0 \\
\hline 2019-12 & RAN\#86 & RP-192626 & 0064 & - & F & Conrection on HARQ-ACK transmission with BWP change & 15.8.0 \\
\hline 2019-12 & RAN\#86 & RP-192626 & 0065 & - & F & CR on slot configuration regarding PUSCH scheduled by RAR & 15.8.0 \\
\hline 2019-12 & RAN\#86 & RP-192626 & 0066 & - & F & Conrection on power control for NE-DC & 15.8.0 \\
\hline 2019-12 & RAN\#86 & RP-192626 & 0067 & - & F & Conrection on time gap definition for HARQ-ACK transmission & 15.8.0 \\
\hline 2019-12 & RAN\#86 & RP-192626 & 0068 & - & F & Conrection on time gap definition for random access procedure & 15.8.0 \\
\hline 2019-12 & RAN\#86 & RP-192626 & 0069 & 3 & F & Conrections to 38.213 including alignment of terminology across specifications in RAN1\#98bis and RAN1\#99 & 15.8.0 \\
\hline 2019-12 & RAN\#86 & RP-193121 & 0070 & 1 & B & Introduction of two-step RACH in NR & 16.0.0 \\
\hline 2019-12 & RAN\#86 & RP-193221 & 0071 & 2 & B & Introduction of shared spectrum channel access & 16.0.0 \\
\hline 2019-12 & RAN\#86 & RP-193123 & 0072 & 1 & B & Introduction of integrated access and backhaul in NR & 16.0.0 \\
\hline 2019-12 & RAN\#86 & RP-193222 & 0073 & 2 & B & Introduction of Industrial IoT & 16.0.0 \\
\hline 2019-12 & RAN\#86 & RP-193125 & 0074 & 1 & B & Introduction of Ultra Reliable Low Latency Communications Enhancements & 16.0.0 \\
\hline 2019-12 & RAN\#86 & RP-193127 & 0075 & 1 & B & Introduction of MIMO enhancements in NR & 16.0.0 \\
\hline 2019-12 & RAN\#86 & RP-193128 & 0076 & 1 & B & Introduction of UE power savings & 16.0.0 \\
\hline 2019-12 & RAN\#86 & RP-193131 & 0077 & 1 & B & Introduction of NR-DC in same Frequency Range and of Cross-carrier Scheduling with Different Numerologies & 16.0.0 \\
\hline 2019-12 & RAN\#86 & RP-193132 & 0078 & 1 & B & Introduction of multiple LTE CRS rate matching patterns & 16.0.0 \\
\hline 2019-12 & RAN\#86 & RP-193124 & 0079 & 1 & B & Introduction of V2X in NR & 16.0.0 \\
\hline 2019-12 & RAN\#86 & RP-193129 & 0080 & 1 & B & Introduction of positioning support in NR & 16.0.0 \\
\hline
\end{tabular}

ETSI


--- Page 240  ---


3GPP TS 38.213 version 17.1.0 Release 17
239
ETSI TS 138213 V17.1.0 (2022-05)

\begin{tabular}{|l|l|l|l|l|l|l|l|}
\hline 2019-12 & RAN\#86 & RP-193223 & 0081 & 2 & B & Introduction of mobility enhancements in NR & 16.0.0 \\
\hline 2020-03 & RAN\#87-e & RP-200184 & 0085 & - & F & Corrections on two-step RACH & 16.1.0 \\
\hline 2020-03 & RAN\#87-e & RP-200194 & 0086 & - & F & Conrections on NR-DC and on Cross-carrier Scheduling with Different Numerologies & 16.1.0 \\
\hline 2020-03 & RAN\#87-e & RP-200186 & 0087 & - & F & Conrections on integrated access and backhaul & 16.1.0 \\
\hline 2020-03 & RAN\#87-e & RP-200189 & 0088 & - & F & Conrections on Industrial IoT & 16.1.0 \\
\hline 2020-03 & RAN\#87-e & RP-200190 & 0089 & - & F & Conrections on MIMO enhancements & 16.1.0 \\
\hline 2020-03 & RAN\#87-e & RP-200193 & 0090 & - & F & Corrections on Mobility Enhancements & 16.1.0 \\
\hline 2020-03 & RAN\#87-e & RP-200185 & 0091 & - & F & Conrections on shared spectrum channel access & 16.1.0 \\
\hline 2020-03 & RAN\#87-e & RP-200192 & 0092 & - & F & Conrections on Positioning & 16.1.0 \\
\hline 2020-03 & RAN\#87-e & RP-200187 & 0093 & - & F & Conrections on Sidelink & 16.1.0 \\
\hline 2020-03 & RAN\#87-e & RP-200191 & 0094 & - & F & Corrections on UE power savings & 16.1.0 \\
\hline 2020-03 & RAN\#87-e & RP-200188 & 0095 & - & F & Conrections on Ultra Reliable Low Latency Communications Enhancements & 16.1.0 \\
\hline 2020-03 & RAN\#87-e & RP-200195 & 0097 & - & F & Introduction of half-duplex operation in CA with unpaired spectrum & 16.1.0 \\
\hline 2020-03 & RAN\#87-e & RP-200447 & 0098 & - & A & Conrections to 38.213 including alignment of teminology across specifications in RAN1\#100-e & 16.1.0 \\
\hline 2020-06 & RAN\#88-e & RP-200683 & 0102 & - & A & Conrection on PDCCH Blind Detection for NR-DC & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-200688 & 0103 & 1 & F & Conrections on integrated access and backhaul & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-200690 & 0104 & 1 & F & Conrections on Ultra Reliable Low Latency Communications Enhancements & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-200693 & 0105 & 1 & F & Corrections on UE power savings & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-200689 & 0106 & 1 & F & Conrections on Sidelink & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-200694 & 0107 & 1 & F & Corrections on Positioning & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-200687 & 0108 & 1 & F & Conrections on shared spectrum channel access & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-200692 & 0109 & 1 & F & Conrections on MIMO enhancements & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-200691 & 0110 & 1 & F & Conrections on Industrial loT & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-200696 & 0111 & 1 & F & Corrections on NR-DC and on Cross-carrier Scheduling with Different Numerologies & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-200686 & 0112 & 1 & F & Conrections on two-step RACH & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-200697 & 0113 & 1 & F & Conrections on half-duplex operation in CA with unpaired spectrum & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-200705 & 0114 & - & B & Introduction of UL transmission switching & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-200695 & 0115 & - & F & Conrections on Mobility Enhancements & 16.2.0 \\
\hline 2020-06 & RAN\#88-e & RP-201349 & 0117 & 1 & A & Extending 8 SSB support to the newly introduced 30 kHz Case C SSB pattern on band n40 & 16.2.0 \\
\hline 2020-09 & RAN\#89-e & RP-201803 & 0119 & - & A & Conrection on the definition for timeline condition & 16.3.0 \\
\hline 2020-09 & RAN\#89-e & RP-201803 & 0120 & - & F & Conrection for PUCCH repetition transmission & 16.3 .0 \\
\hline 2020-09 & RAN\#89-e & RP-201814 & 0121 & - & F & CR on determination of the number of RS for RLM & 16.3.0 \\
\hline 2020-09 & RAN\#89-e & RP-201803 & 0123 & - & A & CR on determining PO for a PUSCH retransmission corresponding to a RAR UL grant in TS 38.213 & 16.3 .0 \\
\hline
\end{tabular}

ETSI


--- Page 241  ---


3GPP TS 38.213 version 17.1.0 Release 17
240
ETSI TS 138213 V17.1.0 (2022-05)

\begin{tabular}{|l|l|l|l|l|l|l|l|}
\hline 2020-09 & RAN\#89-e & RP-201803 & 0125 & - & F & PRACH power ramping suspension & 16.3.0 \\
\hline 2020-09 & RAN\#89-e & RP-201806 & 0126 & - & F & Clarify starting slot within DCl 2_5 indication & 16.3.0 \\
\hline 2020-09 & RAN\#89-e & RP-201804 & 0127 & - & F & CR on 2-step RACH for 38.213 & 16.3 .0 \\
\hline 2020-09 & RAN\#89-e & RP-201813 & 0128 & - & F & CR on Power Control for NR-DC & 16.3.0 \\
\hline 2020-09 & RAN\#89-e & RP-201810 & 0129 & - & F & Type-3 CSS monitoring with PS-RNTI on primary cell & 16.3.0 \\
\hline 2020-09 & RAN\#89-e & RP-201812 & 0131 & - & F & CR on correction on uplink power sharing for DAPS HO & 16.3.0 \\
\hline 2020-09 & RAN\#89-e & RP-201812 & 0132 & - & F & CR on correction on PDCCH monitoring for DAPS HO & 16.3 .0 \\
\hline 2020-09 & RAN\#89-e & RP-201813 & 0133 & - & F & CR to 38.213 on RRC parameter alignment for SCell domancy & 16.3.0 \\
\hline 2020-09 & RAN\#89-e & RP-201813 & 0134 & - & F & CR to 38.213 on BWP triggering via SCell domancy indication & 16.3 .0 \\
\hline 2020-09 & RAN\#89-e & RP-201813 & 0135 & - & F & CR to 38.213 on HARQ-ACK processing timeline for DCI format 1_1 with Scell domancy indication without scheduling PDSCH & 16.3.0 \\
\hline 2020-09 & RAN\#89-e & RP-201807 & 0136 & - & F & Conrections on Sidelink & 16.3 .0 \\
\hline 2020-09 & RAN\#89-e & RP-201809 & 0137 & - & F & Conrections on MIMO enhancements & 16.3.0 \\
\hline 2020-09 & RAN\#89-e & RP-201805 & 0138 & - & F & Corrections on shared spectrum channel access & 16.3.0 \\
\hline 2020-09 & RAN\#89-e & RP-201808 & 0139 & - & F & Conrections on Ultra Reliable Low Latency Communications Enhancements & 16.3.0 \\
\hline 2020-09 & RAN\#89-e & RP-202015 & 0141 & 1 & A & Extending 8 SSB support to the TDD bands with newly introduced 30 kHz Case C SSB pattern & 16.3 .0 \\
\hline 2020-09 & RAN\#89-e & RP-201847 & 0142 & - & A & Conrection on supplementary uplink in Rel-16 TS 38.213 & 16.3.0 \\
\hline 2020-12 & RAN\#90-e & RP-202379 & 0144 & - & A & CR on HARQ-ACK Determination for SPS Release & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202383 & 0145 & - & F & Corrections related to sidelink physical layer procedures & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202382 & 0146 & - & F & Clarify DCI Format 2_5 search space sets & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202380 & 0147 & - & F & CR on 2-step RACH for 38.213 & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202385 & 0148 & - & F & Conrection on UL power control & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202388 & 0149 & 1 & F & Conrection on uplink transmission cancellation for DAPS handover & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202388 & 0150 & 1 & F & Conrection on PUSCH processing capability for DAPS handover & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202388 & 0151 & 1 & F & Correction on intra-frequency DAPS handover & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202383 & 0152 & - & F & Conrections on the use of TDRA and FDRA fields SCl for Mode 1 & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202383 & 0153 & - & F & Conrections for the prioritization between uplink transmission and sidelink transmission/reception & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202383 & 0154 & - & F & Conrections related to the sidelink slot index & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202383 & 0155 & - & F & Conrection on sidelink pathloss calculation for S-SSB power control & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202383 & 0156 & 1 & F & Correction on sidelink TDD configuration for OoC UEs & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202379 & 0158 & - & A & Conrection on HARQ-ACK generation for DL transmission with single TB when multi-TB is configured & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202381 & 0159 & - & F & Miscellaneous corrections on NR unlicensed configured grant & 16.4.0 \\
\hline
\end{tabular}

ETSI


--- Page 242  ---


3GPP TS 38.213 version 17.1.0 Release 17
241
ETSI TS 138213 V17.1.0 (2022-05)

\begin{tabular}{|l|l|l|l|l|l|l|l|}
\hline 2020-12 & RAN\#90-e & RP-202383 & 0160 & - & F & Introduction of the preparation time for SL retransmissions in Mode 1 & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202395 & 0161 & - & F & Conrection on uplink Tx switching & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202381 & 0163 & - & F & Conrection of NRU HARQ procedure in the presence of SPS PDSCH & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202381 & 0165 & - & F & CR to 38.213 on NR-U 2-step RACH PO configuration & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202389 & 0166 & - & F & 38.213 CR for NR-DC power control & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202389 & 0167 & - & F & 38.213 CR Correction on HARQ-ACK codebook for secondary PUCCH group & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202384 & 0168 & - & F & Conrection on Type2 HARQ-ACK codebook construction & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202384 & 0169 & - & F & Conrection on UL grant Type 2 PUSCH release for search space sharing & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202384 & 0170 & - & F & Conrection on PDCCH monitoring on cell(s) configured with Rel-15 PDCCH monitoring capability & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202383 & 0171 & - & F & Conrection on periodicity of resource pool bitmap & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202383 & 0172 & - & F & Correction on PSFCH and PSCCH mapping & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202385 & 0173 & - & F & CR on CBRA based BFR & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202381 & 0174 & - & F & CR to 38.213 to correct references to 38.212 for RACH procedure & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202381 & 0175 & - & F & Conrection on remaining channel occupancy assumption & 16.4 .0 \\
\hline 2020-12 & RAN\#90-e & RP-202398 & 0176 & - & F & Alignment CR for TS 38.213 & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202389 & 0177 & - & F & Corrections for SCell dommancy indication & 16.4.0 \\
\hline 2020-12 & RAN\#90-e & RP-202384 & 0178 & - & F & CR on handling overlapping PUCCH/PUSCH transmissions with repetitions and with different priorities & 16.4 .0 \\
\hline 2021-03 & RAN\#91-e & RP-210055 & 0180 & - & F & Type-1 HARQ-ACK for PDSCH repetition with different SCSs in DL and UL & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210047 & 0182 & - & A & Conrection on the search space configuration of PUCCH-SCell & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210055 & 0183 & - & F & Correction on UCI multiplexing with PUCCH overriding & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210048 & 0184 & - & F & CR on transmission timing adjustment procedure in 38.213 & 16.5 .0 \\
\hline 2021-03 & RAN\#91-e & RP-210055 & 0186 & - & F & Conrection for cancellation due to PDSCH/CSI-RS/SFI & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210049 & 0187 & - & F & Conrection of Type-3 HARQ-ACK codebook generation for a PDSCH with one transport block for a configuration with a maximum number of two TBs & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210049 & 0188 & - & F & Conrection of UE reception of DL control when a DCI indicates a request for a Type-3 HARQ-ACK codebook report without scheduling PDSCH & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210049 & 0189 & - & D & Conection on PUCCH power control for enhanced Type-2 HARQ-ACK codebook and for Type-3 HARQ-ACK codebook & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210052 & 0190 & - & F & CR on HARQ-ACK & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210049 & 0191 & - & F & Conrection on search space set group switching without channel occupancy duration field & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210052 & 0192 & - & F & Conrections on Scell BFR in Rel-16 & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210058 & 0193 & - & F & Correction on uplink Tx switching & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210050 & 0194 & - & F & Conrections related to prioritization between uplink and sidelink & 16.5.0 \\
\hline
\end{tabular}

ETSI


--- Page 243  ---


3GPP TS 38.213 version 17.1.0 Release 17
242
ETSI TS 138213 V17.1.0 (2022-05)

\begin{tabular}{|l|l|l|l|l|l|l|l|}
\hline 2021-03 & RAN\#91-e & RP-210050 & 0195 & - & F & Determination of indexes for slots for S-SS/PSBCH block transmission(s) & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210050 & 0196 & - & F & Restrictions of the slots for S-SSB transmission/reception & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210051 & 0197 & - & F & CR on Timing for secondary cell activation / deactivation with sub-slot PUCCH & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210051 & 0198 & - & F & CR on number of PUCCHs with HARQ-ACK in a slot & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210050 & 0199 & 1 & F & Conrection of SL HARQ-ACK information reporting to the gNB in Mode 1 & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210049 & 0200 & - & F & Conrection on LBT Type and CP Extension Indication for SemiStatic Channel Occupancy in RAR & 16.5 . \\
\hline 2021-03 & RAN\#91-e & RP-210054 & 0201 & - & F & CR to 38.213 on PRACH handling for NR-DC power control & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210054 & 0202 & - & F & CR to 38.213 on HARQ-ACK priority determination for SCell dormancy indication & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210055 & 0203 & - & F & 38.213 CR on DCI ordering in a search space set & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210051 & 0204 & - & F & Conrection on dci-FormatsExt in clause 10.1 in TS 38.213 & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210051 & 0205 & - & F & Resolving collision with semi-static DL and SSB symbols & 16.5 . \\
\hline 2021-03 & RAN\#91-e & RP-210051 & 0206 & - & F & Conrection on PUCCH resource determination in clause 9.2.1 in TS 38.213 & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210059 & 0207 & - & F & Editorial corrections for 38.213 & 16.5.0 \\
\hline 2021-03 & RAN\#91-e & RP-210126 & 0208 & - & A & Resubmission of CR179r1 on Correction on supplementary uplink in 38.213 & 16.5.0 \\
\hline 2021-06 & RAN\#92-e & RP-211234 & 0209 & - & F & Conrection on multiplexing timeline definition for Type-3 HARQ-ACK codebook & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211234 & 0210 & - & F & Conrection on Type-3 HARQ-ACK codebook size ambiguity & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211250 & 0211 & - & F & CR to TS 38.213 on clarifying DAPS HO impact on PUCCH repetition counting & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211235 & 0212 & - & F & Conrections for the reference signal used for sidelink power control & 16.6 .0 \\
\hline 2021-06 & RAN\#92-e & RP-211237 & 0214 & - & F & Conrections for separate HARQ-ACK feedback of multi-TRP transmission & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211240 & 0215 & - & F & Conrection on half-duplex operation in CA with unpaired spectrum & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211239 & 0216 & - & F & Conrection on MR-DC Uplink Power Control in 38.213 & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211234 & 0217 & - & F & Conrection on MsgA PUSCH validation for semistatic channel access & 16.6 .0 \\
\hline 2021-06 & RAN\#92-e & RP-211238 & 0218 & - & F & CR on the number of pathloss estimates maintained by the UE for SRS for positioning. & 16.6 .0 \\
\hline 2021-06 & RAN\#92-e & RP-211249 & 0219 & - & F & Conditions for |AB-DU soft resource availability & 16.6 .0 \\
\hline 2021-06 & RAN\#92-e & RP-211235 & 0220 & - & F & Correction of search space configuration for DCl formats 3_0 and 3_1 & 16.6 .0 \\
\hline 2021-06 & RAN\#92-e & RP-211234 & 0221 & - & F & Correction on SR reporting due to consistent LBT failure recovery & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211236 & 0222 & - & F & Conrection on Prioritization Timeline & 16.6 .0 \\
\hline 2021-06 & RAN\#92-e & RP-211236 & 0223 & - & F & CR on the configuration for one PUCCH-Config with subslotLengthForPUCCH-r16 & 16.6 .0 \\
\hline
\end{tabular}

ETSI


--- Page 244  ---


3GPP TS 38.213 version 17.1.0 Release 17
243
ETSI TS 138213 V17.1.0 (2022-05)

\begin{tabular}{|l|l|l|l|l|l|l|l|}
\hline 2021-06 & RAN\#92-e & RP-211236 & 0224 & - & F & CR on not supporting Type 1 HARQ-ACK codebook for subslot HARQ-ACK in R16 & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211236 & 0225 & - & F & CR on Number of PUCCH resource sets per PUCCH-config & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211236 & 0226 & - & F & Conrection on UL cancellation due to dynamic SFI & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211233 & 0228 & 1 & A & Rel-15 editorial conections for TS 38.213 (mirrored to Rel-16) & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211243 & 0229 & 1 & F & Rel-16 editorial conrections for TS 38.213 & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211236 & 0230 & - & F & Conrection on UE procedure for determining physical downlink control channel assignment for Rel-16 PDCCH monitoring capability & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211235 & 0232 & - & F & Conrections for the multiplexing SL HARQ-ACK information on a PUSCH & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211237 & 0233 & - & F & Conrection on simultaneous multi-CC TCI indication for CORESET & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211234 & 0234 & - & F & Conrection on HARQ-ACK codebook RRC parameter & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211234 & 0235 & - & F & Initial UL BWP size restriction for NR-U & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211235 & 0236 & - & F & Conrection of SL HARQ-ACK reporting when SL feedback is not used & 16.6 .0 \\
\hline 2021-06 & RAN\#92-e & RP-211235 & 0237 & - & F & Conrection of SL HARQ-ACK reporting on UL for SL CG type 2 & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211240 & 0239 & - & F & Conrection on UL cancellation due to DCl format 2_0 & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211240 & 0240 & - & F & Conrection on half-duplex operation in CA with unpaired spectrum & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211236 & 0241 & - & F & Handling collision between PUCCH/PUSCH and semi-static DL symbols and SSBs & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211236 & 0242 & - & F & Conrection on Type-1 HARQ-ACK codebook & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211252 & 0243 & - & F & Conrection on value of 1-bit counter DAI & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211236 & 0244 & - & F & CR on correction for sub-slot based PUCCH & 16.6.0 \\
\hline 2021-06 & RAN\#92-e & RP-211236 & 0245 & - & F & CR on clarification for reference point of sub-slot based PUCCH resource & 16.6.0 \\
\hline 2021-09 & RAN\#93-e & RP-211842 & 0246 & - & F & Clarification on SL power control and SL type-1 HARQ-ACK codebook in out of coverage case & 16.7 .0 \\
\hline 2021-09 & RAN\#93-e & RP-211842 & 0247 & - & F & Parameter name correction for PSSCH power control & 16.7 .0 \\
\hline 2021-09 & RAN\#93-e & RP-211844 & 0248 & - & F & CR on number of received PDSCHs for multi-TRP transmission & 16.7 .0 \\
\hline 2021-09 & RAN\#93-e & RP-211842 & 0249 & - & F & Conection on synchronization procedure for sidelink transmission & 16.7 .0 \\
\hline 2021-09 & RAN\#93-e & RP-211846 & 0250 & 1 & F & Corrections on SCell dommancy indication & 16.7 .0 \\
\hline 2021-09 & RAN\#93-e & RP-211843 & 0251 & 1 & F & Conrection on overlapping between SPS HARQ-ACK with HP and SP HARQ-ACK with LP & 16.7 .0 \\
\hline 2021-09 & RAN\#93-e & RP-211842 & 0252 & - & F & CR on Simultaneous NR SL and LTE SL Operation & 16.7 .0 \\
\hline 2021-09 & RAN\#93-e & RP-211842 & 0253 & - & F & Clarification on PUCCH Power control & 16.7 .0 \\
\hline 2021-09 & RAN\#93-e & RP-211843 & 0254 & - & F & Conrections on Sub-slot Based HARQ-ACK Feedback for MAC CE Activation/deactivation & 16.7 .0 \\
\hline 2021-09 & RAN\#93-e & RP-211842 & 0255 & - & F & Conrection of SL HARQ-ACK reporting on UL for skipped DG & 16.7 .0 \\
\hline 2021-09 & RAN\#93-e & RP-211842 & 0256 & - & F & Conrection on HARQ reporting for multiple pools with PSFCH & 16.7 .0 \\
\hline
\end{tabular}

ETSI


--- Page 245  ---


3GPP TS 38.213 version 17.1.0 Release 17
244
ETSI TS 138213 V17.1.0 (2022-05)

\begin{tabular}{|l|l|l|l|l|l|l|l|}
\hline 2021-09 & RAN\#93-e & RP-211843 & 0257 & - & F & CR for SPS Release and SPS PDSCH Receptions with Slot Aggregation & 16.7 .0 \\
\hline 2021-09 & RAN\#93-e & RP-211850 & 0258 & - & F & Editorial corrections for TS 38.213 & 16.7 .0 \\
\hline 2021-09 & RAN\#93-e & RP-211843 & 0259 & - & F & Correction on HARQ-ACK timing & 16.7 .0 \\
\hline 2021-12 & RAN\#94-e & RP-212962 & 0260 & - & F & Correction on Case 1 dommancy operation with data scheduling & 16.8.0 \\
\hline 2021-12 & RAN\#94-e & RP-212959 & 0261 & - & F & CR on SL HARQ-ACK feedback reporting to gNB & 16.8 .0 \\
\hline 2021-12 & RAN\#94-e & RP-212959 & 0262 & - & F & Clarification on UCI and SL HARQ-ACK & 16.8.0 \\
\hline 2021-12 & RAN\#94-e & RP-212959 & 0263 & - & F & Correction on priority order in power control for PSFCH & 16.8.0 \\
\hline 2021-12 & RAN\#94-e & RP-212960 & 0264 & - & F & Clarification on intra-UE prioritization/multiplexing on semistatic symbols & 16.8.0 \\
\hline 2021-12 & RAN\#94-e & RP-212961 & 0265 & - & F & Correction on frequency hopping for PUCCH & 16.8.0 \\
\hline 2021-12 & RAN\#94-e & RP-212960 & 0266 & - & F & PUCCH multiplexing with SPS HARQ-ACK or SR within a subslot & 16.8.0 \\
\hline 2021-12 & RAN\#94-e & RP-212964 & 0267 & 1 & F & Editorial corrections for TS 38.213 & 16.8.0 \\
\hline 2021-12 & RAN\#94-e & RP-212973 & 0268 & - & B & Introduction of coverage enhancements in NR & 17.00 \\
\hline 2021-12 & RAN\#94-e & RP-212980 & 0269 & - & B & Introduction of dynamic spectum sharing enhancements in NR & 17.00 \\
\hline 2021-12 & RAN\#94-e & RP-212977 & 0270 & - & B & Introduction of enhanced |AB in NR & 17.0.0 \\
\hline 2021-12 & RAN\#94-e & RP-212967 & 0271 & - & B & Introduction for extending NR operation to 71 GHz & 17.0.0 \\
\hline 2021-12 & RAN\#94-e & RP-212968 & 0272 & - & B & Introduction of lloT/URLLC enhancements in NR & 17.0.0 \\
\hline 2021-12 & RAN\#94-e & RP-212979 & 0273 & - & B & Introduction of multicast-broadcast services in NR & 17.0.0 \\
\hline 2021-12 & RAN\#94-e & RP-212969 & 0274 & - & B & Introduction of non-terrestrial network operation in NR & 17.0.0 \\
\hline 2021-12 & RAN\#94-e & RP-212971 & 0275 & - & B & Introduction of UEs with reduced capabilities in NR & 17.0.0 \\
\hline 2021-12 & RAN\#94-e & RP-212972 & 0276 & - & B & Introduction of UE power savings enhancements in NR & 17.0.0 \\
\hline 2021-12 & RAN\#94-e & RP-212966 & 0277 & - & B & Introduction of further enhancements on MIMO for NR & 17.0.0 \\
\hline 2021-12 & RAN\#94-e & RP-213524 & 0278 & - & B & Introduction of small data transmission in RRC_INACTIVE state for NR & 17.0.0 \\
\hline 2021-12 & RAN\#94-e & RP-212978 & 0279 & - & B & Introduction of sidelink enhancements in NR & 17.00 \\
\hline 2022-03 & RAN\#95-e & RP-220245 & 0281 & - & A & CR on UE procedure for receiving HARQ-ACK on sidelink & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220247 & 0283 & - & A & Conrections on HARQ-ACK timing parameters for Rel-17 & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220272 & 0285 & - & A & CR on properties of tdd-UL-DL-ConfigurationDedicated and tdd-UL-DL-configurationDedicated-IAB-MT & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220246 & 0287 & - & A & Clarification of the SPS PDSCH activation and HARQ-ACK transmission for the 1st SPS PDSCH & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220249 & 0289 & - & A & Rel-16 editorial conrections for TS 38.213 (mirrored to Rel-17) & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220257 & 0290 & - & F & Corrections on coverage enhancements in NR & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220251 & 0291 & - & F & Corrections on extending NR operation to 71 GHz & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220252 & 0292 & - & F & Corrections on lloT/URLLC enhancements in NR & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220263 & 0293 & - & F & Conrections on the introduction of multicast-broadcast services in NR & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220262 & 0294 & - & F & Conrections on sidelink enhancements in NR & 17.1.0 \\
\hline
\end{tabular}

ETSI


--- Page 246  ---


3GPP TS 38.213 version 17.1.0 Release 17
245
ETSI TS 138213 V17.1.0 (2022-05)

\begin{tabular}{|l|l|l|l|l|l|l|l|}
\hline 2022-03 & RAN\#95-e & RP-220256 & 0295 & - & F & Conrections on UE power savings enhancements in NR & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220261 & 0296 & - & F & Conrections on elAB & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220250 & 0297 & - & F & Conrections on further enhancements on MIMO for NR & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220271 & 0298 & - & C & Introduction of carrier BW smaller than 40 MHz for n79 & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220264 & 0299 & - & F & Conrections on dynamic spectrum sharing enhancements in NR & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220253 & 0300 & - & F & Conrections on non-tenrestrial network operation in NR & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220254 & 0301 & - & F & Conrections on positioning enhancements in NR & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220255 & 0302 & - & F & Conrections on the introduction of UEs with reduced capabilities in NR & 17.1.0 \\
\hline 2022-03 & RAN\#95-e & RP-220270 & 0303 & - & F & Conrections on small data transmission in RRC_INACTIVE state for NR & 17.1.0 \\
\hline
\end{tabular}

ETSI


--- Page 247  ---


3GPP TS 38.213 version 17.1.0 Release 17
246
ETSI TS 138213 V17.1.0 (2022-05)

\begin{table}
\captionsetup{labelformat=empty}
\caption{History}
\begin{tabular}{|l|l|l|}
\hline \multicolumn{3}{|r|}{Document history} \\
\hline V17.1.0 & May 2022 & Publication \\
\hline & & \\
\hline & & \\
\hline & & \\
\hline & & \\
\hline
\end{tabular}
\end{table}

ETSI

