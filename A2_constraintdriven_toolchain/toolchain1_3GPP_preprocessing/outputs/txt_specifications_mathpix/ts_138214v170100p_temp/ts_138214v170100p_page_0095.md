<!-- Page 95 of ts_138214v170100p -->

3GPP TS 38.214 version 17.1.0 Release 17
94
ETSI TS 138214 V17.1.0 (2022-05)
- The values of \( N_{g}, N_{1} \) and \( N_{2} \) are configured with the higher layer parameters \( n g-n 1-n 2 \). The supported configurations of \( \left(N_{g}, N_{1}, N_{2}\right) \) for a given number of CSI-RS ports and the corresponding values of \( \left(O_{1}, O_{2}\right) \) are given in Table 5.2.2.2.2-1. The number of CSI-RS ports, \( P_{\text {CSI-RS }} \), is \( 2 N_{g} N_{1} N_{2} \).
- When \( N_{g}=2 \), codebookMode shall be set to either ' 1 ' or ' 2 '. When \( N_{g}=4 \), codebookMode shall be set to ' 1 '. The bitmap parameter \( n g-n 1-n 2 \) forms the bit sequence \( a_{A_{\mathrm{c}}-1}, \ldots, a_{1}, a_{0} \) where \( a_{0} \) is the LSB and \( a_{A_{\mathrm{c}}-1} \) is the MSB and where a bit value of zero indicates that PMI reporting is not allowed to correspond to any precoder associated with the bit. The number of bits is given by \( A_{c}=N_{1} O_{1} N_{2} O_{2} \). Bit \( a_{N_{2} O_{2} /+m} \) is associated with all precoders based on the quantity \( v_{r, m}, l=0, \ldots, N_{1} O_{1}-1, m=0, \ldots, N_{2} O_{2}-1 \), as defined below. The bitmap parameter ri-Restriction forms the bit sequence \( r_{3}, \ldots, r_{1}, r_{0} \) where \( r_{0} \) is the LSB and \( r_{3} \) is the MSB. When \( r_{i} \) is zero, \( i \in\{0,1, \ldots, 3\} \), PMI and RI reporting are not allowed to correspond to any precoder associated with \( v=i+1 \) layers.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 5.2.2.2.2-1: Supported configurations of \( \left(N_{g}, N_{1}, N_{2}\right) \) and \( \left(O_{1}, O_{2}\right) \)}
\begin{tabular}{|l|l|l|}
\hline Number of CSI-RS antenna ports, \( P_{\text {CSJ-RS }} \) & ( \( N_{g}, N_{1}, N_{2} \) ) & ( \( O_{1}, O_{2} \) ) \\
\hline 8 & (2,2,1) & \( (4,1) \) \\
\hline \multirow{3}{*}{16} & (2,4,1) & \( (4,1) \) \\
\hline & (4,2,1) & \( (4,1) \) \\
\hline & (2,2,2) & \( (4,4) \) \\
\hline \multirow{4}{*}{32} & (2,8,1) & \( (4,1) \) \\
\hline & (4,4,1) & \( (4,1) \) \\
\hline & (2,4,2) & \( (4,4) \) \\
\hline & (4,2,2) & \( (4,4) \) \\
\hline
\end{tabular}
\end{table}

Each PMI value corresponds to the codebook indices \( i_{1} \) and \( i_{2} \), where \( i_{1} \) is the vector
\[
i_{1}=\left\{\begin{array}{ll}
{\left[\begin{array}{lll}
i_{1,1} & i_{1,2} & i_{1,4}
\end{array}\right]} & v=1 \\
{\left[\begin{array}{lll}
i_{1,1} & i_{1,2} & i_{1,3}
\end{array} i_{1,4}\right]} & v \in\{2,3,4\}
\end{array}\right.
\]
and \( v \) is the associated RI value. When codebookMode is set to ' 1 ', \( i_{1,4} \) is
\[
i_{1,4}=\left\{\begin{array}{lll} 
& i_{1,4,1} & \\
{\left[i_{1,4,1}\right.} & i_{\mathrm{l}, 4,2}=2 \\
\left.i_{1,4,3}\right] & N_{\mathrm{g}}=4
\end{array} .\right.
\]

When codebookMode is set to ' 2 ', \( i_{1,4} \) and \( i_{2} \) are
\[
\begin{array}{c}
i_{\mathbf{1}, 4}=\left[\begin{array}{ll}
i_{\mathbf{l}, 4, \mathbf{1}} & i_{\mathbf{1}, 4,2}
\end{array}\right] \\
i_{2}=\left[\begin{array}{lll}
i_{2,0} & i_{2, \mathbf{1}} & i_{2,2}
\end{array}\right]
\end{array}
\]

The mapping from \( i_{1,3} \) to \( k_{1} \) and \( k_{2} \) for 2-layer reporting is given in Table 5-2.2.2.1-3. The mapping from \( i_{1,3} \) to \( k_{1} \) and \( k_{2} \) for 3-layer and 4-layer reporting is given in Table 5.2.2.2.2-2.
- UE shall only use \( i_{1,2}=0 \) and shall not report \( i_{1,2} \) if the value of \( N_{2} \) is 1 .

ETSI