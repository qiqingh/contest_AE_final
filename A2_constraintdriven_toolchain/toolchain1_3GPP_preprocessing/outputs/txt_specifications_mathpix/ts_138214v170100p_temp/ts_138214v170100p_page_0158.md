<!-- Page 158 of ts_138214v170100p -->

3GPP TS 38.214 version 17.1.0 Release 17
157
ETSI TS 138214 V17.1.0 (2022-05)

DCI format 0_1 for a given resource allocation type indicated by resourceAllocation, except if uselnterlacePUCCH-PUSCH in BWP-UplinkDedicated is configured, in which case uplink type 2 resource allocation is used wherein the UE interprets the LSB bits in the higher layer parameter frequencyDomainAllocation as for the frequency domain resource assignment field of DCI 0_1 according to the procedure in Clause 6.1.2.2.3;
- The \( I_{M C S} \) is provided by higher layer parameter mcsAndTBS;
- Number of DM-RS CDM groups, DM-RS ports, SRS resource indication and DM-RS sequence initialization are determined as in Clause 7.3.1.1.2 of [5, TS 38.212], and the antenna port value, the bit value for DM-RS sequence initialization, precoding information and number of layers, SRS resource indicator are provided by antennaPort, dmrs-SeqInitialization, precodingAndNumberOfLayers, and srs-ResourceIndicator respectively; When two SRS resource sets are configured in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2, precoding information and number of layers (applicable when higher layer parameter usage in SRS-ResourceSet set to 'codebook') associated with the first and second SRS resource set is provided by precodingAndNumberOfLayers and precodingAndNumberOfLayers2, respectively, and SRS resource indicators associated with the first and second SRS resource sets are provided by srs-ResourceIndicator and srs-ResourceIndicator2, respectively. When both srsResourceSetToAddModList and srs-ResourceSetToAddModListDCI-0-2 are configured with two SRS resource sets, the two SRS resource sets configured by srs-ResourceSetToAddModList is used to determine the SRS resource indications by srs-ResourceIndicator and srs-ResourceIndicator2.
- If two SRS resource sets with usage set to 'codebook' or 'noncodebook' are configured in srsResourceSetToAddModList, the two SRS resource sets are used to determine the SRS resource indications by srs-Resourcelndicator and srs-Resourcelndicator 2.
- otherwise, the two SRS resource sets with usage set to 'codebook' or 'noncodebook' configured in srs-ResourceSetToAddModListDCI-0-2 are used to determine the SRS resource indications by srsResourceIndicator and srs-Resourcelndicator2.
- When frequency hopping is enabled, the frequency offset between two frequency hops can be configured by higher layer parameter frequencyHoppingOffset.
- For Type 2 PUSCH transmissions with a configured grant: the resource allocation follows the higher layer configuration according to [10, TS 38.321], and UL grant received on the DCI.
- The PUSCH repetition type and the time domain resource allocation table are determined by the PUSCH repetition type and the time domain resource allocation table associated with the UL grant received on the DCI, respectively, as defined in Clause 6.1.2.1. The value of \( K_{0} \). \( \mathrm{Jset}_{1} \), if configured, is applied when determining the first transmission opportunity.

For PUSCH transmissions with a Type 1 or Type 2 configured grant, the number of (nominal) repetitions \( K \) to be applied to the transmitted transport block is provided by the indexed row in the time domain resource allocation table if numberOfRepetitions is present in the table; otherwise \( K \) is provided by the higher layer configured parameters repK.

For PUSCH transmissions with a Type 2 configured grant, when two SRS resource sets are configured in srsResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2, the SRS resource set association to (nominal) repetitions follows MappingPattern in ConfiguredGrantConfig as defined in Clause 6.1.2.1 for PUSCH scheduled by DCI format 0_1 and 0_2. For PUSCH transmissions with a Type 1 configured grant, when two SRS resource sets with usage set to 'codebook' or 'noncodebook' are configured in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2, if two SRS resource indicators and two precoding information are provided, the SRS resource set association to (nominal) repetitions is determined as follows. When \( \mathrm{K}=2 \), the first and second SRS resource sets are applied to the first and second (nominal) repetitions, respectively.
- When \( \mathrm{K}>2 \) and cyclicMapping in ConfiguredGrantConfig is enabled, the first and second SRS resource sets are applied to the first and second (nominal) repetitions, respectively, and the same SRS resource set mapping pattern continues to the remaining (nominal) repetitions.
- When \( \mathrm{K}>2 \) and sequentialMapping in ConfiguredGrantConfig is enabled, first SRS resource set is applied to the first and second (nominal) repetitions, and the second SRS resource set is applied to the third and fourth (nominal) repetitions, and the same SRS resource set mapping pattern continues to the remaining (nominal) repetitions.

ETSI