<!-- Page 154 of ts_138214v170100p -->

3GPP TS 38.214 version 17.1.0 Release 17
153
ETSI TS 138214 V17.1.0 (2022-05)
6.1.2.2 Resource allocation in frequency domain

The UE shall determine the resource block assignment in frequency domain using the resource allocation field in the detected PDCCH DCI except for a PUSCH transmission scheduled by a RAR UL grant or fallbackRAR UL grant, in which case the frequency domain resource allocation is determined according to clause 8.3 of [6,38.213] or a MsgA PUSCH transmission with frequency domain resource allocation determined according to clause 8.1A of [6,38.213]. Three uplink resource allocation schemes type 0 , type 1 and type 2 are supported. Uplink resource allocation scheme type 0 is supported for PUSCH only when transform precoding is disabled. Uplink resource allocation scheme type 1 and type 2 are supported for PUSCH for both cases when transform precoding is enabled or disabled.

If the scheduling DCI is configured to indicate the uplink resource allocation type as part of the 'Frequency domain resource' assignment field by setting a higher layer parameter resourceAllocation in pusch-Config to 'dynamicSwitch', for DCI format \( 0 \_1 \) or setting a higher layer parameter resourceAllocationDCI-0-2 in pusch-Config to 'dynamicSwitch' for DCI format 0_2, the UE shall use uplink resource allocation type 0 or type 1 as defined by this DCI field. Otherwise the UE shall use the uplink frequency resource allocation type as defined by the higher layer parameter resourceAllocation for DCI format \( 0 \_1 \) or the higher layer parameter resourceAllocationDCI-0-2 for DCI format \( 0 \_2 \). The UE shall assume that when the scheduling PDCCH is received with DCI format \( 0 \_1 \) and useInterlacePUCCHPUSCH in BWP-UplinkDedicated is configured, uplink type 2 resource allocation is used.

The UE shall assume that when the scheduling PDCCH is received with DCI format \( 0 \_0 \), then uplink resource allocation type 1 is used, except when any of the higher layer parameters useInterlacePUCCH-PUSCH in BWPUplinkCommon and useInterlacePUCCH-PUSCH in BWP-UplinkDedicated is configured in which case uplink resource allocation type 2 is used.

The UE expects that either none or both of uselnterlacePUCCH-PUSCH in BWP-UplinkCommon and useInterlacePUCCH-PUSCH in BWP-UplinkDedicated is configured.

If a bandwidth part indicator field is not configured in the scheduling DCI or the UE does not support active bandwidth part change via DCI, the RB indexing for uplink type 0 , type 1 and type 2 resource allocation is determined within the UE's active bandwidth part. If a bandwidth part indicator field is configured in the scheduling DCI and the UE supports active bandwidh part change via DCI, the RB indexing for uplink type 0 , type 1 , type 2 resource allocation is determined within the UE's bandwidth part indicated by bandwidth part indicator field value in the DCI. The UE shall upon detection of PDCCH intended for the UE determine first the uplink bandwidth part and then the resource allocation within the bandwidth part. RB numbering starts from the lowest RB in the determined uplink bandwidth part.
6.1.2.2.1 Uplink resource allocation type 0

In uplink resource allocation of type 0 , the resource block assignment information includes a bitmap indicating the Resource Block Groups (RBGs) that are allocated to the scheduled UE where a RBG is a set of consecutive virtual resource blocks defined by higher layer parameter rbg-Size configured in pusch-Config and the size of the bandwidth part as defined in Table 6.1.2.2.1-1.

\begin{table}
\captionsetup{labelformat=empty}
\caption{Table 6.1.2.2.1-1: Nominal RBG size \( P \)}
\begin{tabular}{|c|c|c|}
\hline Bandwidth Part Size & Configuration 1 & Configuration 2 \\
\hline \( 1-36 \) & 2 & 4 \\
\hline \( 37-72 \) & 4 & 8 \\
\hline \( 73-144 \) & 8 & 16 \\
\hline \( 145-275 \) & 16 & 16 \\
\hline
\end{tabular}
\end{table}

The total number of RBGs ( \( N_{\mathrm{RBG}} \) ) for a uplink bandwidth part \( i \) of size \( N_{\mathrm{BWRPR}}^{\text {size }} \) pren is given by
\[
N_{R B G}=\left[\left(N_{B W P, i}^{\text {sze }}+\left(N_{B W P, i}^{\text {start }} \bmod P\right)\right) / P\right] \text { where }
\]
- the size of the first RBG is \( R B G^{\text {size }}=P-N_{B W P, i}^{\text {start }} \bmod P \),
- the size of the last RBG is \( R B G_{\text {ast }}^{\text {size }}=\left(N_{B W P_{t}}^{\text {start }}+N_{B W P_{t}}^{\text {size }}\right) \bmod P_{\text {if }}\left(N_{B W A}^{\text {start }}+N_{B W P_{t}}^{\text {size }}\right) \bmod P>0 \) and \( P \) otherwise.

ETSI