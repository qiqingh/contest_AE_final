<!-- Page 139 of ts_138214v170100p -->

3GPP TS 38.214 version 17.1.0 Release 17
138
ETSI TS 138214 V17.1.0 (2022-05)

For codebook based transmission, only one SRS resource can be indicated based on the SRI from within the SRS resource set. Except when higher layer parameter ul-FullPowerTransmission is set to 'fullpowerMode2', the maximum number of configured SRS resources for codebook based transmission is 2 . If aperiodic SRS is configured for a UE, the SRS request field in DCI triggers the transmission of aperiodic SRS resources.

A UE shall not expect to be configured with higher layer parameter ul-FullPowerTransmission set to 'fullpowerMode1' and codebookSubset or codebookSubsetDCI-0-2 set to 'fullAndPartialAndNonCoherent' simultaneously.

The UE shall transmit PUSCH using the same antenna port(s) as the SRS port(s) in the SRS resource indicated by the DCI format \( 0 \_1 \) or \( 0 \_2 \) or by configured GrantConfig according to clause 6.1.2.3.

The DM-RS antenna ports \( \left\{\widetilde{p}_{0, \ldots,} \widetilde{p}_{v-1}\right\} \) in Clause 6.4.1.1.3 of [4, TS38.211] are determined according to the ordering of DM-RS port(s) given by Tables 7.3.1.1.2-6 to 7.3.1.1.2-23 in Clause 7.3.1.1.2 of [5, TS 38.212].

Except when higher layer parameter ul-FullPowerTransmission is set to 'fullpowerMode2', when multiple SRS resources are configured by SRS-ResourceSet with usage set to 'codebook', the UE shall expect that higher layer parameters nrofSRS-Ports in SRS-Resource in SRS-ResourceSet shall be configured with the same value for all these SRS resources.

When higher layer parameter ul-FullPowerTransmission is set to 'fullpowerMode2',
- the UE can be configured with one SRS resource or multiple SRS resources with same or different number of SRS ports within an SRS resource set with usage set to 'codebook'.
- up to 2 different spatial relations can be configured for all SRS resources in the SRS resource set with usage set to 'codebook' when multiple SRS resources are configured in the SRS resource set.
- subject to UE capability, a maximum of 2 or 4 SRS resources are supported in an SRS resource set with usage set to 'codebook'.
6.1.1.2 Non-Codebook based UL transmission

For non-codebook based transmission, PUSCH can be scheduled by DCI format \( 0 \_0, \mathrm{DCI} \) format \( 0 \_1, \mathrm{DCI} \) format \( 0 \_2 \) or semi-statically configured to operate according to Clause 6.1.2.3. If this PUSCH is scheduled by DCI format 0_1, DCI format \( 0 \_2 \), or semi-statically configured to operate according to Clause 6.1.2.3, the UE can determine its PUSCH precoder(s) and transmission rank based on the SRI(s) when multiple SRS resources are configured, where the SRI(s) is given by one or two SRS resource indicator(s) in DCI according to clause 7.3.1.1.2 and 7.3.1.1.3 of [5,38.212] for DCI format \( 0 \_1 \) and DCI format \( 0 \_2 \), or the SRI is given by srs-ResourceIndicator according to clause 6.1.2.3, or two SRIs given by srs-ResourceIndicator and srs-ResourceIndicator 2 according to clause 6.1.2.3. The SRS-ResourceSet(s) applicable for PUSCH scheduled by DCI format \( 0 \_1 \) and DCI format \( 0 \_2 \) are defined by the entries of the higher layer parameter srs-ResourceSetToAddModList and srs-ResourceSetToAddModListDCI-0-2 in SRS-config, respectively. The UE shall use one or multiple SRS resources for SRS transmission, where, in a SRS resource set, the maximum number of SRS resources which can be configured to the UE for simultaneous transmission in the same symbol and the maximum number of SRS resources are UE capabilities. The SRS resources transmitted simultaneously occupy the same RBs. Only one SRS port for each SRS resource is configured. Only one or two SRS resource sets can be configured in srs-ResourceSetToAddModList with higher layer parameter usage in SRS-ResourceSet set to 'nonCodebook', and only one or two SRS resource sets can be configured in srs-ResourceSetToAddModListDCI-0-2 with higher layer parameter usage in SRS-ResourceSet set to 'nonCodebook'. When two SRS resource sets are configured in srs-ResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with higher layer parameter usage in SRS-ResourceSet set to 'nonCodebook', one or two SRIs are given by the DCI fields of two SRS resource indicators in clause 7.3.1.1.2 and 7.3.1.1.3 of [5, TS 38.212] for DCI format 0_1 and 0_2. The UE applies the indicated SRI(s) to one or more PUSCH repetitions according to the associated SRS resource set of a PUSCH repetition according to clause 6.1.2.1. The maximum number of SRS resources per SRS resource set that can be configured for non-codebook based uplink transmission is 4 . Each of the indicated one or two SRIs in slot \( n \) is associated with the most recent transmission of SRS resource(s) of associated SRS resource set identified by the SRI, where the SRS transmission is prior to the PDCCH carrying the SRI. When two SRS resource sets are configured in srsResourceSetToAddModList or srs-ResourceSetToAddModListDCI-0-2 with higher layer parameter usage in SRSResourceSet set to 'nonCodebook', the UE is not expected to be configured with different number of SRS resources in the two SRS resource sets.

When the PDCCH reception includes two PDCCH candidates from two respective search space sets, as described in clause 10.1 of [6, TS 38.213], for the purpose of determining the most recent transmission of SRS resource(s) identified by the SRI, the PDCCH candidate that starts earlier in time is used.

ETSI