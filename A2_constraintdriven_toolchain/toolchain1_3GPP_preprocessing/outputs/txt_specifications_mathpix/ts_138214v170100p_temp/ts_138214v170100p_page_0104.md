<!-- Page 104 of ts_138214v170100p -->

3GPP TS 38.214 version 17.1.0 Release 17
103
ETSI TS 138214 V17.1.0 (2022-05)

for \( k=0,1, \ldots, 3 \), where the indices are assigned such that \( g^{(k)} \) increases as \( k \) increases. The remaining vector groups are not restricted.
- If \( N_{2}=1, g^{(k)}=k \) for \( k=0,1, \ldots, 3 \), and \( B_{1} \) is empty.
- If \( N_{2}>1, B_{1}=b_{1}^{(10)} \cdots b_{1}^{(0)} \) is the binary representation of the integer \( \beta_{1} \) where \( b_{1}^{(10)} \) is the MSB and \( b_{1}^{(0)} \) is the LSB. \( \beta_{1} \) is found using:
\[
\beta_{1}=\sum_{k=0}^{3} C\left(O_{1} O_{2}-1-g^{(k)}, 4-k\right)
\]
where \( C(x, y) \) is defined in Table 5.2.2.2.3-1. The group indices \( g^{(k)} \) and indicators \( \left(r_{1}^{(k)}, r_{2}^{(k)}\right) \) for \( k=0,1,2,3 \) may be found from \( \beta_{1} \) using the algorithm:
\[
s_{-1}=0
\]
for \( k=0, \ldots, 3 \)
Find the largest \( x^{*} \in\left\{3-k, \ldots, O_{1} O_{2}-1-k\right\} \) such that \( \beta_{1}-s_{k-1} \geq C\left(x^{*}, 4-k\right) \)
\[
\begin{array}{l}
e_{k}=C\left(x^{*}, 4-k\right) \\
s_{k}=s_{k-1}+e_{k} \\
g^{(k)}=Q O_{2}-1-x^{*} \\
r_{1}^{(k)}=g^{(k)} \bmod O_{1} \\
r_{2}^{(k)}=\frac{\left(g^{(k)}-r_{1}^{(k)}\right)}{O_{1}}
\end{array}
\]

The bit sequence \( B_{2}=B_{2}^{(0)} B_{2}^{(1)} B_{2}^{(2)} B_{2}^{(3)} \) is the concatenation of the bit sequences \( B_{2}^{(k)} \) for \( k=0,1, \ldots, 3 \), corresponding to the group indices \( g^{(k)} \). The bit sequence \( B_{2}^{(k)} \) is defined as
\[
B_{2}^{(k)}=b_{2}^{\left(k, 2 N_{1} N_{2}-1\right)} \cdots b_{2}^{(k, 0)}
\]

Bits \( b_{2}^{\left(k, 2\left(N x_{2}+x_{1}\right)+1\right)} b_{2}^{\left(k, 2\left(N x_{2}+x_{1}\right)\right)} \) indicate the maximum allowed amplitude coefficient \( p_{l, i}^{(l)} \) for the vector in group \( g^{(k)} \) indexed by \( x_{1}, x_{2} \), where the maximum amplitude coefficients are given in Table 5.2.2.2.3-6. A UE that does not report parameter amplitudeSubsetRestriction \( = \) 'supported' in its capability signaling is not expected to be configured with \( b_{2}^{\left(k, 2\left(N_{1} x_{2}+x_{1}\right)+1\right)} b_{2}^{\left(k, 2\left(N_{1} x_{2}+x_{1}\right)\right)}=01 \) or 10 .

ETSI